var map4d=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=63)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.SURFACE=0]="SURFACE",t[t.ROADS=1]="ROADS",t[t.BOUNDARY=2]="BOUNDARY",t[t.LABEL=3]="LABEL",t[t.RASTER=4]="RASTER",t[t.POI=5]="POI",t[t.BUILDING=6]="BUILDING",t[t.LINE=7]="LINE",t[t.FILL=8]="FILL",t[t.CIRCLE=9]="CIRCLE",t[t.SYMBOL=10]="SYMBOL",t[t.USERPOI=11]="USERPOI",t[t.USERBUILDING=12]="USERBUILDING",t[t.GEOJSON=13]="GEOJSON",t[t.RASTER_OVERLAY=14]="RASTER_OVERLAY",t[t.POI_OVERLAY=15]="POI_OVERLAY",t[t.BUILDING_OVERLAY=16]="BUILDING_OVERLAY"}(e.LayerType||(e.LayerType={}));var n=function(){function t(t,e){void 0===e&&(e=0),this.id=t,this.order=e}return t.prototype.equal=function(t){return this.id==t.id},t.prototype.lessThan=function(t){return this.order==t.order?this.id<t.id:this.order<t.order},t}();e.LayerId=n,e.compareLayerId=function(t,e){return t.order==e.order?t.id==e.id?0:t.id>e.id:t.order>e.order};var r=function(){function t(t,e,i,r){this.layerId=new n(t,e),this.layerType=i,this.mapView=r}return t.prototype.getOrder=function(){return this.layerId.order},t.prototype.getLayerId=function(){return this.layerId.id},t.prototype.getLayerType=function(){return this.layerType},t.prototype.setOrder=function(t){this.layerId.order=t},t.prototype.setLayerRenderer=function(t){this.layerRenderer=t},t}();e.Layer=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),r=i(13),o=i(10),a=i(3),s=i(19),l=i(6),u=function(){function t(){}return Object.defineProperty(t,"pixelScale",{get:function(){return t._pixelScale},set:function(e){t._pixelScale=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchBoxSize",{get:function(){return t._touchBoxSize},set:function(e){t._touchBoxSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"resourceScale",{get:function(){return Math.round(t._pixelScale)},enumerable:!0,configurable:!0}),t.getTileSize=function(){return n.MapConstants.baseTileSize*t.pixelScale},t.extendOptions=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0,r=e;n<r.length;n++){var o=r[n];for(var a in o)t[a]=o[a]}return t},t.pointToPixel=function(e){return new o.Point(e.x*t.pixelScale,e.y*t.pixelScale)},t.pixelToPoint=function(e){return new o.Point(e.x/t.pixelScale,e.y/t.pixelScale)},t.getTimePanTo=function(t,e,i){var o=t.distanceTo(e)/500;return o*=i<10?.01:i<14?.5:1.5,o=r.MathUtils.clamp(o,n.MapConstants.minTimeSpanTo,n.MapConstants.maxTimeSpanTo),Math.round(o)},t.getCameraPositionForLatLngBounds=function(t,e,i,n){var o=i.getScreenSize(),u=i.getZoom(),h=1<<u,c=l.ProjectionMercator.projectScale(t.getSouthwest(),h),f=l.ProjectionMercator.projectScale(t.getNortheast(),h),p=f.x-c.x,d=c.y-f.y;p=p<=0?1:p,d=d<=0?1:d;var g=Number.MAX_VALUE;if(p>0||d>0){var y=o.x/p,m=o.y/d;y-=(e.left+e.right)/p,m-=(e.top+e.bottom)/d,g=Math.min(y,m)}var v=u;g>0?v=r.MathUtils.clamp(u+Math.log2(g),n.getMinZoom(),n.getMaxZoom()):(console.warn("Cannot calculate zoom level for bounds. Vertical or horizontal padding is greater than map's height or width"),v=n.getMinZoom()),v=Math.floor(v);var _=Math.pow(2,v),b=c.add(f).multiply(.5),w=l.ProjectionMercator.unproject(b,h),M=l.ProjectionMercator.projectScale(w,_),x=M.add(o.multiply(.5)),T=M.add(o.multiply(-.5));return x=x.subtract(new a.Vector2(e.left,e.top)),T=T.add(new a.Vector2(e.right,e.bottom)),M=x.add(T).multiply(.5),new s.CameraPosition(l.ProjectionMercator.unproject(M,_),0,0,v)},t._pixelScale=1,t._touchBoxSize=1,t}();e.MapUtils=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(9),r=i(12),o=i(49),a=i(64),s=i(10),l=function(){function t(){}return Object.defineProperty(t,"placeFontSize",{get:function(){return 12},enumerable:!0,configurable:!0}),Object.defineProperty(t,"maxTiltIntersectWithScreen",{get:function(){return 90-p.fov*f.rad2Deg},enumerable:!0,configurable:!0}),t.none=-1,t.baseTileSize=256,t.minLatitude=-85.0511287798066,t.maxLatitude=85.0511287798066,t.maxLongitude=180,t.minLongitude=-180,t.maxDegrees=360,t.radiusEarthMeters=6378137,t.halfEarthCircumFerenceInMeter=t.radiusEarthMeters*Math.PI,t.earthCircumFerenceInMeter=2*t.halfEarthCircumFerenceInMeter,t.tileCacheSize=512,t.baseMapLowestOrder=Number.MIN_SAFE_INTEGER,t.baseMapMiddleOrder=-1e6,t.buildingLayerOrder=0,t.userPOILayerOrder=1,t.pointGeoJsonWidth=32,t.pointGeoJsonHeight=32,t.placeSelectedIdPrefix="maplink-selected-place-",t.placeWidth=26,t.placeHeight=32,t.poiFontWeight="normal",t.poiMaxWidth=125,t.poiNumLine=3,t.poiAnchor=new s.Point(.5,1),t.poiLabelAnchor=new s.Point(1.1,.5),t.poiDefaultColor="#6E9FB0",t.pointGeoJsonAnchor=[.5,1],t.infoWindowPadding=2,t.flingMinVelocity=-1e4,t.flingMaxVelocity=1e4,t.flingTimeConstant=150,t.flingSpeedMultiply=15,t.zoomSpeedMouseWheel=15,t.minDurationFlyTo=1e3,t.maxDurationFlyTo=13e3,t.maxBearingAngle=720,t.defaultMinZoom=3,t.defaultMinZoom3d=17,t.defaultMaxZoom=22,t.defaultMaxNativeZoom=19,t.geoJsonMinNativeZoom=20,t.tileExtend=4096,t.defaultAnimationDuration=300,t.defaultFlyZoom=17,t.minTilt=0,t.maxTilt2D=40,t.maxTilt3D=87,t.minTiltReduceFog=75,t.minTimeMoving=150,t.minTimeDoubleZoom=500,t.minTimeSpanTo=500,t.maxTimeSpanTo=4e3,t.skyboxMapBorderMinimum=.001,t.metersPerPixelAtLatitude=0,t.mapBackgroundColor2D="#f2efe9",t.mapBackgroundColor3D="#e1e1e1",t.mapBackgroundScaleRatio=2e4,t.clusterMaxPointCount=1e6,t.biasMatrix=new n.Matrix4(new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1])),t.FPS=1e3/15,t.buildingOverlayIdPrefix="_overlay",t.customBuildingType="custom_building",t.touchBoxSize=8,t.collisionZoomStep=1,t}();e.MapConstants=l;var u=function(){function t(){}return t.getPOIImageUrl=function(t,e,i){return a.MapSettings.getResourseBaseUrl+"/sdk/icons/option"+t+"/"+e+"@"+i},t.getModelTextureUrl=function(t){return a.MapSettings.getResourseBaseUrl+"/sdk/textures/"+t},t.getModelObjUrl=function(t){return a.MapSettings.getResourseBaseUrl+"/sdk/models/"+t},t.baseMapUrl="https://"+o.Env.apiPrefix+".map4d.vn/sdk/tile/{z}/{x}/{y}",t}();e.ServerConstants=u;var h=function(){function t(){}return t.defaultSymbol="markerDefault",t.selectionSymbol="selectionIcon",t.placeSelectedSymbol="placeSelectedIcon",t.geoJsonLayerId="geoJsonLayerId",t}();e.SymbolConstants=h;var c=function(){function t(){}return t.rasterLayerId="1.0.rasterLayer",t.surfaceLayerId="1.1.vector.surfaces",t.roadsLayerId="1.2.vector.roads",t.boundaryLayerId="1.3.vector.boundaries",t.labelLayerId="4.label.tile",t.rasterOverlayLayerId="1.4.rasterOverlay",t.buildingOverlayLayerId="2.buildingOverlay",t.pointLayerId="2.maplink.vector.tile.points",t.pointOverlayLayerId="2.maplink.overlay.tile.points",t.userPOILayerId="1.maplink.vector.tile.user.poi",t.buildingLayerId="2.buildingLayer",t.userBuildingLayerId="3.userBuilding.layer",t.roadTileLayerId="roadTileLayer",t.labelTileLayerId="labelTileLayer",t.pointTileLayerId="pointTileLayer",t.buildingTileLayerId="buildingTileLayer",t.rasterTileLayerId="rasterTileLayer",t}();e.LayerConstants=c;var f=function(){function t(){}return t.rad2Deg=180/Math.PI,t.deg2Rad=Math.PI/180,t.epsilon=1e-6,t}();e.MathConstants=f;var p=function(){function t(){}return t.fov=30*f.deg2Rad,t.nearPlane=.1,t.farPlane=1e3,t.height=15.5,t}();e.CameraConstants=p;var d=function(){function t(){}return t.numTrianglesOnRoundCap=6,t.numTrianglesOnRoundJoin=5,t.numTrianglesPerCircle=4,t.polylineTextureWidth=16,t.polylineTextureHeight=8,t}();e.PolyConstants=d;var g=function(){function t(){}return t.rainFrequency=.004,t.rainParticleRotation=-25,t.snowFrequency=.004,t}();e.ParticleConstants=g;var y=function(){function t(){}return t.refreshTime=6e4,t.refreshDistance=1e4,t}();e.WeatherConstants=y;var m=function(){function t(){}return t.getSkyColor=function(e){return t.skyColors[e]},t.getFogColor=function(e){return t.fogColors[e]},t.getLightColor=function(e){return t.lightColors[e]},t.skyColors={Morning:r.Color.fromHex("cdf9ff"),Noon:r.Color.fromHex("0783f4"),AfterNoon:r.Color.fromHex("243a8b"),Evening:r.Color.fromHex("182863")},t.fogColors={Morning:r.Color.fromHex("FAD8C4"),Noon:r.Color.fromHex("FAFAFA"),AfterNoon:r.Color.fromHex("FAA899"),Evening:r.Color.fromHex("141c36")},t.lightColors={Morning:r.Color.fromHex("#DE8989"),Noon:r.Color.fromHex("#F8F8F8"),AfterNoon:r.Color.fromHex("#BE321A"),Evening:r.Color.fromHex("#1E0032")},t}();e.ColorConstants=m;var v=function(){function t(){}return t.morningTime=6,t.noonTime=12,t.afterNoonTime=16,t.eveningTime=18,t}();e.TimeConstants=v;var _=function(){function t(){}return Object.defineProperty(t,"fontSize",{get:function(){return 24},enumerable:!0,configurable:!0}),t.fontTextureWidth=1e3,t.fontTextureHeight=400,t}();e.FontConstant=_;var b=function(){function t(){}return t.maxCurvedTextAngle=30,t}();e.LabelConstant=b},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,i=0,n=0;return e>0&&(i=this.x/e,n=this.y/e),new t(i,n)},t.prototype.set=function(t){this.x=t.x,this.y=t.y},t.prototype.invert=function(){return new t(-this.x,-this.y)},t.prototype.rotate90=function(){return new t(this.y,-this.x)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y)},t.prototype.rotateBy=function(e){var i=Math.cos(e*Math.PI/180),n=Math.sin(e*Math.PI/180);return new t(this.x*i-this.y*n,this.x*n+this.y*i)},t.prototype.rotateByRadian=function(e){var i=Math.cos(e),n=Math.sin(e);return new t(this.x*i-this.y*n,this.x*n+this.y*i)},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y},t.perp=function(e,i){return new t(i[1]-e[1],e[0]-i[0])},t.neg=function(e){return new t(-e.x,-e.y)},t}();e.Vector2=n},function(t,e,i){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=i(211),r=i(115),o=i(119);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return u(this,t,e,i)}function u(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=f(t,e);return t}(t,e,i,n):"string"==typeof e?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");if(!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(e,i),r=(t=s(t,n)).write(e,i);r!==n&&(t=t.slice(0,r));return t}(t,e,i):function(t,e){if(l.isBuffer(e)){var i=0|p(e.length);return 0===(t=s(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?s(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function c(t,e){if(h(e),t=s(t,e<0?0:0|p(e)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function f(t,e){var i=e.length<0?0:0|p(e.length);t=s(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return V(t).length;default:if(n)return j(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,i);case"utf8":case"utf-8":return L(this,e,i);case"ascii":return S(this,e,i);case"latin1":case"binary":return E(this,e,i);case"base64":return A(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function m(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:v(t,e,i,n,r);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):v(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function v(t,e,i,n,r){var o,a=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,i/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(r){var h=-1;for(o=i;o<s;o++)if(u(t,o)===u(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(i+l>s&&(i=s-l),o=i;o>=0;o--){for(var c=!0,f=0;f<l;f++)if(u(t,o+f)!==u(e,f)){c=!1;break}if(c)return o}return-1}function _(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[i+a]=s}return a}function b(t,e,i,n){return Z(j(e,t.length-i),t,i,n)}function w(t,e,i,n){return Z(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function M(t,e,i,n){return w(t,e,i,n)}function x(t,e,i,n){return Z(V(e),t,i,n)}function T(t,e,i,n){return Z(function(t,e){for(var i,n,r,o=[],a=0;a<t.length&&!((e-=2)<0);++a)i=t.charCodeAt(a),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function A(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function L(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var o,a,s,l,u=t[r],h=null,c=u>239?4:u>223?3:u>191?2:1;if(r+c<=i)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(o=t[r+1]))&&(l=(31&u)<<6|63&o)>127&&(h=l);break;case 3:o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),r+=c}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return i}(n)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,i){return u(null,t,e,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,i){return function(t,e,i,n){return h(e),e<=0?s(t,e):void 0!==i?"string"==typeof n?s(t,e).fill(i,n):s(t,e).fill(i):s(t,e)}(null,t,e,i)},l.allocUnsafe=function(t){return c(null,t)},l.allocUnsafeSlow=function(t){return c(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=l.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var a=t[i];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,r),r+=a.length}return n},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?L(this,0,t):g.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,i,n,r){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(n>>>=0),a=(i>>>=0)-(e>>>=0),s=Math.min(o,a),u=this.slice(n,r),h=t.slice(e,i),c=0;c<s;++c)if(u[c]!==h[c]){o=u[c],a=h[c];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},l.prototype.indexOf=function(t,e,i){return m(this,t,e,i,!0)},l.prototype.lastIndexOf=function(t,e,i){return m(this,t,e,i,!1)},l.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return _(this,t,e,i);case"utf8":case"utf-8":return b(this,t,e,i);case"ascii":return w(this,t,e,i);case"latin1":case"binary":return M(this,t,e,i);case"base64":return x(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function E(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function I(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",o=e;o<i;++o)r+=F(t[o]);return r}function P(t,e,i){for(var n=t.slice(e,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function C(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,i,n,r,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function R(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-i,2);r<o;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function D(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-i,4);r<o;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function k(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function B(t,e,i,n,o){return o||k(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function U(t,e,i,n,o){return o||k(t,0,i,8),r.write(t,e,i,n,52,8),i+8}l.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;i=new l(r,void 0);for(var o=0;o<r;++o)i[o]=this[o+t]}return i},l.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||C(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n},l.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||C(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},l.prototype.readUInt8=function(t,e){return e||C(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||C(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||C(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||C(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||C(t,e,this.length);for(var n=e,r=1,o=this[t+--n];n>0&&(r*=256);)o+=this[t+--n]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||C(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(t,e){e||C(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(t,e){return e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||C(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||C(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||C(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||C(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||O(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},l.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||O(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},l.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);O(this,t,e,i,r-1,-r)}var o=0,a=1,s=0;for(this[e]=255&t;++o<i&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},l.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);O(this,t,e,i,r-1,-r)}var o=i-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},l.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,i){return B(this,t,e,!0,i)},l.prototype.writeFloatBE=function(t,e,i){return B(this,t,e,!1,i)},l.prototype.writeDoubleLE=function(t,e,i){return U(this,t,e,!0,i)},l.prototype.writeDoubleBE=function(t,e,i){return U(this,t,e,!1,i)},l.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,o=n-i;if(this===t&&i<e&&e<n)for(r=o-1;r>=0;--r)t[r+e]=this[r+i];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},l.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var o;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=e;o<i;++o)this[o]=t;else{var a=l.isBuffer(t)?t:j(new l(t,n).toString()),s=a.length;for(o=0;o<i-e;++o)this[o+e]=a[o%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){var i;e=e||1/0;for(var n=t.length,r=null,o=[],a=0;a<n;++a){if((i=t.charCodeAt(a))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function V(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Z(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}}).call(this,i(32))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),r=function(){function t(t,e){this.lat=t,this.lng=e}return t.prototype.equals=function(t){return this.lat==t.lat&&this.lng==t.lng},t.prototype.valid=function(){return isFinite(this.lat)&&Math.abs(this.lat)<=90},t.prototype.toString=function(){return"("+this.lat+", "+this.lng+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[1]),Number(e[0]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"lat"in e&&"lng"in e)return new t(Number(e.lat),Number(e.lng));throw new Error("`ILngLat` argument must be specified as a LngLat instance, an object {lat: <lat>, lng: <lng>}, or an array of [<lng>, <lat>]")},t.prototype.distanceTo=function(e){if(null==e)return 0;var i=t.convert(e),r=n.MathConstants.deg2Rad*this.lat,o=n.MathConstants.deg2Rad*this.lng,a=n.MathConstants.deg2Rad*i.lat,s=n.MathConstants.deg2Rad*i.lng,l=Math.sin((a-r)/2),u=Math.sin((s-o)/2);return 2*n.MapConstants.radiusEarthMeters*Math.asin(Math.sqrt(l*l+Math.cos(r)*Math.cos(a)*u*u))},t.prototype.normalize=function(){var e=this.lat>0?-1:1,i=(this.lat-90*e)%180+90*e;return e=this.lng>0?-1:1,new t(i,(this.lng-180*e)%380+180*e)},t.prototype.add=function(e){return new t(this.lat+e.lat,this.lng+e.lng).normalize()},t.prototype.subtract=function(e){return e?new t(this.lat-e.lat,this.lng-e.lng).normalize():this},t}();e.LatLng=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(5),o=i(2),a=i(13),s=i(1),l=function(){function t(){}return t.projectInternal=function(t,e){var i=a.MathUtils.clamp(t.lat,o.MapConstants.minLatitude,o.MapConstants.maxLatitude);return new n.Vector2(o.MapConstants.maxLongitude+t.lng,o.MapConstants.maxLongitude-o.MathConstants.rad2Deg*Math.log(Math.tan(Math.PI/4+i*Math.PI/o.MapConstants.maxDegrees))).multiply(e/o.MapConstants.maxDegrees)},t.worldSize=function(t){return t*s.MapUtils.getTileSize()},t.getMetersPerPixelAtLatitude=function(t,e){var i=Math.pow(2,e),n=a.MathUtils.clamp(t,o.MapConstants.minLatitude,o.MapConstants.maxLatitude);return Math.cos(n*o.MathConstants.deg2Rad)*Math.PI*2*o.MapConstants.radiusEarthMeters/this.worldSize(i)},t.convertToMeterFromLatLng=function(t){var e=a.MathUtils.clamp(t.lat,o.MapConstants.minLatitude,o.MapConstants.maxLatitude),i=t.lng,r=1-1e-15,s=a.MathUtils.clamp(Math.sin(o.MathConstants.deg2Rad*e),-r,r),l=o.MapConstants.radiusEarthMeters*i*o.MathConstants.deg2Rad,u=.5*o.MapConstants.radiusEarthMeters*Math.log((1+s)/(1-s));return new n.Vector2(l,u)},t.convertToLatLngFromMeter=function(t){var e=(2*Math.atan(Math.exp(t.y/o.MapConstants.radiusEarthMeters))-Math.PI/2)*o.MathConstants.rad2Deg,i=t.x*o.MathConstants.rad2Deg/o.MapConstants.radiusEarthMeters;return new r.LatLng(e,i)},t.projectScale=function(t,e){return this.projectInternal(t,this.worldSize(e))},t.projectZoom=function(t,e){return this.projectInternal(t,1<<e)},t.unproject=function(t,e){var i=t.multiply(o.MapConstants.maxDegrees/this.worldSize(e));return new r.LatLng(o.MapConstants.maxDegrees/Math.PI*Math.atan(Math.exp((o.MapConstants.maxLongitude-i.y)*o.MathConstants.deg2Rad))-90,i.x-o.MapConstants.maxLongitude)},t}();e.ProjectionMercator=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(20),o=i(5),a=i(6),s=i(21),l=i(2),u=i(1),h=i(19),c=i(26),f=function(){function t(){}return t.lat=function(t,e){var i=Math.PI-2*Math.PI*e/Math.pow(2,t);return l.MathConstants.rad2Deg*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))},t.lon=function(t,e){return e/Math.pow(2,t)*l.MapConstants.maxDegrees-l.MapConstants.maxLongitude},t.screenCoordinateToNDC=function(t,e){var i=2*t.x/e.x-1,r=1-2*t.y/e.y;return new n.Vector2(i,r)},t.NDCCoordinateToScreen=function(t,e){var i=e.x*(1+t.x)/2,r=e.y*(1-t.y)/2;return new n.Vector2(i,r)},t.screenCoordinateToLatLng=function(t,e,i,n){return void 0===n&&(n=0),this.screenCoordinateToLatLngZoom(t,e,i,e.getZoom(),n)},t.screenCoordinateToLatLngZoom=function(e,i,s,u,f){if(void 0===f&&(f=0),i.getTilt()>l.MapConstants.maxTiltIntersectWithScreen){var p=this.screenCoordinateToLatLng(new n.Vector2(0,0),new h.CameraPosition(i.getTarget(),l.MapConstants.maxTiltIntersectWithScreen,i.getBearing(),i.getZoom()),s),d=this.latLngToScreenCoordinate(p,0,i,s).y/s.y*s.y;if(e.y<d)return new o.LatLng(1/0,1/0)}u<0&&(u=i.getZoom());var g=t.getElevationPixelFromMeter(f,i)*Math.sin(l.MathConstants.deg2Rad*-i.getTilt()),y=c.CameraUtils.calculateInverseViewProjectionMatrix(i,s.x,s.y),m=Math.pow(2,u),v=t.screenCoordinateToNDC(new n.Vector2(e.x,e.y-g),s),_=y.transform(new r.Vector3(v.x,v.y,-1),1),b=y.transform(new r.Vector3(v.x,v.y,1),1),w=b.z-_.z,M=_.x-(b.x-_.x)*_.z/w,x=_.y-(b.y-_.y)*_.z/w,T=i.getTarget(),A=Math.pow(2,u),L=a.ProjectionMercator.projectScale(T,A);return a.ProjectionMercator.unproject(new n.Vector2(M+L.x,L.y-x),m)},t.pixelCoordinateToCameraCoordinate=function(e,i){return t.pixelCoordinateToCameraCoordinateZoom(e,i,i.getZoom())},t.pixelCoordinateToScreenCoordinate=function(e,i,o,a,s){var l=t.pixelCoordinateToCameraCoordinate(e,i),u=t.getElevationPixelFromMeter(a,i),h=new r.Vector3(l.x,l.y,u),f=s;null==f&&(f=c.CameraUtils.calculateViewProjectionMatrix(i,o.x,o.y));var p=f.transform(h,1),d=(p.x+1)*o.x/2,g=o.y-(p.y+1)*o.y/2;return new n.Vector2(d,g)},t.pixelCoordinateToCameraCoordinateZoom=function(t,e,i){var n=Math.pow(2,i),r=a.ProjectionMercator.worldSize(n),o=a.ProjectionMercator.projectScale(e.getTarget(),n);o.x=o.x-r/2,o.y=r/2-o.y;var s=t;return s.x=s.x-r/2,s.y=r/2-s.y,s.x-=o.x,s.y-=o.y,s},t.latLngToScreenCoordinate=function(t,e,i,n,r){return this.latLngToScreenCoordinateZoom(t,e,i,n,i.getZoom(),r)},t.latLngToScreenCoordinateZoom=function(e,i,n,r,o,s){o<0&&(o=n.getZoom());var l=Math.pow(2,o),u=a.ProjectionMercator.projectScale(e,l);return t.pixelCoordinateToScreenCoordinate(u,n,r,i,s)},t.tileCoordinateToLatLngBounds=function(e){var i=e.getX(),n=e.getY(),r=e.getZoom(),a=new o.LatLng(t.lat(r,n+1),t.lon(r,i)),l=new o.LatLng(t.lat(r,n),t.lon(r,i+1));return new s.LatLngBounds(a,l)},t.pixelCoordinateToVectorTileCoordinate=function(t,e,i,r){var o=u.MapUtils.getTileSize()*r,a=t.x-e*o,s=t.y-i*o;return a=a/o-.5,s=.5-s/o,new n.Vector2(a,s)},t.getElevationPixelFromMeter=function(e,i){return e=Math.max(e,0),t.getPixelFromMeter(e,i.getTarget().lat,i.getZoom())},t.getPixelFromMeter=function(t,e,i){return t/a.ProjectionMercator.getMetersPerPixelAtLatitude(e,i)},t}();e.GeometryUtils=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.name=t,this.size=e,this.offset=i,this.stride=n};e.AttributeInfo=n;var r=function(t,e,i){this.name=t,this.type=e,this.value=i};e.UniformInfo=r;var o=function(){function t(t,e,i){this.gl=t,this.textureUnit=0,this.uniforms={},this.attributes={},this.program=t.createProgram(),this.fragmentShader=this.loadShader(t.FRAGMENT_SHADER,i),this.vertexShader=this.loadShader(t.VERTEX_SHADER,e),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)||(console.log("Error linking shader program"),console.log(t.getProgramInfoLog(this.program))),this.loadAttributes(),this.loadUniforms()}return t.prototype.loadAttributes=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),i=0;i<e;++i){var n=t.getActiveAttrib(this.program,i).name;this.attributes[n]=t.getAttribLocation(this.program,n)}},t.prototype.loadUniforms=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),i=0;i<e;++i){var n=t.getActiveUniform(this.program,i).name;this.uniforms[n]=t.getUniformLocation(this.program,n)}},t.prototype.loadShader=function(t,e){var i=this.gl,n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),i.getShaderParameter(n,i.COMPILE_STATUS)||(console.log("Error loading shader"),console.log(e),console.log(i.getShaderInfoLog(n))),n},t.prototype.bind=function(){this.gl.useProgram(this.program),this.resetTextureUnit()},t.prototype.resetTextureUnit=function(){this.textureUnit=0},t.prototype.setAttributes=function(t){for(var e=this.gl,i=0,n=t;i<n.length;i++){var r=n[i],o=this.attributes[r.name];null!=o&&(e.enableVertexAttribArray(o),e.vertexAttribPointer(o,r.size,e.FLOAT,!1,4*r.stride,4*r.offset))}},t.prototype.setUniforms=function(t){for(var e=this.gl,i=0,n=t;i<n.length;i++){var r=n[i],o=this.uniforms[r.name];null!==o&&("matrix"==r.type&&r.value?e.uniformMatrix4fv(o,!1,r.value.buffer()):"texture"==r.type&&r.value?(e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_2D,r.value.textureId),e.uniform1i(o,this.textureUnit),this.textureUnit+=1):"textureCube"==r.type&&r.value?(e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_CUBE_MAP,r.value.textureId),e.uniform1i(o,this.textureUnit),this.textureUnit+=1):"4fv"==r.type&&r.value?e.uniform4fv(o,r.value):"3fv"==r.type&&r.value?e.uniform3fv(o,r.value):"3f"==r.type&&r.value?e.uniform3f(o,r.value.x,r.value.y,r.value.z):"2fv"==r.type&&r.value?e.uniform2fv(o,r.value):"1f"==r.type?e.uniform1f(o,r.value):"1i"==r.type?e.uniform1i(o,r.value):console.error("Invalid uniform info type: "+r.type))}},t.prototype.disableAttributes=function(){for(var t in this.attributes)this.gl.disableVertexAttribArray(this.attributes[t])},t.prototype.destroy=function(){this.uniforms={},this.attributes={},this.gl.deleteProgram(this.program),this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader)},t}();e.Shader=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(20),r=function(){function t(t){void 0===t&&(t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),this.data=t}return t.prototype.setIdentity=function(t,e,i){return void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),this.data[0]=t,this.data[1]=0,this.data[2]=0,this.data[3]=0,this.data[4]=0,this.data[5]=e,this.data[6]=0,this.data[7]=0,this.data[8]=0,this.data[9]=0,this.data[10]=i,this.data[11]=0,this.data[12]=0,this.data[13]=0,this.data[14]=0,this.data[15]=1,this},t.prototype.copy=function(t){return this.data[0]=t.data[0],this.data[1]=t.data[1],this.data[2]=t.data[2],this.data[3]=t.data[3],this.data[4]=t.data[4],this.data[5]=t.data[5],this.data[6]=t.data[6],this.data[7]=t.data[7],this.data[8]=t.data[8],this.data[9]=t.data[9],this.data[10]=t.data[10],this.data[11]=t.data[11],this.data[12]=t.data[12],this.data[13]=t.data[13],this.data[14]=t.data[14],this.data[15]=t.data[15],this},t.translate=function(e,i,n){return void 0===n&&(n=0),new t(new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,i,n,1]))},t.prototype.translate=function(t,e,i){return void 0===i&&(i=0),this.data[12]+=t,this.data[13]+=e,this.data[14]+=i,this},Object.defineProperty(t.prototype,"position",{get:function(){return new n.Vector3(this.data[12],this.data[13],this.data[14])},enumerable:!0,configurable:!0}),t.rotateX=function(e){e*=Math.PI/180;var i=Math.sin(e),n=Math.cos(e);return new t(new Float32Array([1,0,0,0,0,n,i,0,0,-i,n,0,0,0,0,1]))},t.prototype.setRotationX=function(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return this.setIdentity(),this.data[5]=i,this.data[6]=e,this.data[9]=-e,this.data[10]=i,this},t.prototype.rotateX=function(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t),n=this.data[1],r=this.data[2];return this.data[1]=n*i-r*e,this.data[2]=n*e+r*i,n=this.data[5],r=this.data[6],this.data[5]=n*i-r*e,this.data[6]=n*e+r*i,n=this.data[9],r=this.data[10],this.data[9]=n*i-r*e,this.data[10]=n*e+r*i,n=this.data[13],r=this.data[14],this.data[13]=n*i-r*e,this.data[14]=n*e+r*i,this},t.rotateY=function(e){e*=Math.PI/180;var i=Math.sin(e),n=Math.cos(e);return new t(new Float32Array([n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1]))},t.prototype.setRotationY=function(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return this.setIdentity(),this.data[0]=i,this.data[2]=e,this.data[8]=-e,this.data[10]=i,this},t.prototype.rotateY=function(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t),n=this.data[0],r=this.data[2];return this.data[0]=n*i-r*e,this.data[2]=n*e+r*i,n=this.data[4],r=this.data[6],this.data[4]=n*i-r*e,this.data[6]=n*e+r*i,n=this.data[8],r=this.data[10],this.data[8]=n*i-r*e,this.data[10]=n*e+r*i,n=this.data[12],r=this.data[14],this.data[12]=n*i-r*e,this.data[14]=n*e+r*i,this},t.rotateZ=function(e){e*=Math.PI/180;var i=Math.sin(e),n=Math.cos(e);return new t(new Float32Array([n,i,0,0,-i,n,0,0,0,0,1,0,0,0,0,1]))},t.prototype.setRotationZ=function(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return this.setIdentity(),this.data[0]=i,this.data[1]=e,this.data[4]=-e,this.data[5]=i,this},t.prototype.rotateZ=function(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t),n=this.data[0],r=this.data[1];return this.data[0]=n*i-r*e,this.data[1]=n*e+r*i,n=this.data[4],r=this.data[5],this.data[4]=n*i-r*e,this.data[5]=n*e+r*i,n=this.data[8],r=this.data[9],this.data[8]=n*i-r*e,this.data[9]=n*e+r*i,n=this.data[12],r=this.data[13],this.data[12]=n*i-r*e,this.data[13]=n*e+r*i,this},t.scale=function(e,i,n){return null==i&&(i=e,n=e),new t(new Float32Array([e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1]))},t.prototype.scale=function(t,e,i){null==e&&(e=t,i=t);var n=this.data[0],r=this.data[1],o=this.data[2];return this.data[0]=n*t,this.data[1]=r*e,this.data[2]=o*i,n=this.data[4],r=this.data[5],o=this.data[6],this.data[4]=n*t,this.data[5]=r*e,this.data[6]=o*i,n=this.data[8],r=this.data[9],o=this.data[10],this.data[8]=n*t,this.data[9]=r*e,this.data[10]=o*i,n=this.data[12],r=this.data[13],o=this.data[14],this.data[12]=n*t,this.data[13]=r*e,this.data[14]=o*i,this},t.prototype.multiply=function(e){var i=new t(new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]));if(null==e)return i;for(var n=0;n<4;++n)for(var r=0;r<4;++r)for(var o=0;o<4;++o)i.data[4*n+o]+=this.data[4*n+r]*e.data[4*r+o];return i},t.prototype.fconcat=function(t,e,i,n,r,o,a,s,l,u,h,c,f,p,d,g){var y=this.data[0],m=this.data[1],v=this.data[2],_=this.data[3];return this.data[0]=y*t+m*r+v*l+_*f,this.data[1]=y*e+m*o+v*u+_*p,this.data[2]=y*i+m*a+v*h+_*d,this.data[3]=y*n+m*s+v*c+_*g,y=this.data[4],m=this.data[5],v=this.data[6],_=this.data[7],this.data[4]=y*t+m*r+v*l+_*f,this.data[5]=y*e+m*o+v*u+_*p,this.data[6]=y*i+m*a+v*h+_*d,this.data[7]=y*n+m*s+v*c+_*g,y=this.data[8],m=this.data[9],v=this.data[10],_=this.data[11],this.data[8]=y*t+m*r+v*l+_*f,this.data[9]=y*e+m*o+v*u+_*p,this.data[10]=y*i+m*a+v*h+_*d,this.data[11]=y*n+m*s+v*c+_*g,y=this.data[12],m=this.data[13],v=this.data[14],_=this.data[15],this.data[12]=y*t+m*r+v*l+_*f,this.data[13]=y*e+m*o+v*u+_*p,this.data[14]=y*i+m*a+v*h+_*d,this.data[15]=y*n+m*s+v*c+_*g,this},t.prototype.concat=function(t){return null==t?this:this.fconcat(t.data[0],t.data[1],t.data[2],t.data[3],t.data[4],t.data[5],t.data[6],t.data[7],t.data[8],t.data[9],t.data[10],t.data[11],t.data[12],t.data[13],t.data[14],t.data[15])},t.ortho=function(e,i,n,r,o,a){return void 0===o&&(o=-100),void 0===a&&(a=100),new t(new Float32Array([2/(i-e),0,0,0,0,2/(r-n),0,0,0,0,-2/(a-o),0,-(e+i)/(i-e),-(r+n)/(r-n),-(o+a)/(o-a),1]))},t.prototype.setOrtho=function(t,e,i,n,r,o){return void 0===r&&(r=-100),void 0===o&&(o=100),this.data[0]=2/(e-t),this.data[1]=0,this.data[2]=0,this.data[3]=0,this.data[4]=0,this.data[5]=2/(n-i),this.data[6]=0,this.data[7]=0,this.data[8]=0,this.data[9]=0,this.data[10]=-2/(o-r),this.data[11]=-1,this.data[12]=-(t+e)/(e-t),this.data[13]=-(n+i)/(n-i),this.data[14]=-(r+o)/(r-o),this.data[15]=1,this},t.perspective=function(e,i,n,r){var o=Math.tan(e/2)*n,a=o*i;return t.frustum(-a,a,-o,o,n,r)},t.prototype.setPerspective=function(t,e,i,n){var r=Math.tan(t/2)*i,o=r*e;return this.setFrustum(-o,o,-r,r,i,n)},t.frustum=function(e,i,n,r,o,a){return void 0===o&&(o=-100),void 0===a&&(a=100),new t(new Float32Array([2*o/(i-e),0,0,0,0,2*o/(r-n),0,0,(i+e)/(i-e),(r+n)/(r-n),-(a+o)/(a-o),-1,0,0,-2*o*a/(a-o),0]))},t.prototype.setFrustum=function(t,e,i,n,r,o){void 0===r&&(r=-100),void 0===o&&(o=100),this.data[0]=2*r/(e-t),this.data[1]=0,this.data[2]=0,this.data[3]=0,this.data[4]=0,this.data[5]=2*r/(n-i),this.data[6]=0,this.data[7]=0,this.data[8]=(e+t)/(e-t),this.data[9]=(n+i)/(n-i),this.data[10]=-(o+r)/(o-r),this.data[11]=-1,this.data[12]=0,this.data[13]=0,this.data[14]=-2*r*o/(o-r),this.data[15]=0},t.prototype.transform=function(t,e){void 0===e&&(e=0);var i=this.data[0]*t.x+this.data[4]*t.y+this.data[8]*t.z+this.data[12]*e,r=this.data[1]*t.x+this.data[5]*t.y+this.data[9]*t.z+this.data[13]*e,o=this.data[2]*t.x+this.data[6]*t.y+this.data[10]*t.z+this.data[14]*e;return 0==(e=this.data[3]*t.x+this.data[7]*t.y+this.data[11]*t.z+this.data[15]*e)&&(e=1),new n.Vector3(i/e,r/e,o/e)},t.prototype.buffer=function(){return this.data},t.lookAt=function(e,i,r,o){void 0===r&&(r=1),void 0===o&&(o=new n.Vector3(0,0,1));var a=e.subtract(i).normalize(),s=o.cross(a).normalize(),l=a.cross(s).normalize(),u=t.translate(-e.x,-e.y,-e.z);return u.fconcat(s.x,l.x,a.x,0,s.y,l.y,a.y,0,s.z,l.z,a.z,0,0,0,0,1),u.scale(r)},t.prototype.lookAt=function(t,e,i,r){void 0===i&&(i=1),void 0===r&&(r=new n.Vector3(0,0,1));var o=t.subtract(e).normalize(),a=r.cross(o).normalize(),s=o.cross(a).normalize();return this.setIdentity(),this.translate(-t.x,-t.y,-t.z),this.fconcat(a.x,s.x,o.x,0,a.y,s.y,o.y,0,a.z,s.z,o.z,0,0,0,0,1),this.scale(i)},t.prototype.inverse=function(){for(var e=this.data.slice(),i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n=0;n<4;++n){for(var r=n;r<4&&0==e[4*r+n];)++r;if(4==r||0==e[4*r+n])return console.log("Cannot calculate inverse, determinant is zero"),this;if(r!=n){var o=e.slice(4*n,4*(n+1)),a=e.slice(4*r,4*(r+1));e.set(a,4*n),e.set(o,4*r);var s=i.slice(4*n,4*(n+1)),l=i.slice(4*r,4*(r+1));i.set(l,4*n),i.set(s,4*r)}var u=e.slice(4*n,4*(n+1)),h=i.slice(4*n,4*(n+1));for(r=0;r<4;++r){a=e.slice(4*r,4*(r+1)),l=i.slice(4*r,4*(r+1));if(r!=n){if(0!=a[n]){for(var c=-a[n]/u[n],f=n;f<4;++f)a[f]=a[f]+c*u[f];e.set(a,4*r);for(f=0;f<4;++f)l[f]=l[f]+c*h[f];i.set(l,4*r)}}else{if(0==(c=u[n]))return console.log("Cannot calculate inverse, determinant is zero"),this;for(f=n;f<4;++f)a[f]=a[f]/c;e.set(a,4*r);for(f=0;f<4;++f)l[f]=l[f]/c;i.set(l,4*r)}}}return new t(i)},t}();e.Matrix4=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(39),r=function(){function t(t,e){if(null==t||null==e)throw Error("Parameters can not be null");this.x=t,this.y=e}return t.convertPointToMBPoint=function(t){return new n(t.x,t.y)},t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},t.prototype.toString=function(){return"("+String(this.x)+","+String(this.y)+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"x"in e&&"y"in e)return new t(Number(e.x),Number(e.y));throw new Error("`IPoint` argument must be specified as a Point instance, an object {x: <x>, y: <y>}, or an array of [<x>, <y>]")},t}();e.Point=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r,o,a=i(8),s=i(27),l=i(271),u=i(38),h=i(42),c=i(71),f=i(2),p=i(49);!function(t){t[t.SYMBOL_SHADER=0]="SYMBOL_SHADER",t[t.POLYLINE_SHADER=1]="POLYLINE_SHADER",t[t.FILL_SHADER=2]="FILL_SHADER",t[t.GEOJSON_SHADER=3]="GEOJSON_SHADER",t[t.RASTER_SHADER=4]="RASTER_SHADER",t[t.RASTER_WITH_SHADOW_SHADER=5]="RASTER_WITH_SHADOW_SHADER",t[t.RASTER_FOG_SHADER=6]="RASTER_FOG_SHADER",t[t.RASTER_3D_WITH_SHADOW_SHADER=7]="RASTER_3D_WITH_SHADOW_SHADER",t[t.CIRCLE_SHADER=8]="CIRCLE_SHADER",t[t.BUILDING_OUTLINING=9]="BUILDING_OUTLINING",t[t.BUILDING_SHADER=10]="BUILDING_SHADER",t[t.BUILDING_SELECTION_SHADER=11]="BUILDING_SELECTION_SHADER",t[t.DEBUG_SELECTION_SHADER=12]="DEBUG_SELECTION_SHADER",t[t.PARTICLE_SHADER=13]="PARTICLE_SHADER",t[t.SHADOW_MAPPING_SHADER=14]="SHADOW_MAPPING_SHADER",t[t.BUILDING_WITH_SHADOW_SHADER=15]="BUILDING_WITH_SHADOW_SHADER",t[t.SKY_SHARDER=16]="SKY_SHARDER",t[t.TEXT_LABEL_SHADER=17]="TEXT_LABEL_SHADER",t[t.TILE_DEBUG_SHADER=18]="TILE_DEBUG_SHADER",t[t.LINE_COLLISION_SHADER=19]="LINE_COLLISION_SHADER"}(n=e.ShaderEnum||(e.ShaderEnum={})),function(t){t[t.SYMBOL_MODEL=0]="SYMBOL_MODEL",t[t.RASTER_MODEL=1]="RASTER_MODEL",t[t.CIRCLE_MODEL=2]="CIRCLE_MODEL",t[t.SKY_MODEL=3]="SKY_MODEL",t[t.SELECTION_DEBUG_MODEL=4]="SELECTION_DEBUG_MODEL",t[t.PARTICLE_QUAD_MODEL=5]="PARTICLE_QUAD_MODEL"}(r=e.ModelEnum||(e.ModelEnum={})),function(t){t[t.WHITE_TEXTURE=0]="WHITE_TEXTURE",t[t.RAIN_TEXTURE=1]="RAIN_TEXTURE",t[t.SNOW_TEXTURE=2]="SNOW_TEXTURE",t[t.WATER_DISPLACEMENT=3]="WATER_DISPLACEMENT",t[t.WATER_COLOR=4]="WATER_COLOR",t[t.POLYLINE_TEXTURE=5]="POLYLINE_TEXTURE"}(o=e.TextureEnum||(e.TextureEnum={}));var d=function(){function t(t){this.gl=t,this.shaders=new Map,this.models=new Map,this.textures=new Map,this.init()}return t.getInstance=function(t){var e=t.id;null==this.instances&&(this.instances=new Map);var i=this.instances.get(e);return i||(i=new this(t),this.instances.set(e,i)),i},t.releaseInstance=function(t){var e=t.id;if(null!=this.instances){var i=this.instances.get(e);i&&(i.textures.forEach((function(t){return t.destroy()})),i.models.forEach((function(t){return t.destroy()})),i.shaders.forEach((function(t){return t.destroy()})),i.textures.clear(),i.models.clear(),i.shaders.clear(),this.instances.delete(e))}},t.prototype.createShader=function(t,e){return new a.Shader(this.gl,t,e)},t.prototype.createModel=function(t){var e=this.gl,i=new s.Model(e),n=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null);var r=[new a.AttributeInfo("a_position",3,0,5),new a.AttributeInfo("a_uv",2,3,5)];return i.numOfVertices=6,i.arrayBuffer=n,i.attributeInfos=r,i},t.prototype.init=function(){var t=this.createShader(l.ShaderSource.basicVS,l.ShaderSource.basicFS);this.shaders.set(n.RASTER_SHADER,t),this.shaders.set(n.RASTER_FOG_SHADER,this.createShader(l.ShaderSource.rasterFogVS,l.ShaderSource.rasterFogFS)),this.shaders.set(n.RASTER_WITH_SHADOW_SHADER,this.createShader(l.ShaderSource.raster3DWithShadowVS,l.ShaderSource.rasterWithShadowFS+l.ShaderSource.shadowFS)),this.shaders.set(n.RASTER_3D_WITH_SHADOW_SHADER,this.createShader(l.ShaderSource.raster3DWithShadowVS,l.ShaderSource.raster3DWithShadowFS+l.ShaderSource.shadowFS)),this.shaders.set(n.SYMBOL_SHADER,this.createShader(l.ShaderSource.markerVS,l.ShaderSource.markerFS)),this.shaders.set(n.POLYLINE_SHADER,this.createShader(l.ShaderSource.polylineVS,l.ShaderSource.polylineFS)),this.shaders.set(n.FILL_SHADER,this.createShader(l.ShaderSource.fillVS,l.ShaderSource.fillFS)),this.shaders.set(n.GEOJSON_SHADER,this.createShader(l.ShaderSource.geoJsonVS,l.ShaderSource.geoJsonFS)),this.shaders.set(n.CIRCLE_SHADER,this.createShader(l.ShaderSource.circleVS,l.ShaderSource.circleFS)),this.shaders.set(n.BUILDING_OUTLINING,this.createShader(l.ShaderSource.buildingVS,l.ShaderSource.buildingOutliningFS)),this.shaders.set(n.BUILDING_SHADER,this.createShader(l.ShaderSource.buildingVS,l.ShaderSource.buildingFS)),this.shaders.set(n.BUILDING_SELECTION_SHADER,this.createShader(l.ShaderSource.buildingSelectionVS,l.ShaderSource.buildingSelectionFS)),this.shaders.set(n.SKY_SHARDER,this.createShader(l.ShaderSource.skyVS,l.ShaderSource.skyFS)),this.shaders.set(n.DEBUG_SELECTION_SHADER,this.createShader(l.ShaderSource.debugSelectionVS,l.ShaderSource.debugSelectionFS)),this.shaders.set(n.PARTICLE_SHADER,t),this.shaders.set(n.SHADOW_MAPPING_SHADER,this.createShader(l.ShaderSource.shadowMappingVS,l.ShaderSource.shadowMappingFS)),this.shaders.set(n.TEXT_LABEL_SHADER,this.createShader(l.ShaderSource.textLabelVS,l.ShaderSource.textLabelFS)),this.shaders.set(n.BUILDING_WITH_SHADOW_SHADER,this.createShader(l.ShaderSource.buildingWithShadowVS,l.ShaderSource.buildingWithShadowFS+l.ShaderSource.shadowFS)),p.Env.isTileDebug&&this.shaders.set(n.TILE_DEBUG_SHADER,this.createShader(l.ShaderSource.tileDebugVS,l.ShaderSource.tileDebugFS)),p.Env.isCollisionDebug&&this.shaders.set(n.LINE_COLLISION_SHADER,this.createShader(l.ShaderSource.collisionDebugVS,l.ShaderSource.collisionDebugFS));var e=new Float32Array([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,1,1,0,1,0,1,-1,0,1,1,-1,-1,0,0,1]),i=this.createModel(e),d=[],g=new u.CircleBuilderContext;g.addVertex=function(t){d.push(t.x,t.y)},u.buildCircle(g);var y=new s.Model(this.gl);y.init(d,[new a.AttributeInfo("a_extrude",2,0,2)],g.indices),this.models.set(r.RASTER_MODEL,i),this.models.set(r.SYMBOL_MODEL,i),this.models.set(r.SKY_MODEL,i),this.models.set(r.CIRCLE_MODEL,y),this.models.set(r.SELECTION_DEBUG_MODEL,i),this.models.set(r.PARTICLE_QUAD_MODEL,i);var m=new h.Texture(this.gl);this.textures.set(o.WHITE_TEXTURE,m);var v=new h.Texture(this.gl);v.loadImage(c.Images.get("rainTexture"),null),this.textures.set(o.RAIN_TEXTURE,v);var _=new h.Texture(this.gl);_.loadImage(c.Images.get("snowTexture"),null),this.textures.set(o.SNOW_TEXTURE,_);var b=new h.TextureFiltering(this.gl.LINEAR_MIPMAP_LINEAR,this.gl.LINEAR),w=new h.TextureWrapping(this.gl.REPEAT,this.gl.REPEAT),M=new h.TextureOptions(this.gl.TEXTURE_2D,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,b,w),x=new h.Texture(this.gl,M);x.loadImage(c.Images.waterDisplacement,null),this.textures.set(o.WATER_DISPLACEMENT,x);var T=new h.Texture(this.gl,M);T.loadImage(c.Images.waterColor,null),this.textures.set(o.WATER_COLOR,T);var A=new h.Texture(this.gl,M),L=new Uint8Array(this.createPolylineImageData(f.PolyConstants.polylineTextureWidth,f.PolyConstants.polylineTextureHeight));A.loadImageDataArray(L,f.PolyConstants.polylineTextureWidth,f.PolyConstants.polylineTextureHeight,this.gl.NEAREST),this.textures.set(o.POLYLINE_TEXTURE,A)},t.prototype.getShader=function(t){return this.shaders.get(t)},t.prototype.getModel=function(t){return this.models.get(t)},t.prototype.getTexture=function(t){return this.textures.get(t)},t.prototype.createPolylineImageData=function(t,e){for(var i=new Array(t*e*4).fill(0),n=0,r=0;r<e;++r)for(var o=0;o<t;++o)i[n]=o<t/2?0:255,i[n+1]=0,i[n+2]=0,i[n+3]=255,n+=4;return i},t.instances=null,t}();e.ResourceManager=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this.alpha=n,this._buffer=new Float32Array([t,e,i])}return t.prototype.rgbBuffer=function(){return this._buffer},t.prototype.buffer=function(){return new Float32Array([this.red,this.green,this.blue,this.alpha])},Object.defineProperty(t.prototype,"red",{get:function(){return this._buffer[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"green",{get:function(){return this._buffer[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blue",{get:function(){return this._buffer[2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rgba",{get:function(){return"rgba("+255*this.red+","+255*this.green+","+255*this.blue+","+this.alpha+")"},enumerable:!0,configurable:!0}),t.fromHex=function(e){void 0===e&&(e="000000"),4!=e.length&&7!=e.length&&9!=e.length||(e=e.substring(1,e.length)),3==e.length&&(e=e.split("").map((function(t){return t+t})).join(""));var i=parseInt(e,16);return 6==e.length?new t((i>>16)/255,(i>>8&255)/255,(255&i)/255):new t((i>>24&255)/255,(i>>16&255)/255,(i>>8&255)/255,(255&i)/255)},t.fromInt=function(e){return void 0===e&&(e=0),e<0&&(e=0),new t((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)},t.fromVec3=function(e){return new t(e.x,e.y,e.z)},t.mix=function(e,i,n){return new t(e.red*n+i.red*(1-n),e.green*n+i.green*(1-n),e.blue*n+i.blue*(1-n),e.alpha*n+i.alpha*(1-n))},Object.defineProperty(t.prototype,"code",{get:function(){var t=function(t){var e=(255*t).toString(16);return e=(e=1==e.length?"0"+e:e).length>2?e.substr(0,2):e};return"#"+t(this.red)+t(this.green)+t(this.blue)+t(this.alpha)},enumerable:!0,configurable:!0}),t.isValid=function(t){return/^#?([0-9A-Fa-f]){6,8}$/i.test(t)},t}();e.Color=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.clamp=function(t,e,i){return t<e?e:t>i?i:t},t.toRadians=function(t){return t*Math.PI/180},t.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t}();e.MathUtils=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon",t[t.Raster=4]="Raster",t[t.Building=5]="Building"}(e.GeometryType||(e.GeometryType={}));var n=function(){function t(t,e,i,n){this.id=t,this.type=e,this.geometries=i,this.properties=n}return t.prototype.getId=function(){return this.id},t.prototype.getType=function(){return this.type},t.prototype.getGeometries=function(){return this.geometries},t.prototype.getProperties=function(){return this.properties},t}();e.TileFeature=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.mapState=t,this.layer=e}return t.prototype.renderSelection=function(){},t.prototype.renderShadowMapping=function(){},t.prototype.getRenderTiles=function(){return this.layer.mapView.tileManager.getTilePyramid().getRenderTiles()},t.prototype.getVisibleTiles=function(){return this.layer.mapView.tileManager.getVisibleTiles()},t.getSelectionCode=function(){return this.selectionCode++,(t.selectionCode<t.MIN_SELECTION_CODE||this.selectionCode>t.MAX_SELECTION_CODE)&&(t.selectionCode=t.MIN_SELECTION_CODE),t.selectionCode},t.resetSelectionCode=function(){t.selectionCode=0},t.MIN_SELECTION_CODE=1,t.MAX_SELECTION_CODE=16777215,t.selectionCode=0,t}();e.LayerRenderer=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(55),r=i(27),o=i(42),a=i(37),s=i(102),l=i(70),u=i(2),h=i(71),c=i(1),f=function(){function t(t){this.gl=t,this.models=new Map,this.textures=new Map,this.texts=new Map,this.initialized=!1,this.modelRequestsMap=new Map,this.textureRequestsMap=new Map,this.visibleBuildingIds=new Map}return t.getInstance=function(t){var e=t.id;null==this.instances&&(this.instances=new Map);var i=this.instances.get(e);return i||(i=new this(t),this.instances.set(e,i)),i},t.releaseInstance=function(t){var e=t.id;if(null!=this.instances){var i=this.instances.get(e);i&&(i.textures.forEach((function(t){return t.destroy()})),i.models.forEach((function(t){return t.destroy()})),i.textures.clear(),i.models.clear(),this.instances.delete(e))}},t.prototype.init=function(t,e){this.initialized||(this.initialized=!0,this.taskManager=e,this.requestRender=t)},t.prototype.isAllRequestFinished=function(){return 0==this.modelRequestsMap.size&&0==this.textureRequestsMap.size},t.prototype.hasVisibleBuildingId=function(t){return this.visibleBuildingIds.has(t)},t.prototype.clearVisibleBuildingId=function(){this.visibleBuildingIds.clear()},t.prototype.retainVisibleBuildingId=function(t){var e=this.visibleBuildingIds.get(t);null!=e?this.visibleBuildingIds.set(t,e+1):this.visibleBuildingIds.set(t,1)},t.prototype.removeVisibleBuildingId=function(t){if(this.visibleBuildingIds.has(t)){var e=this.visibleBuildingIds.get(t)-1;0==e?this.visibleBuildingIds.delete(t):this.visibleBuildingIds.set(t,e)}},t.prototype.getModel=function(t){return this.models.get(t)},t.prototype.releaseModel=function(t){var e=this.models.get(t);e&&e.reference<=1&&(e.release(),this.models.delete(t))},t.prototype.getTexture=function(t){return this.textures.get(t)},t.prototype.releaseTexture=function(t){var e=this.textures.get(t);e&&e.reference<=1&&(e.release(),this.textures.delete(t))},t.prototype.createModel=function(t,e,i){var o=this;if(void 0===i&&(i=null),null==t||""==t)return null;if(!n.UrlUtils.isUrlRequest(e))return null;var s=new r.Model(this.gl);s.retain(),this.models.set(t,s);var l=new a.RequestTask(a.Resource.Model);return l.url=e,l.completion=function(e){if(null!=e.data){var n=e.data[0].highestPosition;s.init3dObjectFormArrayBuffer(e.data[0].data),s.setHighestModelPosition(n),s.points=e.data[0].points,s.minX=e.data[0].minX,s.minY=e.data[0].minY,s.minZ=e.data[0].minZ,s.maxX=e.data[0].maxX,s.maxY=e.data[0].maxY,s.maxZ=e.data[0].maxZ,o.modelRequestsMap.delete(t),o.requestRender(),i&&i()}},this.modelRequestsMap.set(t,l),this.taskManager.postTask(l),s},t.prototype.createExtrudeModel=function(t){var e=new r.Model(this.gl);return e.retain(),this.models.set(t,e),e},t.prototype.createMarkerTexture=function(t,e){var i=this;if(null==t||""==t)return null;null==e&&(e=u.SymbolConstants.defaultSymbol);var r=new o.Texture(this.gl);return r.loadImage(n.UrlUtils.isUrlRequest(e)?e:h.Images.get(e),(function(){i.requestRender()})),r.retain(),this.textures.set(t,r),r},t.prototype.createPOITexture=function(t,e){var i=this;if(null==t||""==t)return null;if(!n.UrlUtils.isUrlRequest(e))return null;var r=new o.Texture(this.gl);if(e.startsWith("http")){var s=new a.RequestTask(a.Resource.Texture);s.url=e,s.completion=function(t){if(null!=t.data){r.loadImageFromArrayBuffer(t.data.data,t.data.width,t.data.height,!0,!0,(function(){i.requestRender()}))}},this.taskManager.postTask(s)}else r.loadImage(e,(function(){i.requestRender()}));return r.retain(),this.textures.set(t,r),r},t.prototype.createBuildingTexture=function(t,e){var i=this;if(null==t||""==t)return null;if(!n.UrlUtils.isUrlRequest(e))return null;var r=new o.Texture(this.gl);r.retain(),this.textures.set(t,r);var s=new a.RequestTask(a.Resource.Texture);return s.url=e,s.completion=function(e){if(null!=e.data){r.loadImageFromArrayBuffer(e.data.data,e.data.width,e.data.height,!1,!0,(function(){i.textureRequestsMap.delete(t),i.requestRender()}))}},this.textureRequestsMap.set(t,s),this.taskManager.postTask(s),r},t.prototype.acquireText=function(t,e,i,n,r){void 0===i&&(i=u.MapConstants.poiFontWeight),void 0===n&&(n=u.MapConstants.poiMaxWidth),void 0===r&&(r=u.MapConstants.poiNumLine);var o=t+" "+e+" "+i+" "+n+" "+r,a=this.texts.get(o);return null!=a?(a.model.retain(),a):(a=l.TextLabelFactory.getInstance(this.gl).createText(o,new s.TextLabel(t,e),i,n*c.MapUtils.pixelScale,r),this.texts.set(o,a),a)},t.prototype.releaseText=function(t){var e=this.texts.get(t);null!=e&&(e.model.release(),e.model.reference<=0&&this.texts.delete(t))},t.instances=null,t}();e.MapResourceManager=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(103),r=i(174);!function(t){t[t.BASEMAP=0]="BASEMAP",t[t.ANNOTATION=1]="ANNOTATION",t[t.VECTOR=2]="VECTOR",t[t.OVERLAY=3]="OVERLAY"}(e.Kind||(e.Kind={}));var o=function(){function t(t,e,i){this.renderable=!1,this.kind=t,this.tileCoordinate=e,this.gl=i,this.tileData=new n.TileData,this.tileRenderData=new r.TileRenderData}return t.prototype.getTileData=function(){return this.tileData},t.prototype.setTileData=function(t){this.tileData=t},t.prototype.getTileRenderData=function(){return this.tileRenderData},t.prototype.hasData=function(t){return null!=this.tileData&&null!=this.tileData.getTileLayer(t)},t.prototype.getLayerData=function(t){return this.tileRenderData.getLayerRenderData(t)},t.prototype.isRenderable=function(){return this.renderable},t.prototype.setRenderable=function(){this.renderable=!0},t.prototype.getKind=function(){return this.kind},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t.prototype.destroy=function(){this.tileRenderData.destroy()},t}();e.Tile=o},function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l,u=[],h=!1,c=-1;function f(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&p())}function p(){if(!h){var t=s(f);h=!0;for(var e=u.length;e;){for(l=u,u=[];++c<e;)l&&l[c].run();c=-1,e=u.length}l=null,h=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new d(t,e)),1!==u.length||h||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r=function(){function t(t,e,i,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.target=null==t?null:n.LatLng.convert(t),this.tilt=e,this.bearing=i,this.zoom=r}return t.prototype.setTarget=function(t){this.target=n.LatLng.convert(t)},t.prototype.setTilt=function(t){this.tilt=t},t.prototype.setBearing=function(t){this.bearing=t,Math.abs(Math.abs(this.bearing)%180-90)<.1&&(this.bearing+=.2)},t.prototype.setZoom=function(t){this.zoom=t},t.prototype.getTarget=function(){return this.target},t.prototype.getTilt=function(){return this.tilt},t.prototype.getBearing=function(){return this.bearing},t.prototype.getZoom=function(){return this.zoom},t.convert=function(e){return e instanceof t?e:new t(e.target,e.tilt,e.bearing,e.zoom)},t}();e.CameraPosition=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i}return t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.buffer=function(){return new Float32Array([this.x,this.y,this.z])},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,i=0,n=0,r=0;return e>0&&(i=this.x/e,n=this.y/e,r=this.z/e),new t(i,n,r)},t.prototype.set=function(t){this.x=t.x,this.y=t.y,this.z=t.z},t.prototype.invert=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.rotate90=function(){return new t(this.y,-this.x,this.z)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y,e.z+this.z)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y,this.z-e.z):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y,e*this.z)},t.prototype.rotateBy=function(e){var i=Math.cos(e*Math.PI/180),n=Math.sin(e*Math.PI/180);return new t(this.x*i-this.y*n,this.x*n+this.y*i)},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y+t.z*this.z},t.perp=function(e,i){return new t(i[1]-e[1],e[0]-i[0])},t.neg=function(e){return new t(-e.x,-e.y,-e.z)},t}();e.Vector3=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r=i(2),o=function(){function t(t,e){if(t&&(e?(this.southwest=t instanceof n.LatLng?new n.LatLng(t.lat,t.lng):n.LatLng.convert(t),this.northeast=e instanceof n.LatLng?new n.LatLng(e.lat,e.lng):n.LatLng.convert(e)):4===t.length?(this.southwest=n.LatLng.convert([t[1],t[0]]),this.northeast=n.LatLng.convert([t[3],t[2]])):(this.southwest=t[0]instanceof n.LatLng?new n.LatLng(t[0].lat,t[0].lng):n.LatLng.convert(t[0]),this.northeast=t[1]instanceof n.LatLng?new n.LatLng(t[1].lat,t[1].lng):n.LatLng.convert(t[1]))),this.southwest&&this.northeast&&(this.southwest.lat>this.northeast.lat||this.southwest.lng>this.northeast.lng)){var i=this.southwest,r=this.northeast;this.southwest=new n.LatLng(Math.min(i.lat,r.lat),Math.min(i.lng,r.lng)),this.northeast=new n.LatLng(Math.max(i.lat,r.lat),Math.max(i.lng,r.lng))}}return t.prototype.extend=function(t){var e=n.LatLng.convert(t);return this.southwest&&this.northeast?(this.southwest=new n.LatLng(Math.min(e.lat,this.southwest.lat),Math.min(this.southwest.lng,e.lng)),this.northeast=new n.LatLng(Math.max(e.lat,this.northeast.lat),Math.max(this.northeast.lng,e.lng))):(this.southwest=new n.LatLng(e.lat,e.lng),this.northeast=new n.LatLng(e.lat,e.lng)),this},t.prototype.getCenter=function(){return this.northeast&&this.southwest?new n.LatLng((this.northeast.lat+this.southwest.lat)/2,(this.northeast.lng+this.southwest.lng)/2):new n.LatLng(0,0)},t.prototype.getNortheast=function(){return this.northeast||n.LatLng.convert([r.MapConstants.maxLongitude,r.MapConstants.maxLatitude])},t.prototype.getSouthwest=function(){return this.southwest||n.LatLng.convert([r.MapConstants.minLongitude,r.MapConstants.minLatitude])},t.world=function(){return new t([r.MapConstants.minLongitude,r.MapConstants.minLatitude],[r.MapConstants.maxLongitude,r.MapConstants.maxLatitude])},t.convert=function(e){return e instanceof t?e:new t(e)},t}();e.LatLngBounds=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.layerType=t,this.properties=null}return t.prototype.getType=function(){return this.layerType},t.prototype.getLayerProperties=function(){return this.properties},t.prototype.setLayerProperties=function(t){this.properties=t},t}();e.LayerRenderData=n},function(t,e,i){"use strict";t.exports=function(t){return new s(t||g,null)};function n(t,e,i,n,r,o){this._color=t,this.key=e,this.value=i,this.left=n,this.right=r,this._count=o}function r(t){return new n(t._color,t.key,t.value,t.left,t.right,t._count)}function o(t,e){return new n(t,e.key,e.value,e.left,e.right,e._count)}function a(t){t._count=1+(t.left?t.left._count:0)+(t.right?t.right._count:0)}function s(t,e){this._compare=t,this.root=e}var l=s.prototype;function u(t,e){var i;if(e.left&&(i=u(t,e.left)))return i;return(i=t(e.key,e.value))||(e.right?u(t,e.right):void 0)}function h(t,e,i,n){if(e(t,n.key)<=0){var r;if(n.left)if(r=h(t,e,i,n.left))return r;if(r=i(n.key,n.value))return r}if(n.right)return h(t,e,i,n.right)}function c(t,e,i,n,r){var o,a=i(t,r.key),s=i(e,r.key);if(a<=0){if(r.left&&(o=c(t,e,i,n,r.left)))return o;if(s>0&&(o=n(r.key,r.value)))return o}if(s>0&&r.right)return c(t,e,i,n,r.right)}function f(t,e){this.tree=t,this._stack=e}Object.defineProperty(l,"keys",{get:function(){var t=[];return this.forEach((function(e,i){t.push(e)})),t}}),Object.defineProperty(l,"values",{get:function(){var t=[];return this.forEach((function(e,i){t.push(i)})),t}}),Object.defineProperty(l,"length",{get:function(){return this.root?this.root._count:0}}),l.insert=function(t,e){for(var i=this._compare,r=this.root,l=[],u=[];r;){var h=i(t,r.key);l.push(r),u.push(h),r=h<=0?r.left:r.right}l.push(new n(0,t,e,null,null,1));for(var c=l.length-2;c>=0;--c){r=l[c];u[c]<=0?l[c]=new n(r._color,r.key,r.value,l[c+1],r.right,r._count+1):l[c]=new n(r._color,r.key,r.value,r.left,l[c+1],r._count+1)}for(c=l.length-1;c>1;--c){var f=l[c-1];r=l[c];if(1===f._color||1===r._color)break;var p=l[c-2];if(p.left===f)if(f.left===r){if(!(d=p.right)||0!==d._color){if(p._color=0,p.left=f.right,f._color=1,f.right=p,l[c-2]=f,l[c-1]=r,a(p),a(f),c>=3)(g=l[c-3]).left===p?g.left=f:g.right=f;break}f._color=1,p.right=o(1,d),p._color=0,c-=1}else{if(!(d=p.right)||0!==d._color){if(f.right=r.left,p._color=0,p.left=r.right,r._color=1,r.left=f,r.right=p,l[c-2]=r,l[c-1]=f,a(p),a(f),a(r),c>=3)(g=l[c-3]).left===p?g.left=r:g.right=r;break}f._color=1,p.right=o(1,d),p._color=0,c-=1}else if(f.right===r){if(!(d=p.left)||0!==d._color){if(p._color=0,p.right=f.left,f._color=1,f.left=p,l[c-2]=f,l[c-1]=r,a(p),a(f),c>=3)(g=l[c-3]).right===p?g.right=f:g.left=f;break}f._color=1,p.left=o(1,d),p._color=0,c-=1}else{var d;if(!(d=p.left)||0!==d._color){var g;if(f.left=r.right,p._color=0,p.right=r.left,r._color=1,r.right=f,r.left=p,l[c-2]=r,l[c-1]=f,a(p),a(f),a(r),c>=3)(g=l[c-3]).right===p?g.right=r:g.left=r;break}f._color=1,p.left=o(1,d),p._color=0,c-=1}}return l[0]._color=1,new s(i,l[0])},l.forEach=function(t,e,i){if(this.root)switch(arguments.length){case 1:return u(t,this.root);case 2:return h(e,this._compare,t,this.root);case 3:if(this._compare(e,i)>=0)return;return c(e,i,this._compare,t,this.root)}},Object.defineProperty(l,"begin",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.left;return new f(this,t)}}),Object.defineProperty(l,"end",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.right;return new f(this,t)}}),l.at=function(t){if(t<0)return new f(this,[]);for(var e=this.root,i=[];;){if(i.push(e),e.left){if(t<e.left._count){e=e.left;continue}t-=e.left._count}if(!t)return new f(this,i);if(t-=1,!e.right)break;if(t>=e.right._count)break;e=e.right}return new f(this,[])},l.ge=function(t){for(var e=this._compare,i=this.root,n=[],r=0;i;){var o=e(t,i.key);n.push(i),o<=0&&(r=n.length),i=o<=0?i.left:i.right}return n.length=r,new f(this,n)},l.gt=function(t){for(var e=this._compare,i=this.root,n=[],r=0;i;){var o=e(t,i.key);n.push(i),o<0&&(r=n.length),i=o<0?i.left:i.right}return n.length=r,new f(this,n)},l.lt=function(t){for(var e=this._compare,i=this.root,n=[],r=0;i;){var o=e(t,i.key);n.push(i),o>0&&(r=n.length),i=o<=0?i.left:i.right}return n.length=r,new f(this,n)},l.le=function(t){for(var e=this._compare,i=this.root,n=[],r=0;i;){var o=e(t,i.key);n.push(i),o>=0&&(r=n.length),i=o<0?i.left:i.right}return n.length=r,new f(this,n)},l.find=function(t){for(var e=this._compare,i=this.root,n=[];i;){var r=e(t,i.key);if(n.push(i),0===r)return new f(this,n);i=r<=0?i.left:i.right}return new f(this,[])},l.remove=function(t){var e=this.find(t);return e?e.remove():this},l.get=function(t){for(var e=this._compare,i=this.root;i;){var n=e(t,i.key);if(0===n)return i.value;i=n<=0?i.left:i.right}};var p=f.prototype;function d(t,e){t.key=e.key,t.value=e.value,t.left=e.left,t.right=e.right,t._color=e._color,t._count=e._count}function g(t,e){return t<e?-1:t>e?1:0}Object.defineProperty(p,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(p,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),p.clone=function(){return new f(this.tree,this._stack.slice())},p.remove=function(){var t=this._stack;if(0===t.length)return this.tree;var e=new Array(t.length),i=t[t.length-1];e[e.length-1]=new n(i._color,i.key,i.value,i.left,i.right,i._count);for(var l=t.length-2;l>=0;--l){(i=t[l]).left===t[l+1]?e[l]=new n(i._color,i.key,i.value,e[l+1],i.right,i._count):e[l]=new n(i._color,i.key,i.value,i.left,e[l+1],i._count)}if((i=e[e.length-1]).left&&i.right){var u=e.length;for(i=i.left;i.right;)e.push(i),i=i.right;var h=e[u-1];e.push(new n(i._color,h.key,h.value,i.left,i.right,i._count)),e[u-1].key=i.key,e[u-1].value=i.value;for(l=e.length-2;l>=u;--l)i=e[l],e[l]=new n(i._color,i.key,i.value,i.left,e[l+1],i._count);e[u-1].left=e[u]}if(0===(i=e[e.length-1])._color){var c=e[e.length-2];c.left===i?c.left=null:c.right===i&&(c.right=null),e.pop();for(l=0;l<e.length;++l)e[l]._count--;return new s(this.tree._compare,e[0])}if(i.left||i.right){i.left?d(i,i.left):i.right&&d(i,i.right),i._color=1;for(l=0;l<e.length-1;++l)e[l]._count--;return new s(this.tree._compare,e[0])}if(1===e.length)return new s(this.tree._compare,null);for(l=0;l<e.length;++l)e[l]._count--;var f=e[e.length-2];return function(t){for(var e,i,n,s,l=t.length-1;l>=0;--l){if(e=t[l],0===l)return void(e._color=1);if((i=t[l-1]).left===e){if((n=i.right).right&&0===n.right._color){if(s=(n=i.right=r(n)).right=r(n.right),i.right=n.left,n.left=i,n.right=s,n._color=i._color,e._color=1,i._color=1,s._color=1,a(i),a(n),l>1)(u=t[l-2]).left===i?u.left=n:u.right=n;return void(t[l-1]=n)}if(n.left&&0===n.left._color){if(s=(n=i.right=r(n)).left=r(n.left),i.right=s.left,n.left=s.right,s.left=i,s.right=n,s._color=i._color,i._color=1,n._color=1,e._color=1,a(i),a(n),a(s),l>1)(u=t[l-2]).left===i?u.left=s:u.right=s;return void(t[l-1]=s)}if(1===n._color){if(0===i._color)return i._color=1,void(i.right=o(0,n));i.right=o(0,n);continue}n=r(n),i.right=n.left,n.left=i,n._color=i._color,i._color=0,a(i),a(n),l>1&&((u=t[l-2]).left===i?u.left=n:u.right=n),t[l-1]=n,t[l]=i,l+1<t.length?t[l+1]=e:t.push(e),l+=2}else{if((n=i.left).left&&0===n.left._color){if(s=(n=i.left=r(n)).left=r(n.left),i.left=n.right,n.right=i,n.left=s,n._color=i._color,e._color=1,i._color=1,s._color=1,a(i),a(n),l>1)(u=t[l-2]).right===i?u.right=n:u.left=n;return void(t[l-1]=n)}if(n.right&&0===n.right._color){if(s=(n=i.left=r(n)).right=r(n.right),i.left=s.right,n.right=s.left,s.right=i,s.left=n,s._color=i._color,i._color=1,n._color=1,e._color=1,a(i),a(n),a(s),l>1)(u=t[l-2]).right===i?u.right=s:u.left=s;return void(t[l-1]=s)}if(1===n._color){if(0===i._color)return i._color=1,void(i.left=o(0,n));i.left=o(0,n);continue}var u;n=r(n),i.left=n.right,n.right=i,n._color=i._color,i._color=0,a(i),a(n),l>1&&((u=t[l-2]).right===i?u.right=n:u.left=n),t[l-1]=n,t[l]=i,l+1<t.length?t[l+1]=e:t.push(e),l+=2}}}(e),f.left===i?f.left=null:f.right=null,new s(this.tree._compare,e[0])},Object.defineProperty(p,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(p,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(p,"index",{get:function(){var t=0,e=this._stack;if(0===e.length){var i=this.tree.root;return i?i._count:0}e[e.length-1].left&&(t=e[e.length-1].left._count);for(var n=e.length-2;n>=0;--n)e[n+1]===e[n].right&&(++t,e[n].left&&(t+=e[n].left._count));return t},enumerable:!0}),p.next=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.right)for(e=e.right;e;)t.push(e),e=e.left;else for(t.pop();t.length>0&&t[t.length-1].right===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(p,"hasNext",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].right)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].left===t[e])return!0;return!1}}),p.update=function(t){var e=this._stack;if(0===e.length)throw new Error("Can't update empty node!");var i=new Array(e.length),r=e[e.length-1];i[i.length-1]=new n(r._color,r.key,t,r.left,r.right,r._count);for(var o=e.length-2;o>=0;--o)(r=e[o]).left===e[o+1]?i[o]=new n(r._color,r.key,r.value,i[o+1],r.right,r._count):i[o]=new n(r._color,r.key,r.value,r.left,i[o+1],r._count);return new s(this.tree._compare,i[0])},p.prev=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.left)for(e=e.left;e;)t.push(e),e=e.right;else for(t.pop();t.length>0&&t[t.length-1].left===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(p,"hasPrev",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].left)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].right===t[e])return!0;return!1}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.id=t,this.order=e}return t.prototype.equal=function(t){return this.id==t.id},t.prototype.lessThan=function(t){return this.order==t.order?this.id<t.id:this.order<t.order},t}();e.Order=n,e.compareOrderASC=function(t,e){return t.order==e.order?t.id<e.id?-1:t.id>e.id?1:0:t.order-e.order},e.compareOrderDESC=function(t,e){return t.order==e.order?t.id<e.id?1:t.id>e.id?-1:0:e.order-t.order}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.getLayer=function(){return this.layer},t}();e.LayerProperties=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=i(2),o=i(9),a=i(20),s=function(){function t(){}return t.calculateViewMatrix=function(t,e,i){var o=n.MapUtils.getTileSize(),s=r.CameraConstants.height*Math.tan(r.CameraConstants.fov/2)*o/i/(o/2),l=this.matrix.setRotationX(e.getTilt()),u=e.getBearing(),h=l.transform(new a.Vector3(0,0,r.CameraConstants.height),0);l.setRotationZ(-u);var c=l.transform(h,0);l.setRotationX(e.getTilt()),h=l.transform(new a.Vector3(0,1,0),0),l.setRotationZ(-u);var f=l.transform(h,0);return l.lookAt(c,new a.Vector3(0,0,0),1,f),t.setIdentity(s,s,s),t.concat(l)},t.calculateOrthoProjectionMatrix=function(t,e){return o.Matrix4.ortho(0,t,e,0)},t.calculateViewProjectionMatrix=function(e,i,n){var a=t.calculateViewMatrix(new o.Matrix4,e,n),s=o.Matrix4.perspective(r.CameraConstants.fov,i/n,r.CameraConstants.nearPlane,r.CameraConstants.farPlane);return a.concat(s)},t.calculateInverseViewProjectionMatrix=function(t,e,i){return this.calculateViewProjectionMatrix(t,e,i).inverse()},t.matrix=new o.Matrix4,t}();e.CameraUtils=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),a=function(t){function e(e,i,n,r,a){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null);var s=t.call(this)||this;if(s.gl=e,s.attributeInfos=[],s.uniformInfos=[],s._points=[],i){s.numOfVertices=i.length;for(var l=[],u=0,h=i;u<h.length;u++)for(var c=h[u],f=0,p=n;f<p.length;f++)for(var d=0,g=c[b=p[f]];d<g.length;d++){var y=g[d];l.push(y)}s.arrayBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,s.arrayBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(l),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);for(var m=i[0],v=0,_=0;_<n.length;++_){var b=n[_],w=r[_],M=m[b].length,x=new o.AttributeInfo(w,M,v,0);s.attributeInfos.push(x),v+=M}for(var T=0,A=s.attributeInfos;T<A.length;T++){(x=A[T]).stride=v}null!=a&&s.setIndices(a)}return s}return r(e,t),e.prototype.init=function(t,e,i){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),null!=this.gl&&null!=t&&null!=i&&null!=e){var n=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.setIndices(i),this.arrayBuffer=n,this.numOfVertices=i.length,this.attributeInfos=e}else console.log("GL or data or dicies is missing")},e.prototype.init3dObjectFormArrayBuffer=function(t){if(void 0===t&&(t=null),null!=this.gl){var e=this.gl.createBuffer();if(null!=t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.arrayBuffer=e;this.numOfVertices=t.byteLength/4/8,this.attributeInfos=[new o.AttributeInfo("a_position",3,0,8),new o.AttributeInfo("a_uv",2,3,8),new o.AttributeInfo("a_normal",3,5,8)]}else console.log("Vertices size can not be null")}else console.log("init model Building no data")},e.prototype.init3dObject=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null!=this.gl){var i=this.gl.createBuffer();if(null!=t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.arrayBuffer=i;null!=e?this.setIndices(e):this.numOfVertices=t.length/8,this.attributeInfos=[new o.AttributeInfo("a_position",3,0,8),new o.AttributeInfo("a_uv",2,3,8),new o.AttributeInfo("a_normal",3,5,8)]}else console.log("Vertices size can not be null")}else console.log("init model Building no data")},e.prototype.setIndices=function(t){if(t){var e=this.gl;this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Int16Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.numOfVertices=t.length}},e.prototype.bind=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.arrayBuffer),this.indexBuffer&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},e.prototype.unbind=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.indexBuffer&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)},e.prototype.render=function(t){this.indexBuffer?this.gl.drawElements(t,this.numOfVertices,this.gl.UNSIGNED_SHORT,0):this.numOfVertices>0&&this.gl.drawArrays(t,0,this.numOfVertices)},e.prototype.renderPartial=function(t,e,i){this.indexBuffer?this.gl.drawElements(t,i,this.gl.UNSIGNED_SHORT,2*e):this.numOfVertices>0&&this.gl.drawArrays(t,e,i)},e.prototype.setUniform=function(t){this.uniformInfos.push(t)},e.prototype.destroy=function(){this.arrayBuffer&&(this.gl.deleteBuffer(this.arrayBuffer),this.arrayBuffer=null),this.indexBuffer&&(this.gl.deleteBuffer(this.indexBuffer),this.indexBuffer=null),this.attributeInfos=[],this.uniformInfos=[]},e.prototype.setHighestModelPosition=function(t){this.highestModelPosition=t},e.prototype.getHighestModelPosition=function(){return this.highestModelPosition},Object.defineProperty(e.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxX",{get:function(){return this._maxX},set:function(t){this._maxX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxY",{get:function(){return this._maxY},set:function(t){this._maxY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxZ",{get:function(){return this._maxZ},set:function(t){this._maxZ=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minX",{get:function(){return this._minX},set:function(t){this._minX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minY",{get:function(){return this._minY},set:function(t){this._minY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minZ",{get:function(){return this._minZ},set:function(t){this._minZ=t},enumerable:!0,configurable:!0}),e}(i(69).ResourceReference);e.Model=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),a=function(t){this.geometryCoordinates=[],this.geometryCoordinates=t};e.GeometryCoordinates=a;var s=function(t){function e(e){var i=t.call(this,e)||this;return i.normalizeGeometryCoordinates(),i}return r(e,t),e.prototype.normalizeGeometryCoordinates=function(){for(var t=[],e=0;e<this.geometryCoordinates.length;++e){for(var i=[],n=0;n<this.geometryCoordinates[e].length;++n)i.push([this.geometryCoordinates[e][n][0]/o.MapConstants.tileExtend-.5,.5-this.geometryCoordinates[e][n][1]/o.MapConstants.tileExtend]);t.push(i)}this.geometryCoordinates=t},e}(a);e.GeometryCollection=s},function(t,e,i){(function(t){var n=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),i={},n=0;n<e.length;n++)i[e[n]]=Object.getOwnPropertyDescriptor(t,e[n]);return i},r=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(s(arguments[i]));return e.join(" ")}i=1;for(var n=arguments,o=n.length,a=String(t).replace(r,(function(t){if("%%"===t)return"%";if(i>=o)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return t}})),l=n[i];i<o;l=n[++i])g(l)||!b(l)?a+=" "+l:a+=" "+s(l);return a},e.deprecate=function(i,n){if(void 0!==t&&!0===t.noDeprecation)return i;if(void 0===t)return function(){return e.deprecate(i,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),r=!0}return i.apply(this,arguments)}};var o,a={};function s(t,i){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(i)?n.showHidden=i:i&&e._extend(n,i),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),h(n,t,n.depth)}function l(t,e){var i=s.styles[e];return i?"["+s.colors[i][0]+"m"+t+"["+s.colors[i][1]+"m":t}function u(t,e){return t}function h(t,i,n){if(t.customInspect&&i&&x(i.inspect)&&i.inspect!==e.inspect&&(!i.constructor||i.constructor.prototype!==i)){var r=i.inspect(n,t);return m(r)||(r=h(t,r,n)),r}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(m(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}if(y(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(g(e))return t.stylize("null","null")}(t,i);if(o)return o;var a=Object.keys(i),s=function(t){var e={};return t.forEach((function(t,i){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(i)),M(i)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(i);if(0===a.length){if(x(i)){var l=i.name?": "+i.name:"";return t.stylize("[Function"+l+"]","special")}if(_(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(w(i))return t.stylize(Date.prototype.toString.call(i),"date");if(M(i))return c(i)}var u,b="",T=!1,A=["{","}"];(p(i)&&(T=!0,A=["[","]"]),x(i))&&(b=" [Function"+(i.name?": "+i.name:"")+"]");return _(i)&&(b=" "+RegExp.prototype.toString.call(i)),w(i)&&(b=" "+Date.prototype.toUTCString.call(i)),M(i)&&(b=" "+c(i)),0!==a.length||T&&0!=i.length?n<0?_(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),u=T?function(t,e,i,n,r){for(var o=[],a=0,s=e.length;a<s;++a)E(e,String(a))?o.push(f(t,e,i,n,String(a),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(f(t,e,i,n,r,!0))})),o}(t,i,n,s,a):a.map((function(e){return f(t,i,n,s,e,T)})),t.seen.pop(),function(t,e,i){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1];return i[0]+e+" "+t.join(", ")+" "+i[1]}(u,b,A)):A[0]+b+A[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,i,n,r,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),E(n,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=g(i)?h(t,l.value,null):h(t,l.value,i-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),v(a)){if(o&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function v(t){return void 0===t}function _(t){return b(t)&&"[object RegExp]"===T(t)}function b(t){return"object"==typeof t&&null!==t}function w(t){return b(t)&&"[object Date]"===T(t)}function M(t){return b(t)&&("[object Error]"===T(t)||t instanceof Error)}function x(t){return"function"==typeof t}function T(t){return Object.prototype.toString.call(t)}function A(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(i){if(v(o)&&(o=t.env.NODE_DEBUG||""),i=i.toUpperCase(),!a[i])if(new RegExp("\\b"+i+"\\b","i").test(o)){var n=t.pid;a[i]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",i,n,t)}}else a[i]=function(){};return a[i]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=d,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=_,e.isObject=b,e.isDate=w,e.isError=M,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=i(219);var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var t=new Date,e=[A(t.getHours()),A(t.getMinutes()),A(t.getSeconds())].join(":");return[t.getDate(),L[t.getMonth()],e].join(" ")}function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",S(),e.format.apply(e,arguments))},e.inherits=i(33),e._extend=function(t,e){if(!e||!b(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t};var I="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function P(t,e){if(!t){var i=new Error("Promise was rejected with a falsy value");i.reason=t,t=i}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(I&&t[I]){var e;if("function"!=typeof(e=t[I]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,I,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,i,n=new Promise((function(t,n){e=t,i=n})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(t,n){t?i(t):e(n)}));try{t.apply(this,r)}catch(t){i(t)}return n}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),I&&Object.defineProperty(e,I,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,n(t))},e.promisify.custom=I,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function i(){for(var i=[],n=0;n<arguments.length;n++)i.push(arguments[n]);var r=i.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return r.apply(o,arguments)};e.apply(this,i).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(P,e,a)}))}return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),Object.defineProperties(i,n(e)),i}}).call(this,i(18))},function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)r(i,n)&&(t[n]=i[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){var e,i,n,r,o,a;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(a=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)o=t[e],a.set(o,r),r+=o.length;return a}},a={arraySet:function(t,e,i,n,r){for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(n)},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(5),a=i(35),s=i(1),l=i(10),u=i(2),h=i(157),c=function(t){function e(i){var n=t.call(this)||this,r={};if(s.MapUtils.extendOptions(r,e.defaultMarkerOptions,i),n.elevation=r.elevation,n.zIndex=r.zIndex,null==r.position||null==r.anchor||null==r.windowAnchor||null==r.visible||null==n.elevation||null==n.zIndex||null==r.draggable)throw Error("Parameters can not be null");return n.properties=new h.SymbolLayerProperties(r.title,r.snippet,r.windowAnchor,o.LatLng.convert(r.position),l.Point.convert(r.anchor),0,0,"",r.iconView,r.icon,r.elevation,r.rotation,r.label,l.Point.convert(r.labelAnchor),r.visible,r.draggable,r.userInteractionEnabled),n}return r(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.map.mapView.hideInfoWindow(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setInfoWindow=function(t){t!==this.properties.getInfoWindow()&&this.properties.setInfoWindow(t)},e.prototype.setInfoContents=function(t){t!==this.properties.getInfoContents()&&this.properties.setInfoContents(t)},e.prototype.setIcon=function(t){this.getIconView()?console.warn("Icon view markers has the priority over other markers"):(null==t&&(t=u.SymbolConstants.defaultSymbol),t!==this.properties.getIcon()&&(this.properties.setIcon(t),this.properties.setTextureDirty(!0),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)))},e.prototype.setTitle=function(t){this.properties.getTitle()!==t&&(this.properties.setTitle(t),null!=this.map&&this.map.mapView.updateInfoContents(this.id))},e.prototype.setSnippet=function(t){this.properties.getSnippet()!==t&&(this.properties.setSnippet(t),null!=this.map&&this.map.mapView.updateInfoContents(this.id))},e.prototype.setLabel=function(t){this.properties.getMarkerLabel()!==t&&(this.properties.setMarkerLabel(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.setWindowAnchor=function(t){if(null!=t){var e=l.Point.convert(t);this.properties.getWindowAnchor().equals(e)||this.properties.setWindowAnchor(e)}else console.warn("Parameter anchor can not be null")},e.prototype.setPosition=function(t){if(null!=t){var e=o.LatLng.convert(t);this.properties.getPosition().equals(e)||(this.properties.setPosition(e),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))}else console.warn("Parameter position can not be null")},e.prototype.setVisible=function(t){null!=t?this.properties.isVisible()!==t&&(this.properties.setVisible(t),null!=this.map&&(t||this.isInfoWindowShown()&&this.map.mapView.hideInfoWindow(this.id),this.map.mapView.updateAnnotation(this.id))):console.warn("Parameter visible can not be null")},e.prototype.setAnchor=function(t){if(null!=t){var e=l.Point.convert(t);this.properties.getAnchor().equals(e)||(this.properties.setAnchor(e),null!=this.map&&this.map.mapView.updateAnnotation(this.id))}else console.warn("Parameter anchor can not be null")},e.prototype.setLabelAnchor=function(t){if(null!=t){var e=l.Point.convert(t);this.properties.getLabelAnchor().equals(e)||(this.properties.setLabelAnchor(e),null!=this.map&&this.map.mapView.updateAnnotation(this.id))}else console.warn("Parameter labelAnchor can not be null")},e.prototype.setDraggable=function(t){null!=t?this.properties.setDraggable(t):console.warn("Parameter draggable can not be null")},e.prototype.getTitle=function(){return this.properties.getTitle()},e.prototype.getSnippet=function(){return this.properties.getSnippet()},e.prototype.getWindowAnchor=function(){var t=this.properties.getWindowAnchor();return null==t?null:new l.Point(t.x,t.y)},e.prototype.getPosition=function(){return this.properties.getPosition()},e.prototype.isVisible=function(){return this.properties.isVisible()},e.prototype.getAnchor=function(){var t=this.properties.getAnchor();return null==t?null:new l.Point(t.x,t.y)},e.prototype.getLabelAnchor=function(){var t=this.properties.getLabelAnchor();return null==t?null:new l.Point(t.x,t.y)},e.prototype.getIcon=function(){return this.properties.getIcon()},e.prototype.getLabel=function(){return this.properties.getMarkerLabel()},e.prototype.isDraggable=function(){return this.properties.isDraggable()},e.prototype.getInfoWindow=function(){return this.properties.getInfoWindow()},e.prototype.getInfoContents=function(){return this.properties.getInfoContents()},e.prototype.isInfoWindowShown=function(){return null!=this.map&&this.map.mapView.isInfoWindowShown(this.id)},e.prototype.showInfoWindow=function(){null!=this.map&&this.properties.isVisible()&&!this.isInfoWindowShown()&&this.map.mapView.showInfoWindow(this.id)},e.prototype.hideInfoWindow=function(){null!=this.map&&this.isInfoWindowShown()&&this.map.mapView.hideInfoWindow(this.id)},e.prototype.getIconView=function(){return this.properties.getIconView()},e.prototype.setIconView=function(t){this.properties.getIconView()!==t&&(this.properties.setIconView(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.getRotation=function(){return this.properties.getRotation()},e.prototype.setRotation=function(t){null!=t?this.properties.getRotation()!==t&&(this.properties.setRotation(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter rotation can not be null")},e.prototype.getProperties=function(){return this.properties},e.prototype.isUserInteractionEnabled=function(){return this.properties.isUserInteractionEnabled()},e.prototype.setUserInteraction=function(t){this.properties.setUserInteraction(t)},e.defaultMarkerOptions={visible:!0,anchor:new l.Point(.5,1),labelAnchor:new l.Point(.5,.5),icon:u.SymbolConstants.defaultSymbol,elevation:0,rotation:0,windowAnchor:new l.Point(.5,0),zIndex:0,draggable:!1,iconView:null,userInteractionEnabled:!0},e}(a.Annotation);e.Marker=c},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){"use strict";var n=i(59),r=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};t.exports=c;var o=i(44);o.inherits=i(33);var a=i(121),s=i(84);o.inherits(c,a);for(var l=r(s.prototype),u=0;u<l.length;u++){var h=l[u];c.prototype[h]||(c.prototype[h]=s.prototype[h])}function c(t){if(!(this instanceof c))return new c(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||n.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),c.prototype._destroy=function(t,e){this.push(null),this.end(),n.nextTick(e,t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.id=null,this.map=null,this.zIndex=0,this.bringFrontBuilding=!1}return t.prototype.getId=function(){return this.id},t.prototype.getMap=function(){return this.map},t.prototype.getUserData=function(){return this.userData},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.setUserData=function(t){this.userData=t},t.prototype.setZIndex=function(t){null!=t?t!=Number.MAX_SAFE_INTEGER&&t!=Number.MIN_SAFE_INTEGER?t!=this.zIndex&&(null!=this.map&&this.map.mapView.updateAnnotationZIndex(this.id,this.zIndex,t),this.zIndex=t):console.warn("zIndex value is not allowed!!!"):console.warn("Parameter index can not be null")},t.prototype.getElevation=function(){return this.elevation},t.prototype.setElevation=function(t){null!=t?this.elevation!==t&&(this.elevation=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter elevation can not be null")},t}();e.Annotation=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o,a=i(5),s=i(35),l=i(1),u=i(158);!function(t){t.Solid="solid",t.Dotted="dotted"}(o=e.PolylineStyle||(e.PolylineStyle={}));var h=function(t){function e(i){var n=t.call(this)||this,r={};l.MapUtils.extendOptions(r,e.defaultPolylineOptions,i);for(var s=0,h=r;s<h.length;s++){if(null==h[s])throw Error("Parameters can not be null")}return n.path=r.path.map((function(t){return a.LatLng.convert(t)})),n.elevation=r.elevation,n.zIndex=r.zIndex,n.properties=new u.LineLayerProperties(r.strokeWidth,r.strokeColor,r.strokeOpacity,r.elevation,r.closed,r.visible,r.draggable,r.style,r.userInteractionEnabled),r.style!=o.Dotted&&r.style!=o.Solid&&(console.warn("Wrong style options for Polyline. Only use 'dotted' or 'solid'."),r.style=o.Solid),n.properties.setStyle(r.style),n}return r(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setClosed=function(t){null!=t?this.properties.isClosed()!=t&&(this.properties.setClosed(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter closed can not be null")},e.prototype.setPath=function(t){null==t||t.length<2?console.warn("Parameter path size must be greater than 1"):(this.path=t.map((function(t){return a.LatLng.convert(t)})),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))},e.prototype.setStrokeWidth=function(t){null!=t?this.properties.getStrokeWidth()!=t&&(this.properties.setStrokeWidth(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeWidth can not be null")},e.prototype.setStrokeColor=function(t){null!=t?this.properties.getStrokeColor().code!=t&&(this.properties.setStrokeColor(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeColor can not be null")},e.prototype.setStrokeOpacity=function(t){null!=t?this.properties.getStrokeOpacity()!=t&&(this.properties.setStrokeOpacity(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeOpacity can not be null")},e.prototype.setVisible=function(t){null!=t?this.properties.isVisible()!=t&&(this.properties.setVisible(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter visible can not be null")},e.prototype.setDraggable=function(t){null!=t?this.properties.isDraggable()!=t&&this.properties.setDraggable(t):console.warn("Parameter draggable can not be null")},e.prototype.setStyle=function(t){null!=t?(t!=o.Dotted&&t!=o.Solid&&(console.warn("Wrong style options for Polyline. Only use 'dotted' or 'solid'."),t=o.Solid),this.properties.getStyle()!=t&&(this.properties.setStyle(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id))):console.warn("Parameter style can not be null")},e.prototype.getPath=function(){return(this.path||[]).slice()},e.prototype.getStrokeWidth=function(){return this.properties.getStrokeWidth()},e.prototype.getStrokeColor=function(){return this.properties.getStrokeColor().code},e.prototype.getStrokeOpacity=function(){return this.properties.getStrokeOpacity()},e.prototype.isVisible=function(){return this.properties.isVisible()},e.prototype.isClosed=function(){return this.properties.isClosed()},e.prototype.isDraggable=function(){return this.properties.isDraggable()},e.prototype.getStyle=function(){return this.properties.getStyle()},e.prototype.getProperties=function(){return this.properties},e.prototype.isUserInteractionEnabled=function(){return this.properties.isUserInteractionEnabled()},e.prototype.setUserInteraction=function(t){this.properties.setUserInteraction(t)},e.defaultPolylineOptions={strokeWidth:0,strokeColor:"#0000ff",strokeOpacity:1,visible:!0,closed:!1,draggable:!1,zIndex:0,elevation:0,style:"solid",userInteractionEnabled:!0},e}(s.Annotation);e.Polyline=h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(101);!function(t){t[t.Tile=0]="Tile",t[t.CustomModel=1]="CustomModel",t[t.CustomTexture=2]="CustomTexture",t[t.TileOverlay=3]="TileOverlay",t[t.POIOverlay=4]="POIOverlay",t[t.BuildingOverlay=5]="BuildingOverlay",t[t.Model=6]="Model",t[t.Texture=7]="Texture",t[t.RasterOverlay=8]="RasterOverlay",t[t.MAX=9]="MAX"}(e.Resource||(e.Resource={}));var r=function(t){this.method="GET",this.params=null,this.id=n.UUID.generate(),this.type=t};e.RequestTask=r;var o=function(t){this.id=t,this.success=!1,this.data=null};e.ResponseTask=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r,o=i(3),a=i(2),s=i(108),l=i(13);!function(t){t[t.Butt=0]="Butt",t[t.Square=1]="Square",t[t.Round=2]="Round"}(n=e.LineCapType||(e.LineCapType={})),function(t){t[t.Miter=0]="Miter",t[t.Bevel=1]="Bevel",t[t.Round=2]="Round"}(r=e.LineJoinType||(e.LineJoinType={}));var u=function(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t};e.CircleBuilderContext=u,e.buildCircle=function(t){var e=a.PolyConstants.numTrianglesPerCircle,i=2*Math.PI;t.addVertex(new o.Vector2(0,0));for(var n=0;n<e;++n)t.addVertex(new o.Vector2(Math.cos(n*i/e),Math.sin(n*i/e)).normalize()),0!=n&&(t.indices.push(0),t.indices.push(0+n),t.indices.push(0+n+1));t.indices.push(0),t.indices.push(e),t.indices.push(1)};var h=function(){function t(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t}return t.prototype.clear=function(){this.indices=[]},t}();e.PolygonBuilderContext=h,e.buildPolygon=function(t,e){var i=[],n=[];t.forEach((function(t,r){0!=r&&n.push(i.length/2),t.forEach((function(t){i.push((t.x+.5)*a.MapConstants.tileExtend),i.push((.5-t.y)*a.MapConstants.tileExtend),e.addVertex(t)}))})),e.indices=s.default(i,n)};var c=function(){function t(t,e,i,o,a){void 0===t&&(t=function(t,e){}),void 0===e&&(e=n.Butt),void 0===i&&(i=r.Bevel),void 0===o&&(o=!1),void 0===a&&(a=3),this.indices=[],this.addVertex=t,this.lineCapType=e,this.lineJoinType=i,this.closedPolyline=o,this.miterLimit=a,this.numVertices=0}return t.prototype.buildPolyLine=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.buildPolyLineSegment(t,e,i)},t.prototype.clear=function(){this.indices=[],this.numVertices=0},t.prototype.buildPolyLineSegment=function(t,e,i){void 0===i&&(i=null);var n=0,s=this.closedPolyline?t.length+2:t.length,u=t.length,h=s-0;if(!(h<2)){var c,f,p,d=t[0],g=t[1];f=new o.Vector2(g.y-d.y,d.x-g.x).normalize(),this.closedPolyline||this.addCap(d,f,!0),this.addPolyLineVertex(d,f,new o.Vector2(0,1)),this.addPolyLineVertex(d,f.multiply(-1),new o.Vector2(0,0));for(var y=1;y<h-1;++y){var m=(y+0+1)%u;if(n+=l.MathUtils.distance(d,g),(d=g)!=(g=t[m])){c=f,f=new o.Vector2(g.y-d.y,d.x-g.x).normalize();var v=1;0==(p=c.add(f)).x&&0==p.y?p=new o.Vector2(c.y-f.y,f.x-c.x):v=2/p.dot(p),p=p.multiply(v);var _=this.lineJoinType==r.Bevel;p.length>this.miterLimit&&(_=!0,p=p.multiply(this.miterLimit/p.length));var b=n;if(this.lineJoinType!=r.Miter||_){var w=_||this.lineJoinType==r.Bevel?1:a.PolyConstants.numTrianglesOnRoundJoin;f.x*c.y-f.y*c.x>0?(this.addPolyLineVertex(d,p,new o.Vector2(b,1)),this.addPolyLineVertex(d,c.multiply(-1),new o.Vector2(b,0)),this.addIndices(),this.addFan(d,c.multiply(-1),f.multiply(-1),p,new o.Vector2(b,0),new o.Vector2(b,0),new o.Vector2(b,1),w),this.addPolyLineVertex(d,p,new o.Vector2(b,1)),this.addPolyLineVertex(d,f.multiply(-1),new o.Vector2(b,0))):(this.addPolyLineVertex(d,c,new o.Vector2(b,1)),this.addPolyLineVertex(d,p.multiply(-1),new o.Vector2(b,0)),this.addIndices(),this.addFan(d,c,f,p.multiply(-1),new o.Vector2(b,1),new o.Vector2(b,1),new o.Vector2(b,0),w),this.addPolyLineVertex(d,f,new o.Vector2(b,1)),this.addPolyLineVertex(d,p.multiply(-1),new o.Vector2(b,0)))}else this.addPolyLineVertex(d,p,new o.Vector2(b,1)),this.addPolyLineVertex(d,p.multiply(-1),new o.Vector2(b,0)),this.addIndices()}}n+=l.MathUtils.distance(d,g),i||(i=1);var M=i*a.PolyConstants.polylineTextureWidth/a.PolyConstants.polylineTextureHeight;n=Math.floor(n/M)*M,this.addPolyLineVertex(g,f,new o.Vector2(n,1)),this.addPolyLineVertex(g,f.multiply(-1),new o.Vector2(n,0)),this.addIndices(),this.closedPolyline||this.addCap(g,f,!1),e&&e()}},t.prototype.addCap=function(t,e,i){var r=i?0:1;switch(this.lineCapType){case n.Butt:break;case n.Square:var s=new o.Vector2(-e.y,e.x);this.addPolyLineVertex(t,e.add(s),new o.Vector2(r,0)),this.addPolyLineVertex(t,e.multiply(-1).add(s),new o.Vector2(r,0)),i||this.addIndices();break;case n.Round:var l=e,u=e.multiply(-1),h=new o.Vector2(0,0),c=new o.Vector2(r,1),f=new o.Vector2(r,0),p=new o.Vector2(r,.5);i&&(l=l.multiply(-1),u=u.multiply(-1),c.y=0,f.y=1),this.addFan(t,l,u,h,c,f,p,a.PolyConstants.numTrianglesOnRoundCap);break;default:console.log("Invalid line cap type")}},t.prototype.addPolyLineVertex=function(t,e,i){++this.numVertices,this.addVertex(t,e,i)},t.prototype.addIndices=function(){this.indices.push(this.numVertices-4),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-1)},t.prototype.addFan=function(t,e,i,n,r,a,s,l){var u=e.x*i.y-e.y*i.x,h=Math.atan2(u,e.dot(i)),c=this.numVertices;this.addPolyLineVertex(t,n,s),this.addPolyLineVertex(t,e,r);for(var f=e,p=0;p<l;p++){var d=(p+1)/l;f=e.rotateByRadian(h*d);var g=new o.Vector2(0,0);g=r.multiply(1-d).add(a.multiply(d)),this.addPolyLineVertex(t,f,g),this.indices.push(c),this.indices.push(c+p+(h>0?1:2)),this.indices.push(c+p+(h>0?2:1))}},t}();e.PolylineBuilderContext=c},function(t,e,i){"use strict";function n(t,e){this.x=t,this.y=e}t.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.y,r=i*this.x+e*this.y;return this.x=n,this.y=r,this},_rotateAround:function(t,e){var i=Math.cos(t),n=Math.sin(t),r=e.x+i*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+i*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.cameraWillChange=0]="cameraWillChange",t[t.cameraChanging=1]="cameraChanging",t[t.idle=2]="idle",t[t.hover=3]="hover",t[t.click=4]="click",t[t.dblClick=5]="dblClick",t[t.drag=6]="drag",t[t.dragEnd=7]="dragEnd",t[t.dragStart=8]="dragStart",t[t.mouseMove=9]="mouseMove",t[t.mouseOut=10]="mouseOut",t[t.mouseOver=11]="mouseOver",t[t.rightClick=12]="rightClick",t[t.tilesLoaded=13]="tilesLoaded",t[t.modeChanged=14]="modeChanged",t[t.longClick=15]="longClick",t[t.boundsChanged=16]="boundsChanged"}(e.MapEvent||(e.MapEvent={}))},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(5),a=i(35),s=i(1),l=i(159),u=i(160),h=i(10),c=i(67),f=function(t){function e(i){var n=t.call(this)||this,r={};s.MapUtils.extendOptions(r,e.defaultPolygonOptions,i);for(var a=0,u=r;a<u.length;a++){if(null==u[a])throw Error("Parameters can not be null")}return n.paths=r.paths.map((function(t){return t.map((function(t){return o.LatLng.convert(t)}))})),e.normalizePaths(n.paths),n.properties=new l.FillLayerProperties(r.fillColor,r.fillOpacity,r.strokeColor,r.strokeWidth,r.elevation,r.visible,r.draggable,r.userInteractionEnabled),n.zIndex=r.zIndex,n.elevation=r.elevation,n}return r(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setPaths=function(t){null!=t?(this.paths=t.map((function(t){return t.map((function(t){return o.LatLng.convert(t)}))})),e.normalizePaths(this.paths),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter paths can not be null")},e.prototype.setFillColor=function(t){null!=t?this.properties.getFillColor().code!=t&&(this.properties.setFillColor(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillColor can not be null")},e.prototype.setFillOpacity=function(t){null!=t?this.properties.getFillOpacity()!=t&&(this.properties.setFillOpacity(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillOpacity can not be null")},e.prototype.setStrokeColor=function(t){this.properties.getStrokeColor().code!=t&&(this.properties.setStrokeColor(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.setStrokeWidth=function(t){this.properties.getStrokeWidth()!=t&&(this.properties.setStrokeWidth(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.setVisible=function(t){null!=t?this.properties.isVisible()!==t&&(this.properties.setVisible(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter visible can not be null")},e.prototype.setDraggable=function(t){null!=t?this.properties.isDraggable()!==t&&this.properties.setDraggable(t):console.warn("Parameter draggable can not be null")},e.prototype.getPaths=function(){return(this.paths||[]).slice()},e.prototype.getFillColor=function(){return this.properties.getFillColor().code},e.prototype.getFillOpacity=function(){return this.properties.getFillOpacity()},e.prototype.getStrokeColor=function(){return this.properties.getStrokeColor().code},e.prototype.getStrokeWidth=function(){return this.properties.getStrokeWidth()},e.prototype.isVisible=function(){return this.properties.isVisible()},e.prototype.isDraggable=function(){return this.properties.isDraggable()},e.prototype.getProperties=function(){return this.properties},e.prototype.isUserInteractionEnabled=function(){return this.properties.isUserInteractionEnabled()},e.prototype.setUserInteraction=function(t){this.properties.setUserInteraction(t)},e.normalizePaths=function(t){if(t.length>1)for(var e=function(e){var i=t[0],n=!1,r=t[e];if(r.forEach((function(t){var e=h.Point.convert([t.lat,t.lng]),r=i.map((function(t){return h.Point.convert([t.lat,t.lng])}));c.CollisionUtils.polygonContainsPoint(r,e)||(n=!0)})),n){i[0].equals(i[i.length-1])&&i.pop(),r[0].equals(r[r.length-1])&&r.pop();var a=i.map((function(t){return[t.lat,t.lng]})),s=r.map((function(t){return[t.lat,t.lng]})),l=u.intersection(a,s),f=u.union(a,s);if(null!=l&&Array.isArray(l)){var p=l[0].map((function(t){return new o.LatLng(t[0],t[1])}));t[e]=p}if(null!=f&&Array.isArray(f)){var d=f[0].map((function(t){return new o.LatLng(t[0],t[1])}));t[0]=d}}},i=1;i<t.length;++i)e(i)},e.defaultPolygonOptions={fillColor:"#0000ff",fillOpacity:1,visible:!0,strokeColor:"#ff0000",strokeWidth:1,draggable:!1,zIndex:0,elevation:0,userInteractionEnabled:!0},e}(a.Annotation);e.Polygon=f},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(69),a=i(12),s=i(2),l=i(166),u=function(t,e){this.min=t,this.mag=e};e.TextureFiltering=u;var h=function(t,e){this.wraps=t,this.wrapt=e};e.TextureWrapping=h;var c=function(t,e,i,n,r,o){this.target=t,this.internalFormat=e,this.format=i,this.type=n,this.filtering=r,this.wrapping=o};e.TextureOptions=c;var f=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this)||this;return n.gl=e,n.options=i,null==i&&n.initDefaultTextureOptions(),n.isLoaded=!1,n.color=null,n.init(),n}return r(e,t),e.prototype.initDefaultTextureOptions=function(){var t=this.gl,e=new u(t.LINEAR_MIPMAP_LINEAR,t.LINEAR),i=new h(t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE);this.options=new c(t.TEXTURE_2D,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e,i)},e.prototype.init=function(){var t=this.gl;this.textureId=t.createTexture(),this.loadColor(a.Color.fromHex("FFFFFF"))},e.prototype.bind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.textureId)},e.prototype.unbind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)},e.prototype.loadColor=function(t){var e=this.gl;if(this.width=1,this.height=1,null!=this.textureId){e.bindTexture(e.TEXTURE_2D,this.textureId);var i=new Uint8Array([255*t.red,255*t.green,255*t.blue,255*t.alpha]);e.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,i),e.texParameteri(this.options.target,e.TEXTURE_WRAP_S,this.options.wrapping.wraps),e.texParameteri(this.options.target,e.TEXTURE_WRAP_T,this.options.wrapping.wrapt),this.applyFilter(),e.bindTexture(e.TEXTURE_2D,null)}},e.prototype.loadImageFromArrayBuffer=function(t,e,i,n,r,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=null);var a=this.gl;if(this.width=e,this.height=i,null!=this.textureId){a.bindTexture(a.TEXTURE_2D,this.textureId);var s=new ImageData(new Uint8ClampedArray(t),e,i);n&&(this.color=this.getColorFromImageData(s)),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,r?1:0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,s),this.applyFilter(),a.bindTexture(a.TEXTURE_2D,null),this.isLoaded=!0,o&&o()}},e.prototype.loadImage=function(t,e){var i=this;if(void 0===e&&(e=null),null==t)return console.warn("loadImageFromUrl: URL is null"),void(e&&e());var n=this.gl,r=new Image;r.crossOrigin="*",r.src=t,r.onload=function(){i.width=r.width,i.height=r.height,null!=i.textureId&&(n.bindTexture(n.TEXTURE_2D,i.textureId),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),i.applyFilter(),n.bindTexture(n.TEXTURE_2D,null),i.isLoaded=!0),e&&e()}},e.prototype.loadImageDataArray=function(t,e,i,n,r){void 0===r&&(r=null);var o=this.gl;this.width=e,this.height=i,null!=this.textureId&&(o.bindTexture(o.TEXTURE_2D,this.textureId),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,i,0,o.RGBA,o.UNSIGNED_BYTE,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,n),o.bindTexture(o.TEXTURE_2D,null),this.isLoaded=!0),r&&r()},e.prototype.destroy=function(){this.textureId&&(this.gl.deleteTexture(this.textureId),this.textureId=null)},e.prototype.applyFilter=function(t){void 0===t&&(t=!0);var e=this.gl;if(e.texParameteri(this.options.target,e.TEXTURE_MAG_FILTER,this.options.filtering.mag),this.isPowerOf2(this.width)&&this.isPowerOf2(this.height)&&t)e.texParameteri(this.options.target,e.TEXTURE_MIN_FILTER,this.options.filtering.min),e.generateMipmap(this.options.target);else{var i=this.options.filtering.min;i==e.LINEAR_MIPMAP_LINEAR||i==e.LINEAR_MIPMAP_NEAREST?i=e.LINEAR:i!=e.NEAREST_MIPMAP_LINEAR&&i!=e.NEAREST_MIPMAP_NEAREST||(i=e.NEAREST),e.texParameteri(this.options.target,e.TEXTURE_MIN_FILTER,i)}},e.prototype.initFrameBufferTexture=function(t,e){var i=this.gl;this.width=t,this.height=e,this.textureId=i.createTexture(),i.bindTexture(this.options.target,this.textureId),i.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,null),i.texParameteri(this.options.target,i.TEXTURE_WRAP_S,this.options.wrapping.wraps),i.texParameteri(this.options.target,i.TEXTURE_WRAP_T,this.options.wrapping.wrapt),this.applyFilter(!1),i.bindTexture(i.TEXTURE_2D,null),this.isLoaded=!0},e.prototype.isPowerOf2=function(t){return 0==(t&t-1)},e.prototype.getColorFromImageData=function(t){var e,i=t.data.length/(t.width*t.height);if(i<3)return s.MapConstants.poiDefaultColor;var n,r,o,a=new Map;n=r=o=0;for(var u=0;u<t.data.length;u+=i)if(n=t.data[u],r=t.data[u+1],o=t.data[u+2],!(0==(4==i?t.data[u+3]:255)||n>240&&r>240&&o>240)){e=l.ColorUtils.rgbToHex(n,r,o),a.has(e)||a.set(e,0);var h=a.get(e)+1;a.set(e,h)}var c=0;return a.forEach((function(t,i){t>c&&(c=t,e=i)})),e},e}(o.ResourceReference);e.Texture=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(105),r=i(0),o=i(76),a=i(78),s=i(75),l=i(180),u=i(7),h=i(3),c=i(6),f=i(1),p=i(67),d=i(51),g=i(31),y=i(41),m=i(181),v=i(36),_=i(182),b=i(10),w=i(183),M=i(184),x=i(186),T=i(68),A=i(2),L=i(17),S=i(77),E=i(14),I=i(103),P=i(53),C=i(187),O=i(188),R=i(54),D=i(72),k=i(107),B=i(189),U=i(190),N=i(191),F=i(109),j=i(111),V=i(21),Z=function(){function t(t,e){var i=this;this.idCounter=1,this._symbolVisibleIds=[],this.map=t,this.tileManager=e,this.circleTree=n(),this.symbolTree=n(),this.userPOITree=n(),this.userBuildingTree=n(),this.circleAnnotations=new Map,this.symbolAnnotations=new Map,this.shapeAnnotations=new Map,this.userPOIAnnotations=new Map,this.userBuildingAnnotations=new Map,this._iconViewMarkerManager=new x.IconViewMarkerManager(this.map),this.infoWindowManager=new M.InfoWindowManager(this.map,this.symbolAnnotations,this._iconViewMarkerManager),this.dirty=!1,this.updateBuildingBounds=!1;this.tilePyramid=new S.TilePyramid(this.map,0,(function(t){return i.createTile(t)}),(function(t){i.removeTile(t)})),this.lastZoom=this.map.mapState.getZoom()}return t.prototype.setDirty=function(){this.dirty=!0},t.prototype.update=function(){var t=this,e=this.map.tileManager.getVisibleTiles();this._iconViewMarkerManager.update(),this.dirty&&(this._symbolVisibleIds=[],this._iconViewMarkerManager.getIconViewMarkers().forEach((function(e){e.isVisible()&&t._symbolVisibleIds.push(e.getId())})),e.forEach((function(e){var i=t.tilePyramid.getTile(e.tileCoordinate);if(null!=i){var n=t.getTileData(e.tileCoordinate);t.updateRenderTile(n,i),i.setTileData(n)}})),this.dirty=!1),this.infoWindowManager.render(this._symbolVisibleIds),this.tilePyramid.update(e,this.map.mapState,this.lastZoom),this.createTileLayerRenderDatas(e),this.lastZoom=this.map.mapState.getZoom(),this.updateBuildingBounds&&(this.setDirty(),this.updateBuildingBounds=!1)},t.prototype.createTileLayerRenderDatas=function(t){var e=this;t.forEach((function(t){var i=e.tilePyramid.getTile(t.tileCoordinate);if(i){var n=i.getTileRenderData(),o=i.getTileData();if(o)for(var a=o.getLayerIds(),s=function(t){var s=a[t];if(n.hasLayerRenderData(s))return"continue";var l=o.getTileLayer(s);if(null==l)return console.warn("getLayerData not reachable"),"continue";var u=null;if(l.featureCount()>0){var h=l.getType();switch(h){case r.LayerType.LINE:var c=l.getFeature(0).getProperties();u=new k.LineLayerRenderData(l,e.map.gl,c.getStrokeWidth()),n.setLayerRenderData(s,u);break;case r.LayerType.FILL:u=new B.FillLayerRenderData(l,e.map.gl),n.setLayerRenderData(s,u);break;case r.LayerType.CIRCLE:u=new U.CircleLayerRenderData(l,e.map.gl),n.setLayerRenderData(s,u);break;case r.LayerType.SYMBOL:u=new N.SymbolLayerRenderData(l,e.map.gl),n.setLayerRenderData(s,u);break;default:u=null}var p=l.getFeatures();if(h==r.LayerType.USERPOI)p.forEach((function(t){var r=t.getProperties(),o=r.getId();if(!n.hasLayerRenderData(o)){var a=e.map.mapStyle.build("pois","points",i.getTileCoordinate().getZoom(),null,null);if(a?(r.setFontSize(a.size),r.setHaloColor(a.halo.color)):(r.setFontSize(A.MapConstants.placeFontSize*f.MapUtils.pixelScale),r.setHaloColor(null)),u=new F.UserPOILayerRenderData(l,e.map.gl)){var s=[];s.push(t),u.init(s),u.upload(e.map.gl,e.map.mapState),n.setLayerRenderData(o,u)}}}));else if(h==r.LayerType.USERBUILDING)p.forEach((function(t){var i=t.getProperties(),r=i.getId();if(!n.hasLayerRenderData(r)&&e.map.mapState.is3dMode()&&(u=new j.UserBuildingLayerRenderData)){var o=u,a=[];a.push(t);var s=i.updateExtrudeModel;o.init(a),o.upload(e.map.gl,e.map.mapState,(function(){var t=o.getModel();if(t||s){if(i.setCoverPoints(t.points),s){var e=new V.LatLngBounds;i.getCoordinates().forEach((function(t){e.extend(t)})),i.updateBoundsFromLatLngBounds(e)}else i.updateBounds(new D.BoundingBox(t.minX,t.minY,t.maxX,t.maxY));i.onModelLoaded&&i.onModelLoaded(),i.onModelLoaded=null,i.annotationManager&&i.annotationManager.setDirty()}})),n.setLayerRenderData(r,o)}}));else if(u){var d=l.getFeatures();u.init(d)}}},l=0;l<a.length;++l)s(l);i.setRenderable()}}))},t.prototype.reload=function(){this.clearAllLayerRenderTiles(),this.tilePyramid.clear()},t.prototype.clearAllLayerRenderTiles=function(){var t=this,e=this.map.getLayer(A.LayerConstants.userPOILayerId);e&&e.clearRenderTiles();var i=this.map.getLayer(A.LayerConstants.userBuildingLayerId);i&&i.clearRenderTiles(),this.shapeAnnotations.forEach((function(e){e instanceof m.PolygonAnnotationData?t.map.getLayer(e.getLayerId()).clearRenderTiles():t.map.getLayer(e.getLayerId()).clearRenderTiles()})),this.circleAnnotations.forEach((function(e){t.map.getLayer(e.getLayerId()).clearRenderTiles()})),this.symbolAnnotations.forEach((function(e){t.map.getLayer(e.getLayerId()).clearRenderTiles()}))},t.prototype.createTile=function(t){var e=new L.Tile(L.Kind.ANNOTATION,t,this.map.gl),i=this.getTileData(t);return this.updateRenderTile(i,e),e.setTileData(i),e},t.prototype.removeTile=function(e){var i=this,n=e.getTileData(),o=e.getTileCoordinate().toString(),a=this.map.getLayer(A.LayerConstants.userPOILayerId);a&&a.removeRenderTile(o);var s=this.map.getLayer(A.LayerConstants.userBuildingLayerId);(s&&s.removeRenderTile(o),null!=n)&&n.getLayerIds().forEach((function(e){var n=i.map.getLayer(e);if(null!=n){var a=n.getLayerType();if(a==r.LayerType.LINE)n.removeRenderTile(o);else if(a==r.LayerType.FILL){n.removeRenderTile(o)}else if(a==r.LayerType.CIRCLE){n.removeRenderTile(o)}else if(a==r.LayerType.SYMBOL){var s=n,l=i._symbolVisibleIds.findIndex((function(i){return t.pointLayerId+i==e}));-1!=l&&i._symbolVisibleIds.splice(l,1),s.removeRenderTile(o)}}}));e.destroy()},t.prototype.getTileData=function(t){var e=this;if(0==this.symbolAnnotations.size&&0==this.shapeAnnotations.size&&0==this.circleAnnotations.size&&0==this.userPOIAnnotations.size&&0==this.userBuildingAnnotations.size)return null;var i=new I.TileData;this.shapeAnnotations.forEach((function(n){n.updateTileData(t,i,e.map.mapState.getMaxNativeZoom())}));var n=u.GeometryUtils.tileCoordinateToLatLngBounds(t),r={minX:n.getSouthwest().lng,minY:n.getSouthwest().lat,maxX:n.getNortheast().lng,maxY:n.getNortheast().lat};return this.circleTree.search(r).forEach((function(e){e.updateTileData(t,i)})),this.symbolTree.search(r).forEach((function(n){n.symbolAnnotation.isVisible()&&(n.updateTileData(t,i),e._symbolVisibleIds.push(n.id))})),this.userPOITree.search(r).forEach((function(e){e.getUserPOIAnnotation().isVisible()&&e.updateTileData(t,i)})),this.userBuildingTree.search(r).forEach((function(n){if(n.getUserBuildingAnnotation().isVisible()){var r=n.getUserBuildingAnnotation().getProperties();r.annotationManager||(r.annotationManager=e),r.hasBounds&&!n.boundsUpdated&&(e.userBuildingTree.remove(n),n.updateBounds(new D.BoundingBox(r.minX,r.minY,r.maxX,r.maxY)),e.userBuildingTree.insert(n),e.updateBuildingBounds=!0),n.updateTileData(t,i)}})),i},t.prototype.addAnnotation=function(t){this.setDirty();var e=this.idCounter++;return this.idCounter<0&&(this.idCounter=0),this.addAnnotationInternal(e,t),e},t.prototype.addAnnotationInternal=function(e,i){if(i instanceof g.Marker){var n=i;if(n.getIconView()){this._iconViewMarkerManager.add(e,n);var o=t.pointLayerId+e;this.map.createLayer(o,r.LayerType.SYMBOL,A.MapConstants.buildingLayerOrder+n.getZIndex())}else{var a=new w.SymbolAnnotationData(this.map.gl,e,n);this.symbolTree.insert(a),this.symbolAnnotations.set(e,a),a.createLayer(this.map)}}else if(i instanceof v.Polyline){var s=new _.PolylineAnnotationData(e,i);s.createLayer(this.map),this.shapeAnnotations.set(e,s)}else if(i instanceof y.Polygon){var u=new m.PolygonAnnotationData(e,i);u.createLayer(this.map),this.shapeAnnotations.set(e,u)}else if(i instanceof d.Circle){var h=new l.CircleAnnotationData(e,i);h.createLayer(this.map),this.circleAnnotations.set(e,h),this.circleTree.insert(h)}else if(i instanceof P.POI){var c=new C.UserPOIAnnotationData(e,i);this.userPOIAnnotations.set(e,c),this.userPOITree.insert(c)}else if(i instanceof R.Building){var f=new O.UserBuildingAnnotationData(e,i);this.userBuildingAnnotations.set(e,f),this.userBuildingTree.insert(f)}},t.prototype.hideInfoWindow=function(t){this.infoWindowManager.hideInfoWindow(t)},t.prototype.isInfoWindowShown=function(t){return this.infoWindowManager.isInfoWindowShown(t)},t.prototype.showInfoWindow=function(t){this.infoWindowManager.showInfoWindow(t)},t.prototype.updateInfoContents=function(t){this.infoWindowManager.updateInfoContents(t)},t.prototype.updateAnnotationZIndex=function(e,i,n){var r=this.symbolAnnotations.get(e);if(r){var o=t.pointLayerId+r.id,a=this.map.getLayer(o);if(!a)return void console.warn("Symbol layer should not be null");this.map.mapRenderer.removeLayer(o,i),a.setOrder(n),this.map.mapRenderer.addLayer(a)}else if(this.shapeAnnotations.has(e)){o=t.annotationLayerId+e.toString();var s=this.map.getLayer(o);if(!s)return void console.warn("Shape layer should not be null");this.map.mapRenderer.removeLayer(o,i),s.setOrder(n),this.map.mapRenderer.addLayer(s)}else if(this.circleAnnotations.has(e)){o=t.annotationLayerId+e.toString();var l=this.map.getLayer(o);if(!l)return void console.warn("Circle layer should not be null");this.map.mapRenderer.removeLayer(o,i),l.setOrder(n),this.map.mapRenderer.addLayer(l)}},t.prototype.updateAnnotation=function(e,i){var n=this.symbolAnnotations.get(e);if(this._iconViewMarkerManager.getIconViewMarkers().get(e)&&this._iconViewMarkerManager.updateIconView(e),n){if(i&&(this.symbolTree.remove(n),n.updateAnnotationData(),this.symbolTree.insert(n)),!n.symbolAnnotation.isVisible()||i){var r=n.getLayerId(),o=this.map.getLayer(r);if(o)o.renderTiles.forEach((function(t){t.tile.getTileRenderData().getLayerRenderDatas().delete(r)})),this.map.removeLayer(r,n.symbolAnnotation.getZIndex()),n.createLayer(this.map)}this.setDirty()}else if(this.shapeAnnotations.has(e)){var a=this.shapeAnnotations.get(e);if(i){var s=t.annotationLayerId+e.toString();a.reloadLayout(),this.tilePyramid.getTiles().forEach((function(t){t.tile.getTileData().removeTileLayer(s),t.tile.getTileRenderData().removeLayerRenderData(s)})),this.setDirty()}a.createLayer(this.map)}else if(this.circleAnnotations.has(e)){var l=this.circleAnnotations.get(e);l.createLayer(this.map),i&&(l.updateBounds(),this.circleTree.remove(l),this.circleTree.insert(l),this.setDirty())}else if(this.userPOIAnnotations.has(e)){var u=this.userPOIAnnotations.get(e);i&&(this.userPOITree.remove(u),u.updateBounds(),this.userPOITree.insert(u),this.tilePyramid.getTiles().forEach((function(t){var i=A.LayerConstants.userPOILayerId+e;t.tile.getTileData().removeTileLayer(i),t.tile.getTileRenderData().removeLayerRenderData(i)})),this.setDirty())}else if(this.userBuildingAnnotations.has(e)){var h=this.userBuildingAnnotations.get(e);i&&(this.map.userBuildingLayer.renderTiles.forEach((function(t){t.tile.getTileRenderData().getLayerRenderDatas().delete(A.LayerConstants.userBuildingLayerId+e)})),this.userBuildingTree.remove(h),h.updateBounds(),h.boundsUpdated=!1,this.userBuildingTree.insert(h)),this.setDirty()}},t.prototype.removeAnnotation=function(e){this.setDirty();var i=this.symbolAnnotations.get(e),n=this._iconViewMarkerManager.getIconViewMarkers().get(e);if(i||n){var r=A.MapConstants.buildingLayerOrder;n?(r+=n.getZIndex(),this._iconViewMarkerManager.remove(e)):(r+=i.symbolAnnotation.getZIndex(),this.symbolTree.remove(i),this.symbolAnnotations.delete(e)),this.map.removeLayer(t.pointLayerId+e.toString(),r)}else if(this.shapeAnnotations.has(e)){var o=this.shapeAnnotations.get(e).getAnnotation().getZIndex();this.shapeAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString(),o)}else if(this.circleAnnotations.has(e)){var a=this.circleAnnotations.get(e).getAnnotation().getZIndex();this.circleTree.remove(this.circleAnnotations.get(e)),this.circleAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString(),a)}else if(this.userPOIAnnotations.has(e)){this.userPOITree.remove(this.userPOIAnnotations.get(e)),this.userPOIAnnotations.delete(e),this.map.getLayer(A.LayerConstants.userPOILayerId).clearRenderTiles()}else if(this.userBuildingAnnotations.has(e)){this.userBuildingTree.remove(this.userBuildingAnnotations.get(e)),this.userBuildingAnnotations.delete(e),this.map.getLayer(A.LayerConstants.userBuildingLayerId).clearRenderTiles()}},t.prototype.updateRenderTile=function(t,e){var i=this;if(null!=t&&t.getLayerIds().length>0){var n=e.getTileCoordinate(),o=n.toString();t.getLayerIds().forEach((function(t){var l=i.map.getLayer(t);if(null!=l){var u=l.getLayerType(),h=new a.RenderTile(s.UnwrappedTileCoordinate.createWithXYZoom(n.getX(),n.getY(),n.getZoom()),e);if(u==r.LayerType.LINE)l.addRenderTile(o,h);else if(u==r.LayerType.FILL){l.addRenderTile(o,h)}else if(u==r.LayerType.CIRCLE){l.addRenderTile(o,h)}else if(u==r.LayerType.SYMBOL){l.addRenderTile(o,h)}else if(u==r.LayerType.USERPOI){l.addRenderTile(o,h)}else if(u==r.LayerType.USERBUILDING){l.addRenderTile(o,h)}}}))}else e.setRenderable()},t.prototype.queryBuildingAndAnnotation=function(e){var i=this,n=this.queryAnnotations(e),r=this.map.mapState,a=u.GeometryUtils.screenCoordinateToLatLng(e,r.cameraPosition,r.getScreenSize()),s=null,l=null,p=null,d=new T.Box(new b.Point(e.x-f.MapUtils.touchBoxSize/2,e.y-f.MapUtils.touchBoxSize/2),new b.Point(e.x+f.MapUtils.touchBoxSize/2,e.y+f.MapUtils.touchBoxSize/2));if(a.valid()){var y=o.TileCoordinate.fromLatLng(a,r.getZoom(),r.is3dMode()),m=1,v=r.getMaxNativeZoom();r.getZoom()>v&&(y=o.TileCoordinate.fromLatLng(a,r.getMaxNativeZoom(),r.is3dMode()),m=Math.pow(2,Math.round(r.getZoom())-v));var _=this.tilePyramid.getTile(y);if(_&&null!=(s=_.getTileData())&&0!=s.getLayerIds().length){var w=r.scale,M=y.getX(),x=y.getY(),A=u.GeometryUtils.screenCoordinateToLatLng(new h.Vector2(d.min.x,d.min.y),r.cameraPosition,r.getScreenSize()),L=u.GeometryUtils.screenCoordinateToLatLng(new h.Vector2(d.max.x,d.max.y),r.cameraPosition,r.getScreenSize());l=u.GeometryUtils.pixelCoordinateToVectorTileCoordinate(c.ProjectionMercator.projectScale(A,w),M,x,m),p=u.GeometryUtils.pixelCoordinateToVectorTileCoordinate(c.ProjectionMercator.projectScale(L,w),M,x,m)}}n.frontBuildingAnnotations.sort((function(e,i){var n=e instanceof g.Marker?t.pointLayerId+e.getId():t.annotationLayerId+e.getId(),r=i instanceof g.Marker?t.pointLayerId+i.getId():t.annotationLayerId+i.getId();if(e.getZIndex()==i.getZIndex()){if(n>r)return-1;if(r>n)return 1}else{if(e.getZIndex()>i.getZIndex())return-1;if(i.getZIndex()>e.getZIndex())return 1}return 0}));var S=this.checkCollisionAnnotations(d,l,p,a,n.frontBuildingAnnotations,s);if(S)return S;var E=this._iconViewMarkerManager.getIconViewMarkers(),I=[];if(E.forEach((function(t){t.isUserInteractionEnabled()&&i.checkCollisionIconViewMarker(d,t)&&I.push(t)})),0!=I.length){if(I.length>1){for(var P=0,C=I[0].getZIndex(),O=1;O<I.length;++O)I[O].getZIndex()>C&&(C=I[O].getZIndex(),P=O);return I[P]}return I[0]}if(r.is3dMode()){var R=this.map.queryBuildingInfo(d);if(null!=R)return R}return n.belowBuildingAnnotations.sort((function(e,i){var n=e instanceof g.Marker?t.pointLayerId+e.getId():t.annotationLayerId+e.getId(),r=i instanceof g.Marker?t.pointLayerId+i.getId():t.annotationLayerId+i.getId();if(e.getZIndex()==i.getZIndex()){if(n>r)return-1;if(r>n)return 1}else{if(e.getZIndex()>i.getZIndex())return-1;if(i.getZIndex()>e.getZIndex())return 1}return 0})),this.checkCollisionAnnotations(d,l,p,a,n.belowBuildingAnnotations,s)},t.prototype.queryAnnotations=function(t){var e=this,i=[],n=[];if(null==t)return{frontBuildingAnnotations:i,belowBuildingAnnotations:n};this.tileManager.getVisibleTiles().forEach((function(t){var r=t.getTileCoordinate(),o=u.GeometryUtils.tileCoordinateToLatLngBounds(r),a={minX:o.getSouthwest().lng,minY:o.getSouthwest().lat,maxX:o.getNortheast().lng,maxY:o.getNortheast().lat};e.symbolTree.search(a).forEach((function(t){var e=t.symbolAnnotation;e.isVisible()&&(e.getZIndex()>A.MapConstants.buildingLayerOrder?i.push(e):n.push(e))}))}));var r=this.map.mapState,a=u.GeometryUtils.screenCoordinateToLatLng(t,r.cameraPosition,r.getScreenSize());if(a.valid()){var s=r.getMaxNativeZoom(),l=r.getZoom(),h=o.TileCoordinate.fromLatLng(a,l>s?s:l,r.is3dMode()),c=this.tilePyramid.getTile(h);if(c){var f=c.getTileData();if(null!=f&&0!=f.getLayerIds().length)for(var p=f.getLayerIds(),d=f.getLayerIds().length,g=0;g<d;++g){var y=p[g],m=f.getTileLayer(y);if(null!=m)for(var v=0;v<m.featureCount();++v){var _=m.getFeature(v);if(_){if(!(_ instanceof E.TileFeature)||_.getType()==E.GeometryType.Point)continue;var b=Number(_.id);if(this.shapeAnnotations.has(b)){var w=this.shapeAnnotations.get(b).getAnnotation();w&&w.getZIndex()>A.MapConstants.buildingLayerOrder?i.push(w):w&&n.push(w)}}}}var M=u.GeometryUtils.tileCoordinateToLatLngBounds(h),x={minX:M.getSouthwest().lng,minY:M.getSouthwest().lat,maxX:M.getNortheast().lng,maxY:M.getNortheast().lat},T=this.circleTree.search(x);for(g=0;g<T.length;++g){var L=T[g].getAnnotation();L.isVisible()&&(L.getZIndex()>A.MapConstants.buildingLayerOrder?i.push(L):n.push(L))}}}return{frontBuildingAnnotations:i.filter((function(t){return t.isUserInteractionEnabled()})),belowBuildingAnnotations:n.filter((function(t){return t.isUserInteractionEnabled()}))}},t.prototype.getBuilding=function(t){return this.userBuildingAnnotations.has(t)?this.userBuildingAnnotations.get(t).getUserBuildingAnnotation():null},t.prototype.getPOI=function(t){return this.userPOIAnnotations.has(t)?this.userPOIAnnotations.get(t).getUserPOIAnnotation():null},t.prototype.clearShapeIndexer=function(){this.shapeAnnotations.forEach((function(t){t.clearIndex()}))},t.prototype.checkCollisionAnnotations=function(e,i,n,r,o,a){for(var s=f.MapUtils.getTileSize(),l=this.map.mapState,m=0;m<o.length;++m){if(o[m]instanceof g.Marker){var _=o[m];if(null==_.getId())continue;var w=this.symbolAnnotations.get(_.getId());if(null==w)continue;if(p.CollisionUtils.boxIntersectsSymbol(e,_.getPosition(),_.getElevation(),w.width,w.height,_.getAnchor(),l))return o[m]}if(r.valid())if(o[m]instanceof v.Polyline){if(null==i||null==n||null==a)continue;var M=[new b.Point(i.x,n.y),new b.Point(n.x,n.y),new b.Point(n.x,i.y),new b.Point(i.x,i.y)],x=t.annotationLayerId+o[m].getId();if(null==(E=a.getTileLayer(x)))continue;for(var T=function(t){var e=E.getFeature(t).getGeometries().geometryCoordinates;if(null==A.map.getLayer(x))return"continue";var i=o[m].getStrokeWidth()/2;l.getZoom()>l.getMaxNativeZoom()&&(i/=Math.pow(2,Math.round(l.getZoom())-l.getMaxNativeZoom()));var n=[];return e.forEach((function(t){var e=[];t.forEach((function(t){return e.push(new b.Point(t[0],t[1]))})),n.push(e)})),p.CollisionUtils.polygonIntersectsBufferedMultiLine(M,n,i/s)?{value:o[m]}:void 0},A=this,L=0;L<E.featureCount();++L){var S=T(L);if("object"==typeof S)return S.value}}else if(o[m]instanceof y.Polygon){if(null==i||null==n||null==a)continue;var E;M=[new b.Point(i.x,n.y),new b.Point(n.x,n.y),new b.Point(n.x,i.y),new b.Point(i.x,i.y)],x=t.annotationLayerId+o[m].getId();if(null==(E=a.getTileLayer(x)))continue;for(L=0;L<E.featureCount();++L){for(var I=E.getFeature(L).getGeometries().geometryCoordinates,P=!1,C=function(t){var e=I[t],i=[];if(e.forEach((function(t){return i.push(new b.Point(t[0],t[1]))})),0==t){if(!(P=p.CollisionUtils.polygonIntersectsPolygon(M,i)))return"break"}else if(p.CollisionUtils.polygonIntersectsPolygon(M,i)&&!p.CollisionUtils.polygonIntersectsBufferedMultiLine(M,[i],0))return P=!1,"break"},O=0;O<I.length;++O){if("break"===C(O))break}if(P)return o[m]}}else if(o[m]instanceof d.Circle){var R=o[m],D=R.getCenter(),k=R.getRadius(),B=l.getScale(),U=k/c.ProjectionMercator.getMetersPerPixelAtLatitude(l.getCamera().getTarget().lat,l.getZoom()),N=c.ProjectionMercator.projectScale(D,B),F=u.GeometryUtils.screenCoordinateToLatLng(new h.Vector2(e.min.x,e.min.y),l.cameraPosition,l.getScreenSize()),j=u.GeometryUtils.screenCoordinateToLatLng(new h.Vector2(e.max.x,e.max.y),l.cameraPosition,l.getScreenSize()),V=c.ProjectionMercator.projectScale(F,B),Z=c.ProjectionMercator.projectScale(j,B);if(p.CollisionUtils.boxIntersectsCircle(V,Z,new b.Point(N.x,N.y),U))return o[m]}}return null},t.prototype.checkCollisionIconViewMarker=function(t,e){var i=this.map.latLngToScreenCoordinate(e.getPosition(),e.getElevation()),n=this._iconViewMarkerManager.getIconViewsHTML().get(e.getId()),r=document.getElementById(""+n.id),o=r.clientWidth*f.MapUtils.pixelScale,a=r.clientHeight*f.MapUtils.pixelScale;o=o%2?o+1:o,a=a%2?a+1:a;var s=i.x-e.getAnchor().x*o,l=i.y-e.getAnchor().y*a,u=new T.Box(new b.Point(s,l),new b.Point(s+o,l+a));return p.CollisionUtils.boxIntersectsBox(t,u)},t.annotationLayerId="1.maplink.annotation.layer.",t.pointLayerId="3.maplink.annotation.points.",t}();e.AnnotationManager=Z},function(t,e,i){(function(t){function i(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===i(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===i(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===i(t)},e.isError=function(t){return"[object Error]"===i(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(t){var n=i(4).Buffer,r=i(58).Transform,o=i(232),a=i(29),s=i(85).ok,l=i(4).kMaxLength,u="Cannot create final Buffer. It would be larger than 0x"+l.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16384,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var h=Object.keys(o),c=0;c<h.length;c++){var f=h[c];f.match(/^Z/)&&Object.defineProperty(e,f,{enumerable:!0,value:o[f],writable:!1})}for(var p={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},d=Object.keys(p),g=0;g<d.length;g++){var y=d[g];p[p[y]]=y}function m(t,e,i){var r=[],o=0;function a(){for(var e;null!==(e=t.read());)r.push(e),o+=e.length;t.once("readable",a)}function s(){var e,a=null;o>=l?a=new RangeError(u):e=n.concat(r,o),r=[],t.close(),i(a,e)}t.on("error",(function(e){t.removeListener("end",s),t.removeListener("readable",a),i(e)})),t.on("end",s),t.end(e),a()}function v(t,e){if("string"==typeof e&&(e=n.from(e)),!n.isBuffer(e))throw new TypeError("Not a string or buffer");var i=t._finishFlushFlag;return t._processChunk(e,i)}function _(t){if(!(this instanceof _))return new _(t);S.call(this,t,o.DEFLATE)}function b(t){if(!(this instanceof b))return new b(t);S.call(this,t,o.INFLATE)}function w(t){if(!(this instanceof w))return new w(t);S.call(this,t,o.GZIP)}function M(t){if(!(this instanceof M))return new M(t);S.call(this,t,o.GUNZIP)}function x(t){if(!(this instanceof x))return new x(t);S.call(this,t,o.DEFLATERAW)}function T(t){if(!(this instanceof T))return new T(t);S.call(this,t,o.INFLATERAW)}function A(t){if(!(this instanceof A))return new A(t);S.call(this,t,o.UNZIP)}function L(t){return t===o.Z_NO_FLUSH||t===o.Z_PARTIAL_FLUSH||t===o.Z_SYNC_FLUSH||t===o.Z_FULL_FLUSH||t===o.Z_FINISH||t===o.Z_BLOCK}function S(t,i){var a=this;if(this._opts=t=t||{},this._chunkSize=t.chunkSize||e.Z_DEFAULT_CHUNK,r.call(this,t),t.flush&&!L(t.flush))throw new Error("Invalid flush flag: "+t.flush);if(t.finishFlush&&!L(t.finishFlush))throw new Error("Invalid flush flag: "+t.finishFlush);if(this._flushFlag=t.flush||o.Z_NO_FLUSH,this._finishFlushFlag=void 0!==t.finishFlush?t.finishFlush:o.Z_FINISH,t.chunkSize&&(t.chunkSize<e.Z_MIN_CHUNK||t.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+t.chunkSize);if(t.windowBits&&(t.windowBits<e.Z_MIN_WINDOWBITS||t.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+t.windowBits);if(t.level&&(t.level<e.Z_MIN_LEVEL||t.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+t.level);if(t.memLevel&&(t.memLevel<e.Z_MIN_MEMLEVEL||t.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+t.memLevel);if(t.strategy&&t.strategy!=e.Z_FILTERED&&t.strategy!=e.Z_HUFFMAN_ONLY&&t.strategy!=e.Z_RLE&&t.strategy!=e.Z_FIXED&&t.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+t.strategy);if(t.dictionary&&!n.isBuffer(t.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(i);var s=this;this._hadError=!1,this._handle.onerror=function(t,i){E(s),s._hadError=!0;var n=new Error(t);n.errno=i,n.code=e.codes[i],s.emit("error",n)};var l=e.Z_DEFAULT_COMPRESSION;"number"==typeof t.level&&(l=t.level);var u=e.Z_DEFAULT_STRATEGY;"number"==typeof t.strategy&&(u=t.strategy),this._handle.init(t.windowBits||e.Z_DEFAULT_WINDOWBITS,l,t.memLevel||e.Z_DEFAULT_MEMLEVEL,u,t.dictionary),this._buffer=n.allocUnsafe(this._chunkSize),this._offset=0,this._level=l,this._strategy=u,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!a._handle},configurable:!0,enumerable:!0})}function E(e,i){i&&t.nextTick(i),e._handle&&(e._handle.close(),e._handle=null)}function I(t){t.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(p),writable:!1}),e.Deflate=_,e.Inflate=b,e.Gzip=w,e.Gunzip=M,e.DeflateRaw=x,e.InflateRaw=T,e.Unzip=A,e.createDeflate=function(t){return new _(t)},e.createInflate=function(t){return new b(t)},e.createDeflateRaw=function(t){return new x(t)},e.createInflateRaw=function(t){return new T(t)},e.createGzip=function(t){return new w(t)},e.createGunzip=function(t){return new M(t)},e.createUnzip=function(t){return new A(t)},e.deflate=function(t,e,i){return"function"==typeof e&&(i=e,e={}),m(new _(e),t,i)},e.deflateSync=function(t,e){return v(new _(e),t)},e.gzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),m(new w(e),t,i)},e.gzipSync=function(t,e){return v(new w(e),t)},e.deflateRaw=function(t,e,i){return"function"==typeof e&&(i=e,e={}),m(new x(e),t,i)},e.deflateRawSync=function(t,e){return v(new x(e),t)},e.unzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),m(new A(e),t,i)},e.unzipSync=function(t,e){return v(new A(e),t)},e.inflate=function(t,e,i){return"function"==typeof e&&(i=e,e={}),m(new b(e),t,i)},e.inflateSync=function(t,e){return v(new b(e),t)},e.gunzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),m(new M(e),t,i)},e.gunzipSync=function(t,e){return v(new M(e),t)},e.inflateRaw=function(t,e,i){return"function"==typeof e&&(i=e,e={}),m(new T(e),t,i)},e.inflateRawSync=function(t,e){return v(new T(e),t)},a.inherits(S,r),S.prototype.params=function(i,n,r){if(i<e.Z_MIN_LEVEL||i>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+i);if(n!=e.Z_FILTERED&&n!=e.Z_HUFFMAN_ONLY&&n!=e.Z_RLE&&n!=e.Z_FIXED&&n!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+n);if(this._level!==i||this._strategy!==n){var a=this;this.flush(o.Z_SYNC_FLUSH,(function(){s(a._handle,"zlib binding closed"),a._handle.params(i,n),a._hadError||(a._level=i,a._strategy=n,r&&r())}))}else t.nextTick(r)},S.prototype.reset=function(){return s(this._handle,"zlib binding closed"),this._handle.reset()},S.prototype._flush=function(t){this._transform(n.alloc(0),"",t)},S.prototype.flush=function(e,i){var r=this,a=this._writableState;("function"==typeof e||void 0===e&&!i)&&(i=e,e=o.Z_FULL_FLUSH),a.ended?i&&t.nextTick(i):a.ending?i&&this.once("end",i):a.needDrain?i&&this.once("drain",(function(){return r.flush(e,i)})):(this._flushFlag=e,this.write(n.alloc(0),"",i))},S.prototype.close=function(e){E(this,e),t.nextTick(I,this)},S.prototype._transform=function(t,e,i){var r,a=this._writableState,s=(a.ending||a.ended)&&(!t||a.length===t.length);return null===t||n.isBuffer(t)?this._handle?(s?r=this._finishFlushFlag:(r=this._flushFlag,t.length>=a.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),void this._processChunk(t,r,i)):i(new Error("zlib binding closed")):i(new Error("invalid input"))},S.prototype._processChunk=function(t,e,i){var r=t&&t.length,o=this._chunkSize-this._offset,a=0,h=this,c="function"==typeof i;if(!c){var f,p=[],d=0;this.on("error",(function(t){f=t})),s(this._handle,"zlib binding closed");do{var g=this._handle.writeSync(e,t,a,r,this._buffer,this._offset,o)}while(!this._hadError&&v(g[0],g[1]));if(this._hadError)throw f;if(d>=l)throw E(this),new RangeError(u);var y=n.concat(p,d);return E(this),y}s(this._handle,"zlib binding closed");var m=this._handle.write(e,t,a,r,this._buffer,this._offset,o);function v(l,u){if(this&&(this.buffer=null,this.callback=null),!h._hadError){var f=o-u;if(s(f>=0,"have should not go down"),f>0){var g=h._buffer.slice(h._offset,h._offset+f);h._offset+=f,c?h.push(g):(p.push(g),d+=g.length)}if((0===u||h._offset>=h._chunkSize)&&(o=h._chunkSize,h._offset=0,h._buffer=n.allocUnsafe(h._chunkSize)),0===u){if(a+=r-l,r=l,!c)return!0;var y=h._handle.write(e,t,a,r,h._buffer,h._offset,h._chunkSize);return y.callback=v,void(y.buffer=t)}if(!c)return!1;i()}}m.buffer=t,m.callback=v},a.inherits(_,S),a.inherits(b,S),a.inherits(w,S),a.inherits(M,S),a.inherits(x,S),a.inherits(T,S),a.inherits(A,S)}).call(this,i(18))},function(t,e,i){"use strict";t.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.USERPOI=0]="USERPOI",t[t.USERPOITEXT=1]="USERPOITEXT",t[t.PLACE_LABEL=2]="PLACE_LABEL",t[t.POI=3]="POI",t[t.POITEXT=4]="POITEXT",t[t.VECTOR_LABEL=5]="VECTOR_LABEL",t[t.BOUNDARY_LABEL=6]="BOUNDARY_LABEL",t[t.QUERYBOX=7]="QUERYBOX"}(e.CollisionType||(e.CollisionType={}));var n=function(){function t(t,e,i){this.rank=0,this.hash=0,this.obb=t,this.renderData=i,this.type=e}return t.prototype.setVisible=function(t){},t.prototype.isVisible=function(){return!1},t.prototype.getId=function(){return this.hash},t.prototype.getRank=function(){return this.rank},t.prototype.getZoom=function(){return this.zoom},t}();e.CollisionItem=n},function(t,e,i){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.TILE=0]="TILE",t[t.GROUND=1]="GROUND",t[t.BUILDING=2]="BUILDING",t[t.POI=3]="POI"}(n=e.OverlayType||(e.OverlayType={}));var r=function(){function t(t){this.id=0,this.map=null,this.type=t,this.isValid=!0}return t.prototype.getType=function(){return this.type},t.prototype.getProperties=function(){return this.properties},t.prototype.setMap=function(t){this.map!==t&&this.isValid&&(null!=this.map&&(this.map.mapView.removeOverlay(this.id),this.id=0),this.map=t,null!=this.map&&(this.id=this.map.mapView.addOverlay(this)))},t.prototype.setVisible=function(t){this.properties.setVisible(t),null!=this.map&&this.map.mapView.requestRender()},t.prototype.isVisible=function(){return this.properties.isVisible()},t.prototype.setZIndex=function(t){this.type!=n.TILE&&this.type!=n.GROUND||(this.properties.setZIndex(t),null!=this.map&&(this.map.mapView.overlayManager.dirtyRasterOverlays(),this.map.mapView.requestRender()))},t}();e.Overlay=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return Object.defineProperty(t,"apiPrefix",{get:function(){return"api"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"tileEnv",{get:function(){return"api"==this.apiPrefix?"":"api-dev"==this.apiPrefix?"-dev":"-test"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isDebug",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isTileDebug",{get:function(){return this.isDebug&&!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isCollisionDebug",{get:function(){return this.isDebug&&!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"sdkVersion",{get:function(){return"1.6.2"},enumerable:!0,configurable:!0}),t}();e.Env=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.raster="raster",t.roadmap="roadmap",t.satellite="satellite"}(e.MapType||(e.MapType={}))},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(5),a=i(1),s=i(35),l=i(147),u=function(t){function e(i){var n=t.call(this)||this,r={};a.MapUtils.extendOptions(r,e.defaultCircleOptions,i);for(var s=0,u=r;s<u.length;s++){if(null==u[s])throw Error("Parameters can not be null")}return n.properties=new l.CircleLayerProperties(o.LatLng.convert(r.center),r.radius,r.fillColor,r.fillOpacity,r.strokeColor,r.strokeWidth,r.elevation,r.visible,r.draggable,r.userInteractionEnabled),n.zIndex=r.zIndex,n.elevation=r.elevation,n}return r(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setCenter=function(t){if(null!=t){var e=o.LatLng.convert(t);this.properties.getCenter().equals(e)||(this.properties.setCenter(e),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))}else console.warn("Parameter center can not be null")},e.prototype.setRadius=function(t){null!=t?this.properties.getRadius()!=t&&(this.properties.setRadius(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter radius can not be null")},e.prototype.setFillColor=function(t){null!=t?this.properties.getFillColor().code!=t&&(this.properties.setFillColor(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillColor can not be null")},e.prototype.setFillOpacity=function(t){null!=t?this.properties.getFillOpacity()!=t&&(this.properties.setFillOpacity(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillOpacity can not be null")},e.prototype.setStrokeColor=function(t){null!=t?this.properties.getStrokeColor().code!=t&&(this.properties.setStrokeColor(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeColor can not be null")},e.prototype.setStrokeWidth=function(t){null!=t?this.properties.getStrokeWidth()!=t&&(this.properties.setStrokeWidth(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeWidth can not be null")},e.prototype.setVisible=function(t){null!=t?this.properties.isVisible()!==t&&(this.properties.setVisible(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter visible can not be null")},e.prototype.setDraggable=function(t){null!=t?this.properties.setDraggable(t):console.warn("Parameter draggable can not be null")},e.prototype.getCenter=function(){return this.properties.getCenter()},e.prototype.getRadius=function(){return this.properties.getRadius()},e.prototype.getFillColor=function(){return this.properties.getFillColor().code},e.prototype.getFillOpacity=function(){return this.properties.getFillOpacity()},e.prototype.getStrokeColor=function(){return this.properties.getStrokeColor().code},e.prototype.getStrokeWidth=function(){return this.properties.getStrokeWidth()},e.prototype.isVisible=function(){return this.properties.isVisible()},e.prototype.isDraggable=function(){return this.properties.isDraggable()},e.prototype.getProperties=function(){return this.properties},e.prototype.isUserInteractionEnabled=function(){return this.properties.isUserInteractionEnabled()},e.prototype.setUserInteraction=function(t){this.properties.setUserInteraction(t)},e.defaultCircleOptions={radius:0,fillColor:"#0000ff",fillOpacity:1,visible:!0,strokeColor:"#00ff00",strokeWidth:0,draggable:!1,zIndex:0,elevation:0,userInteractionEnabled:!0},e}(s.Annotation);e.Circle=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=function(){function t(t,e,i){this.width=t,this.height=e,this.url=i}return t.prototype.clone=function(){return new t(this.width,this.height,this.url)},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getUrl=function(){return null==this.url?null:this.url.replace("@1x","@"+n.MapUtils.resourceScale+"x")},t}();e.Icon=r},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(35),a=i(161),s=i(1),l=i(5),u=i(12),h=function(t){function e(i){var n=t.call(this)||this,r={};return s.MapUtils.extendOptions(r,e.defaultPOIOptions,i),n.properties=new a.UserPOILayerProperties(r.title,u.Color.fromHex(r.titleColor),r.subtitle,l.LatLng.convert(r.position),r.type,r.icon,r.zIndex,r.visible,r.draggable,r.userInteractionEnabled),n.elevation=r.elevation,n}return r(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.getTitle=function(){return this.properties.getTitle()},e.prototype.setTitle=function(t){this.properties.getTitle()!==t&&(this.properties.setTitle(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.getPosition=function(){return this.properties.getPosition()},e.prototype.setPosition=function(t){if(null!=t){var e=l.LatLng.convert(t);this.properties.getPosition().equals(e)||(this.properties.setPosition(e),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))}else console.warn("Parameter position can not be null")},e.prototype.getTitleColor=function(){return this.properties.getTitleColor().code},e.prototype.setTitleColor=function(t){this.properties.setTitleColor(u.Color.fromHex(t))},e.prototype.getSubtitle=function(){return this.properties.getSubtitle()},e.prototype.setSubtitle=function(t){this.properties.setSubtitle(t)},e.prototype.getType=function(){return this.properties.getType()},e.prototype.setType=function(t){this.properties.setType(t)},e.prototype.getIcon=function(){return this.properties.getIcon()},e.prototype.setIcon=function(t){this.properties.getIcon()!==t&&(this.properties.setTextureDirty(!0),this.properties.setIcon(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))},e.prototype.getZIndex=function(){return this.properties.getRank()},e.prototype.setZIndex=function(t){this.properties.setRank(t)},e.prototype.isVisible=function(){return this.properties.isVisible()},e.prototype.setVisible=function(t){this.properties.setVisible(t)},e.prototype.isDraggable=function(){return this.properties.isDraggable()},e.prototype.setDraggable=function(t){this.properties.setDraggable(t)},e.prototype.getProperties=function(){return this.properties},e.prototype.isUserInteractionEnabled=function(){return this.properties.isUserInteractionEnabled()},e.prototype.setUserInteraction=function(t){this.properties.setUserInteraction(t)},e.defaultPOIOptions={title:"Default icon name",subtitle:"",titleColor:"#FF0000",type:"",elevation:0,zIndex:0,draggable:!1,visible:!0,userInteractionEnabled:!0},e}(o.Annotation);e.POI=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(35),a=i(1),s=i(162),l=i(5),u=i(163),h=i(6),c=i(3),f=i(165),p=i(21),d=i(16),g=i(72),y=function(t){function e(i){var n=t.call(this)||this,r={};a.MapUtils.extendOptions(r,e.defaultBuildingOptions,i);var o=[],u=null;if(r.position&&(u=l.LatLng.convert(r.position)),!r.model)if(r.coordinates.length>=2){var h=0,c=0;if(r.coordinates.forEach((function(t){var e=l.LatLng.convert(t);o.push(e),h+=e.lat,c+=e.lng})),h/=o.length,c/=o.length,u=new l.LatLng(h,c),r.position){var f=l.LatLng.convert(r.position),p=f.lng-u.lng,d=f.lat-u.lat;u=f;var g=[];o.forEach((function(t){g.push(new l.LatLng(t.lat+d,t.lng+p))})),o=g}}else console.warn("Coordinates size must be greater than 2");return n.properties=new s.UserBuildingLayerProperties(r.name,r.scale,r.bearing,u,r.height,r.elevation,r.model,r.texture,o,r.visible,r.draggable,r.userInteractionEnabled,r.selected,r.growUp),n.zIndex=r.zIndex,n.properties.onModelLoaded=null,n.properties.updateBounds(),n.properties.hasBounds=!1,n}return r(e,t),e.prototype.setMap=function(t){if(t&&!this.properties.getModelUrl()&&this.properties.getCoordinates().length<=2)console.error("Cannot add object to the map without any model information");else if(!t||0!=this.properties.getCoordinates().length||this.properties.getLocation()){if(this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,this.properties.setMap(t),null!=this.map)){if(!this.properties.getModelUrl()&&this.properties.getCoordinates().length>2){var e=this.properties.getCoordinates(),i=new p.LatLngBounds;e.forEach((function(t){i.extend(t)})),this.properties.updateBoundsFromLatLngBounds(i)}this.id=this.map.mapView.addAnnotation(this)}}else console.error("Cannot add object to the map without knowing object's position")},e.prototype.getPosition=function(){return this.properties.getLocation()},e.prototype.setPosition=function(t){if(null!=t){var e=this.properties.getLocation();this.properties.setLocation(l.LatLng.convert(t));var i=this.properties.getCoordinates();if(i.length>0&&null!=e){var n=this.properties.getLocation(),r=n.lng-e.lng,o=n.lat-e.lat,a=[];i.forEach((function(t){a.push(new l.LatLng(t.lat+o,t.lng+r))})),this.properties.setCoordinates(a)}if(null!=this.map){var s=d.MapResourceManager.getInstance(this.map.mapView.gl).getModel(this.properties.getModelName());s?(this.properties.setCoverPoints(s.points),this.properties.updateBounds(new g.BoundingBox(s.minX,s.minY,s.maxX,s.maxY))):this.properties.updateBounds(),this.map.mapView.updateAnnotation(this.id,!0)}}else console.warn("Parameter location can not be null")},e.prototype.getName=function(){return this.properties.getName()},e.prototype.setName=function(t){null!=t?this.properties.setName(t):console.warn("Parameter name can not be null")},e.prototype.getBearing=function(){return this.properties.getBearing()},e.prototype.setBearing=function(t){null!=t?this.properties.getBearing()!=t&&(this.properties.setBearing(t),this.properties.updateBounds(),this.properties.hasBounds=!1,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter bearing can not be null")},e.prototype.getScale=function(){return this.properties.getScale()},e.prototype.setScale=function(t){null!=t?t<=0?console.warn("Parameter scale can not be less than 0"):this.properties.getScale()!=t&&(this.properties.setScale(t),this.properties.updateBounds(),this.properties.hasBounds=!1,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter scale can not be null")},e.prototype.getHeight=function(){return this.properties.getHeight()},e.prototype.setHeight=function(t){null!=t?null!=this.properties.getCoordinates()&&0!=this.properties.getCoordinates().length?this.properties.getHeight()!=t&&(this.properties.setHeight(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Object with Obj model is unsupported this action"):console.warn("Parameter height can not be null")},e.prototype.getElevation=function(){return this.properties.getElevation()},e.prototype.setElevation=function(t){null!=t?(this.properties.setElevation(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter elevation can not be null")},e.prototype.isSelected=function(){return this.properties.isSelected()},e.prototype.setSelected=function(t){this.properties.isSelected()!=t&&(this.properties.setSelected(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.setModel=function(t){null!=t?this.properties.getModelUrl()!=t&&(this.properties.setModelUrl(t),this.properties.updateBounds(),this.properties.hasBounds=!1,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Model data could not be null")},e.prototype.getCoordinates=function(){return(this.properties.getCoordinates()||[]).slice()},e.prototype.setCoordinates=function(t){if(null==t||t.length<=2)console.warn("Coordinates size must be != null or greater than 2");else{var e=0,i=0,n=[];t.forEach((function(t){var r=l.LatLng.convert(t);n.push(r),e+=r.lat,i+=r.lng})),e/=n.length,i/=n.length;var r=new l.LatLng(e,i);this.properties.setLocation(r),this.properties.setCoordinates(n),this.properties.updateBounds(),this.properties.hasBounds=!1,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)}},e.prototype.setTexture=function(t){null!=t?this.properties.getTextureUrl()!=t&&(this.properties.setTextureUrl(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Texture data could not be null")},e.prototype.isVisible=function(){return this.properties.isVisible()},e.prototype.setVisible=function(t){this.properties.setVisible(t),null!=this.map&&this.map.mapView.updateAnnotation(this.id)},e.prototype.isGrowUp=function(){return this.properties.isGrowUp()},e.prototype.setGrowUp=function(t){this.properties.setGrowUp(t)},e.prototype.isDraggable=function(){return this.properties.isDraggable()},e.prototype.setDraggable=function(t){null!=t?this.properties.setDraggable(t):console.warn("Parameter draggable can not be null")},e.prototype.isUserInteractionEnabled=function(){return this.properties.isUserInteractionEnabled()},e.prototype.setUserInteraction=function(t){this.properties.setUserInteraction(t)},e.prototype.getProperties=function(){return this.properties},e.prototype.getTileCovers=function(t,e){var i=this;if(e){if(!this.map)return console.warn("This Building was not added to Map or it is not referenced to Building in Map"),void e([]);var n=function(){for(var n=[],r=0;r<t.length;++r){var o=u.tiles(i.createFeatureData(),{min_zoom:t[r],max_zoom:t[r]});o&&o.forEach((function(t){n.push({x:t[0],y:t[1],z:t[2]})}))}e(n)};this.properties.hasBounds?(n(),this.properties.onModelLoaded=null):this.properties.onModelLoaded=n}},e.prototype.getBoundsCoordinates=function(t){var e=this;if(t){if(!this.map)return console.warn("This Building was not added to Map or it is not referenced to Building in Map"),t([]),null;var i=function(){var i=[],n=e.properties.getCoverPoints();if(n){for(var r=0;r<n.length;++r)i.push(n[r]);i=f.ConvexHull.makeHull(i)}else{e.getCoverCoordinates().forEach((function(t){i.push(t)}))}t(i)};this.properties.hasBounds?(i(),this.properties.onModelLoaded=null):this.properties.onModelLoaded=i}},e.prototype.getCoverCoordinates=function(){var t=this,e=h.ProjectionMercator.convertToMeterFromLatLng(this.getPosition()),i=[],n=this.getBearing()*Math.PI/180;return this.properties.getCoordinates().forEach((function(r){var o=h.ProjectionMercator.convertToMeterFromLatLng(r);if(o.x-=e.x,o.y-=e.y,0!=n){var a=o.x,s=o.y;o.x=(a*Math.cos(n)-s*Math.sin(n))*t.getScale(),o.y=(a*Math.sin(n)+s*Math.cos(n))*t.getScale()}else o.x=o.x*t.getScale(),o.y=o.y*t.getScale();var l=h.ProjectionMercator.convertToLatLngFromMeter(new c.Vector2(e.x+o.x,e.y+o.y));i.push(l)})),i},e.prototype.createFeatureData=function(){var t,e=[],i=this.properties.getCoverPoints();if(i){for(var n=0;n<i.length;++n)e.push([i[n].lng,i[n].lat]);t={type:"MultiPoint",properties:{},coordinates:e}}else{var r=this.getCoverCoordinates();r.forEach((function(t){e.push([t.lng,t.lat])})),e.push([r[0].lng,r[0].lat]),t={type:"Polygon",properties:{},coordinates:[e]}}return t},e.defaultBuildingOptions={name:"Unknown name",scale:1,bearing:0,elevation:0,height:1,model:null,texture:null,coordinates:[],zIndex:0,draggable:!1,visible:!0,userInteractionEnabled:!0,selected:!1,growUp:!0},e}(o.Annotation);e.Building=y},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(13),r=i(1),o=function(){function t(){}return t.getTileUrl=function(t,e,i,n){for(var r=0,o=0,a="";o<t.length;)if("{"==t[o]){switch(a+=t.substring(r,o),t[o+1]){case"x":a+=e.toString();break;case"y":a+=i.toString();break;case"z":a+=n.toString();break;default:console.log("Invalid map url pattern: "+t)}r=o+=3}else++o;return a+=t.substr(r)},t.getBuildingDataUrl=function(t,e,i){for(var n=0,r=0,o="";r<t.length;)if("{"==t[r]){switch(o+=t.substring(n,r),t[r+1]){case"s":o+=e;break;case"k":o+=i;break;default:console.log("Invalid Model url pattern: "+t)}n=r+=3}else++r;return o+=t.substr(n)},t.getIconRequestUrl=function(t,e,i){for(var o=0,a=0,s="";a<t.length;)if("{"==t[a]){switch(s+=t.substring(o,a),t[a+1]){case"t":s+=e;break;case"k":s+=i;break;case"s":s+=n.MathUtils.clamp(r.MapUtils.resourceScale,1,3)+"x";break;default:console.log("Invalid Model url pattern: "+t)}o=a+=3}else++a;return s+=t.substr(o)},t.isUrlRequest=function(t){return null!=t&&(t.startsWith("http")||t.startsWith("./")||t.startsWith("/")||t.startsWith("blob:"))},t}();e.UrlUtils=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.create=function(t,e,i){var n=window.document.createElement(t);return e&&(n.className=e),i&&i.appendChild(n),n},t.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)},t}();e.DOMUtils=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Texture=0]="Texture",t[t.Extrude=1]="Extrude",t[t.External=2]="External",t[t.ExternalExtrude=3]="ExternalExtrude",t[t.Polygon=4]="Polygon"}(e.BuildingType||(e.BuildingType={}))},function(t,e,i){t.exports=r;var n=i(82).EventEmitter;function r(){n.call(this)}i(33)(r,n),r.Readable=i(83),r.Writable=i(227),r.Duplex=i(228),r.Transform=i(229),r.PassThrough=i(230),r.Stream=r,r.prototype.pipe=function(t,e){var i=this;function r(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function o(){i.readable&&i.resume&&i.resume()}i.on("data",r),t.on("drain",o),t._isStdio||e&&!1===e.end||(i.on("end",s),i.on("close",l));var a=!1;function s(){a||(a=!0,t.end())}function l(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(h(),0===n.listenerCount(this,"error"))throw t}function h(){i.removeListener("data",r),t.removeListener("drain",o),i.removeListener("end",s),i.removeListener("close",l),i.removeListener("error",u),t.removeListener("error",u),i.removeListener("end",h),i.removeListener("close",h),t.removeListener("close",h)}return i.on("error",u),t.on("error",u),i.on("end",h),i.on("close",h),t.on("close",h),t.emit("pipe",i),t}},function(t,e,i){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,i,n,r){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,i)}));case 3:return e.nextTick((function(){t.call(null,i,n)}));case 4:return e.nextTick((function(){t.call(null,i,n,r)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick((function(){t.apply(null,o)}))}}}:t.exports=e}).call(this,i(18))},function(t,e,i){var n=i(4),r=n.Buffer;function o(t,e){for(var i in t)e[i]=t[i]}function a(t,e,i){return r(t,e,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(o(n,e),e.Buffer=a),o(r,a),a.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,i)},a.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=r(t);return void 0!==e?"string"==typeof i?n.fill(e,i):n.fill(e):n.fill(0),n},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r,o,a,s=i(3),l=[[1,0],[0,1]],u=[],h=[],c=function(){function t(t,e,i,n,r){this.dimension=[n/2,r/2],this.angle=i,this.centroid=[t,e],this.quad=null,this.axis0=null,this.axis1=null,this.update()}return t.prototype.update=function(){var t=this.centroid,e=this.dimension[0],i=this.dimension[1];if(0===this.angle)this.quad=[t[0]-e,t[1]-i,t[0]+e,t[1]-i,t[0]+e,t[1]+i,t[0]-e,t[1]+i],this.axis0=new s.Vector2(l[0][0],l[0][1]),this.axis1=new s.Vector2(l[1][0],l[1][1]);else{var n=Math.cos(this.angle)*e,r=Math.sin(this.angle)*e,o=-Math.sin(this.angle)*i,a=Math.cos(this.angle)*i;this.quad=[t[0]-n-o,t[1]-r-a,t[0]+n-o,t[1]+r-a,t[0]+n+o,t[1]+r+a,t[0]-n+o,t[1]-r+a],this.updateAxes()}},t.prototype.updateAxes=function(){var t=new s.Vector2(this.quad[4]-this.quad[6],this.quad[5]-this.quad[7]);this.axis0=t.normalize();var e=new s.Vector2(this.quad[4]-this.quad[2],this.quad[5]-this.quad[3]);this.axis1=e.normalize()},t.prototype.getQuad=function(){return this.quad},t.prototype.getExtent=function(){return 0===this.angle?new f(this.quad[0],this.quad[1],this.quad[4],this.quad[5]):new f(Math.min(this.quad[0],this.quad[2],this.quad[4],this.quad[6]),Math.min(this.quad[1],this.quad[3],this.quad[5],this.quad[7]),Math.max(this.quad[0],this.quad[2],this.quad[4],this.quad[6]),Math.max(this.quad[1],this.quad[3],this.quad[5],this.quad[7]))},t.projectToAxis=function(t,e,i){var s=t.quad;n=s[0]*e.x+s[1]*e.y,r=s[2]*e.x+s[3]*e.y,o=s[4]*e.x+s[5]*e.y,a=s[6]*e.x+s[7]*e.y,i[0]=Math.min(n,r,o,a),i[1]=Math.max(n,r,o,a)},t.axisCollide=function(e,i,n,r){return t.projectToAxis(e,n,u),t.projectToAxis(i,n,h),!(h[0]>u[1]||h[1]<u[0])&&(t.projectToAxis(e,r,u),t.projectToAxis(i,r,h),!(h[0]>u[1]||h[1]<u[0]))},t.intersect=function(e,i){return t.axisCollide(e,i,e.axis0,e.axis1)&&t.axisCollide(e,i,i.axis0,i.axis1)},t}();e.OBB=c;var f=function(){function t(t,e,i,n){this.min=new s.Vector2(t,e),this.max=new s.Vector2(i,n)}return t.prototype.intersect=function(t){return t.max.x>=this.min.x&&t.max.y>=this.min.y&&t.min.x<=this.max.x&&t.min.y<=this.max.y},t.prototype.getMin=function(){return this.min},t.prototype.getMax=function(){return this.max},t.prototype.getCentroid=function(){return new s.Vector2((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2)},t}();e.AABB=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.visible=t,this.zIndex=null!=e?e:0}return t.prototype.setLayerId=function(t){this.layerId=t},t.prototype.getLayerId=function(){return this.layerId},t.prototype.setVisible=function(t){this.visible=t},t.prototype.isVisible=function(){return this.visible},t.prototype.setZIndex=function(t){this.zIndex=t},t.prototype.getZIndex=function(){return this.zIndex},t}();e.OverlayProperties=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(19);e.CameraPosition=n.CameraPosition;var r=i(51);e.Circle=r.Circle;var o=i(52);e.Icon=o.Icon;var a=i(5);e.LatLng=a.LatLng;var s=i(21);e.LatLngBounds=s.LatLngBounds;var l=i(148);e.Map=l.Map4D;var u=i(40);e.MapEvent=u.MapEvent;var h=i(333);e.MapObjectData=h.MapObjectData;var c=i(334);e.MapsEventListener=c.MapsEventListener;var f=i(31);e.Marker=f.Marker;var p=i(335);e.MarkerClusterer=p.MarkerClusterer;var d=i(79);e.MarkerLabel=d.MarkerLabel;var g=i(10);e.Point=g.Point;var y=i(41);e.Polygon=y.Polygon;var m=i(36);e.Polyline=m.Polyline;var v=i(336);e.Projection=v.Projection;var _=i(94);e.TimeEffect=_.TimeEffect;var b=i(93);e.Weather=b.Weather;var w=i(95);e.Data=w.Data,e.MapData=w.MapData;var M=i(337);e.Measure=M.Measure;var x=i(339);e.CoordinateTransformer=x.CoordinateTransformer;var T=i(53);e.POI=T.POI;var A=i(54);e.Building=A.Building;var L=i(340);e.BuildingOverlay=L.BuildingOverlay;var S=i(341);e.TileOverlay=S.TileOverlay;var E=i(342);e.GroundOverlay=E.GroundOverlay;var I=i(343);e.POIOverlay=I.POIOverlay;var P=i(50);e.MapType=P.MapType;var C=i(344);e.DirectionsRenderer=C.DirectionsRenderer;var O=i(345);e.AnimationOptions=O.AnimationOptions;var R=i(346);e.CircleOptions=R.CircleOptions;var D=i(66);e.ControlOptions=D.ControlOptions;var k=i(347);e.EventOptions=k.EventOptions;var B=i(348);e.MapOptions=B.MapOptions;var U=i(349);e.MarkerClusterOptions=U.MarkerClusterOptions;var N=i(350);e.MarkerLabelOptions=N.MarkerLabelOptions;var F=i(351);e.MarkerOptions=F.MarkerOptions;var j=i(352);e.PaddingOptions=j.PaddingOptions;var V=i(353);e.PolygonOptions=V.PolygonOptions;var Z=i(354);e.PolylineOptions=Z.PolylineOptions;var z=i(355);e.POIOptions=z.POIOptions;var G=i(356);e.BuildingOptions=G.BuildingOptions;var Y=i(357);e.TileOverlayOptions=Y.TileOverlayOptions,e.GroundOverlayOptions=Y.GroundOverlayOptions,e.POIOverlayOptions=Y.POIOverlayOptions,e.BuildingOverlayOptions=Y.BuildingOverlayOptions;var W=i(358);e.DirectionsRendererOptions=W.DirectionsRendererOptions;var H=i(359);e.POIData=H.POIData,e.BuildingData=H.BuildingData},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),r=i(50),o=i(97),a=i(65),s=function(){function t(t){this.language=a.MapLanguage.vi,this.vectorFormat=o.VectorFormat.mvt,this.minZoom=n.MapConstants.defaultMinZoom,this.maxZoom=n.MapConstants.defaultMaxZoom,this.maxNativeZoom=n.MapConstants.defaultMaxNativeZoom,this._3dMode=!1,this._objectsEnabled=!0,this._placesEnabled=!0,this._filterPOITypes=[],this._dataLayerMinZoom=n.MapConstants.defaultMinZoom,this._dataLayerMaxZoom=n.MapConstants.defaultMaxZoom,this.mapModeChangedObserver=t}return Object.defineProperty(t,"getSignature",{get:function(){return this.signature},enumerable:!0,configurable:!0}),Object.defineProperty(t,"getResourseBaseUrl",{get:function(){return this.resourseBaseUrl},enumerable:!0,configurable:!0}),t.prototype.setMapType=function(t){this.mapType=t},t.prototype.getMapType=function(){return this.mapType},t.prototype.setMapLanguage=function(t){this.language=t},t.prototype.getMapLanguage=function(){return this.language},t.prototype.setMinZoom=function(t){this.minZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.setMaxZoom=function(t){this.maxZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.getMapUrl=function(){if(this.is3dMode())return n.ServerConstants.baseMapUrl+"?mode=3d&type=raster&key="+t.accessKey;var e=n.ServerConstants.baseMapUrl+"?mode="+(this.is3dMode()?"3d":"2d")+"&type="+this.mapType+"&key="+t.accessKey;return this.mapType==r.MapType.roadmap?e+"&format="+this.vectorFormat:e},t.prototype.getPreferMaxTilt=function(){return this.is3dMode()?n.MapConstants.maxTilt3D:n.MapConstants.maxTilt2D},t.prototype.getPreferMinZoom=function(){var t=this.minZoom,e=this.is3dMode()?n.MapConstants.defaultMinZoom3d:n.MapConstants.defaultMinZoom;return t=t>e?t:e},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinTilt=function(){return n.MapConstants.minTilt},t.prototype.getMaxTilt=function(){return this._3dMode?n.MapConstants.maxTilt3D:n.MapConstants.maxTilt2D},t.prototype.getMaxNativeZoom=function(){return this.maxNativeZoom},t.prototype.setDate=function(t){this.date=t},t.prototype.getDate=function(){return this.date||new Date},t.prototype.setMaxNativeZoom=function(t){this.maxNativeZoom=t},t.getAccessKey=function(){return this.accessKey},t.prototype.enable3dMode=function(t){return t!=this._3dMode&&(this._3dMode=t,this.mapModeChangedObserver.onMapModeChanged(),!0)},t.prototype.is3dMode=function(){return this._3dMode},t.prototype.setRestrictionBounds=function(t){this.restrictionBounds=t},t.prototype.getRestrictionBounds=function(){return this.restrictionBounds},Object.defineProperty(t.prototype,"objectsEnabled",{get:function(){return this._objectsEnabled},set:function(t){this._objectsEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placesEnabled",{get:function(){return this._placesEnabled},set:function(t){this._placesEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterPOITypes",{get:function(){return this._filterPOITypes},set:function(t){this._filterPOITypes=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataLayerMinZoom",{get:function(){return this._dataLayerMinZoom},set:function(t){this._dataLayerMinZoom=t,this._dataLayerMinZoom>this._dataLayerMaxZoom&&(this._dataLayerMinZoom+=this._dataLayerMaxZoom,this._dataLayerMaxZoom=this._dataLayerMinZoom-this._dataLayerMaxZoom,this._dataLayerMinZoom-=this._dataLayerMaxZoom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataLayerMaxZoom",{get:function(){return this._dataLayerMaxZoom},set:function(t){this._dataLayerMaxZoom=t,this._dataLayerMinZoom>this._dataLayerMaxZoom&&(this._dataLayerMinZoom+=this._dataLayerMaxZoom,this._dataLayerMaxZoom=this._dataLayerMinZoom-this._dataLayerMaxZoom,this._dataLayerMinZoom-=this._dataLayerMaxZoom)},enumerable:!0,configurable:!0}),t.accessKey="208e1c99aa440d8bc2847aafa3bc0669",t.resourseBaseUrl="https://hcm01.vstorage.vngcloud.vn/v1/AUTH_4486f66f671c41bab0d3dea1904626d4",t.signature="__SIGNATURE__",t.defaultMapStyle='{"layers":{"earth":{"draw":{"polygons":{"color":[[2,"#F1F3F4"]]}}},"water":{"draw":{"polygons":{"color":"#90D5EF"},"lines":{"color":"#90D5EF","width":[[12,1],[14,2]]}}},"roads":{"filter":{"kind":["highway","major_road","minor_road","path","rail","ferry","aeroway","construction"]},"draw":{"lines":{"color":"#FFF","width":[[10,1]],"outline":{"color":[[7,"#ececec"],[15,"#dadce0"]],"width":[[13,1]]}},"text":{"color":"#677277","size":[[8,10],[17,12]],"halo":{"color":"#FFF"}}},"highway":{"filter":{"kind":["highway"]},"draw":{"lines":{"color":"#FBC0AC","width":[[7,1],[10,2],[14,3],[15,5],[16,8],[17,13],[18,20],[19,36]],"outline":{"color":"#F9A09C","width":[[7,0],[11,1]]}},"text":{"size":[[8,12]]}}},"major_road":{"filter":{"kind":["major_road"]},"draw":{"lines":{"width":[[13,2],[15,4],[16,8],[17,13],[18,20],[19,36]],"outline":{"width":[[13,1]]}},"text":{"size":[[8,12]]}},"primary":{"filter":{"kind_detail":["primary","primary_link"]},"draw":{"lines":{"width":[[10,2],[14,3],[15,5],[16,8],[17,13],[18,20],[19,36]],"outline":{"width":[[11,1]]}},"text":{"size":12}}},"trunk":{"filter":{"kind_detail":["trunk","trunk_link"]},"draw":{"lines":{"color":[[7,"#EBB97B"],[11,"#FDE293"]],"width":[[7,1],[10,2],[14,3],[15,5],[16,8],[17,13],[18,20],[19,36]],"outline":{"color":"#EBB97B","width":[[11,1]]}},"text":{"size":12}}}},"minor_road":{"filter":{"kind":["minor_road","path"]},"draw":{"lines":{"width":[[17,3],[18,5],[19,10]],"outline":{"width":[[16,1]]}}},"unclassified":{"filter":{"kind_detail":["unclassified"]},"draw":{"lines":{"width":[[14,0],[15,2],[16,4],[17,7],[18,10],[19,20]],"outline":{"width":[[15,1]]}}}},"residential":{"filter":{"kind_detail":["residential"]},"draw":{"lines":{"width":[[14,0],[15,2],[16,4],[17,7],[18,10],[19,20]],"outline":{"width":[[15,1]]}}}},"footway":{"filter":{"kind_detail":["footway","pedestrian"]},"draw":{"lines":{"color":"#DDDFE3","width":[[16,2]],"outline":{"width":[[18,1]]}}}}},"construction":{"filter":{"kind":["construction"]},"draw":{"lines":{"color":"#DDDFE3","width":[[14,1],[15,2]],"outline":{"width":[[14,1]]}}}},"rail":{"filter":{"kind":["rail"]},"draw":{"lines":{"color":[[10,"#E5E5E5"]],"width":[[10,2]]}}},"aeroway":{"filter":{"kind":["aeroway"]},"draw":{"lines":{"color":"#F1F3F4","width":[[13,2],[15,6]],"outline":{"color":"#E1E3E6","width":[[10,1]]}}}},"ferry":{"filter":{"kind":["ferry"]},"draw":{"lines":{"color":"#2B68C566","width":[[5,1]],"outline":{"color":"#CBCDE133","width":[[5,1]]}}}}},"boundaries":{"draw":{"lines":{"color":"#FF00FF","width":[[2,0]]},"text":{"color":"#798083","size":10,"halo":{"color":"#FFF"}}},"country":{"filter":{"kind_detail":["2"]},"draw":{"lines":{"color":"#768681","width":[[2,1]]}}},"province":{"filter":{"kind":["province","province_sf"]},"draw":{"lines":{"color":[[7,"#BDBDBD"],[8,"#768681"]],"width":[[5,1],[11,0]]}}},"district":{"filter":{"kind":["district"]},"draw":{"lines":{"color":"#BDBDBD","width":[[11,1]]}}},"ward":{"filter":{"kind":"ward"},"draw":{"lines":{"color":"#BDBDBD","width":[[14,0]]}}}},"places":{"draw":{"text":{"color":"#505050","size":0,"style":"bold","halo":{"color":"#FFF"}}},"country":{"filter":{"kind":["country","country_sf"]},"draw":{"text":{"color":"#505050","size":[[2,9],[5,12],[6,18],[9,0]]}}},"archipelago":{"filter":{"kind":["archipelago"]},"draw":{"text":{"color":"#505050","size":[[5,9],[6,12],[8,14]]}}},"province":{"filter":{"kind":["province"]},"draw":{"text":{"color":"#565D67","size":[[7,9],[8,16],[10,20],[14,0]]}},"city":{"filter":{"kind_detail":["city"]},"draw":{"text":{"color":"#505050","size":[[5,12],[8,18],[10,20],[14,0]]}}}},"district":{"filter":{"kind":["district"]},"draw":{"text":{"color":"#6A7989","size":[[11,16],[13,18],[14,0]]}}},"ward":{"filter":{"kind":["ward"]},"draw":{"text":{"color":"#6A7989","size":[[14,14],[15,16],[17,0]]}}}},"pois":{"draw":{"points":{"size":[[2,0],[15,12]],"halo":{"color":"#FFF"}}}},"landuse":{"draw":{},"aerodrome":{"filter":{"kind":["aerodrome","apron"]},"draw":{"polygons":{"color":"#F1F3F4"}}},"grass":{"filter":{"kind":["grass","forest","park","theme_park","grassland","natural_wood","garden","cemetery","attraction","golf_course"]},"draw":{"polygons":{"color":"#B6E59E"},"lines":{"color":"#B6E59E","width":[[14,2]]}}},"hospital":{"filter":{"kind":["hospital"]},"draw":{"polygons":{"color":"#FCE8E6"}}},"university":{"filter":{"kind":["university","school","college"]},"draw":{"polygons":{"color":"#F6F7F9"}}},"stadium":{"filter":{"kind":["stadium","pitch","sports_centre"]},"draw":{"polygons":{"color":"#A8DAB5"}}},"beach":{"filter":{"kind":["beach"]},"draw":{"polygons":{"color":"#FEEFC3"}}},"pedestrian":{"filter":{"kind":["pedestrian"]},"draw":{"polygons":{"color":"#DDDDE8"}}},"substation":{"filter":{"kind":["substation","power_line"]},"draw":{"lines":{"color":"#E2E4E6","width":[[2,0]]},"polygons":{"color":"#E2E4E6"}}},"urban_area":{"filter":{"kind":["urban_area"]},"draw":{"polygons":{"color":"#E2E4E6"}}}},"transit":{},"buildings":{}}}',t}();e.MapSettings=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.en="en",t.vi="vi"}(e.MapLanguage||(e.MapLanguage={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_LEFT=2]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=3]="BOTTOM_RIGHT"}(e.ControlOptions||(e.ControlOptions={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(68),r=i(10),o=i(7),a=i(3),s=function(){function t(){}return t.boxIntersectsSymbol=function(e,i,s,l,u,h,c){s=c.is3dMode()?s:0;var f=o.GeometryUtils.latLngToScreenCoordinate(i,s,c.cameraPosition,c.getScreenSize()),p=new a.Vector2(f.x+(.5-h.x)*l,f.y+(.5-h.y)*u),d=new n.Box(new r.Point(p.x-l/2,p.y-u/2),new r.Point(p.x+l/2,p.y+u/2));return t.boxIntersectsBox(e,d)},t.pointIntersectsBox=function(t,e){return t.x<=e.max.x&&t.y<=e.max.y&&t.x>=e.min.x&&t.y>=e.min.y},t.boxIntersectsBox=function(t,e){return!(e.min.x>t.max.x||e.max.x<t.min.x||e.min.y>t.max.y||e.max.y<t.min.y)},t.polygonIntersectsPolygon=function(e,i){for(var n=0;n<e.length;n++)if(t.polygonContainsPoint(i,e[n]))return!0;for(n=0;n<i.length;n++)if(t.polygonContainsPoint(e,i[n]))return!0;return!!t.lineIntersectsLine(e,i)},t.multiPolygonIntersectsBufferedPoint=function(e,i,n){for(var r=0;r<e.length;r++){var o=e[r];if(t.polygonContainsPoint(o,i))return!0;if(t.pointIntersectsBufferedLine(i,o,n))return!0}return!1},t.multiPolygonIntersectsBufferedMultiPoint=function(e,i,n){for(var r=0;r<i.length;r++)for(var o=i[r],a=0;a<o.length;a++)if(t.multiPolygonIntersectsBufferedPoint(e,o[a],n))return!0;return!1},t.multiPolygonIntersectsMultiPolygon=function(e,i){if(1===e.length&&1===e[0].length)return t.multiPolygonContainsPoint(i,e[0][0]);for(var n=0;n<i.length;n++)for(var r=i[n],o=0;o<r.length;o++)if(t.multiPolygonContainsPoint(e,r[o]))return!0;for(var a=0;a<e.length;a++){for(var s=e[a],l=0;l<s.length;l++)if(t.multiPolygonContainsPoint(i,s[l]))return!0;for(var u=0;u<i.length;u++)if(t.lineIntersectsLine(s,i[u]))return!0}return!1},t.multiPolygonIntersectsBufferedMultiLine=function(e,i,n){for(var r=0;r<i.length;r++)for(var o=i[r],a=0;a<e.length;a++){var s=e[a];if(s.length>=3)for(var l=0;l<o.length;l++)if(t.polygonContainsPoint(s,o[l]))return!0;if(t.lineIntersectsBufferedLine(s,o,n))return!0}return!1},t.lineIntersectsBufferedLine=function(e,i,n){if(e.length>1){if(t.lineIntersectsLine(e,i))return!0;for(var r=0;r<i.length;r++)if(t.pointIntersectsBufferedLine(i[r],e,n))return!0}for(var o=0;o<e.length;o++)if(t.pointIntersectsBufferedLine(e[o],i,n))return!0;return!1},t.lineIntersectsLine=function(e,i){if(0===e.length||0===i.length)return!1;for(var n=0;n<e.length-1;n++)for(var r=e[n],o=e[n+1],a=0;a<i.length-1;a++){var s=i[a],l=i[a+1];if(t.lineSegmentIntersectsLineSegment(r,o,s,l))return!0}return!1},t.lineSegmentIntersectsLineSegment=function(e,i,n,r){return t.isCounterClockwise(e,n,r)!==t.isCounterClockwise(i,n,r)&&t.isCounterClockwise(e,i,n)!==t.isCounterClockwise(e,i,r)},t.pointIntersectsBufferedMultiLine=function(e,i,n){return i.some((function(i){return t.pointIntersectsBufferedLine(e,i,n)}))},t.polygonIntersectsBufferedMultiLine=function(t,e,i){var n=this,r=!1;return e.forEach((function(e){t.length>=3&&e.forEach((function(e){n.polygonContainsPoint(t,e)&&(r=!0)})),n.lineIntersectsBufferedLine(t,e,i)&&(r=!0)})),r},t.pointIntersectsBufferedLine=function(e,i,n){var o=n*n,a=r.Point.convertPointToMBPoint(e);if(1===i.length)return a.distSqr(i[0])<o;for(var s=1;s<i.length;s++){var l=i[s-1],u=i[s];if(t.distToSegmentSquared(e,l,u)<o)return!0}return!1},t.boxIntersectsCircle=function(t,e,i,n){var r=i.x-Math.max(t.x,Math.min(i.x,t.x+(e.x-t.x))),o=i.y-Math.max(t.y,Math.min(i.y,t.y+(e.y-t.y)));return r*r+o*o<n*n},t.multiPolygonContainsPoint=function(t,e){for(var i,n,r,o=!1,a=0;a<t.length;a++)for(var s=0,l=(i=t[a]).length-1;s<i.length;l=s++)n=i[s],r=i[l],n.y>e.y!=r.y>e.y&&e.x<(r.x-n.x)*(e.y-n.y)/(r.y-n.y)+n.x&&(o=!o);return o},t.polygonContainsPoint=function(t,e){for(var i=!1,n=0,r=t.length-1;n<t.length;r=n++){var o=t[n],a=t[r];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(i=!i)}return i},t.isCounterClockwise=function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)},t.distToSegmentSquared=function(t,e,i){var n=r.Point.convertPointToMBPoint(e),o=r.Point.convertPointToMBPoint(i),a=r.Point.convertPointToMBPoint(t),s=n.distSqr(o);if(0===s)return a.distSqr(n);var l=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/s;return l<0?a.distSqr(n):l>1?a.distSqr(o):a.distSqr(o.sub(n)._mult(l)._add(n))},t}();e.CollisionUtils=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(39),r=function(){function t(t,e){this._min=new n(t.x,t.y),this._max=new n(e.x,e.y)}return Object.defineProperty(t.prototype,"min",{get:function(){return this._min},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0}),t}();e.Box=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this._reference=0}return t.prototype.retain=function(){++this._reference},t.prototype.release=function(){--this._reference,this._reference<=0&&this.destroy()},Object.defineProperty(t.prototype,"reference",{get:function(){return this._reference},enumerable:!0,configurable:!0}),t}();e.ResourceReference=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r=i(27),o=i(8),a=i(167),s=i(168),l=i(2),u=i(39),h=i(3),c=i(1),f={" ":6,"!":6,'"':9,"#":15,$:13,"%":19,"&":17,"'":5,"(":7,")":7,"*":13,"+":13,",":5,"-":7,".":6,"/":8,0:13,1:13,2:13,3:13,4:13,5:13,6:13,7:13,8:13,9:13,":":6,";":6,"<":13,"=":13,">":13,"?":10,"@":21,A:15,B:15,C:17,D:17,E:15,F:14,G:18,H:17,I:6,J:13,K:16,L:12,M:21,N:18,O:18,P:16,Q:18,R:18,S:16,T:16,U:17,V:17,W:22,X:16,Y:16,Z:13,"[":7,"\\":8,"]":7,"^":13,_:10,"`":13,a:13,b:14,c:13,d:14,e:13,f:8,g:13,h:14,i:6,j:6,k:12,l:6,m:22,n:14,o:14,p:14,q:14,r:9,s:11,t:8,u:14,v:12,w:18,x:12,y:12,z:11,"{":9,"|":13,"}":9,"~":13," ":6,"¡":6,"¢":13,"£":13,"¤":13,"¥":13,"¦":13,"§":12,"¨":13,"©":19,"ª":8,"«":11,"¬":13,"­":7,"®":19,"¯":12,"°":10,"±":13,"²":8,"³":8,"´":13,"µ":14,"¶":15,"·":6,"¸":5,"¹":8,"º":9,"»":11,"¼":18,"½":18,"¾":18,"¿":10,"À":15,"Á":15,"Â":15,"Ã":15,"Ä":15,"Å":15,"Æ":20,"Ç":15,"È":13,"É":13,"Ê":16,"Ë":13,"Ì":6,"Í":6,"Î":6,"Ï":6,"Ð":17,"Ñ":18,"Ò":18,"Ó":18,"Ô":18,"Õ":18,"Ö":18,"×":13,"Ø":18,"Ù":17,"Ú":17,"Û":17,"Ü":17,"Ý":13,"Þ":14,"ß":14,"à":13,"á":13,"â":13,"ã":13,"ä":13,"å":13,"æ":20,"ç":11,"è":13,"é":13,"ê":13,"ë":13,"ì":6,"í":6,"î":6,"ï":6,"ð":14,"ñ":14,"ò":14,"ó":14,"ô":14,"õ":14,"ö":14,"÷":13,"ø":14,"ù":14,"ú":14,"û":14,"ü":14,"ý":12,"þ":14,"ÿ":12,"Ā":15,"ā":13,"Ă":15,"ă":13,"Ą":15,"ą":13,"Ć":15,"ć":11,"Ĉ":15,"ĉ":11,"Ċ":15,"ċ":11,"Č":15,"č":11,"Ď":17,"ď":14,"Đ":17,"đ":14,"Ē":13,"ē":13,"Ĕ":13,"ĕ":13,"Ė":13,"ė":13,"Ę":13,"ę":13,"Ě":13,"ě":13,"Ĝ":17,"ĝ":13,"Ğ":17,"ğ":13,"Ġ":17,"ġ":13,"Ģ":17,"ģ":13,"Ĥ":17,"ĥ":14,"Ħ":17,"ħ":14,"Ĩ":6,"ĩ":6,"Ī":6,"ī":6,"Ĭ":6,"ĭ":6,"Į":6,"į":6,"İ":6,"ı":6,"Ĳ":13,"ĳ":12,"Ĵ":6,"ĵ":6,"Ķ":14,"ķ":12,"ĸ":12,"Ĺ":12,"ĺ":6,"Ļ":12,"ļ":6,"Ľ":12,"ľ":6,"Ŀ":12,"ŀ":7,"Ł":12,"ł":6,"Ń":18,"ń":14,"Ņ":18,"ņ":14,"Ň":18,"ň":14,"ŉ":16,"Ŋ":18,"ŋ":14,"Ō":18,"ō":14,"Ŏ":18,"ŏ":14,"Ő":18,"ő":14,"Œ":22,"œ":22,"Ŕ":14,"ŕ":9,"Ŗ":14,"ŗ":9,"Ř":14,"ř":9,"Ś":13,"ś":11,"Ŝ":13,"ŝ":11,"Ş":13,"ş":11,"Š":13,"š":11,"Ţ":13,"ţ":8,"Ť":13,"ť":8,"Ŧ":13,"ŧ":8,"Ũ":17,"ũ":14,"Ū":17,"ū":14,"Ŭ":17,"ŭ":14,"Ů":17,"ů":14,"Ű":17,"ű":14,"Ų":17,"ų":14,"Ŵ":22,"ŵ":18,"Ŷ":13,"ŷ":12,"Ÿ":13,"Ź":13,"ź":11,"Ż":13,"ż":11,"Ž":13,"ž":11,"ſ":7,"ƒ":13,"Ơ":21,"ơ":14,"Ư":21,"ư":15,"ǰ":6,"Ǻ":15,"ǻ":13,"Ǽ":20,"ǽ":20,"Ǿ":18,"ǿ":14,"Ș":13,"ș":11,"Ț":13,"ț":8,"ȷ":6,"ʼ":4,"ˆ":14,"ˇ":14,"ˉ":14,"˘":14,"˙":6,"˚":13,"˛":4,"˜":14,"˝":13,"˳":8,"̀":0,"́":0,"̃":0,"̉":0,"̏":0,"̣":0,"΄":13,"΅":13,"Ά":15,"·":6,"Έ":14,"Ή":19,"Ί":8,"Ό":19,"Ύ":16,"Ώ":19,"ΐ":8,"Α":15,"Β":15,"Γ":12,"Δ":13,"Ε":13,"Ζ":13,"Η":17,"Θ":18,"Ι":6,"Κ":14,"Λ":14,"Μ":21,"Ν":18,"Ξ":13,"Ο":18,"Π":17,"Ρ":14,"Σ":13,"Τ":13,"Υ":13,"Φ":19,"Χ":13,"Ψ":19,"Ω":18,"Ϊ":6,"Ϋ":13,"ά":14,"έ":11,"ή":14,"ί":8,"ΰ":14,"α":14,"β":15,"γ":12,"δ":13,"ε":11,"ζ":11,"η":14,"θ":14,"ι":8,"κ":12,"λ":12,"μ":14,"ν":13,"ξ":11,"ο":14,"π":15,"ρ":14,"ς":11,"σ":14,"τ":11,"υ":14,"φ":17,"χ":13,"ψ":18,"ω":18,"ϊ":8,"ϋ":14,"ό":14,"ύ":14,"ώ":18,"ϑ":14,"ϒ":13,"ϖ":20,"Ѐ":13,"Ё":13,"Ђ":17,"Ѓ":12,"Є":15,"Ѕ":13,"І":6,"Ї":6,"Ј":6,"Љ":22,"Њ":22,"Ћ":17,"Ќ":14,"Ѝ":18,"Ў":14,"Џ":17,"А":15,"Б":14,"В":15,"Г":12,"Д":16,"Е":13,"Ж":20,"З":13,"И":18,"Й":18,"К":14,"Л":16,"М":21,"Н":17,"О":18,"П":17,"Р":14,"С":15,"Т":13,"У":14,"Ф":19,"Х":13,"Ц":17,"Ч":16,"Ш":24,"Щ":24,"Ъ":16,"Ы":20,"Ь":15,"Э":15,"Ю":25,"Я":15,"а":13,"б":14,"в":13,"г":10,"д":13,"е":13,"ж":17,"з":11,"и":15,"й":15,"к":12,"л":13,"м":17,"н":15,"о":14,"п":14,"р":14,"с":11,"т":11,"у":12,"ф":17,"х":12,"ц":15,"ч":14,"ш":21,"щ":21,"ъ":16,"ы":18,"ь":14,"э":11,"ю":19,"я":13,"ѐ":13,"ё":13,"ђ":14,"ѓ":10,"є":11,"ѕ":11,"і":6,"ї":6,"ј":6,"љ":20,"њ":21,"ћ":14,"ќ":12,"ѝ":15,"ў":12,"џ":14,"Ѡ":24,"ѡ":19,"Ѣ":16,"ѣ":15,"Ѥ":22,"ѥ":17,"Ѧ":16,"ѧ":13,"Ѩ":22,"ѩ":18,"Ѫ":17,"ѫ":15,"Ѭ":23,"ѭ":20,"Ѯ":13,"ѯ":11,"Ѱ":19,"ѱ":18,"Ѳ":18,"ѳ":14,"Ѵ":15,"ѵ":12,"Ѷ":15,"ѷ":12,"Ѹ":29,"ѹ":25,"Ѻ":19,"ѻ":15,"Ѽ":23,"ѽ":19,"Ѿ":23,"ѿ":19,"Ҁ":15,"ҁ":11,"҂":14,"҃":13,"҄":13,"҅":13,"҆":13,"҈":23,"҉":22,"Ҋ":18,"ҋ":15,"Ҍ":14,"ҍ":14,"Ҏ":14,"ҏ":14,"Ґ":12,"ґ":10,"Ғ":12,"ғ":10,"Ҕ":15,"ҕ":12,"Җ":21,"җ":18,"Ҙ":13,"ҙ":11,"Қ":15,"қ":13,"Ҝ":14,"ҝ":12,"Ҟ":14,"ҟ":12,"Ҡ":16,"ҡ":14,"Ң":17,"ң":15,"Ҥ":19,"ҥ":17,"Ҧ":25,"ҧ":20,"Ҩ":18,"ҩ":15,"Ҫ":15,"ҫ":11,"Ҭ":13,"ҭ":11,"Ү":13,"ү":12,"Ұ":13,"ұ":12,"Ҳ":14,"ҳ":13,"Ҵ":20,"ҵ":17,"Ҷ":16,"ҷ":14,"Ҹ":16,"ҹ":14,"Һ":16,"һ":14,"Ҽ":20,"ҽ":15,"Ҿ":20,"ҿ":15,"Ӏ":6,"Ӂ":20,"ӂ":17,"Ӄ":16,"ӄ":13,"Ӆ":16,"ӆ":13,"Ӈ":17,"ӈ":14,"Ӊ":17,"ӊ":15,"Ӌ":16,"ӌ":14,"Ӎ":21,"ӎ":17,"ӏ":6,"Ӑ":15,"ӑ":13,"Ӓ":15,"ӓ":13,"Ӕ":20,"ӕ":20,"Ӗ":13,"ӗ":13,"Ә":17,"ә":13,"Ӛ":17,"ӛ":13,"Ӝ":20,"ӝ":17,"Ӟ":13,"ӟ":11,"Ӡ":14,"ӡ":11,"Ӣ":18,"ӣ":15,"Ӥ":18,"ӥ":15,"Ӧ":18,"ӧ":14,"Ө":18,"ө":14,"Ӫ":18,"ӫ":14,"Ӭ":15,"ӭ":11,"Ӯ":14,"ӯ":12,"Ӱ":14,"ӱ":12,"Ӳ":14,"ӳ":12,"Ӵ":16,"ӵ":14,"Ӷ":12,"ӷ":10,"Ӹ":20,"ӹ":18,"Ӻ":12,"ӻ":10,"Ӽ":14,"ӽ":12,"Ӿ":13,"ӿ":12,"Ԁ":14,"ԁ":14,"Ԃ":21,"ԃ":21,"Ԅ":21,"ԅ":19,"Ԇ":15,"ԇ":12,"Ԉ":23,"ԉ":20,"Ԋ":24,"ԋ":21,"Ԍ":18,"ԍ":15,"Ԏ":17,"ԏ":15,"Ԑ":14,"ԑ":11,"Ԓ":16,"ԓ":13,"Ḁ":15,"ḁ":13,"Ḿ":21,"ḿ":22,"Ẁ":22,"ẁ":18,"Ẃ":22,"ẃ":18,"Ẅ":22,"ẅ":18,"Ạ":15,"ạ":13,"Ả":15,"ả":13,"Ấ":15,"ấ":13,"Ầ":15,"ầ":13,"Ẩ":15,"ẩ":13,"Ẫ":15,"ẫ":13,"Ậ":15,"ậ":13,"Ắ":15,"ắ":13,"Ằ":15,"ằ":13,"Ẳ":15,"ẳ":13,"Ẵ":15,"ẵ":13,"Ặ":15,"ặ":13,"Ẹ":13,"ẹ":13,"Ẻ":13,"ẻ":13,"Ẽ":13,"ẽ":13,"Ế":16,"ế":13,"Ề":16,"ề":13,"Ể":16,"ể":13,"Ễ":16,"ễ":13,"Ệ":16,"ệ":13,"Ỉ":6,"ỉ":6,"Ị":6,"ị":6,"Ọ":18,"ọ":14,"Ỏ":18,"ỏ":14,"Ố":18,"ố":14,"Ồ":18,"ồ":14,"Ổ":18,"ổ":14,"Ỗ":18,"ỗ":14,"Ộ":18,"ộ":14,"Ớ":21,"ớ":16,"Ờ":21,"ờ":16,"Ở":21,"ở":16,"Ỡ":21,"ỡ":16,"Ợ":21,"ợ":16,"Ụ":17,"ụ":14,"Ủ":17,"ủ":14,"Ứ":18,"ứ":15,"Ừ":21,"ừ":15,"Ử":21,"ử":15,"Ữ":21,"ữ":15,"Ự":21,"ự":15,"Ỳ":13,"ỳ":12,"Ỵ":13,"ỵ":12,"Ỷ":13,"ỷ":12,"Ỹ":13,"ỹ":12,"Ὅ":18," ":12," ":24," ":12," ":24," ":8," ":6," ":4," ":13," ":6," ":4," ":2,"​":0,"–":12,"—":24,"―":24,"‗":9,"‘":4,"’":4,"‚":5,"‛":4,"“":8,"”":8,"„":9,"†":12,"‡":12,"•":9,"…":18,"‰":28,"′":5,"″":9,"‹":7,"›":7,"‼":11,"⁄":3,"⁰":8,"⁴":8,"⁵":8,"⁶":8,"⁷":8,"⁸":8,"⁹":8,"ⁿ":9,"₣":13,"₤":13,"₧":18,"₫":14,"€":14,"℅":19,"ℓ":12,"№":24,"℠":19,"™":18,"Ω":18,"℮":14,"⅛":18,"⅜":18,"⅝":18,"⅞":18,"∂":13,"∆":13,"∏":17,"∑":15,"−":13,"√":13,"∞":16,"∫":9,"≈":13,"≠":13,"≤":13,"≥":13,"◊":14,"ﬀ":16,"ﬁ":14,"ﬂ":14,"ﬃ":22,"ﬄ":22,"\ufeff":0,"￼":24,"�":24};!function(t){t[t.center=0]="center",t[t.left=1]="left",t[t.right=2]="right"}(n||(n={}));var p=function(){function t(t){this.gl=t,this._font=new Map,this.init()}return t.getInstance=function(t){var e=t.id;null==this.instances&&(this.instances=new Map);var i=this.instances.get(e);return i||(i=new this(t),this.instances.set(e,i)),i},t.releaseInstance=function(t){var e=t.id;if(null!=this.instances){var i=this.instances.get(e);i&&(i._font.forEach((function(t){return t.destroy()})),i._font.clear(),this.instances.delete(e))}},t.prototype.init=function(){var t=new s.FontSDF(this.gl,l.FontConstant.fontSize,.18,"Arial",400);this._font.set("normal",t);var e=new s.FontSDF(this.gl,l.FontConstant.fontSize,.18,"Arial",600);this._font.set("bold",e)},t.prototype.createCurvedText=function(t,e,i,s,f,p){if(void 0===f&&(f=!1),void 0===p&&(p=n.center),null==s||s.length<2)return this.createText(t,e,i,200,1);var d=this._font.get(i);if(!d)return console.error("Can not find this Font to create text: "+e.text),null;var g=[];if(f)for(var y=s[s.length-1],m=s.length-1;m>=0;--m)g.push(new u(s[m].x-y.x,s[m].y-y.y));else{var v=s[0];s.forEach((function(t){g.push(new u(t.x-v.x,t.y-v.y))}))}s=g,g=[];var _,b=this.gl,w=[],M=e.text,x=e.size,T=this.measureTextLabelLength(e),A=0,L=9999,S=0;for(m=0;m<s.length-1;++m){if(S=s[m+1].angleTo(s[m]),L<9998&&Math.abs(L-S)>l.LabelConstant.maxCurvedTextAngle*l.MathConstants.deg2Rad)return null;L=S,A+=s[m].dist(s[m+1])}if(A<T)return null;switch(p){case n.center:_=.5;break;case n.left:_=0;break;case n.right:_=1}var E=(A-T)*_,I={x:0-T/2,y:0},P=[],C=[],O=null;for(m=0;m<M.length;m++){var R=this.normalizeCharacter(M[m]);if(z=this.drawGlyph(R,I,d,x,0,null,!1)){var D=z.centerX;0!=m&&O||(O=D),C.push(z),P.push(D-O)}}var k=d.tinySDFGenerator.buffer*c.MapUtils.pixelScale,B=[];for(m=0;m<P.length;m++){for(var U=0,N=0,F=0,j=s[0],V=s[0],Z=P[m]+E+2*k;U+N<=Z;){if(++F>=s.length)return null;V=j,j=s[F],U+=N,N=V.dist(j)}var z,G=(Z-U)/N,Y=j.sub(V).mult(G)._add(V),W=Math.atan2(j.y-V.y,j.x-V.x);if(z=C[m]){var H=z.width/2,X=z.height/2,q=new u(Y.x,Y.y),J=new u(q.x-H,q.y-X),Q=new u(q.x+H,q.y-X),K=new u(q.x-H,q.y+X),$=new u(q.x+H,q.y+X),tt=(J.x-q.x)*Math.cos(W)-(J.y-q.y)*Math.sin(W)+q.x,et=(J.x-q.x)*Math.sin(W)+(J.y-q.y)*Math.cos(W)+q.y,it=(Q.x-q.x)*Math.cos(W)-(Q.y-q.y)*Math.sin(W)+q.x,nt=(Q.x-q.x)*Math.sin(W)+(Q.y-q.y)*Math.cos(W)+q.y,rt=(K.x-q.x)*Math.cos(W)-(K.y-q.y)*Math.sin(W)+q.x,ot=(K.x-q.x)*Math.sin(W)+(K.y-q.y)*Math.cos(W)+q.y,at=($.x-q.x)*Math.cos(W)-($.y-q.y)*Math.sin(W)+q.x,st=($.x-q.x)*Math.sin(W)+($.y-q.y)*Math.cos(W)+q.y;w.push(tt,et,z.textureX,z.textureY,it,nt,z.textureX+z.textureWidth,z.textureY,rt,ot,z.textureX,z.textureY+z.textureHeight,it,nt,z.textureX+z.textureWidth,z.textureY,rt,ot,z.textureX,z.textureY+z.textureHeight,at,st,z.textureX+z.textureWidth,z.textureY+z.textureHeight),J.x-=k,Q.x-=k,K.x-=k,$.x-=k,tt=(J.x-q.x)*Math.cos(W)-(J.y-q.y)*Math.sin(W)+q.x,et=(J.x-q.x)*Math.sin(W)+(J.y-q.y)*Math.cos(W)+q.y,it=(Q.x-q.x)*Math.cos(W)-(Q.y-q.y)*Math.sin(W)+q.x,nt=(Q.x-q.x)*Math.sin(W)+(Q.y-q.y)*Math.cos(W)+q.y,rt=(K.x-q.x)*Math.cos(W)-(K.y-q.y)*Math.sin(W)+q.x,ot=(K.x-q.x)*Math.sin(W)+(K.y-q.y)*Math.cos(W)+q.y,at=($.x-q.x)*Math.cos(W)-($.y-q.y)*Math.sin(W)+q.x,st=($.x-q.x)*Math.sin(W)+($.y-q.y)*Math.cos(W)+q.y,B.push(new h.Vector2(tt,et)),B.push(new h.Vector2(it,nt)),B.push(new h.Vector2(rt,ot)),B.push(new h.Vector2(at,st))}}var lt=new r.Model(b),ut=b.createBuffer();return b.bindBuffer(b.ARRAY_BUFFER,ut),b.bufferData(b.ARRAY_BUFFER,new Float32Array(w),b.STATIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,null),lt.arrayBuffer=ut,lt.numOfVertices=w.length/4,lt.attributeInfos=[new o.AttributeInfo("a_position",2,0,4),new o.AttributeInfo("a_uv",2,2,4)],lt.retain(),new a.TextLabelData(this.gl,t,e.text,d,x,T,x,l.MapConstants.none,lt,B)},t.prototype.createText=function(t,e,i,n,s){var l=this._font.get(i);if(!l)return console.error("Can not find this Font to create text: "+e.text),null;var u=this.gl,h=[],c=e.text,f=e.size,p=this.measureTextLabelLength(e),d=!1,g=!0,y=Math.ceil(p/n);(0==s||s>y)&&(s>0&&(g=!1,d=!0),s=y);var m=n,v=n;1==s&&p<n&&(v=p,g&&(m=p),d=!0);for(var _={x:0-m/2,y:f/2-f*s/2},b="",w=1,M=0;M<c.length;M++){var x=c[M];b+=x;var T=!1;if(" "==x){for(var A="",L=M+1;" "!=c[L]&&L<c.length;)A+=c[L],++L;var S=this.measureTextLength(b+A,f);if(w==s&&m<S&&m-S<3*this.measureTextLength(".",f)&&!d){this.drawGlyph(".",_,l,f,m,h,!1),this.drawGlyph(".",_,l,f,m,h,!1),this.drawGlyph(".",_,l,f,m,h,!1);break}S>m&&(b="",T=!0,++w)}this.drawGlyph(x,_,l,f,m,h,T)}var E=new r.Model(u),I=u.createBuffer();return u.bindBuffer(u.ARRAY_BUFFER,I),u.bufferData(u.ARRAY_BUFFER,new Float32Array(h),u.STATIC_DRAW),u.bindBuffer(u.ARRAY_BUFFER,null),E.arrayBuffer=I,E.numOfVertices=h.length/4,E.attributeInfos=[new o.AttributeInfo("a_position",2,0,4),new o.AttributeInfo("a_uv",2,2,4)],E.retain(),new a.TextLabelData(this.gl,t,e.text,l,f,v,w*f,m,E)},t.prototype.drawGlyph=function(t,e,i,n,r,o,a){var s=i.metrics[t];if(!s)return null;var l,u,h,c,p=i.fontSize,d=n/p,g=i.tinySDFGenerator.buffer,y=p+2*g,m=p+2*g,v=p/2+g,_=f[t],b=s.x,w=s.y,M=!1;return y>0&&m>0&&(l=e.x+(0-g)*d,u=e.x+(0-g+y)*d,h=e.y-v*d,c=e.y+(m-v)*d,o&&o.push(l,h,b,w,u,h,b+y,w,l,c,b,w+m,u,h,b+y,w,l,c,b,w+m,u,c,b+y,w+m),M=!0),e.x=e.x+_*d,a&&(e.y+=n,e.x=0-r/2),M?{centerX:(l+u)/2,centerY:(h+c)/2,width:u-l,height:c-h,textureX:b,textureY:w,textureWidth:y,textureHeight:m}:null},t.prototype.measureTextLabelLength=function(t){for(var e=0,i=t.size,n=t.text,r=i/l.FontConstant.fontSize,o=0;o<n.length;o++){var a=f[n[o]];a&&(e+=a*r)}return e},t.prototype.measureTextLength=function(t,e){for(var i=0,n=e/l.FontConstant.fontSize,r=0;r<t.length;r++){var o=f[t[r]];o&&(i+=o*n)}return i},t.prototype.normalizeCharacter=function(t){return 208==t.charCodeAt(0)&&(t=String.fromCodePoint(272)),t},t.instances=null,t}();e.TextLabelFactory=p},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=i(13),o=function(){function t(){}return t.get=function(t){return(this.images[t]||[null,null,null])[r.MathUtils.clamp(n.MapUtils.resourceScale,1,3)-1]},t.markerDefault="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTIyVDE3OjI0OjUzKzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTIyVDE3OjI0OjUzKzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0yMlQxNzoyNDo1MyswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxZDg1NGY4Yi1lYzEzLTQzZjktOWEwMC02OGYwYzRkNWYyODUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiODVkZWE1ZC0yYWNlLWExNDktYmI5MS01NjVjNGY5ZDdkZTAiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2MwZmJlYS1iODZjLTQwMDItYjcxOC1iYTI3M2MzMmY5NTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjgzYzBmYmVhLWI4NmMtNDAwMi1iNzE4LWJhMjczYzMyZjk1OCIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0yMlQxNzoyNDo1MyswNzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoxZDg1NGY4Yi1lYzEzLTQzZjktOWEwMC02OGYwYzRkNWYyODUiIHN0RXZ0OndoZW49IjIwMTktMDEtMjJUMTc6MjQ6NTMrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6UtMbgAAAC9UlEQVRYhcWXTYtcRRSGn7equ5OQheDCqBBcmJWoIEIMBoKMI6Kg/gFxI8YvBDWgLiKJ+UAiYsCFro0LxY2I4EdiJgYC0Y0wGDELESMEiVmIMmqc7qrXRZvEHqu67+0W5kAt+pzT5336nqrTt2Sb1bSwqupApxY4f+dmDCQlQgANAkEiw5zQPZJvN94EWgP+A8IZQjqBwxGZw9ngmMkZZOg7s3Hhq+YABbsV2C8xD47DxumfkK4AX0MOW4AdwDFgJ3ByUtGmLXiaoOMWdwNxQq4Mc4gjwDP/B8BzMceDgvVNSC9RwPqYw2vA87MAzHWIL017Tgx0iHuBO6YB6EnsB9ZOqX8RoxvQAWBdKVrdhClwXzRbqmXRr8BHOH8vsQl0F3BlKVfS5rXuzAMfNgaQfe/lXb4ihk8NiA9G8uJFX8Y3Cb0ruKEILO4vAVRbEOGWSmiQc3gcWFzh/zo6PQL8WaG+reSuAhhtrIQWbX0RknEaPqFOyvRSJmROYp8q63NtyT9uEJVj5pfQzQOl4QcHkQiAGPT6Dsvxt3Lj6Jac407Bz0WvuBmoPZ2rJW6sxH5qBWD720roKjL7+O8v6sV+91VgQ7Ee+qbkr7bADguSH6iEHzJcL3gdOA9sMDwMzFfrZZ1oBRCUDkP4ndoIFluNtmKwKl2/bEvgj4s6Y750WvbxSZWbmK0F4HQrgBxEChwE0qwAcn4zkIuxMXMADEcNn82o/6VD+NyhLDXp39BZPjCDeN/k3cCFWkKT94Fjtg5NJW/eAj4Zl1IF6CZfWtHpRSqDpK6tc3/lNfuW0zqWU4/l1GsHsMJ+NH6hJcAe4MykvDav5YfA7zUStz4A3miSO+YYji4Nz8Wz4B8m1PwO9KQMvdAfWa0AKnZWicds1Xb1hZzDU8DZpgWnuRl9atg7nBSjZrSLCbu+MUDOsbiSApiXbb09Im7eAV5pIw7tbkajejk8oZCvQ2yzOZpz3P4vmMY2y+V0KZvthvdNeBRYmqaIVvt6/je+DyExBbNQBQAAAABJRU5ErkJggg==",t.markerDefault2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTIyVDE3OjI1OjQ1KzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTIyVDE3OjI1OjQ1KzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0yMlQxNzoyNTo0NSswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM2MyYjNmMC00NTM4LTRhM2YtOTNhMC1hNDEyNmZjNGNjMTQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0MDZjOWM2Yy1jZDdjLWIyNDQtYTU3Mi0zNjQzOTllOWJkMTkiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiMDNkZGZjNC1kNTE4LTQxN2YtYjUzNi0zZDJjOGUyZjY3ODEiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmIwM2RkZmM0LWQ1MTgtNDE3Zi1iNTM2LTNkMmM4ZTJmNjc4MSIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0yMlQxNzoyNTo0NSswNzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozM2MyYjNmMC00NTM4LTRhM2YtOTNhMC1hNDEyNmZjNGNjMTQiIHN0RXZ0OndoZW49IjIwMTktMDEtMjJUMTc6MjU6NDUrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5Dm+KFAAAHV0lEQVR4nOWbXYxdVRXHf/91zp1pwUpDiDHSgKjBD2wVqdaPxAcVAkF84MUYCn4gNBGMogajoIEoMSRWsUpiLdqYEE0UtGnqR9FGCkUxRopofbCxEFpREpT2QdqZe87++3DbMm1n7pmz77lTE/6TlcmcWWvtdf77c+29j2zzQkbZ1uBfl5x/zN9FLSKVWEaIKfcpXFLPIDYEBQWCsyrqVYEukPRqo3OEXwK86LDqAeA/wBOyd1naqUgPW9pb9YEiEYi6hokiqMo+0Z8gDEbUqjlYV2hGfC//zc5uCcjAEsGlkt9veEtJvOwINeKE1rcEWAassPQ+AKf4h8QjwhsN2xkQ1BnGSUBZSKslXRew8sirZnS4M23OLEKXQbHL9jrw94CqiyCjCyezYFUZsTWkjZrx8iPDnCe0vhexzfitXbjsmACrVHwixDbBu7r1fQzeiXWfUnycEVtxlwQssrUhXNwBOrVDv3NhSdTFOg26w6JcJx2NAV4MbDBc0Y2/VriSQUVeAxxsazw6ASJA6+2T8vIAWL4CSMCHgbqN7chdwNZn0qAWTiqEr8Tc0NZuJAKiKt+uVHxxFB9dwUAh3bY4ehe2sRuFgKWyvgEsxIA3X0yEWCtYLIHUbJBNgOpiDbAy135cECxf1Cs+ODkJk5PN+pkE6KWRYk2e7fihFDdMT7N0aqpZtzUBURVEVVwEnJMR22x4DtgPPAv8twuHgnN7lJf35jHJtSagrwDrQzmBzYRhh/A1dV28se/eMuFlJFaAr7X181H9l9LqSauRgdYE9Or0esEFeWEB5gBmjeX3GO4CdjOo+eeAPaANti7FfBSPlPm9qRKvalJqTUCJVwIvzonI5pmUdDHwHWBoDzV8N6V4by4JgtP61G9u0mtNQKVYnhMQgMWXQQ+3MPmd8S1ZZQGTxPlNeu1nASuPALMzkr8dJJSMhuTIlklhXCRSsN7wx6wypfOaVFoTIHFWTiyGnyKmCOMAmGOVYhNORDr6e1r25pwyEWc3qbRPhswZc8U+DCEf0/SFCXw0czGQZJBP4Mb495FTKJzRpNCeADGP9dUJSHVV/PP4h/XAH+FETUGCWffMBPtCKdG+xTbGmtMC+jmVocKLjzczg8o2CYav3U/BWU2g36TQfhAUBzICCVMvr6g5IoOfCqtGEgJk47qmJFHMFPt1zDloDEXjFNqaAMO+tjYCElxyKNUcSjVTqaafEiBOPJcxqaypi4Gksobw5W3LPBzr0006GdOgd2cEQqniwkUTeoMxiyaCU4renPrldI9qShycAietUoqLWscJCP+tSad9C3DxWE4w4NOKVNxZKua9f1BKpxZ18S0yNz2dikebdDLSYT8CTLe3A1nvWBzlDwMNzSQNFGjZ4ijvEcrdc6gs/7lJKSMX6D8me29eTABcFnX8GrgaOH2W/58OXt2L4lfAxfnFaB/okSat1tNg4P21/FvQK/MCA8MrjO8qFF8AHgU/CfRDOjeiWG7UuIJrLMN+wEn7m/RaEzClSWRvCnnknWDB2TBjuerDTzuArXuHJhyH0T4XMGAeAEbpBuPG45Ie0jxerzUBk55i0tPPREr3ZoU2ZgionDYf9PS/p4ZvOQA5+wERVBHUwQ/o6Ii6YxzCxcbCBeGiUbn9nmAE/QiS9Afjn2WFOEYY7g/iTz2V9Jq3BDPGAJ4fpgzfZHAm9/8CG92pSByRJrQmoEg6KmE9aPNQVqhjgM0OYGsbm1EPR6cFa0f00R2krzKPFHgmurggsQWzrQM/o8HcD7Qek1oTkOTjpU7yLbRkvmNUlm+HVA+GpJkyHDn7AbPJDsymtr66gq3v2/zShuOlCa2XwmU9+1LV8q2Id4NmS3DGiQO2vmbnXXbJyQZnlZ6rXUrekBXFCEjWOlt/zbXP6AIaJrcDjTl4h9gN+vooDtovhSnnFKxnSb6ZhVkc9VOK65307ChOWnecXtNgbzZPU94tdFVuUPOB8d3I980n5R2GsVyVlf058N/H4RvA8HhCN/voSdIQacBYCJhI9VPYNzrrbnQjbPNZ6uIp1QVN0oRxXZYmnH4ip41d+60dGyv3flxTUM1DmjCW6/IGSpta6fOV4m0yr+3I8V/6aeJTfXqzfWuQhbG1AACjp22voeE2yDxR2fokcGDoRHycNKH9pmiLw2EnATzoSF+R8m56HEGyvmTHth59yg43osbaAp6vhXQbpC25fgxbGCyyjvF7UlrAZE5rTlSJuK4KrZDc7oaJ2ZMcHwN10Y1OwFhbwEwYPWl8Le2O1Q4aXY+1dywTKt3nAkMF2Aq+qUVxNxn9om2MbTDWQfAEJKhhbah+jYKrh6na2pBS3JFf2PywYF1gBoz5tGHO+4KWH07WjYxnJXkMMrbFR+kER0fmA+CrwLPdNtljxweM9o9eUvM548LMArOhZnelYnUKbRIsHTz0/qm06CN9957oaqXXhJPRBYDDn81a26l1zdGHSWtsbV/IOBbi2+E5Mbgixz3Gt4YF5kcLHsML/fP5/wG9iVkz0V9YmwAAAABJRU5ErkJggg==",t.myPosition="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gkbBDgFfaxCbgAAB0JJREFUWMOV122MHVd5B/DfOTNz7+7e3bUNduzYKDgkJqYiNkENsopaAYKELwiVEkAExIcWaBWpVUVIQFQJQhWUpIX2Q5F4kxAKLyIIVMGHBiMECFAgQHCCxOaNoCQOcbxgx3vv7r1zZ+b0w8yudzc0kEe6Gs3c8zz/55z/83aC7XJ9okbAguCVkl8IHlPom1cayMxL+shAUGGCNbkVpaFcJWiMBHOSgAYfCVvg2rdrEi/pTBSYYoSv4W3mlHZhN/qCptNN21wPm55TwRks+wsjP+5WZyixEz/D7aFT+uAmWxNBKUl6ggv0PVdjtnMrbQL6Y5J3cE+KTgkqsfu6LjeH7vU8frAgqfWtuVhtUaPpDIVnAa5zOGK/ZEHmNxpjE0EjdeQJ3p/aZaE7/hWLCgc7juvtoHkUFmfEXibkUQiok7Q2lYalZlo/jRqIoqnKQ3ZYUQtIGnJF52eDYEbhBZJ848u6hcBcT6xKze9/5JyHlU6qVdgrOmomHDY7NyMbTzXNVjcajVzmYmP3S8YqLJOrNqByled34BvqAVkmNBPN8KfOXf5yO275L3+zf9FF8z27Y5CNK2fvO+3em467857vOxMu1s9nZHUtbfIjSfpqBy16SG5qluAfU8vJvAOS/ZuiXAgMcnF4Wnn5IYPb3+7dz9vhVbOFvTEoNm8xJZPVqdP3LfvaO2/3lZ//ysr8BfqjSrPJiyTIBY9b8JgkBO9LMI9DHRkbMl+Iwwet/sd1rnjXlW4a9BwKpEklnDyneWqiidg5K+6bF/u5lJKwOvXAp+/yoX/+b3fPX2puOD2/KYQuIx7AKPizxOs9X7Kvi9wARSZMTyv/8x2O/v3LfLSfuxDNN5f4/N3C8YeEs2fa2Ni7mz8/IL35CNcelRAnld9+8idu/KfPO1Hs1tsUnAk9yaPmnAxuTH28SFhPjPbo00Rz5CKDH/6DT8/3HEZz4x3ird8lleiTdRp1ZaNKvPc13PJaDeKwtPSyT/jbX500DoWwOSAElcxSVJizjc+5QvQbk8+9yTWDogW/4X/FW+4gRIpB+6yb9hcz8lmKOW79Fjfe0ebVoHD4f671LvcYDXpb6G0DsjKIaoubo77IhNFY/eK/tOvS5/jrELjthHDrcXqDlqBpbUt4N4mqoU5ks/z7d/nGkhAC+xa9YvfL7RyVmjxuKdeNrHVgdkvg9URL1v71KscW+i4YV3z1nlal6cD+P2kSIaMp+eLdTBsW+g584S1ene42WpzZGuSmFmLL5vkTmC0EJ4wv2+Ny9E8NNXedbEl6JvB1qZvW4rceEh49q0F+4aKLPGzay7ZU1STTi+KW9iALglOamdxOOLumeXyZLP/THEiJPOP3Z3hq0qbffN9uJ1WbKNhwIW6v3AlasJr22KVn14VSx/L6eQcy1R+2EbUNZ0OqRnJANiwtw2Jf3LWLqm7T849JDG1a7t/TFigYV87aK9Zp23aDKgomNjlX1pKL9Z445xFUF+0Ur75EMiGLf5oDply5X9o7L2Jy32n3OmpmbWp7JZhEteFmA+fGmnCFwbVf9u2ViZNF5K1XEHukugN4BvDYcfDGI8zkDEtP/stxd7rM7LDcUpLJrEXBSBLXqasaadATl3/o7BPnfC8lXndYuv4V1GtkgTxudSQEiqy1UI7aavi2o1JKPPg7X//l950ZzMq2zQoBK1E7/W2hYVRqHDF4/W0+NZpaQvzo1Zr3XsV0lWqNpm4pySKpYTpqnzdcfb4Uj6aW3vFVX3FQf3W6bfdBKRplXvXBWi0X7LJpAioK8dSj1i7c44GXXOhYHi2+5lLNoX1MAyulMDxHM2XnIq97sfRvr5WuO3a+GX32Ljd/7rhHih2K+jx80s5ey+70u+ADCQYah7YPI+vt+OPXueKdV7pprnAohLYdPzHUnF3TNNjRFw8sdu2YsFo+Yzumze4HMAxu7gaSVc+T29/N+GGd20EuDp80eelhC595sze98LneMFfYE4L+FovJdG3q1GNP+c41t/nkvfcbze/R2zaQEETR48ZOthDvSTrIwoxLsNB5uBEpWSbUY3X6tcmRv7LrQ1c5dtkel8/kdjZJPSwt/3bFIzd8yfF7fuCpeNQg9sVtIxlEjRWFBwWVmuDvUnvlaAvyjNoLJT3bLh4xMFOIa2N1WrLmhLFTGjkOyBzUm3mpQd4TV8unDaXre6+sWZIbQzsTXt/V2SjIJGMLCpd0M8J27hSZMN8TZwshC0LqUrespXNjTdU8bSxfvxNNNB42Y0Xdfd0o8R9I7ZKmc6I2o3ZQ2qDj2dyINgNHRMmKsV+rTfS6i0nEx9ZvRr1OJZNUqI3xoMwFanu7FdWzAA7oaYyxrO9JPaUoKLZRC37ZqZXO35IylWMeF9yPJ7rsWP/3D53G+vdcUmk8qnS/fR5TKq1iJDndrTpxXmmrvH9T7y07SpKokKvMyyxIZtV6oqJzvZYpVYaSEYYmpk5LLhOMpQ1CPrwV8v8Ate8QCQydph8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDktMjdUMDQ6NTY6MDUtMDQ6MDCDT2HeAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTA5LTI3VDA0OjU2OjA1LTA0OjAw8hLZYgAAAABJRU5ErkJggg==",t.myPosition2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAACxLAAAsSwGlPZapAAAAB3RJTUUH4gkUBQweFUICFAAAD9RJREFUeNrVm3twXNV5wH/fuXd19ykJS3bAGNvIBhsD5U0gODhuHm1pSwLptBATpsFkOpOhbcqAY3AypdO4Ce6YtgmZTFsa2gKFdlJC0pLQhkDBuJDyKAzG2MYP2RgDlmTL2l3trvbec/rHOXd3ZWTprmwX8s1odHV1zznf63znex1hunCHgQgoAhVgBiAIeQwjQAfgIYwSIGSBHIY0kELhAx4G5WYzQIQhRKghVDGMIoyiqQEGATSgEARDCAiQcj93yLTImN6oWw34gGqgLngYUu5Zk8fQjSEPpLFfx2AO+304Lq04hUAVQxHDIdKUMBiKQICgHCNwDF/bPjntjbjdWClo97eHoB0hHaQYowehB8g69rR+HRM81ZqHf6da5ioDBxAGEUI0VjcUpjFKAX+WnKzkX95iLFnaySVeDHwMJ2LodXIw7ivTNoMnZ4q0MKMK7EcxgCEkxOpYBagDvcCfJFt66q/uMFDD7nfBSr2EoQNQzEQxG6vmkSP8WBE9GTMU4DlG7CNikAKGIkLgtCECDgB/Mzk6/lSrUXO/PUAjgCFHGsM8oMsRXXeEH2/icWsYt2YK6MOjhwr9KKqECL6zR7OSTTYxrDHNpSzf7V6L6HHE+9Cwxe8nGMBHCIHd5BmichhmBvjmxGiqI06raSp1DTgfQ8gpGBa4cR8E4nE4hBgEwwJGmMM8rD1QNC3HJIPHwx8Zq1jxwK3ARxCGOBXDTJrq/kEEA6QQBgjYxZA7iGOIgHXjUX8vbwLsfo9lfDYwRN8vAPE43OoYeqnSRw/CGLHxtmfUBAOacKuxnl3B/bwLFOiDY0e8pyClEE8h4mYzBiKNqWtMpI9ufgdNTZjFTg5gpR8f0i1HZPPpdmMlngfKDfM3B+HkoyFegMBHsilUXWPKFSJ9kJAiETXnJKVR5PHUCfi5DJ6vkEodXQsxZjqLjmfCPmq8iYcwG8OA+69zlprHoAYyQNW5tZpeYPZ0iRegEKA0UNpLdWwbNd2Fmn0hnb9yMSf2nUChENAhAsMVaruGKf10E4NvPc+IKqH1QoL8HNICFGtMRy/i7XASaSpEDPI2wqBz2cZpwBpj1aNC7MpkEM6g6e23xfdcgBKg/DIlo+HGG+j7wnlcuqCXSzoDFnZ49HiKXAtjdaQpj0UMjVTZvvMAz9/zEhu/94/sVArJnE3OaBitT5MRgsbjdYQKGtgL9AB3CdLw9ADeAeYCNRYDnbR51Ckgl8Ub3cFoVER/bw1Lrzid356ZY6kSgonZ1SKIFtCG6kCZjd/fxAM33clz/gz8zDwy5QrtmgnrJ8AhtrKV24CHsL5rCMIaYw3eQbfvhVnA/LaIN+D7SN5Hhp/m0C03s/jWj/HlWXmWt3wSARiDGBBjxs8tglG409wu7MVDB8o8fecT3LX+LrZ0L6OrFGLCENPGxoydpX6E/YBwIoa3QFhl7FKW/BSGJVhPIJnqG0ilkHQdU3yF8hPf4drLT+UWT8iaZlCktEYQ8KZAOjJ2hFI2qBLnkUSa0oZ+7lr+JR4snEuumkLq9baYYG2CYjPWNoAHwq3GBjgW0dnAnMTSd8R7VXTtIPU31nHbghlcC2gDRsCLNCiB+Mg7VIVtg9A/bJ8ButMwpwuWzILOoCkyre2xaSAS59e9McQDZ6xmXaobP0qj2mBCvBX2IezF2MSKcFtD0D6GM9uRvuchfogJh6jvXs83T+7k12JkjUE0VuK1EP59C/zzq/B0P+wvgqnTDKt9u+qsAiybD9edC796OnR4ViMUdosYqxHeWyP8ZN7NrPZ7SYU+EkWJDbW4VTcDY/bFahNL/0RgHgmPPQHyAar4PxTfuI81C3u4zhhCEXzt0FECP9oCa/4TNu0BMWBSVvW8Fq0wxql+BFIHo+DsubD2k/Cbi606xfPFa+wY4oGF1/P1wkUUSrXGJ8m0QNiD8A4gCh9DgGCzeonj+UIGr/gUhzbczTULe7jOQBQTrwTqEdz4CHz672DTXvAy4GVBfLtAZCDU9idygaf49hsVwKtvwpX3wI0/sBqkxDJCBN9AtKCHFRu+zTXFpxnpzOIl1IFY2D3kEDowHkvvAE0nhpMg2TmbSaHKe6jetpLTPn8R65QQCIg2iBIYKMMV/wA/fBH8jJW4NiQSkzYWQ88HLwUvvgFP7oErz4B8h/2/Esuv2V1c6M/k6cc2sD/TS0eYbCsYoIMxRggZUy7s7SSh0yNOFRkh+vLH+ENf0ek0WJRANYSr7oONWyBVgDAh4YdDrCGpAvz3Vrj6fqhFbhvY3RT5ivzvLeMmKug2sjFxRqkbQDEKCAUSqn82QJU3Ub73Vi6emeeXcdY+dtr/4EewcatFvB61T/jhUI/sXM9sgd//oaPANPwE86E8n3joKywdfYVSLpgs8h8nQw3k+Q9QpElj/aIp1V/c4gBXnMkKt6F0fNQ9shn+9lnwcseG+FYmeDk79w8227Uiu1U0wPJF/BamrSysjXw+RUahyJIkN4iN6kbfonrTdZzam+My91p5CsYi+PrPLAZHEcEdEWL38E8ft2s5h0oB9Ob46E2/S195L9XAT+waeRiyCkOudY3JIJNCsZ3a5y7gMiVkDETaJkp5dCu8uAe8junt+alAG/AC+N89VgsAtLa2QAnpa87jUrZRy6YSbQOLoZBVMGGQMiHUNYYCasEMLmy8dPx+8BVAN8/24wHiUH940/i1AU7r5cN0443pthQwrZBGnmRS1D0FpQpR94V0FgIWOj6KJ9alfaofSDmH5jhBZFMcPNVv1/SsYyQAhYAF3RdQKFWIvKl1IA78UspOOTWkFMJBwqvPorfDsykF7Zi2ZcC6t9YuHz8GxAHMu0UbT7hXAtDh0fvZs+jlIGFKJbYDflxhmRJtTyGUiOZ1k/eUzbXG3H/zEFB3Ejne9NuYjv5h987h4CkK82dQoEjkJWOAscMSnhwiQBXdnSFgfMmE4So2ufD/kC8WF87EkWQLMRQ66KCGbgMPlcRijl9pAhEfT6m3zZw2IS47JyM8QBXHbBhJi+Z0uw6Ao0nhJgXjovru9HjaATNcoUYa1QYeRtGs+04KkT0Cvf4DFCNNEWyMDjC/m8YJcDx3QRxFkoJTutw7h0OkKe0+SIk8XpTsKBQgUq6oOCXUNYYT8P91E4NjEYNuBgNwei98qJCUlUfLAZs4WTzTvlIOh7GIwYdfY5Bu/HpyX6Cu0I0EyKSDIg35DN7wixSLNXbE3I8MdKVtJic+CY4XxCfAsvl2zch6LwZgpMr24RcYyWdtGm4KiP2eMYVQnfJzBx0KYZjojSF+Pm4q4OqzOG5xQGMpF8hee874tQF2HOAFiug2fAAw1BSaUffnlANH62hOJ3joJZ7VhqqA57K3XLUEzpsLUc3lC44xKIFoDM6fC7++yL1TNhTXhsqDL7GRhQSVZMWTGMOyIkU5qR2ohZjcHNJ3/z07B8tscK91ZGwC82ufoOmaHWOI44CvfdwlSy2ZGmCwxMa772dX9mTStTCxEoYYRhU+VQxVmDqKagQMAk9u5fvuUXkuX3fVEvjipRCVIeVNNVtySHl2zi9eCp9Z4iJDZdc2wI9f45/A+gEJqbeNVnWqypXFSiRMiZVr6Ow55K+5k2feLfE4Lj0VOyHf/jQsXQz14rFhQsqzc31kEXzrSvvOERoBMlDiiS/8OT/PnUVuNFkR1VoSoUhgH0AxTMKUmIm5lEH99VPcHWpKruBjtIHAg4evswjXizbamI5NUAK+2DkuWwyPfB7SvssMuzRcqBn5y//ir+jCi5OpCcCmxAyHEFDUgTFKwCgJtgFApYbuWkj2j9ez5bl+1jvG6Dh1PTMHj6+ElZdDWAE95ghSVnpyBKzEfeMpOyaswcpl8LOVds445R6nwp7r5y++sZ4tnfPJJDR+OBrLBJRQINzuCiMRJyLMJWFZrFEYeZ7i9vv46oIZrJioMPJvW2DNT+HVPSA6YWFE4Ky5sPZTcOURCiPbh7j/tOtZO43CSAphN8YWRoTVjaEdwBJsfrCt0lg0RL2/WRoLXZa4URobi+CxbXD/yzaZsb+IrT+1lMbElcYunw+/80vwG4sg8Ccuje0b4SfzbmG1N2NapbE6wmvx6rY8HrkObMMcbIG07eJofZjw9TtZddoMVjih6kZxVDUnG6nB5v2w95ALo7Fe3bxuWNRrn2OtiK29qzcKoHYc4MHTVvGN4ARS0yyO7gX2YX1II3zVtPrwKfRRlMdfpvzkd7n2o/O42SVNYts07fK4FT4qMpQ39LN++Zd4sHDOUZTHhc2IK49HsRG0RTFBU0fzNu20xgjU65iKj3RfQmH5DTzwlUdZMVDmKYe8JyBKESkhMgYdGUxcF2ypDxpt0EqIlLISd2PV/jJPrn6Uzy1fyQPdH6ZQ8dsmPj763sZQRyN0WTHbBgkf23b8GeBbwEIWYfuA22+RyeBVdlMJDxB+ZzWXfPZMVszMcZkS0hMMmaxFpjZQ5pkfb+NfbljLM14BlV1Atjw67RaZEU5iCw8DS51uBfHCNxsYxnYDWpQyqGk2SQHZFEoEKq9S1gZzw/X03XgBl/XN4KLDmqQaN0YaTVI1tu8Y4rl7X+LZe+5lpwjkziVvsE7YNPxse+4rXsdQAccODayVlulWuU6xyIXGml6Evna1oBUKgXVVS3upqu3UdB518sV0fvJMek/tJt+dITAGimOM7TpA8bFNDO57gRF1CK1Pt21yCtsmN80o00rfsBMYBNdJbmj0CY5vlKxjGyUr7lTQnIJMv1cwXiDwkUwKFWpMeZRIDxNSIqLqnJcARQFPdePnsngphYweq0ZJeIuQvSiEHgzDjOsZfm+rbAnbNZbGPnf8wrbK+sAgPrug5W7RYVdq3kvQ6vjgAoaAUxDK9GEvonzQm6Vj4lMYBonYQQ7bBxkHZoddrHqv7x+HRAY4AesuVNnpumyT+wfvL/EDjLCTc8GZPUvX6HsHHFmacfeYwdqFV4H5zHE2Ib4N9kHRhlhnFfA2r/Mm52CP9hjDOydG1Z90yljWRaAPEPaiqcAH8MqMzfDsAoZYjFBx2Lt64pFgauRXmVZvwN4bgjSG+dh+4vdLG1qlfgjFbqDaOMbjL9ZNjtbU8f8wzVZacf2VEVV8tiLsonl7a8rU+jEkXLB7vY5hFz7bON8RH2AISNjz0u7FyTzNS3Ka+FKSj2Ym9pJa3Gt0PC9OCrbLcxDhHRThOIc6boFKeHu0PQRXmfHdBLG6NS9f9GKYAQ0391hfnR3FMITHECnq7labje2k5at17YWI7cMaQ6NE6jskahiy2MbrMfJAl2u/O/rL09YlG6ZGiarravIblzhj2w93Ty9QmB7c4VznOk07bFxa5SD2+o0gpAjwyAJZd30+QBp3z2MbZNs1DSGGOh5VNKNoygg199amaorYC9vxTbB4/Tak3gr/B00sppUy/FK+AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA5LTIwVDA1OjEyOjMwLTA0OjAwxqW7kgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wOS0yMFQwNToxMjozMC0wNDowMLf4Ay4AAAAASUVORK5CYII=",t.logoIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAACdCAYAAABCWoqsAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAFxZJREFUeNrsnU1y20iWgNOK2rd6PxFNn6DoE5iKmL2lE4g6gaTFrCWtZ0HpBKRPYHo/EaJPINYJzI6Y/bBP0IMnPZRZFAECifwFvi9CoZ4ai8xMAPnh5c9LYwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgV3ygCfzzH//1P+Pi16j4kd9/099Gf58e+fOV/t4WP38UPxv5+d///s8VLQsAAAjdn7xF0JPi57MKe+Lx6zYq/B/yu5D8hisAAIDQwV7iEn2fFz9fPAu8qeC/F3JfcmUAABA6NIvEp8XPpfk1hJ4SMkQvUn8q5L7migEAIHT4q8gnKvFpRsWWyP1BBF/IfctVBABA6EMWeRmNTzKuhsj8qfh5ROwAAAh9aCKXufGZeVul3jVKlp8f+n+vSslWDYnr6vhyFXz5IvFZy9KlPIgdAAChD0bkItC7DhH52vx1BfrWcfl2V9PLb5t5/FexF2W754oDACD0von8VCPyqcWfyyK07ybCXLWWu1xpf24xenDF3nYAAITeF5mLCOfmeLKX/Uj8ySS04GxH7tctI/elip1heAAAhJ5tVD5vGdkuTAZbwnQe/rrFiIPI/IJoHQAAoecmcxHeN9N8kZmI/CG3rGya/OauhdhlwdwtjwgAAELPQXI35m2+vLci7yh2GX04YwgeAAChpyy2eQup3fZtCFpX8cvLzLE59q1KnWxzAAAIPSmRyXy5DLFPGohMIvLHnrfHjUbsp0fa4or88AAACD0lmT83iEpXKrDNQNplpC85x9pF2mTBYwMAgNBzkPnDUBOtFG10r9E6UgcAQOjZypxhZdN4Lz5SBwBA6EnKfK2SYuGX+XMr3/xImyF1AACEnpzM2Zpl13ZIHQAgEU56Xr9j27KQeQXaJmfaRlXM9VhZAABA6N4izHtTv898hcyROgBAX+jlkLsu7PpGZO6sPRl+BwBA6MHlMyp+vZjqVdrIHKkDAPSOPg6512252iBzO3aG3zd1bc/wOwAAEbqLKPLeVCdGSSYnuW4Lk5eOSU1ZpZyb1LLVadmfTf0+9du+p8wFAEDo/kQzKn79rPknUYaDdahaxP3FvA1Xjy0+ZqWC/57CITEahc+P/LNFUdYrHjEAAITeVjLPNRFv8LO9VXoi8XPHHy3Ru2Sz+xpT7kX9ZEvgDVIHAEDooSLGYIvgNBoXyV0WP6MAVZe6PUUceWiSGx+pAwAg9MZikaH2qjndTyHmzXX+/trUzy37YmPephRWgdteZP7S4J8idYAeov3vS4cA5iyFacS+8FsP6nBTI9EH3zIvbuiJjg6MIraBfPdzURYZir8NtZBO2rb4zgdz/IS2afHvTF+kXtSly/XexGgHnSIZd7jWZ3SXcIC7GH2fTrH64sdOoLTJ6YUj6wj9SHS+0eh86/H77xvILDRBT41r+Ybei0j9yHqNJnwKuduiwYLRJkIfzFHL0Pi+OpbAy1uEXnz3vwNXd6WiX6Z8iFfu+9DrovNbXzIXiWmnfpdgm0h7fNMoMkSULm3cdMHhNFS5Euc68PdNaXLw8CI/pGd5ov39S1H3nxLM6YsyQnd4Q1V1jCtfEerOvPEk8SYSeT5rO/mW+lLfYJF68zYIudbiEgWBY+oSePWdkcpdxD5PSew5R+i1c+ceZf5s4s6Xt32rfA4kjzZtjtQDRc26A2RkANzdU9L3ntMSfz7HLzr9itA9RB0rH4sYGmZIS5FxCKlrm7dp96FL/TrycwJg0w+W0Sn8QvrWu6JtXtQTCL3lTXVeE3U8ePi+13lpk+8QU/kyklKUPnSpj3SHhO/Od2IA3JFzPxgqeJoidDdRx9rTFoOchtkrbzbf8tS2b7sCdMhS9x09XxsAdy+I96bD1scBRevRDqk6yfCmkgarmr958vB9sx7dxNMAN9qTZbmGKHXfi+OmBsBNPyh9IEPtzYki9Rwj9CqZb12nQNUh0Zue3Wgzn6sy9RrYbBccrNQ9dcBTw9AouAuivtESVlIPungwx0xxVcOUPrap9VEw5f5Rn5m/lpaimmokMKQz62VY/DHgc5Ji5Hd64MVw1XNJTiqCkhSTlkTJBtcjqa9DZe/8LbOHoO4M8SfH33Xf45t4IhGcx0NdnjpEnuXCkqFI/XVxnEuBpbwYTssmUcuXujJKqmDzlu1R2qXyZEHLKbGvx+59fdGYta1fVYpc/bxLrfP4SL2lrt/NW1ayTeTrJdeqL6OUcs3/eeC//77zUjly3O+XoxufEPoBEVX8943LN9sjSWv6gmyzWPqQpuZ433R4MIYm9WvTbstfk89LMRK/bvmiN9J/P9X76eGAiMcWLy8/GnbEEwf1nmiE2+azJvoj02MrrfcqwjXrWza4RkdO7wSO5fHXXaeuZEHyTfHdj74rmNsc+peK/+56uP3GhJ9/DC2ukec3767XJMj++UQ4d7yuYZpKxTRNskS6Lx3LJe0zD5X90GG9u+b9n+hz8C1CvQeZDU6CCMl+KedOFD9/N2+prbv2z3chrl9uQp90eONOPTpfRfhOn/OsLq7JkKQ+dXT/TlPphHeSMd047gN+xk7g0aAPcV3v85D1tswG99DHB1Mj648dg5RTE2DqIhuh60MyqmjwpeMHJ0aH+CPCd458ba1weE2GIvXLxD7Hlcx9COhU74nkpL4jc5/1PvdcB+ln225Rk4Vf9z2P2i/M2zy8Lde++7GcIvRxoMg21vyjrAHYRPjeLxmMOgxB6qOuHXUqi+ECpUku53dTuye+Gb95K8rTFMee69C2Xa/MANDjnxcdrp3Xl7GchD7xHdlqhxjrrX8TSejnHveluxx1GILUu0bX0RfDBU6TPDbpJX0K9UL17OO5tcwG95DyGeEeuDXtM2KGCKCyEvrvNZFtbg/joTe/WEL3WW/XD3nfpd715WqaQB0kah4Z8I3zZC+W2eB6PdRe0VdvVeq2z7i3/usksxvYtzS+RKpbWYd/Rvr+L57rhdQ9SzmFxXA6ZcCxmuEY6+I1F9fO9gXhaogNb3G6ZJDAMfshd8eJF2JF6FuPAoxWb49JMfos9cvAf+eSmYHQuNoOZZMNbmhD7fvYJjP7jNA9R4D6UMQSxI89sYfm1OM8uq8Hvq9Sb73zIIXFcFrmkYHgz67puB3KMhvc4IbaDwQstjt5vK37yELoNedGuxRgzMU1sSN047Ez9vmSkpPU27RD22j7LoHr4WpBnnSSsp9Ztgid6f9emvypqpeL62E9OtMhG9wgh9oPsErJNb9l3pguBTiOXQ9ZbKG5nGMwMX6S26w9R4+5pIltc2CN5NofNZmyOHKccNdyNJWCi9Xmkrzj4cA1XO3U88bkd4RniHq9bnm0jBhttv4Nfah9lx8W/RuL4ir4l8PPihnlbTq+8Q3lGtVJPensYeZtwWObTrBpxNsmEZJI5buHunWZv5cyycvYbd0LmSb2uDdvh1zkkN8/dL1aL2y1zAY3+KH2mr67TduPhiz0USbllA5bhtJkS8OiqZwtFo9t9bMfd75r07HsnzN/sJLNHrZDm0U0TaPoNkPdroZ4340odPjbszYHj2hkeJbB/Whbr22Ia2CZDU5gqN2B0H05LXehbxIrZ7mPU96W5WQfeag/6Nv3hcp+tVfu/ahtPxnLSoX9oA/83/XAgAuNfssTrEY9u+G7SD3VtmgzJHp6bHGcxVD3d4/3vQ1WQ7f6NynnDe9SL1thjlre9zbJfxhqT5zc59BdyuIfjiOWyd7Rh+vdDl3nzsYHHqpVKf1Dkbue4nSvIj8d2DVq+n1JDsnqGolFi+j70tSnmWwTncv9tKxZYGpFh8/bdBm6lb8tvvsywRfZrvWSa7S2fEkaN3neLLPBMdSO0LPCR1KXQ2L/s3M3B4bkq4bpdhbP5CLyGLwOWya+OO67cbA4znIxnA9sheqiPEsT4ASrCPWSqRmblefjY99vmQ3OGIbas8DLkLt0QsXP/xU/P11HBJkibfCsZzlPWrZlGZH/1AcRmecr83LvaptRi6oovO2pgE+eqmQr9K+OXo5SfGHryspTv2ybDY6h9mqS6o99z6GPVGTzjnuFNz25+I3Fri9F84Ai33i8B5C5fRQ3rXh22gy3rz1m7bN9sVk7+IxVahfWRZn0Wtncy8cWttpkg2OovZ5xSvfuiaebWm7I3RWbU/O2rcg2z/OmRpCuCCmDUux1N8OLtluoN0BfeeR9Cz03mbeNlt8NrVsshntKrP6bRD8rpbI4jYgts8EJDLXX83tKhfE2hy5v4JLsw/w6F7k8x1eik6sEO+DQQ0qrI1HKkwmbRCPHUZAcZf76wtty4ZNE4wvL6LztiEBb/paA0EeJXNokn6EO2eDkHj3vEIg1inArkmltUhtVchhUrnwVxuuiOJW6vOHtztvIzSGLfWRe5nHAQn/Yj7r2BP9owi6Ay03oWcp874WtaSc7Lu8Pi8VwiwTb6DTRz+pTWXa5sSxbiPPmZzX9433KD7C+6Ni0q7e+1vs+dF0EdHXgxp/pXPKowWdUvdH8w2E5twGlttitk+43fil+z/bKcxvq5vQ4H+ljSCp3mdtEzdc7L8RtOhHfC8dsMgG6lERKiYRclmVkIHVsj53+ka3QVRYLc3guZqIiu0nkpg8VpT/sybyM1G52k4lou4V4yfBZ71MPZc1d5uUL26LFn5xrdN5muH3b4UQo39HN2MFnjBKs18jBZ5xa9m2sRA97naeWf+4reAqXKa5G6mW0/nLkIV8HEHqIbTCP5dzQnsxL5nsZwkJkxFp5/GyXUUsvZG55v8lzcteyPRcB6hAkVanHz3BNzHr9y0Ao5pZ/53VtQNDUrzVSLzv+F91zfbAhAgh95bkJtqWgK2T+TuqBovSvPj7U8RnzfZO5zZ70mxSuq6Oo8NLBd18meFlj1osIPUx0ft/hpcvrMxk8l/sRqQt3Gq3vN9gfFY07cVi2jWepP2n6z2mDN7zdSN1nlL7xmDTC1bXpncx38DUkvg6UDMT2O8ZdVk/rc59khN6lT9JRStfbe8GdzKVP7rL7aNEroTeUennG9WwnqUZVx+E6Svf1BiUyetQHdtbwb16l7jlK9znH6mK4vc8y93m/fQ30LHdZTGqVcEr/ZpbwNe1SL9uh3C3Z3LzLfNbh+rzK3PdWvGinrTWQuiBDjGW0XnWzfvZQLh/yuNWXj3JffpvOYWz8rXj3mXSk67Xpu8zLjGk+OuJFwGqsLP+uPB2vrfxmJq3V7YeCjFb12nlJGQe+BnD82sioy0/T/dwA7+uhoh6f2lDqpQSrhjkmGUhuo512W5mXPOtnuH5ofb8xdrk2vZe5x2h6GbjduiwmLUfjjt4rmg65zKCYOmW9xk3qpc/4NNI1gPfXRKaEblTkz6b7SPAiRKKc6KetidQ1U9CxoYyqm31UdSJVB1wndVl2kPmfkYy+4bl8gXnw+EAg83bRtMsh5O+Bn2E58nPb4f4u5bfUl5tVee01cpV76UsmIt+v14semfvdY722xu/UWV+4PNIv/a738Ni43W4bLKdIEsentpB6FecqYVflkYVrD4462a1xk5O93La0dXSzpRqdD03m5f22NPaLof5yv+nIV2hcpCo+L9ugIh1orkxLaXuq13JIz0vH6xCDYKnOkzkPvaPUL10KXcsjC9guTfe5uhTTXG6N//kcmyxKg5P5Dl8dCT1WpBY6VTH84uFIX3ZvAqRRLfrLf1v82VmKp+a5fC5CJnc6SanmGlnYRBdjT1mj+nrS0IPP6FyHE9u+CA1Z5uWedBd1f4pU/q1J71S3IfCYySEmQ0RGQW9DfuFJai1QNMCVpdTPPZRlbcJkagvJKsChOFNkbtcBdPz7TeStS3JfIZdwbHrYP/VJ5sEDwpMUW8JS6teeynJv+rMlRIR5EeB72mS6Qua/6Lra/Snycxvq/oI3rnhukHnyQreU+shl1rg9Lkz+aRW3IcSp16DpcDsy/+s933VP+jKROlwFvKc3CT5noWS+4qlJ7tpfxZJ50kK3lPqlp3KUkUfO4rkNNBzb9Bogc7dR+iqVudSG+SWc3NMJCj3ECMUi0k4GqHn+tD+Lel1OUm+lllKf+jpSUTvLs0ylfhXiRmtxpCAyr+msA78I5Cr1qxSlplHzlcd+ImoECO/Y6DU5SyH17kkOLdZS6tcey7FWqec0/B6y42uyDxmZ199jNklCkkwsovfdJ8dR9DaFSKhBvc8c13uTer0Hxlr71o8pXZOTXFqvhdSnNgcj9FDq0vF9CnWzNYzOkXkz2mZ6SzaxiD4vIvUHB1Gr3Msfc5g7dljvMmfEJ+bMk5D4o16LTym+XP2WU2uK1DX5TJ04yoxqtx7LIZm9ROozk2Y6SrnxLgLPqc4blAmZN4zw9GSnpi+mXxOvj1zz+6JOj/q8tEnYtNHRh6fc9lt3rPdar+uCZyY4G/2Rdv9Dr8Uqh+vwIcfWLh6QeQORfgzRATQsS0iCb5nQle3PyBxa3DNl8qFJzT2zjiXxBvd0lcQ/HPnckda7SuwrrTfPCgxD6A1FKm9UZwm9YPRS5lr/l5oOCplDjv2LF6ED+OQk14KruFY1/0TOsD0PWJbbyE1yFUnmN8gcAAChd+VYwpeZzwVye1KXebIY20nKZAaLCDIfmeqV7cgcAAChN5bo6xaWGqmLcGYBy7MILPXYW3hkquEUmQMAIPQQUp+GGnrfkfon4z8BTSnNKNvndKh9gswBABB6SKnPfWWQqyhPuVfdl9Riy1zmzO+QOQAAQg8tdRkW/hZqPt2z1JcxpalteGioHZkDACD0IFKXqHIWuDxSjo/GXVY52ZZ2EVmac/N+VTsyBwBA6EGlPtUMXKmUpw23sQ9lKNruvvh1jswBABB6ChK9KcQ0jVSeleVHXOm2uJgylza7Q+YAAAg9JanPY0hdM9ctWvxZ0ANWjsh8jswBABA6Uv9VpqanxpV7zKOe6qYr2pE5AABCR+oVUj82hP6UiMyfkTkAAEJH6tVlktzvdYvc7mKU64DMT5E5AABCR+r1ZVockfpcxYrMAQAAoWcgdTlkpkqUzyGz3CFzAACE3hepjyOUaWmqs8oFy3KHzAEAEHqOUr+qEOhzJKnXpYqV8nxD5gAAgNCbC/Q0stQ/VYweTIoyzT3J/FRfGJA5AECmfBh6A1REpsZE3Aeugn0273OmC7cus8ZVfBcyh6H3C6cVz9+xl/IVrQcIHam3kfqVi+xxyBwAoD+c0ATJDr+Xi/cOiXvWtUzIHACACJ1IPXy5ZO58eqBMkud9g8wBAIAIPfFIXct1KP+71XY2ZA4AgNCRenyp72eVa7WdDZkDACB0pJ6G1BcHpN5mO9sMmQMAIHSknq7Up8fS1h6Yh0fmAAA9gkVxRziyUO5jLCFWlOtC08gicwAAInRoGamfJlSud7nokTkAABE6NIvUowpSyyUL40b6nzbmbTvbFpkDACB0yEvq+6vX1/qDzAEAEDpkLvVkygYAAAgdqbeX+k/DqWkAAIODRXEW1CyUexV9rIVy5m2fOTIHACBCh1wjdRbAAQAQoYOfSP1bqHIgcwAAQOj+pN4mJSsyBwCATjDk7k6sVcPvCz1YxfX3yfeIzM+ROQAAIPQMpc6paQAAgND9S32isjU+pI7MAQDgEMyhO6aQ6sq8Pw1NmHadU0fmAACA0MNKfVEj9SkyBwAAhJ6/1Odtpa5z8y/IHAAAqmAO3TMq70ND7Vcq/SYy319oh8wBAACh5yJ1ZA4AAAg9H6lfFHJeInMAAOgCc+iBODKnPj4gf2QOAABE6JlF6luV9bri/4/MAQAAoWck9afi5w6ZAwAAQs9b6gaZAwAAQu+X1JE5AAAg9MyljswBAAChZy51ZA4AAAg9c6lfI3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMP8vwADhq0/mGNStUgAAAABJRU5ErkJggg==",t.rainTexture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAACACAYAAAAhzrj3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFZSURBVHgBrVNBbsNACATiQ2+2f5D+pP8/tS9JD5UaKTZTYCG2ayenrKJ4BMMA4zXRi87l9/bhT6mAdNRhG5lo4v+pjNCTSJflNJXOVDqWugBDtBiI+qVq1SuroF0fYMZt3A7mf9cCb7tUA1pAdik7P9fpfYmcCsx0RH4AJJYwoLbTM/KUAMKD2AFBh/WobVaxB2/KOyeLMERVl5TOyg96yckLvEUIKsZGdtfl1IuLzdCxkY3XGYeJU9DcQmtBFhHi1CFwjLLp5TMd2sJIMorD/htCh8H9SpnNOony9BAoQU7AbaBMSUXunEjRLlUAcL/nUZhtUZY+dGxtIwebkyzlIaWgbu0FzgdjKK3LXVEbOS5IRMzhc7iRNG6XwQdzY9rdiE35PnPtnqEgr/bSSsX9xr3qbNH2mqyAWwvADLew2TD63XPkE8bqbUKmdRVRpkzs27F/lJ9G/PoD4CKlP3uMsAAAAAAASUVORK5CYII=",t.snowTexture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH1SURBVHgBpVPtbtswDDxSst0m6pqkzZphzSPs9x6/L7CH2I8NSLAldmAj8ZfEUW6dtR3WPxUgWCbE4/GOAt656HVARGIsLQpcWoskxvoe3WyGWo8NEcl/ATTZVhXmkjTz4NkxJZmmI1jbcEBFGXIH5ArSjzl2PHwTSY7AkjOsuja7BftrIX+hVwS9bwLLAUe52lGSaqHtCGJH2iVw3XVYSefviXDHoLkPYcocRM/H4JHrN7PSYVM1reb8ju2MDFI0WFDfL0H0USD3Aloy0VUQAQMlQSYBGhVqp0mi9RB3PQBEwSiFA9MHrbIIgqXyWuu+4YEi7UAsCDgJSyGcuQK4OANEtQMpC0I20NbKGl4QeB0GVySqXZChS41nyjSjxg4ODQWc0xrooyPE4Gc2KX0VhF9aR13/9+ephaJP01nTwddMqvVjf7tHCOUm2Ks2pfhwAofaGGr7Ft1zgPrm06zS64fhcpCJJmgtOtAAoiYRtrr3YD4wbLkrvtfnQYo2avatP2LNxn8OPqxAZmEIF0EZkPBRtcjZYGPY/Cyb6sedc7/ONsbDw4PkX76eUus1ZKhRFkVQwYIXUgNqa+TQe9kZbzaavB9H+p9R3lbVYpK4mWE4r2rHRo1IyyYpqaty59yLUX7zMTW2Sqdw8vSYThpvXz+md68/1R4Na0qbii0AAAAASUVORK5CYII=",t.selectionIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAANVJREFUeNpiYcAB/jMwCAApAwbqgAeMQEySDqADHID4P5VwAy57mBgGGAy4A1jwxRsQN1LJngMMgxUM3ij4D8mC/VSyZyEwGy4gNQ2AygEHKjng4JDMBR+omHofjOaC0Ww4mg1Hs+FoNsQFGP9TL6WTnQhB2W0+lKY3aIQVOgpAvJ+KrWBC+Px/bE1+oGABHSxvINQfMIC6kD6+xuOQfrr5mkDv6D7dfI2rjwjE68mwvJ+q+QVoYAAQvyfC4vs0K1ugoYEvu/b/p0d5As2u76nha4AAAwAVTG0xZ5O+UAAAAABJRU5ErkJggg==",t.selectionIcon2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATVJREFUeNrsmNsNgkAQRVdjAZRgCZZACZRgCZSgFVCCJVACJUgHlIAd4JDgh37sJiuPWeacZMIX0bl3s5cZ5yIYnGukBmXVxPRydMZBAARAAAQAAACrHCJngYs8MmW9vKSZdpVfYhjiQwgBEAABdsIp8r1WYS+tAwAAYBpkGuRLEAEQAAEQgGkQAAAAwL8PkDGykmdptP/7Z77PpTqFM/5S9ZyWOl9LjkzqYaD5W2jbU0j1Jlz3iJApXXvFVhW7+ysTPw3jvZb/uwC9TMcnOdeHOTfX4+VhxnWPCNrjcl7XPRdkZcb1BOJyedcDp6E247qiuNzOdY8I5xXiUo/rG8SlPtcDH0+dGdcXjMt0XJ85LtN0faa4TN91jxBXz2nod+V6IC5/dw31bl0PxOXoerHl/3gLMABFnyPWKue8swAAAABJRU5ErkJggg==",t.waterColor="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAxgDGAAD/4QBuRXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAEAAAExAAIAAAAHAAAAModpAAQAAAABAAAAOgAAAABHb29nbGUAAAADkAAABwAAAAQwMjIwoAIABAAAAAEAAAQAoAMABAAAAAEAAAQAAAAAAAAA/9sAQwACAQECAQECAgICAgICAgMFAwMDAwMGBAQDBQcGBwcHBgcHCAkLCQgICggHBwoNCgoLDAwMDAcJDg8NDA4LDAwM/9sAQwECAgIDAwMGAwMGDAgHCAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAQABAAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8Aq281jqSlrqOa1DKJHmRjI0an5WfD4G0ttwS4wTjpxTrcrDaJGguVi2b0mdHeNASR/q1KbEYbScsSR3YYqmVXSruCY2ptZGlKxho0Jcgf8888/exvbjBIAO0ip/ESx3UtvdKIRdTO6qqxSLgL8xYBWbIAYDOThQByBkf18fxH1stv6/r9CebTbGC1t4YZFuLqVg0ciRFVQcAKxJBAY55J3DGeRUOn3sdzA1uEhuNvDPEGWSMZAVw3VlySCACcEZU4wLFnZODcK+nrJJnDtHJ+72PlVJ54YMQu7pkjjjBbFpD6ld/ZoIJmuP3hlMcpjZZPulScn5mIGGK5LOEx0Id0tQUujf5EMd/NbakzNaO8rgedDLKfmGCVKkDdwMnOScEc96Lu1gin2wxuzOVZ0d2lXJOEX7rAE9cqME5HAGKdYn7RZwq0dvapasoZjt3oT/y0OeFVs7WPzYKrwOtOsGs7S9bzI4boRXCNloVhwd3O9wB8rZ+6NxcEcEDNGtrD21Q9fJnna3m+xWrx4fzLeIt9nJPIIUEE4GAQcAEE7jVS71a1uLzdawW0iqRjbuXcW4Gec5GMgKdoJGfaRPssQaE26zPMXWM20pK7mOVBQKoTAP3VJBIXg4wZrqNJbXc9wblFkZXlS2+WPpgfMqkcZIU9xnAJJpavQa0d9f6/r+mNtEkS5VYZptPkkDOss0iqjx43EluobpgA88DHI3Mi1JZrRbVZJIYZDh3Cny5SF4+UdZCQTlRtBJwDkkM0+4gtpfIuLGZZ5Sku+3mO5ScbcADqDztIIbG35eadJPbWkLNH5izSFYjunCKqMPm5H3GODlPmBDE4ANF+ouXW1iCW4ivNLhuPscz3VvKEnu1UsHyMopPIViFcjdjdhucCnw/6AY5Iri5juLoNJsUld43fxc5PIYcgY6nA5Fprm61pY0+0SXU74MK53CIg4wGPAjx2LBRk9Qc1XxapaiO6sZIZJGLLcrKGRiu4MiEgAg4+7kkFV6cgzsVvp/X/AAwX7/Y9f8pbO03eZh5xKyKCSMkMv3QMYAxgAYHHJmSQNb/YIreFZlTEcaqXXBJYsrMSMkYJKgEgDGTkEs57ePT7e4WXNwrmBCkMTxFivdgfm4OChRg316Nmt7fUIGnjaOaZCu9J43lIbgZUbSGDAHA6oMkYIxVegvJ/ruR6hLuZG+d7iNRvmWLll+YljlQQOoO4lsngkcmS5DWcj7FtY0uASoB+ZF64U5IU9QVPzAcdzkgaXTokvIlikjUAbvMSdixxgEMfmwVBGSMEjAOKdp4uYA0PzSLICcMnyudrESDbjoMNu/3s7sEUblaWC8VrhZv7SurmSS5k3Exnc2Hzk5wynjsxU4AAIUg0W8IaRIbdtTby9hBkjEi7Rgb0A5CEhuMFs9Bxmi1bT3smVoFkvLeIgbAd1yqg5yAcbfmALHOAgxnoIWFzZyrELKS3hG4kSKVVIz7sAzAryGUrxnvzVGS10CK7WRXRXWbadvmwptSNc53Daudo+XuGwQOSCKkljhdFkktYWh2gq0VvIinJwVIHLYH93nPBBzgRyqbQpCtm11DIjbFWVgznnEgAySgBIDAkhlPXoVlWO1eOaS4kaFZGxdGItsAwCDvUFsdQxIOT0DEipNdOg6WW1v8AVXjd5LWOQDPzmcqPu7wpxtU+xJ4wSBwGLfRm2+ymaR/ulQS8aqWyDtKnCgqRwuQccgdDJLHZ2yW/ltZhY5iqkrtkGACMxKd2CCBuIGSD3BFPnsobuBplt5vKt9zP5SNthGWbcx6BiflBJYngHnhlp0C68xi6e0tii/uZAp3FvPLB04BztIHqeNuBkn2ih0+Z08na1ywZTEUQlUAZSHz/ABk9cqSMY4PGRtNE4guBE1xHdYa2iuEeGSUM7KzDa2BhgRsBwTk+9T3Wn3F5rEkMPmIsm9LiCC4iaTduIwxADZI28MvLMR1OQ+aK3JlJ7EeqJNPqreY1rIHmzKd0eUcAZUbOdu0bQM4AHUHmnO7fZ/OQLC0OIgFZ2LxnJXB65yOhAXkEgnJqbRNQmE6ltgkLeXvlgMnyspB35+XI4wpBB/DDRyfZgsjx2truRQjPcAAwMMDiNc8cZCcgYyNmBVdCbO/KDztLazLaySSqjqzXJyDFKFYqyfvApDjA+cEDHAHBZwnub2OeWxa1t7iSM+dHC58yYKWz1Ax8vcllIB5wTTY4fssKKq2txbqm1wshX58DOR1yDyQDt5I44IZawtLdrCkf7vcxUPg2zNtbBG0g45XqSmfUDFSVyrcfBNeXDru8+5jaQLGdm7yT2K91c5A5IU89jVeT7Qlj+8VbOYqrpIy/Z2dScDGQpG3155HHAyJtMlvNKXzI47tbgNuX7K/mJxwEC8o3zZJBB4AxtojuPKkDFb5VlKglTlpFOS3y8KT7ZyO2RwDUfXSwx5Xm8PSNbLdQrGwkmldT5cOQwKIWJK7sZw3zEISNoOKfa2VxBZoiFcybjGBIFWQZB3Bmf7pcH5QuSSfmA5qS6kuryJZZWWWHIFsCqyIxAxjy88ALnG7GCGxu6mO6sVm+YxwzRxj5pElUyBAGOEy2CMdzub5RjPOTXdi6WP/Z",t.waterDisplacement="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QB6RXhpZgAATU0AKgAAAAgABgEyAAIAAAAUAAAAVgMBAAUAAAABAAAAagMDAAEAAAABAAAAAFEQAAEAAAABAQAAAFERAAQAAAABAAAOxFESAAQAAAABAAAOxAAAAAAyMDE2OjAzOjAxIDE0OjQ4OjQxAAABhqAAALGP/9sAQwACAQECAQECAgICAgICAgMFAwMDAwMGBAQDBQcGBwcHBgcHCAkLCQgICggHBwoNCgoLDAwMDAcJDg8NDA4LDAwM/9sAQwECAgIDAwMGAwMGDAgHCAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAQABAAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+ydT1KC9mSN9Jjjk2bSxtBD8wPIDF2Y9fUH2rodP0a1k0f8Ad587y8YlYNIy4+6fMIL49CCO1Z2paPJpitHOtky9YUjkyW9cAkCT1+Vgw9DWeNfXRr2F5FnhaSQBDI6D8NoB/nnHrX9McvtIpUn/AME8aNRu7vf5/wBfkVLzw3dRMscl1Z2cbr+6keMwxnHQEFyrfQfl2rQ1Dwk+u6VHILuZY3UK5t38xVcdwrsY3U9f4SMfdFXvEsFjqlzHdLb6bHNMMsY4ysjYPXCBg30wD3zRNd2B0rao/eSSBZYtzxEt6lWXn9fr6V7eo1GSvf0X9f15kLmkm7trvZW9NfxZR8Lx6boj/Ym1SG+mRdqtMu1g3qoV+pzztYfSs/xX4SaWcTDazLysRhYoM84BYl1z7fhUN3eNDen7LZ26wg4VwUkAbjsGYj6HA4rodLsbl0F1qFvulHR0lXao9D+8GPxzW8pSpS9tzb+mr9P6sT7r91PT5GZpMkcnkx3H2hWVdokLkSwt2+ZArkc/xDmrF1oraa63NpZ+bau20kRRyLv94nw34ghvwqwfCx8RagsxeObqmDgSoByCrgHocdd3tWtcwXGoab9nW5jWbdtkMtyhSTB/i4B/z2rnqVknp810NFZaX09dP0+/qY+pmPXNNjt1t5rD7LIGimgKjGOuRIBuHP8As1NqvmwWNvPdW9tewSKAZHdtrYPVtudv5/XFZtvpdnp2tXQvNOjhlU7mUKC2f72NxyPqMcde1aen+Jb0XaxpJpqqoOFa58uYn0KkgFSB/CO/cU5KyXJqt9+/ncmXL119P87sl8S+KNL07QLf/iW2MawrxKk4AUZ65GMdQTuGOh3VH4VtZNTg2rCjq6FljRkmZl6gjEh+vANVbiFb3VJJLTdDcW4LbYZHbcMfdYfMGA54VWwOlc/a6iNLLzG3hgulbCidTGjk85+XC4PuqGqp4e9Nxhvvrd7/AD/EKmrXMtF6v8G7GzrFhqWu6r9nj0+MfYmBDkxqwGeQ5BLL19wav+K9P1LU9IjhhhbdGpUMkat5R77mZiMfX8jTdC063uLb7ZHY2slwoLgWkqzNF6nGTlDnOBgjuDVW43Sah532aG4kYhGikmETk/7Oflz6dQfapU25JRt7vl1/8Ct/XYOa/vO1vT81zWKfhqDXLfTFiZlSOE8mJmGD3xsK49Ry34U3VdRmTWLVbpTOZn28rJ+8PY55DN6gjPsa2oLv7FdyI26wmUHcrzLD5v1AA/MA9OtSaHfz6lDNHDJp14khMbKt0sgmPbO8jOOxySOme1VKs+Z1Gl+W4dLN/JO1vnr/AF1JNLum0tI/Ml+2KYynmSSmNw3+6Cef90kVJd6Ot7b+Y0eG/hD2fAz6Oxzn35PoKoyeM7mXUJFkgdfMBEVwqhot3+8SQPpwaRPGV74ft/Nn1WxluPMEbQEgOB7MDjB/2tv41z+xq35o2u/x/Cy/AvbRL5L/AIb/ACLyeHppLH9z9neSFAQZGPmJ6cqFk/At+HamHwt/b2lb/ssPXafnilUnrxHKoP5HPvWH4k8aJrUESxR+TOTyh/duuOePmG78WGap6XfPqAVpYlV921pHk3K3cEgjJ6f3m7810Rw1bl5m7O/9dVch2UrP/NfddEd74eW31TyRY6bDNGNqPJbC1DEHPyPgluvQPmtS1F9ZTxySWyyLsz88K3Bx3G5trH6HcK0b6aK40+SOzvNLiuM/JAJzAWb1UOAGJ/unJPY1Ssn1C1tWN9Da2824ZdZwytj64I/E/nVe2c42dvnv62K95SXfzf4tP/IsXlgviqIQhrRWVMxyFcLxyPlY7W+gAx6Vinw+kl2rtNrEbY2b7S3dFhcf7zMrqfQ4x2IrVLNqlttt4fJmk+WRY+VcjvuCDr2OMD1pbHxG9nKqtqVjbSsceXMwfLj+FsYYN6EKQaIyqRTUfu/pP+vVk8zfW/6+S0b+46BfB0msbpoNPaFYCAokRQvP8LH5yp9OMe4rM8T+CJL2D/VrFMybVUw/cYdjk5H549DV/QL++0e1ulhhije3BwIZ9zYxzjqdvP3T05qnpfiDUNSka5m06SZN2wGQeWc+m4NjB91I9cV59OdaMnJSVlt3/MJSWza9E/8AgmLB4Vvr/RltZF+xx2WAxilaRV5zz91k9QfnpsjXekCGGFpLpJTtkZFyJT2b5WZS3qAAT/dNdVpelwnXHvPtf9nzxo37hpY8zZ/hKHn8VIz71kNqB82Z7X7OI5H8p1ZolMh7HbMAD7Ec9t3auqOJlJtaNb+V356+ofZsmv0Xz1uLqevx3NhDBJbzWgjxgrC4UnPcMoQg56EKR61V1GWe8s2WztWn4A2OHj49yMlf0HvT2mNhbTedbI0ajLRuNxX/AGsAkbc+gI96XTNej0uNZhb2csgH3FkjBIP+yWDAe2PwFXFcqvBfiGm1799Vb7x2jaOraHH5mmafCY1wrxyNJIh+of8A9COP5VDBpF01/Gps/PyQzQiEM8g9Rlto9emfbvWx4cuo5L6a6Vpo7iNGbajGRDx3wx4B7YPtik0Vv7eguGa0to5geNw8kyHruxv2t9NqmsXWlFyb/q/q/wBRylzW5vz/AM2f/9k=",t.markerClusterIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RUU4OTlGRUY0QUMyMTFFOUFCNTE4NjMzMDg3QUZCNkMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RUU4OTlGRjA0QUMyMTFFOUFCNTE4NjMzMDg3QUZCNkMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFRTg5OUZFRDRBQzIxMUU5QUI1MTg2MzMwODdBRkI2QyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFRTg5OUZFRTRBQzIxMUU5QUI1MTg2MzMwODdBRkI2QyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvdO35oAABUCSURBVHjaxFsLlF1Ved773MfcmcmdSTJ5kBd5kRfkAUHBpBY0gIAVTYtWpFSgqVjsaqkKtFhIkaWyWqWlXW21rtJW0FopSwTkoRhFJUAxII9AjCTkSTLMTF7zvO/d77//t+fsuZnJTJJJPGv9c88995x99v/6/n///x5jRuFoAjXw/FugPwPV89qDIAeqGGPLIHwm8D0FqgPV43sW1xtxniYlKnqfled2g+aDMqDloPWgqaAEaBzIHufcj+v5MaAC6K9AvwLdDzoNdCNoKcYugs4wJtkCxsBQ0ipFRoViB5mE458KrpXxWcT4xVeMKeVxrQc/3YnfnwXN4Hv/GtQL6v5NCOBvQFtATxnlag3GuwSn0Fga2qnDpTR/kvdYz7QNuT18Eo73OqGo34AM5GnyGyDzHRDOzbiewoUkhXAT6K2TJQDRfAl0Cmf7EYxzJcx6AZhuUMaTLmbcDcNw7eHCW2qecXx1YROE8SI+b4BwzseFD9Py9pxIAdTT7z4JetMop58C4/Pg7mQ8UWva7nCNu31gog8TT+j3ivg7pGUngNKKD9YOIpFAGN4q8g8Z0/dxCOIyXHs/LqwF7QcdGG0BjCHj14DuAWGy0WcAXvUqlwQ1Ltp2oamLP3fAfBsxWQipAPW5T+Da0/i5kfyJbePc3ofzBbQc3JfEc+nxEGxaxw8FKe/xMikDf/IvAAYewfmNxCNxidbREMAYOjGkbOaCvqEmX/en+KlZUdvaQDkuVloe1/uA8EUR3GoM8wGAOdTWtBkWcwhjJGNfF1S3i1RIMA7TtRfYhmhS/hJ+n6+u3uDUyqLACvp5wJcCrKHni3j+THx/J+gvGS32HasAhPnP0KT+C3Q77n8PND4HoWucasXZGNEdLUACQze+lK2GuvEAyomIBGPHx6AYDfFuEYaYdgVWUdpqTOdMY9pgYh0iUN7TaNXqbChwq2G2vBFCAEj2/AWuwUoNFGU+dwRsOKIArgedrYyb38WkId3GbNVaTeQGakDCVh4X+hjCZJLTnOJkhuYauUFwwdSY9SBAWXFqTSKE3Tg/RO2LRWS8RZiBbtH7TSgBkaIs4LiM7ls+WgE0U4LX4j4kH2Ma1ChsEKrkKFoNwxK3m0HT8X0yMTIE8gHvtTFzfhJeo26QUOm/SgQQQeyiZVuFjwHv8mP3bocFIWxWbjiCBSSHi0dlTToSdYrOEdHXT6gXJz1OTXI2aDpuqCdTjsxE1Iwwm8NJL8bM7YRWYaIuq6brYLYWUks3qFbrmfwlbJwY+flOwfdx+N7qVBCdOM+4QDmYYIR5pGbh8wWNMkMeiSMJYA0zLqBr5RzIIqMTSFE2XUzAJuGti5ihpikgMceIJt0HTbTifAee3yUTz0GLnzbm4DTcBx8vdkIY0FL7QlyfqhpuBwbs34brkEQKL01bxZwKx5c5jKWRinDEGgpW358A80Xc1I20vPAzXPgY6PGhTPFIAsgGeb3YHoClbqxezjkFpVNBc8QfbQxgCQ7cIz4L7bZeh8eBIeM+oPdPw02TYZIpAUWMHYmV7VWLKEFIe/FsG77vwrvbGQUm4paZnJLleywtK09L2EpmxmBiPY9C8ML0StBtR8gShw2Ddcy5WzkDAGME7SQwowVOzd6DoAc6iQKi6R2c7Hw8ey5mPqNRzVq0mQrCl7M14UxwBUIpvA1hQCgbMIeNsJocLGIapD27Tt2sQjCMOEYbGH+lHffB4twd+OEK0K0q3ONLhLJc9Py5OCCoDaaHGLt0rGqmGGR/B5mHiF8uw/ULxIusuo4NQl347v48IowEdiAMdSDz/ClQ/bm7wfB0uJzTd/tUW1Lv7m8b8ypWi62/hYufIIjsH4a3xEgEUOAsACjmTHX0AvLw3iVA4IyGPPl5JybxulV5/R5IMtNJNdlsCO4lq0mPAGnBrx14QxTcJ1jSDIQ7fRVcCAO+jR/foFdmra40e7AS3fwkmH8XnpFsEIlWdfBRXwzV0adeBp0FLdxizDx5H/1wgaQMDIUSuwX5E0Rz8dV2hrEurmIPErzEQsY6LSGM0Uy7quH6QFgRwe8gLnwfn7+wKuAp+LLtQeDNebj3lmFMflRWg41U7R+bqo1nToMmkOmtwNdVTpG5wBQ5RQa30jXeklBIyxPglLyhRdYuOEcwqIZU0azUDSbjHIHBzLMqlCLBL03lPoMv6/4Hpv93ILinW3sMq8HksQighwCTVQHkvgyEv14toYWTi+iXb+HzaacmK4Ujcc9zaCHjnQ4h4ayTIfUAFfgifvu5RuBqRnke7p9jCbJ0s/mQ6jMIn3sl67p5BP4+qgWRDBcbRY5zMYAJafNqWMdCavEFfD5uVdMfc4oJc2ni1g4Rl3n0WcWUdfhEVluNKIAA89s0wB3Ao4dfwjsAeqX36LK8qpiTeoj5IE6buzirz0IIEMitmPiVQMVx+FwN+kVFExPnyY2QKppevwn6JExk7HPGXITz27HqW1mvRRjzACPTMR9L+DmXC5+jPRK0hLW0f2R4Y9vUfz9VUZ93AfOVEQqgUvNd8vovgOEZ/4jxkS1Gl+NdXw3CzDEf1/HzMhYR5Fh0lMJYRE28T+07WmfMnZIC12i84o5C+zWWIJ9lrB8eeAfkLKDxPdCHRqEqXHUqOJdFCLEXMKFfzRRYjnkjEMYtDPyIXYknkINgwm1e48fK9BBUQKz9EsJN9lRaQP0I+ZQs9rxB0UYTnQw+m+C/GUg2CVCxlxJ1vqDL4f7jnUyG/LGCQhI//IExl2CSW45X4zXar9RYwgGEujVQXDROo1AVkAc7ZlDBcghQ/i0FJpZ6EXi8UAzI6SpLAEvCjfhuC3Lu9CaMCyCbgPQyi+wqfZkWLc3VoMtp9ovo/yKoO/TZB0bL7IcSAMd+5nlkhoJbd9cIYBrnI8diWslqzdCqkefzUDD4qkOYyhbFYyuaSk7AoFMrKoQpYCp1ua67L8S1d2ORsVSu34t7ofHMeyG0u4gbciA3Nz825hrc03q0SH+UAvAgKjXDm1Zp0VS02X/Mi5lOQPsNN2qGORW4NOkmzSNE2ac45W9yknl3MkgKSqcjbI3XtHSs5OlpTUszfwggQgI0H+ld09eR+iJrOQBzasUyuRlCOd8dnvuP6hGUzBpPgXLuNOa7wJ6t72e5HinmOOTYaaScXQ9oRjqDCVgGwtqzStNwwyp2dY5JRrIEl5ciodLH4ypsOajs9EjlJaWYeBZWW4U1SEhw7X5IcKKrdsPMMPnNqByOafZiAPY84NHu12Dh90GrUNTcsvLxE3aUJvmSvdVljFApqFzbsFfnl6Ml5tv1Jq7xy7VOp/nOeK7/kwmV8CQGjwk19b7R5ZpLZW8FsnCC6019RN32ukiNQJotsuB6Gde2M1EV5v0aQuoIfSauO9rIxXX26rp8I7T+jFpF2samLJYgy9YMFyYVZmlSBc6z+ttsYxNwJ8L8a/J3UdACqyWwXvWA6oLJ1wf7qLgwZ0vxWn9dM6o1WayuKnfpjXXBb2Vag9T5k8GE8qwFVJeybpDJnsBDmjITqYBDrt+Iq4rMkOFy4DbVtnztINEg+b1Nxb03f4i200z5Ezaubhxgw6LOnPyjQtOWue33JXaW4cQ6UvbwfqwbdjlsB5NKTV/ODaycO2d+s4etYczW7D8wg6Cz/36YAOBIrjuQA0dJ/FArY73vCyzDKSAKLuRq2uDuJLiBxy8x9fEBmDsWXQru8DrkYBY/oAgpFQs7hz14rt2rAtilaJoP/YqgkuRSPE83OdHM+8hUZAElyVjvtV7hfEq+5knmKyEoep6Tga/LwNLBTZL5XFCDT6xRv8pLwwEPNtm4RFjHStQBX7c/8RavXSnQZmbCyaBJmmMHqoE5gH+mRAUmgmZuf4x0AYAkqeW8b31blWSW5e62wJ9SLAN01LTjTxgsBL1DKfzuZB6SDt4rgLiPUSl08SIbOil2rfqbCmUXx8VqjV3KTI9p5hfe1+S0btdm4l6fvED2RbWzan4y4p9PtF5hqUyKpnU2btWLYA6w3pgMkp68iQuy/S39KPANP/fEd0D/FCcXvhWe5eceZlO+oXEqLUR2sO11gyDw6BpA9ZCsdB3PZ7nY1MXM29lr6K89ipVvwJz/TQdIesCW62IKZRsDW9XfscpLX6va7qKbyO/iU9KV3W7V59N0lay2CKoW8PQQEx4t7r1gN+oC1JyOCy1E/og49Gsyn7Xx9Rx89UB3nA32p/7Ro+oCpVBlWF7WfRRSdNqESHKhJCnnVGSK+79nzCYbg6e4wnLZtQH6KmibHYjWo31I1vcvRsH4LPp0JdLGw9tfMWZLTjvWGb/Ag6/0vQ5c+Cz4iuJeYjXFj76jai/68ObilNdyE0KOJi73tMgeH4SDDdykIEzLBglxD6kGvWq0Htgd7B1yxwn5/fuIKHSsxM0TOL/A6SKs5EMxTHQD5z05eG/lWSjy85hnUSNG/2ZMeTZq0KdLfuUU5M3y0376VIrVndSV8LlOSPq7xjxv9ZkksULaYh90ujv2NjY7qpsj3TEKomYbjpz/K06+AlqBL+d4pYmWN8H07zfmxZuwQs2oC5Rp7j0roaxb4LIJ5inkU1w/H8ky7lt6c9EGqSXXz7K62su9AAnmB6dAdNMx0nNE4joXh5l3gy6WZgboNqcRw4fXEdcKXM2uM6tWeLf0BEAzQZdS8GXOcw++PI4JZnJa/yx798NcO5bAba7WBo0NurSll8BPQlBjG+gqvZ7iYscFq6leAl0T9+8mF+P7fN2w1MqtMS1BP/A0Tu4HRl1C4vRMTmiktQIbtJJljC+CvoExFtvqfq3q0luUIeFPsOohTOC1FcYsTWrJy/cXe9iTLDN586tFMf/edSKAWTg7X3dQuKUKKCkXL2lFGL2MDi1WfxdNZ7jikqZnF67N8g1MH5rY85MO7k+4QUNePMkGKGyHDhki+BdB/w36e6OYI9Z1idUyXY5RSBj9EehnzAdmkPmIEUB0K/3JJrqxT/6KMN8ePFhJXslE+j/x0qt04Log9qfIaIfVpuVMlpdKbF9LYfYlWs5qDpVju3u51AhBz7OP8bDRHe8SMmdbFVKKzHrr2FnRrS6vi/CYeU7gNp95QQrsQ/BP8fuTTqvyswLXiZiw7WSqXBeU0kSZOUn2ZGJ2CcvcwtFCaPwPlIn6Gm0ctFoLWOy09FQOzHnzP+BF8IOVq7VZ08zVmHcpMVWpHW6BebTebcwbyDMaF6oAkjW7zt5ii1xWd1K1necbqnZge1ymu47RQOZ7BneRlhmx+hiR2q26RCoolhR+CX6+iTHEN5OvslHwXhVzGU/nrtBymN/YKAM23gMgwRu2XxVvWS1T0vNPxT1Q0/8R+T/EzVN5Mh9Re4sw+93fhoYfAcEMtubC6ka8H+nM6dAJy2z+pwLnkuY7nsD39WRukRk4nxI1L8w3eub9Vr3XwN/v4x5p6HzE1wM8Wkna96gKIMWlsDeEDECv+M9wA9hT/YehFf7XR/Wll/OfOpxmaBI2L2YDKcOJCSWkYAmwKojT/nwI9LsGv0/XOoMPr1EAzLL6ewwnv2a367TAjaoLHABHK3Kb7bfrDrSGmtCTf1Zb79XmyW1+YdBGNPsgHRQOWH6HAl6SSYiFvabnYHJf1z18qaUKclHgw+NIYsYbrX4mKEgpmkin6cf/AVnvHCQcZtjlgeQKKZ3GBGpfMGU3sq51a6Er/NCaVa3PtSqYEj9lDq1YpGyC6ZXh2s2JGMvE9EsAvu4noEjpbt1H9EzUTkJ6f7vxYsBn5Wy6AtPdaBpumapb3ztmxaHFm1+F4XIyv2+lxnZww0MRL1uPmbevN3GHIjwma0SyyMCmMFpIyv0UPp+CXW9BLt+IELwsE2d6ZYY7x+03v4LpFJbBgiLlrX/bLfyzB8LvOx3n/wt6cqgdIkv4lKjgXs0Gm4ItshFfdpD1glMJUln/fz4mBpxDzBMOMrES+bYhie+7w8QZ0oAyr5pw4gwkWk5jfCebMw1s+7Ww+FGkaQvzeWRjO/7dmDeRLFSyWqFO+UIPLaMbK8Hux3HtxqBhOug2OZnYu4zmmXCF4vIYfEIh+Crwfm5uyhCpo6DsJNvnJHcQRJeosgcT7PocsWaoA8tMdx5CXVbBVhieyfjexFDmTT7JqvTmkm7MjCC4sUligo1Day+03/VDzP0idoh3DbdH6BxCuCANzCa6Qv24kXl9xcb9hByzrRS7y7Mj1VbJxbmOTFa2w/4S5r1t/Qj2HiE+N8ASz3aKA75E74IN00XysY15QQNL9r5Q47fR9iKZ6LpHMU16Hv1FhCPuEnuemYds6fojDAgJd1+lozfagf8r0EBzE6VKAtNe1p2hQumgztAJwXQ3jiAHrldXKLEXOT5eumtDE5LYGymudFDDzcF6xG/Srm59QMjrQl5TliXtlkGYH9QFQn+U1O9ctWmHAQrL9QUpO3AnZ4IoLybZdSuEcAiuAbDJlXRiGdy8T6IC8trilmGqnUVFTjHX+jHa+RHrKWKMvVD3ppsR4jCnrqyGOJ/i9vcNOac+MfuvgXnJn4H81X/yMkcjgL0s9UZcK0hwh/8WYWuVJcpsIuw3ECfq5b+/gIqdsN19WJq2S1EFwboDz3bKNtaDzFIGO8Th72Resor7DjCHPZ9G9ggT3o0Y2yX/nYakozmteUdtnbAMrfd8FNYmQpRdIY+ReXe0AghBUbDgUlZHsDIpgqHSGfrSpI33AFfX2UiJ0xN0ckn4c34BogGe6RaE3k/HPTTEu8rEgBvUXyWc7cdYh2AJBaSSGai7CczXpwM3tHHhpYB5diNJ64WQHVy3+n9OPxpmDT7iktVCAsa5zHbAWOJq3S/QYOIVpPNF0WBifS9A+9eCv1dH+C5B6z+RpR/Gb4iru75Y44LwVvUaCK4PK7I+IHzpGiLml7lEHMk2vxEdHbQG8dELNVly8MciEKi4hDXDAFQdY381LGKlmYcmXKGm4zqURt5UaJfdpw1jFGjD/0C1Ns5Aezap1nMvY+jfwYWHjO6vffpEFublX0S+xq1xYg0PYlKIhSkw2AgGWzCzKficKstUAOGYlfh9LRddwx0TucdnnpaZJX+YXNH9S54mYfwsUt7UGxj3TBYf7uWOsZN2zKYQJLRczxT6YTX/RFn/QbK6ExyfGdnDs4ypnBlBHrCCTL2uriWRQMpw4yoqkOQO3eJWxSXR9ve5De5Yjv8XYAA3ZoF+5F8SWQAAAABJRU5ErkJggg==",t.placeSelectedIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAmCAYAAADX7PtfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAN9WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA5LTExVDE2OjU4OjI4KzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTA5LTExVDE2OjU4OjI4KzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOS0xMVQxNjo1ODoyOCswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDplOGQ2NGY4ZC1iMjUzLWE3NDQtYjQ2My03Y2JmYjYzZTE2ZDMiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo5MTBiMDBiNi03MDhjLTVkNGYtOTc4Yy1kOWUyZTg3Mzg5ZjUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMzY1MzI0Mi01NWYzLTZkNDctODM3ZS00NDg1NWJhM2VlZGEiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjMzY1MzI0Mi01NWYzLTZkNDctODM3ZS00NDg1NWJhM2VlZGEiIHN0RXZ0OndoZW49IjIwMTktMDktMTFUMTY6NTg6MjgrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZThkNjRmOGQtYjI1My1hNzQ0LWI0NjMtN2NiZmI2M2UxNmQzIiBzdEV2dDp3aGVuPSIyMDE5LTA5LTExVDE2OjU4OjI4KzA3OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDxyZGY6QmFnPiA8cmRmOmxpPjAwRDE1MTRCMThFMkIxRjUwNjRGMTZCODA5NUZCNDU4PC9yZGY6bGk+IDxyZGY6bGk+QUQ0RkRCQUU0Q0YyQURFODg2RkExNTFFMjJDRDE5NUM8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6MGIwOWQ0ZTUtMGYzZS1iOTQ0LWJmZTMtNGJjZTczMDQyMDcwPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjFjMzlkZDBlLTg0ZGUtNmI0OC05Zjc2LTYzMzZkZjYyZWI5NDwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyNWJkYjU4ZS05NWEyLTc4NDgtYmIzNC0wNjgzZjkyNWEwNmI8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6MjY4YjIxZmQtZWJmZi05ZTQwLTljMjktMjc1NWE2NGQ3YWUyPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjM0NzY4OTNlLThlYTUtN2I0MC05NDk2LTY0MGY2Y2M3NDc3NzwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1YmNjZjM2Zi03OTBmLTRjNDgtYjQwOS02MWM4MGU5ODdkZTg8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6NWU1NmM3OTktOTdlOS0wZTQ4LWFlZDAtYzFlMjI0Y2JiN2VhPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjZmOGE1Y2RlLTc3ZTAtMjc0NC1iNjE3LWVlMjA1ZTMwY2RlMTwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDo3NGIzYjNmMC01YzVlLWU5NDQtOWUyMS0wMWMxZGRjNzZjZDk8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6ODc3ZTIwOGMtZWQyNS1mNTRiLWEzNWItMWY2MmNhOTQ2ZWQwPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjhiNzQyZjNlLWI2OGEtODE0YS05N2NiLWEwZWMwOTVjNjFhNjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDphYTg5M2Q0MC0wNDc2LTYwNDQtYTc0OC03MGFhNTc0N2RmYTA8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YjIwMmEwYzgtZmJiMC0xZDQ4LWFhYTYtZTA5NzQ3MjBlOTM2PC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmIyOTQ0MjQ0LWY1ZDItNWY0NS04M2M2LWRhYjhhZGEzN2E2ZjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjODcxMTc5Yy0xMTA1LTBmNGMtODdkMy04MzEwYzczOTVhYTk8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6ZDIyNDM3YjAtZmE2Zi1iYzQyLTliNDItMTIyOTI2ZTc0MTI5PC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmQ3NTBlOWUwLTQ5OTgtMjI0ZC04OGFiLTFmOTQ2ZWUzZTNhMjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDpkOGYwYWI1MS02MmMxLTI5NGMtYjIzMi0wYzVjNDQwNjI5ZGQ8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6ZGFkMzE3ZTUtNThiNy02MTQyLTkxMTEtNmZhZDYyNjBmZmQyPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmRlNDE1ZWFiLTgwZWYtMTA0My05NDMxLTgxOTBjZjFiZGNmYjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmNDU3NDRhOS1mMjEwLWQxNGItOWU3My1lNDc2OTJlMTc3ZTY8L3JkZjpsaT4gPHJkZjpsaT54bXAuZGlkOjBkNjI2MGYwLTE3NmEtODA0NS1iZjdiLTEzMDhmYmQ4NzAxNDwvcmRmOmxpPiA8cmRmOmxpPnhtcC5kaWQ6ODNmMWNmMzAtMDg1Ny03ZTQzLWEwZDgtMjgwODU4YWRjNGIzPC9yZGY6bGk+IDxyZGY6bGk+eG1wLmRpZDpBNTdBRUFFRERGQzNFOTExQkY1OEI3MUE5MzYzQzI2NDwvcmRmOmxpPiA8cmRmOmxpPnhtcC5kaWQ6Y2JhYjFlZTktZTU1ZC00ODRhLTgzYTctNzBlYTg2N2I5MmNlPC9yZGY6bGk+IDxyZGY6bGk+eG1wLmRpZDpmMmNhNzBjZS0yYmY0LWQzNDQtOTM3Mi00ZjdiY2RhNTA5ODY8L3JkZjpsaT4gPC9yZGY6QmFnPiA8L3Bob3Rvc2hvcDpEb2N1bWVudEFuY2VzdG9ycz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5i29DLAAACcklEQVRYhb3XTYhNYRzH8c8ZrxvFgmRhNSWJLKRQQ5ISZcFEjQWDskAWEkqTSQmLycZiihULRqIslPeMhLyssBjCwoZCrDCuxTlnHPeec55zjfGrZ3Ge53f/3/v8z/88L1GtVvM/NRreL5sf8s3GGizGDExK+j/hBe7gEh6VBZl87UEMLNFCHEZbwfjUpC3BAdzDftwqCthS0D8Ox9GfwiomfgFuoBfjqwIn4Ap2Iko7oxxjgSJsxXVMDAHHEl0Up2i4Wih+r2PLgN3Ulv4DWKo2HC0CzsXuv49dmPQdmJcH7Maokog1nEY7piWtPemrlZRVCw6lD+lnMR2rArCDScvqfNIG0KV4msvRioF0hitLzHAmB5bVwcRTpEi8cAyldEWJmbjaQgp52rLAOQHz3QrAkGdWFjilQsDhakoWOCZgXlQhYMjTkgW+qR+tK/LVFYAhz5ss8Gb9aF3JdojLvkhdiadMt/n9HfZhS4k5SoK2iqsxLZBF4pl1NP7HBp3NAq/iOWYGoBuS1qyeibetoZSmK8lIqTth/LGW9uHhCMDu41z6kAX+xDYM/kPYYBJzqOjr98PHOBaOU3n/P4Kn2Y68I0ZXvalRlU44T+TURR7wG9qJPleJWjDbz1ibxAoCYYBap0pTabDU0IlXee4iIFxATxjYoJ7kt7kqA8I+cVlXVT/2lhlCwG9Yj48VYB+wDt+HA4TXytdZ4ve2Ce9CwaoAid/JqZLxXlyuEqgqEHbJ2TfxUhPn2WaAX7DZn9/BIDbi60gAiS8oJzPPJ8SVWVnNAmGPuDjeiu+CTSl0Ic3TR2zHD02kMlX0v+/4f5PSYekXCqB9cPeXO3gAAAAASUVORK5CYII=",t.images={markerDefault:[t.markerDefault,t.markerDefault2x,t.markerDefault2x],placeSelectedIcon:[t.placeSelectedIcon,t.placeSelectedIcon,t.placeSelectedIcon],myPosition:[t.myPosition,t.myPosition2x,t.myPosition2x],logoIcon:[t.logoIcon,t.logoIcon,t.logoIcon],rainTexture:[t.rainTexture,t.rainTexture,t.rainTexture],snowTexture:[t.snowTexture,t.snowTexture,t.snowTexture],selectionIcon:[t.selectionIcon,t.selectionIcon2x,t.selectionIcon2x],markerClusterIcon:[t.markerClusterIcon,t.markerClusterIcon,t.markerClusterIcon]},t}();e.Images=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){this._minX=t,this._minY=e,this._maxX=i,this._maxY=n}return Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}();e.BoundingBox=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,i,n){this.annotationId=t,this.id=e,this.name=i,this.location=n};e.BuildingQueryResult=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(14),r=function(){function t(t,e){this.features=[],this.name=t,this.layerType=e}return t.prototype.getType=function(){return this.layerType},t.prototype.getName=function(){return this.name},t.prototype.featureCount=function(){return this.features.length},t.prototype.getFeatures=function(){return this.features},t.prototype.getFeature=function(t){return t>=0&&t<this.features.length?this.features[t]:null},t.prototype.addFeature=function(t,e,i,r){var o=new n.TileFeature(t,e,i,r);this.features.push(o)},t}();e.TileLayer=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(76),r=i(6),o=i(3),a=i(1),s=function(){function t(){}return t.createWithXYZoom=function(e,i,r,o){void 0===o&&(o=!1);var a=new t;return a.wrap=(e<0?e-(1<<r)+1:e)/(1<<r)>>0,a.tileCoordinate=new n.TileCoordinate(e&(1<<r)-1,i<0?0:Math.min(i,(1<<r)-1),r,o),a},t.createWithWrapAndTileCoordinate=function(e,i){var n=new t;return n.wrap=e,n.tileCoordinate=i,n},t.fromLatLng=function(e,i){var n=r.ProjectionMercator.projectScale(e,Math.pow(2,i)).multiply(1/a.MapUtils.getTileSize());return t.createWithXYZoom(Math.floor(n.x),Math.floor(n.y),i)},t.prototype.toVec2=function(){var t=this.tileCoordinate.getX()+this.wrap*(1<<this.tileCoordinate.getZoom());return new o.Vector2(t,this.tileCoordinate.getY())},t.prototype.parent=function(){var e=this.tileCoordinate.zoom-1,i=this.tileCoordinate.x/2>>0,r=this.tileCoordinate.y/2>>0;return t.createWithWrapAndTileCoordinate(this.wrap,new n.TileCoordinate(i,r,e,this.tileCoordinate.is3DMode()))},t.prototype.children=function(){var e=this.tileCoordinate.zoom+1,i=2*this.tileCoordinate.x,r=2*this.tileCoordinate.y;return[t.createWithWrapAndTileCoordinate(this.wrap,new n.TileCoordinate(i,r,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new n.TileCoordinate(i,r+1,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new n.TileCoordinate(i+1,r,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new n.TileCoordinate(i+1,r+1,e,this.tileCoordinate.is3DMode()))]},t.prototype.getWrap=function(){return this.wrap},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t.prototype.equal=function(t){return this.wrap==t.getWrap()&&this.tileCoordinate.equal(t.getTileCoordinate())},t.prototype.notEqual=function(t){return this.wrap!=t.getWrap()},t.prototype.lessThan=function(t){return this.wrap==t.getWrap()?this.tileCoordinate.lessThan(t.getTileCoordinate()):this.wrap<t.getWrap()},t}();e.UnwrappedTileCoordinate=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6),r=i(1),o=i(2),a=function(){function t(t,e,i,n){void 0===n&&(n=!1),this.x=t,this.y=e,this.zoom=i,this.mode3D=n&&this.getZoom()>=o.MapConstants.defaultMinZoom3d}return t.fromLatLng=function(e,i,o){var a=n.ProjectionMercator.projectScale(e,Math.pow(2,i)).multiply(1/r.MapUtils.getTileSize());return new t(Math.floor(a.x),Math.floor(a.y),i,o)},t.prototype.parent=function(){return new t(this.x/2,this.y/2,this.zoom-1,this.mode3D)},t.prototype.children=function(){var e=this.zoom+1,i=2*this.x,n=2*this.y;return[new t(i,n,e,this.mode3D),new t(i,n+1,e,this.mode3D),new t(i+1,n,e,this.mode3D),new t(i+1,n+1,e,this.mode3D)]},t.prototype.set3DMode=function(t){this.mode3D=t&&this.getZoom()>=o.MapConstants.defaultMinZoom3d},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getZoom=function(){return this.zoom},t.prototype.is3DMode=function(){return this.mode3D},t.prototype.equal=function(t){return null!=t&&(this.x==t.x&&this.y==t.y&&this.zoom==t.zoom&&this.mode3D==t.mode3D)},t.prototype.notEqual=function(t){return null!=t&&(this.x!=t.x||this.y!=t.y||this.zoom!=t.zoom||this.mode3D!=t.mode3D)},t.prototype.lessThan=function(t){return null!=t&&(this.x==t.x?this.y==t.y?this.zoom==t.zoom?this.mode3D<t.mode3D:this.zoom<t.zoom:this.y<t.y:this.x<t.x)},t.prototype.isChildOf=function(t){return this.mode3D==t.mode3D&&null!=t&&(0==t.zoom||t.zoom<this.zoom&&t.x==this.x>>this.zoom-t.zoom&&t.y==this.y>>this.zoom-t.zoom)},t.prototype.toString=function(){return this.getZoom()+"/"+this.getX()+"/"+this.getY()+"/"+(this.mode3D?"1":"0")},t}();e.TileCoordinate=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(177),r=i(78),o=i(104),a=function(){function t(t,e,i,r,o,a){void 0===o&&(o=null),void 0===a&&(a=null),this.renderTiles=[],this.mapView=t,this.tileCache=e>0?new n.TileCache(e):null,this.tiles=new Map,this.createTileFn=i,this.removeTileCallBackFn=r,this.updateTileCacheFn=o,this.requestMap=a}return t.prototype.updateRenderableTiles=function(t,e,i){var n=this,a=[],s=[],l=[];if(e.getZoom()<i&&0!=t.length){var u=t[0].getTileCoordinate().getZoom();this.renderTiles.forEach((function(t){t.getUnwrappedTileCoordinate().getTileCoordinate().getZoom()>u&&l.push(t)}))}this.renderTiles=[],t.forEach((function(t){var u=t.getTileCoordinate();u.set3DMode(e.is3dMode());var h=n.getTile(u),c=n.requestMap&&n.requestMap.has(u.toString());if(null!=h&&(h.isRenderable()||c)||(h=n.createTileOrGetFromCacheIfExist(u),n.mapView.getGeoJsonManager().addTile(new o.VectorTile(u,n.mapView.gl))),h.isRenderable())n.renderTiles.push(new r.RenderTile(t,h)),a.push(u);else{if(a.push(u),e.isFlyingTo())return;if(e.getZoom()>i)for(var f=t.parent();f.getTileCoordinate().getZoom()>=i;){if(u=f.getTileCoordinate(),null!=(h=n.getTile(u))&&h.isRenderable()){a.some((function(t){return t.equal(u)}))||(a.push(u),s.push(new r.RenderTile(f,h)));break}f=f.parent()}else e.getZoom()<i&&l.forEach((function(e){var i=e.getUnwrappedTileCoordinate();i.getTileCoordinate().isChildOf(t.getTileCoordinate())&&(u=i.getTileCoordinate(),null!=(h=n.getTile(u))&&h.isRenderable()&&(a.some((function(t){return t.equal(u)}))||(a.push(u),n.renderTiles.push(new r.RenderTile(i,h)))))}))}})),0!=s.length&&(this.renderTiles.forEach((function(t){s.push(t)})),this.renderTiles=s),a.sort((function(t,e){return t.lessThan(e)?-1:t.lessThan(e)?0:1}));for(var h=[],c=0;c<a.length;++c)a[c]!==a[c+1]&&h.push(a[c]);a=h;var f=Array.from(this.tiles);f.sort((function(t,e){return t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?-1:t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?0:1}));for(var p=0,d=0;p<f.length;)if(d==a.length||f[p][1].tileCoordinate.lessThan(a[d])){var g=f[p][1].tile;this.removeTileCallBackFn(g),this.mapView.getGeoJsonManager().removeTile(g.tileCoordinate),this.tileCache&&f[p][1].tile.isRenderable()&&this.tileCache.add(f[p][0],f[p][1].tile),this.tiles.delete(f[p][0].toString()),++p}else a[d].lessThan(f[p][1].tileCoordinate)||++p,++d},t.prototype.createTileOrGetFromCacheIfExist=function(t){var e=null;return this.tileCache&&(e=this.tileCache.pop(t.toString()))&&this.updateTileCacheFn&&this.updateTileCacheFn(e),e||(e=this.createTileFn(t)),this.tiles.set(t.toString(),{tileCoordinate:t,tile:e}),e},t.prototype.getTile=function(t){return this.tiles.has(t.toString())?this.tiles.get(t.toString()).tile:null},t.prototype.update=function(t,e,i){this.updateRenderableTiles(t,e,i)},t.prototype.clear=function(){this.tiles.clear(),this.clearTileCache(),this.renderTiles=[]},t.prototype.clearTileCache=function(){this.tileCache&&this.tileCache.clear()},t.prototype.getTileCache=function(){return this.tileCache},t.prototype.getTiles=function(){return this.tiles},t.prototype.getRenderTiles=function(){return this.renderTiles},t}();e.TilePyramid=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.unwrappedTileCoordinate=t,this.tile=e}return t.prototype.clone=function(){return new t(this.unwrappedTileCoordinate,this.tile)},t.prototype.getTile=function(){return this.tile},t.prototype.getUnwrappedTileCoordinate=function(){return this.unwrappedTileCoordinate},t}();e.RenderTile=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=i(10),o=function(){function t(e){var i={};n.MapUtils.extendOptions(i,t.defaultMarkerLabelOptions,e);for(var o=0,a=i;o<a.length;o++){if(null==a[o])throw Error("Parameters can not be null")}this.fontWeight="normal"!=i.fontWeight&&"bold"!=i.fontWeight?"normal":i.fontWeight,this.color=i.color,this.fontSize=i.fontSize,this.maxWidth=i.maxWidth,this.line=i.line,this.text=i.text,this.halo=i.halo,this.haloColor=i.haloColor,this.anchor=r.Point.convert(i.anchor);var s={};n.MapUtils.extendOptions(s,t.defaultMarginOptions,i.margin),this.marginOptions=s}return t.prototype.getColor=function(){return this.color},t.prototype.getFontWeight=function(){return this.fontWeight},t.prototype.getFontSize=function(){return this.fontSize},t.prototype.getMaxWidth=function(){return this.maxWidth},t.prototype.getLine=function(){return this.line},t.prototype.getText=function(){return this.text},t.prototype.hasHalo=function(){return this.halo},t.prototype.getHaloColor=function(){return this.haloColor},t.prototype.getAnchor=function(){return this.anchor},t.prototype.getMargin=function(){return this.marginOptions},t.defaultMarkerLabelOptions={text:"",color:"#000000",fontWeight:"normal",fontSize:13,maxWidth:200,line:1,halo:!0,haloColor:"#ffffff",anchor:new r.Point(.5,.5),margin:{top:0,bottom:0,left:0,right:0}},t.defaultMarginOptions={top:0,bottom:0,left:0,right:0},t}();e.MarkerLabel=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o,a=i(5),s=i(118);!function(t){t[t.PLACE=0]="PLACE",t[t.ROAD=1]="ROAD",t[t.BOUNDARY=2]="BOUNDARY"}(o=e.LabelType||(e.LabelType={}));var l=function(t){function e(e,i,n,r){var s=t.call(this,"",e,n,r)||this;s.id="label|"+s.osmId,s.type=i,s.fontSize=n.size,s.haloColor=n.haloColor,s.reverse=!1,s.position=[];var l=n.coordinates||[];if(i==o.PLACE)2==l.length&&s.position.push(new a.LatLng(l[1],l[0]));else if(l.length>=2){var u=l[0]||[],h=l[l.length-1]||[];2==u.length&&2==h.length&&(s.position.push(new a.LatLng(u[1],u[0])),s.position.push(new a.LatLng(h[1],h[0])))}return s}return r(e,t),e.prototype.setReverse=function(t){this.reverse=t},e.prototype.getLabelType=function(){return this.type},e.prototype.getFontSize=function(){return this.fontSize},e.prototype.hasHalo=function(){return null!=this.haloColor},e.prototype.getHaloColor=function(){return this.haloColor},e.prototype.isReverse=function(){return this.reverse},e.prototype.getConfigZoom=function(){return this.zoom},e.prototype.getPosition=function(){return this.position},e.prototype.setVisible=function(t){this.visible=t},e}(s.VectorLayerProperties);e.LabelLayerProperties=l},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o,a=i(0),s=i(27),l=i(14),u=i(22),h=i(8),c=i(3),f=i(1),p=i(38);!function(t){t[t.LINE=0]="LINE",t[t.POLYGON=1]="POLYGON"}(o=e.SurfaceType||(e.SurfaceType={}));var d=function(t){function e(e,i){var n=t.call(this,e)||this;return n.gl=i,console.assert(e==a.LayerType.SURFACE||e==a.LayerType.BOUNDARY,"Invalid surface layer type"),n}return r(e,t),e.prototype.init=function(t){var e=this;if(0!=t.length){var i=f.MapUtils.getTileSize();t.forEach((function(t){e.properties=t.getProperties();var n=e.properties;switch(t.getType()){case l.GeometryType.LineString:e.surfaceType=o.LINE,e.buildLine(t,i,n.getWidth());break;case l.GeometryType.Polygon:e.surfaceType=o.POLYGON,e.buildPolygon(t,i);break;default:console.error("Invalid GeometryType")}}))}else console.error("Empty features")},e.prototype.upload=function(t,e){},e.prototype.destroy=function(){this.model&&this.model.destroy()},e.prototype.getSurfaceType=function(){return this.surfaceType},e.prototype.getModel=function(){return this.model},e.prototype.buildLine=function(t,e,i){if(!(i<=0))if(t.getType()==l.GeometryType.LineString){var n=[],r=new p.PolylineBuilderContext;r.addVertex=function(t,e,i){n.push(t.x,t.y,e.x,e.y,i.x,i.y)},r.lineCapType=p.LineCapType.Round,r.lineJoinType=p.LineJoinType.Round;for(var o=t.getGeometries().geometryCoordinates,a=0;a<o.length;++a){for(var u=[],f=0;f<o[a].length;++f){var d=new c.Vector2(o[a][f][0],o[a][f][1]);d.x=d.x*e,d.y=d.y*e,u.push(d)}r.buildPolyLine(u,null,i)}this.model=new s.Model(this.gl),this.model.init(n,[new h.AttributeInfo("a_position",2,0,6),new h.AttributeInfo("a_extrude",2,2,6),new h.AttributeInfo("a_uv",2,4,6)],r.indices)}else console.warn("Invalid geometry type: "+t.getType())},e.prototype.signedArea=function(t){for(var e,i,n=0,r=0,o=t.length,a=o-1;r<o;a=r++)e=t[r],n+=((i=t[a]).x-e.x)*(e.y+i.y);return n},e.prototype.buildPolygon=function(t,e){var i=[],n=[],r=i.length/2,o=new p.PolygonBuilderContext;if(o.addVertex=function(t){i.push(t.x,t.y)},t.getType()==l.GeometryType.Polygon){for(var a=t.getGeometries().geometryCoordinates,u=[],f=0;f<a.length;++f){for(var d=[],g=0;g<a[f].length;++g){var y=new c.Vector2(a[f][g][0],a[f][g][1]);y.x=y.x*e,y.y=y.y*e,d.push(y)}var m=this.signedArea(d);0!==m&&(m<0?(u.length>0&&(p.buildPolygon(u,o),o.indices.forEach((function(t){return n.push(t+r)})),r=i.length/2),u=[d]):u.push(d))}u.length>0&&(p.buildPolygon(u,o),o.indices.forEach((function(t){return n.push(t+r)}))),this.model=new s.Model(this.gl),this.model.init(i,[new h.AttributeInfo("a_position",2,0,2)],n)}},e}(u.LayerRenderData);e.SurfaceLayerRenderData=d},function(t,e,i){"use strict";var n,r="object"==typeof Reflect?Reflect:null,o=r&&"function"==typeof r.apply?r.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function c(t,e,i,n){var r,o,a,s;if(u(i),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),o=t._events),a=o[e]),void 0===a)a=o[e]=i,++t._eventsCount;else if("function"==typeof a?a=o[e]=n?[i,a]:[a,i]:n?a.unshift(i):a.push(i),(r=h(t))>0&&a.length>r&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=a.length,s=l,console&&console.warn&&console.warn(s)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},r=f.bind(n);return r.listener=i,n.wrapFn=r,r}function d(t,e,i){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(r):y(r,r.length)}function g(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function y(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return h(this)},s.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n="error"===t,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=r[t];if(void 0===l)return!1;if("function"==typeof l)o(l,this,e);else{var u=l.length,h=y(l,u);for(i=0;i<u;++i)o(h[i],this,e)}return!0},s.prototype.addListener=function(t,e){return c(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return c(this,t,e,!0)},s.prototype.once=function(t,e){return u(e),this.on(t,p(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,p(this,t,e)),this},s.prototype.removeListener=function(t,e){var i,n,r,o,a;if(u(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(r=-1,o=i.length-1;o>=0;o--)if(i[o]===e||i[o].listener===e){a=i[o].listener,r=o;break}if(r<0)return this;0===r?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,r),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var r,o=Object.keys(i);for(n=0;n<o.length;++n)"removeListener"!==(r=o[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},s.prototype.listeners=function(t){return d(this,t,!0)},s.prototype.rawListeners=function(t){return d(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(t,e,i){(e=t.exports=i(121)).Stream=e,e.Readable=e,e.Writable=i(84),e.Duplex=i(34),e.Transform=i(125),e.PassThrough=i(226)},function(t,e,i){"use strict";(function(e,n,r){var o=i(59);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,i){var n=t.entry;t.entry=null;for(;n;){var r=n.callback;e.pendingcb--,r(i),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=v;var s,l=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?n:o.nextTick;v.WritableState=m;var u=i(44);u.inherits=i(33);var h={deprecate:i(225)},c=i(122),f=i(60).Buffer,p=r.Uint8Array||function(){};var d,g=i(123);function y(){}function m(t,e){s=s||i(34),t=t||{};var n=e instanceof s;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,u=t.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(u||0===u)?u:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var i=t._writableState,n=i.sync,r=i.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),e)!function(t,e,i,n,r){--e.pendingcb,i?(o.nextTick(r,n),o.nextTick(T,t,e),t._writableState.errorEmitted=!0,t.emit("error",n)):(r(n),t._writableState.errorEmitted=!0,t.emit("error",n),T(t,e))}(t,i,n,e,r);else{var a=M(i);a||i.corked||i.bufferProcessing||!i.bufferedRequest||w(t,i),n?l(b,t,i,a,r):b(t,i,a,r)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function v(t){if(s=s||i(34),!(d.call(v,this)||this instanceof s))return new v(t);this._writableState=new m(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),c.call(this)}function _(t,e,i,n,r,o,a){e.writelen=n,e.writecb=a,e.writing=!0,e.sync=!0,i?t._writev(r,e.onwrite):t._write(r,o,e.onwrite),e.sync=!1}function b(t,e,i,n){i||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),T(t,e)}function w(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var n=e.bufferedRequestCount,r=new Array(n),o=e.corkedRequestsFree;o.entry=i;for(var s=0,l=!0;i;)r[s]=i,i.isBuf||(l=!1),i=i.next,s+=1;r.allBuffers=l,_(t,e,!0,e.length,r,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;i;){var u=i.chunk,h=i.encoding,c=i.callback;if(_(t,e,!1,e.objectMode?1:u.length,u,h,c),i=i.next,e.bufferedRequestCount--,e.writing)break}null===i&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}function M(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function x(t,e){t._final((function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),T(t,e)}))}function T(t,e){var i=M(e);return i&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(x,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),i}u.inherits(v,c),m.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(m.prototype,"buffer",{get:h.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===v&&(t&&t._writableState instanceof m)}})):d=function(t){return t instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(t,e,i){var n,r=this._writableState,a=!1,s=!r.objectMode&&(n=t,f.isBuffer(n)||n instanceof p);return s&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(i=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof i&&(i=y),r.ended?function(t,e){var i=new Error("write after end");t.emit("error",i),o.nextTick(e,i)}(this,i):(s||function(t,e,i,n){var r=!0,a=!1;return null===i?a=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),o.nextTick(n,a),r=!1),r}(this,r,t,i))&&(r.pendingcb++,a=function(t,e,i,n,r,o){if(!i){var a=function(t,e,i){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,i));return e}(e,n,r);n!==a&&(i=!0,r="buffer",n=a)}var s=e.objectMode?1:n.length;e.length+=s;var l=e.length<e.highWaterMark;l||(e.needDrain=!0);if(e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else _(t,e,!1,s,n,r,o);return l}(this,r,s,t,e,i)),a},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},v.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(t,e,i){var n=this._writableState;"function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!=t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(t,e,i){e.ending=!0,T(t,e),i&&(e.finished?o.nextTick(i):t.once("finish",i));e.ended=!0,t.writable=!1}(this,n,i)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,i(18),i(223).setImmediate,i(32))},function(t,e,i){"use strict";(function(e){var n=i(233);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function r(t,e){if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0}function o(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=i(29),s=Object.prototype.hasOwnProperty,l=Array.prototype.slice,u="foo"===function(){}.name;function h(t){return Object.prototype.toString.call(t)}function c(t){return!o(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var f=t.exports=v,p=/\s*function\s+([^\(\s]*)\s*/;function d(t){if(a.isFunction(t)){if(u)return t.name;var e=t.toString().match(p);return e&&e[1]}}function g(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function y(t){if(u||!a.isFunction(t))return a.inspect(t);var e=d(t);return"[Function"+(e?": "+e:"")+"]"}function m(t,e,i,n,r){throw new f.AssertionError({message:i,actual:t,expected:e,operator:n,stackStartFunction:r})}function v(t,e){t||m(t,!0,e,"==",f.ok)}function _(t,e,i,n){if(t===e)return!0;if(o(t)&&o(e))return 0===r(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(c(t)&&c(e)&&h(t)===h(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var s=(n=n||{actual:[],expected:[]}).actual.indexOf(t);return-1!==s&&s===n.expected.indexOf(e)||(n.actual.push(t),n.expected.push(e),function(t,e,i,n){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(i&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var r=b(t),o=b(e);if(r&&!o||!r&&o)return!1;if(r)return t=l.call(t),e=l.call(e),_(t,e,i);var s,u,h=x(t),c=x(e);if(h.length!==c.length)return!1;for(h.sort(),c.sort(),u=h.length-1;u>=0;u--)if(h[u]!==c[u])return!1;for(u=h.length-1;u>=0;u--)if(s=h[u],!_(t[s],e[s],i,n))return!1;return!0}(t,e,i,n))}return i?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function w(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function M(t,e,i,n){var r;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(n=i,i=null),r=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(i&&i.name?" ("+i.name+").":".")+(n?" "+n:"."),t&&!r&&m(r,i,"Missing expected exception"+n);var o="string"==typeof n,s=!t&&r&&!i;if((!t&&a.isError(r)&&o&&w(r,i)||s)&&m(r,i,"Got unwanted exception"+n),t&&r&&i&&!w(r,i)||!t&&r)throw r}f.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return g(y(t.actual),128)+" "+t.operator+" "+g(y(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var i=new Error;if(i.stack){var n=i.stack,r=d(e),o=n.indexOf("\n"+r);if(o>=0){var a=n.indexOf("\n",o+1);n=n.substring(a+1)}this.stack=n}}},a.inherits(f.AssertionError,Error),f.fail=m,f.ok=v,f.equal=function(t,e,i){t!=e&&m(t,e,i,"==",f.equal)},f.notEqual=function(t,e,i){t==e&&m(t,e,i,"!=",f.notEqual)},f.deepEqual=function(t,e,i){_(t,e,!1)||m(t,e,i,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,i){_(t,e,!0)||m(t,e,i,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,i){_(t,e,!1)&&m(t,e,i,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,i,n){_(e,i,!0)&&m(e,i,n,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,i){t!==e&&m(t,e,i,"===",f.strictEqual)},f.notStrictEqual=function(t,e,i){t===e&&m(t,e,i,"!==",f.notStrictEqual)},f.throws=function(t,e,i){M(!0,t,e,i)},f.doesNotThrow=function(t,e,i){M(!1,t,e,i)},f.ifError=function(t){if(t)throw t},f.strict=n((function t(e,i){e||m(e,!0,i,"==",t)}),f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var x=Object.keys||function(t){var e=[];for(var i in t)s.call(t,i)&&e.push(i);return e}}).call(this,i(32))},function(t,e,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o,a=i(15),s=i(0),l=i(11),u=i(8),h=i(12),c=i(20),f=i(2),p=i(9);!function(t){t[t.Building=0]="Building",t[t.Selection=1]="Selection",t[t.Shadow=2]="Shadow"}(o=e.BuildingRenderType||(e.BuildingRenderType={}));var d=function(t){function e(e,i,n){var r=t.call(this,i,n)||this;return r.gl=e,r.fogStartUniformValue=Number.POSITIVE_INFINITY,r.fogRangeUniformValue=Number.POSITIVE_INFINITY,r.shadowMvpMatrix=new p.Matrix4,r}return r(e,t),e.prototype.render=function(){if(this.mapState.is3dMode()&&this.layer.mapView.isBuildingsEnabled())if(this.layer.getLayerType()==s.LayerType.BUILDING){var t=this.layer;this.renderInternal(o.Building,t)}else console.warn("This layer is not building !")},e.prototype.renderSelection=function(){if(this.mapState.is3dMode())if(this.layer.getLayerType()==s.LayerType.BUILDING){var t=this.layer;this.renderInternal(o.Selection,t)}else console.warn("This layer is not building !")},e.prototype.renderShadowMapping=function(){if(this.mapState.is3dMode())if(this.layer.getLayerType()==s.LayerType.BUILDING){var t=this.layer;this.renderInternal(o.Shadow,t)}else console.warn("This layer is not building !")},e.prototype.renderOutlining=function(t){var e=this;if(t&&0!=t.size){var i=l.ResourceManager.getInstance(this.gl).getShader(l.ShaderEnum.BUILDING_OUTLINING);i.bind(),this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.NOTEQUAL,1,255),this.gl.stencilMask(0),t.forEach((function(t){var n=t.getModel();null!=n&&0!=n.attributeInfos.length&&(n.bind(),i.setAttributes(n.attributeInfos),i.setUniforms([new u.UniformInfo("u_modelMatrix","matrix",t.getScaledModelMatrix()),new u.UniformInfo("u_mvpMatrix","matrix",t.getScaledMvpMatrix())]),n.render(e.gl.TRIANGLES),n.unbind())})),this.gl.disable(this.gl.STENCIL_TEST),i.disableAttributes()}},e.prototype.renderInternal=function(t,e){if(0!=e.textureBuildingGroups.size||0!=e.extrudeBuildings.length){var i=l.ResourceManager.getInstance(this.gl);this.gl.enable(this.gl.DEPTH_TEST);var n=null;if(this.fogStartUniformValue=Number.POSITIVE_INFINITY,this.fogRangeUniformValue=Number.POSITIVE_INFINITY,t===o.Building){if(this.mapState.getTilt()>f.MapConstants.maxTiltIntersectWithScreen){var r=f.MapConstants.defaultMaxNativeZoom,a=1.5*this.mapState.getScreenSize().y,s=Math.pow(2,Math.max(this.mapState.getZoom()-r,0));this.fogStartUniformValue=a*s+256}else this.fogStartUniformValue=99999999999,this.fogRangeUniformValue=99999999999;(n=e.effectManager.enableShadowEffect?i.getShader(l.ShaderEnum.BUILDING_WITH_SHADOW_SHADER):i.getShader(l.ShaderEnum.BUILDING_SHADER)).bind();var h=e.lightManager.sunLight,c=e.timeEffectManager.getFogColor();n.setUniforms([new u.UniformInfo("u_light_position","3f",h.lightPosition),new u.UniformInfo("u_light_color","3fv",h.lightColor.rgbBuffer()),new u.UniformInfo("u_fogStart","1f",this.fogStartUniformValue),new u.UniformInfo("u_fogRange","1f",this.fogRangeUniformValue),new u.UniformInfo("u_fogColor","3fv",c.rgbBuffer())])}else t===o.Selection?(n=i.getShader(l.ShaderEnum.BUILDING_SELECTION_SHADER)).bind():t===o.Shadow&&(e.effectManager.shadowMap.bind(),(n=i.getShader(l.ShaderEnum.SHADOW_MAPPING_SHADER)).bind());var p=new Set;this.renderTextureBuildings(t,e,n,p),this.renderExtrudeBuildings(t,e,n,p),this.gl.disable(this.gl.DEPTH_TEST),t==o.Shadow&&e.effectManager.shadowMap.unbind(),n.disableAttributes(),this.renderOutlining(p),p.clear()}},e.prototype.renderTextureBuildings=function(t,e,i,n){var r=this;if(0!=e.textureBuildingGroups.size){var p=l.ResourceManager.getInstance(this.gl).getTexture(l.TextureEnum.WHITE_TEXTURE);e.textureBuildingGroups.forEach((function(l){var d=l.getModel();null!=d&&0!=d.attributeInfos.length&&l.buildings.forEach((function(l){var g=l.getLayerProperties(),y=g.getId(),m=r.layer.mapView,v=l.getType();if((v==s.LayerType.USERBUILDING||!m.hasVisibleBuildings()||m.isVisibleBuilding(y))&&(v==s.LayerType.USERBUILDING||m.isVisibleBuilding(y)||!m.isHiddenBuilding(y))&&(v!=s.LayerType.USERBUILDING||g.isVisible())){if(l.finishedGrowUp()||(l.updateMatrices(r.mapState,!0),r.layer.mapView.requestRender()),t===o.Building){g.isSelected()&&(r.gl.enable(r.gl.STENCIL_TEST),r.gl.stencilFunc(r.gl.ALWAYS,1,255),r.gl.stencilMask(255),n.add(l));var _=l.getTexture();if(null!=_&&_.isLoaded||(_=p),(x=e.effectManager).enableShadowEffect){var b=x.shadowMap;r.shadowMvpMatrix.copy(l.getModelMatrix()),r.shadowMvpMatrix.concat(b.getLightViewProjectionMatrix()).concat(f.MapConstants.biasMatrix),i.setUniforms([new u.UniformInfo("u_shadowMap","texture",b.getShadowMapTexture()),new u.UniformInfo("u_shadowMvpMatrix","matrix",r.shadowMvpMatrix)])}i.setUniforms([new u.UniformInfo("u_camera_direction","3f",r.mapState.cameraPositionVector),new u.UniformInfo("u_modelMatrix","matrix",l.getModelMatrix()),new u.UniformInfo("u_mvpMatrix","matrix",l.getMvpMatrix()),new u.UniformInfo("u_texture","texture",_)])}else if(t===o.Selection){var w=a.LayerRenderer.getSelectionCode();l.setSelectionCode(w);var M=h.Color.fromInt(w);i.setUniforms([new u.UniformInfo("u_color","3f",new c.Vector3(M.red,M.green,M.blue)),new u.UniformInfo("u_mvpMatrix","matrix",l.getMvpMatrix())])}else if(t===o.Shadow){var x;b=(x=e.effectManager).shadowMap;r.shadowMvpMatrix.copy(l.getModelMatrix()),r.shadowMvpMatrix.concat(b.getLightViewProjectionMatrix()),i.setUniforms([new u.UniformInfo("u_shadowMvpMatrix","matrix",r.shadowMvpMatrix)])}d.bind(),i.setAttributes(d.attributeInfos),d.render(r.gl.TRIANGLES),d.unbind(),i.resetTextureUnit(),t===o.Building&&g.isSelected()&&r.gl.disable(r.gl.STENCIL_TEST)}}))}))}},e.prototype.renderExtrudeBuildings=function(t,e,i,n){var r=this;if(0!=e.extrudeBuildings.length){var p=l.ResourceManager.getInstance(this.gl).getTexture(l.TextureEnum.WHITE_TEXTURE);if(t===o.Building){var d=e.effectManager;if(d.enableShadowEffect){var g=d.shadowMap;i.setUniforms([new u.UniformInfo("u_shadowMap","texture",g.getShadowMapTexture())])}}e.extrudeBuildings.forEach((function(l){if(t!==o.Shadow){var d=l.getLayerProperties(),g=d.getId(),y=r.layer.mapView,m=l.getType();if((m==s.LayerType.USERBUILDING||!y.hasVisibleBuildings()||y.isVisibleBuilding(g))&&(m==s.LayerType.USERBUILDING||y.isVisibleBuilding(g)||!y.isHiddenBuilding(g))&&(m!=s.LayerType.USERBUILDING||d.isVisible())){var v=l.getModel();if(null!=v&&0!=v.attributeInfos.length){if(l.finishedGrowUp()||(l.updateMatrices(r.mapState,!0),r.layer.mapView.requestRender()),t===o.Building){d.isSelected()&&(r.gl.enable(r.gl.STENCIL_TEST),r.gl.stencilFunc(r.gl.ALWAYS,1,255),r.gl.stencilMask(255),n.add(l));var _=l.getTexture();if(null!=_&&_.isLoaded||(_=p),(x=e.effectManager).enableShadowEffect){var b=x.shadowMap;r.shadowMvpMatrix.copy(l.getModelMatrix()),r.shadowMvpMatrix.concat(b.getLightViewProjectionMatrix()).concat(f.MapConstants.biasMatrix),i.setUniforms([new u.UniformInfo("u_shadowMvpMatrix","matrix",r.shadowMvpMatrix)])}i.setUniforms([new u.UniformInfo("u_texture","texture",_),new u.UniformInfo("u_camera_direction","3f",r.mapState.cameraPositionVector),new u.UniformInfo("u_modelMatrix","matrix",l.getModelMatrix()),new u.UniformInfo("u_mvpMatrix","matrix",l.getMvpMatrix())])}else if(t===o.Selection){var w=a.LayerRenderer.getSelectionCode();l.setSelectionCode(w);var M=h.Color.fromInt(w);i.setUniforms([new u.UniformInfo("u_color","3f",new c.Vector3(M.red,M.green,M.blue)),new u.UniformInfo("u_mvpMatrix","matrix",l.getMvpMatrix())])}else if(t===o.Shadow){var x;b=(x=e.effectManager).shadowMap;r.shadowMvpMatrix.copy(l.getModelMatrix()),r.shadowMvpMatrix.concat(b.getLightViewProjectionMatrix()),i.setUniforms([new u.UniformInfo("u_shadowMvpMatrix","matrix",r.shadowMvpMatrix)])}v.bind(),i.setAttributes(v.attributeInfos),v.render(r.gl.TRIANGLES),v.unbind(),i.resetTextureUnit(),t===o.Building&&d.isSelected()&&r.gl.disable(r.gl.STENCIL_TEST)}}}}))}},e}(a.LayerRenderer);e.BuildingLayerRenderer=d},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(9),a=i(8),s=i(0),l=i(15),u=i(11),h=i(1),c=i(2),f=i(7),p=i(63),d=i(12),g=i(3),y=i(141),m=function(t){function e(e,i){var n=t.call(this,e,i)||this,r=u.ResourceManager.getInstance(n.layer.mapView.gl);return n.shader=r.getShader(u.ShaderEnum.SYMBOL_SHADER),n.model=r.getModel(u.ModelEnum.SYMBOL_MODEL),n.mvpMatrix=new o.Matrix4,n}return r(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==s.LayerType.POI){if(!this.mapState.is3dMode()&&this.layer.mapView.isPOIsEnabled()){var t=this.layer;null!=t.poiRenderDatas&&0!=t.poiRenderDatas.length&&this.renderPOIs(t.poiRenderDatas)}}else console.error("Invalid layer type")},e.prototype.renderPOIs=function(t){var e=this,i=this.layer.mapView.gl;i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),this.shader.bind(),this.model.bind(),this.shader.setAttributes(this.model.attributeInfos);var n=this.mapState.cameraPosition,r=this.mapState.getScreenSize(),o=this.mapState.getOrthoProjectionMatrix(),s=[],l=this.mapState.getViewProjectionMatrix();t.forEach((function(t,u){var p=u.getLayerProperties();if(null!=p&&u.isVisible()){var g=u.getTexture();if(null!=g&&g.isLoaded){var y=c.MapConstants.placeWidth*h.MapUtils.pixelScale,m=c.MapConstants.placeHeight*h.MapUtils.pixelScale,v=f.GeometryUtils.latLngToScreenCoordinate(p.getPosition(),0,n,r,l),_=c.MapConstants.poiAnchor;e.mvpMatrix.setIdentity(y/2,m/2,1),e.mvpMatrix.translate((.5-_.x)*y,(.5-_.y)*m,0),e.mvpMatrix.translate(v.x,v.y,0),e.mvpMatrix.concat(o),e.shader.setUniforms([new a.UniformInfo("u_mvpMatrix","matrix",e.mvpMatrix),new a.UniformInfo("u_texture","texture",g)]),e.model.render(i.TRIANGLES),e.shader.resetTextureUnit();var b=p.getTitleColor();if(!b){var w=g.color?g.color:c.MapConstants.poiDefaultColor;b=d.Color.fromHex(w)}u.isTextVisible()&&u.getTextData()&&s.push({textData:u.getTextData(),color:b,halo:p.getHaloColor(),coordinate:v,symbolWidth:y,symbolHeight:m,anchor:_})}}})),s.length>0&&s.forEach((function(t){e.renderSymbolLabel(t.coordinate,t.symbolWidth,t.symbolHeight,t.anchor,t.textData,t.color,t.halo)})),this.model.unbind(),i.disable(i.BLEND)},e.prototype.renderSymbolLabel=function(t,e,i,n,r,o,a){var s=0,l=0,u=0,f=0,d=new p.Point(0,.5),m=h.MapUtils.pixelScale,v=c.MapConstants.poiLabelAnchor,_=r.widthPerLine==c.MapConstants.none?r.width:r.widthPerLine,b=(v.x-n.x)*e+(u-f)*m+_*(.5-d.x),w=(v.y-n.y)*i+(s-l)*m+r.height*(.5-d.y),M=t.add(new g.Vector2(b,w));y.TextLabelRenderer.render(this.layer.mapView.gl,this.mapState,r,M,o,null!=a,a)},e}(l.LayerRenderer);e.POILayerRenderer=m},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(291),s=i(57),l=function(t){function e(e,i,n){var r=t.call(this,e,i,o.LayerType.BUILDING,n)||this;return r.extrudeBuildings=[],r.dirty=!0,r.textureBuildingGroups=new Map,r.buildingIds=new Set,r}return r(e,t),e.prototype.update=function(t){if(t.is3dMode())if(this.getLayerType()==o.LayerType.BUILDING){if(this.dirty&&(this.dirty=!1,this.mapView.isBuildingsEnabled())){this.clear();var e=this.mapView.tileManager.getTilePyramid().getRenderTiles();this.updateInternal(t,e)}}else console.warn("This layer is not building !")},e.prototype.updateInternal=function(t,e){var i=this,n=new Set(this.mapView.getSelectedBuildings());e.forEach((function(e){e.getTile().getTileRenderData().getLayerRenderDatas().forEach((function(e,r){if(e.getType()==i.getLayerType()){var l=e,u=e.getLayerProperties();if(i.isInFilterBuildingTypes(u.getTypes())){var h=u.getId();if(!i.buildingIds.has(h))if(i.buildingIds.add(h),l.updateMatrices(t),i.layerType!=o.LayerType.USERBUILDING&&u.setSelected(n.has(h)),l.getBuildingType()==s.BuildingType.Polygon)i.extrudeBuildings.push(l);else{var c=u.getModelName(),f=i.textureBuildingGroups.get(c);if(null==f){var p=new a.BuildingGroup(c);p.addBuilding(l),i.textureBuildingGroups.set(c,p)}else f.addBuilding(l)}}}}))})),this.lightManager.update(t.getCamera().getTarget())},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.setLightingManager=function(t){this.lightManager=t},Object.defineProperty(e.prototype,"effectManager",{get:function(){return this._effectManager},set:function(t){this._effectManager=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeEffectManager",{get:function(){return this._timeEffectManager},set:function(t){this._timeEffectManager=t},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.textureBuildingGroups.clear(),this.extrudeBuildings=[],this.buildingIds.clear()},Object.defineProperty(e.prototype,"filterBuildingTypes",{get:function(){return this._filterBuildingTypes},set:function(t){this._filterBuildingTypes=t,this.dirty=!0},enumerable:!0,configurable:!0}),e.prototype.isInFilterBuildingTypes=function(t){return!this._filterBuildingTypes||!this._filterBuildingTypes.length||this._filterBuildingTypes.length<1||!!t&&this._filterBuildingTypes.some((function(e){return-1!==t.indexOf(e)}))},e}(o.Layer);e.BuildingLayer=l},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(47);function a(t){var e,i=0;if(0==t.length)return i;for(e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return i}var s=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this,o=n.getLayerProperties();return r.rank=o.getRank(),r.hash=a(o.getId()),r.zoom=0,r}return r(e,t),e.prototype.setVisible=function(t){var e=this.renderData;e.setVisible(t),t||(e.setHideTextOnly(!1),e.setTextVisible(t))},e.prototype.isVisible=function(){return this.renderData.isVisible()},e}(o.CollisionItem);e.POICollisionIconRenderData=s;var l=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}return r(e,t),e.prototype.setVisible=function(t){var e=this.renderData;e.setHideTextOnly(!0),e.setTextVisible(t)},e.prototype.isVisible=function(){return this.renderData.isTextVisible()},e}(s);e.POICollisionTextRenderData=l;var u=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this,o=n.getLayerProperties();return r.rank=o.getCollisionRank(),r.hash=a(o.getId()),r.zoom=o.getConfigZoom(),r}return r(e,t),e.prototype.setVisible=function(t){this.renderData.getLayerProperties().setVisible(t)},e.prototype.isVisible=function(){return this.renderData.getLayerProperties().isVisible()},e}(o.CollisionItem);e.LabelCollisionRenderData=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Rainy=0]="Rainy",t[t.Snowy=1]="Snowy",t[t.Sunny=2]="Sunny",t[t.Cloudy=3]="Cloudy",t[t.Live=4]="Live",t[t.None=5]="None"}(e.Weather||(e.Weather={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Live=0]="Live",t[t.Morning=1]="Morning",t[t.Noon=2]="Noon",t[t.AfterNoon=3]="AfterNoon",t[t.Evening=4]="Evening",t[t.None=5]="None"}(e.TimeEffect||(e.TimeEffect={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5);!function(t){var e=function(){function t(t){if(null==t)throw new Error("Parameter coordinate can not be null");this._coordinate=n.LatLng.convert(t)}return t.prototype.get=function(){return this._coordinate},t.prototype.forEachLatLng=function(t){this._coordinate&&t(this._coordinate)},t.prototype.getType=function(){return"Point"},t}();t.Point=e;var i=function(){function t(t){if(null==t)throw new Error("Parameter coordinates can not be null");this._coordinates=t.map((function(t){return n.LatLng.convert(t)}))}return t.prototype.forEachLatLng=function(t){this._coordinates&&this._coordinates.forEach((function(e){return t(e)}))},t.prototype.getType=function(){return"MultiPoint"},t.prototype.getArray=function(){return this._coordinates},t.prototype.getAt=function(t){return this._coordinates[t]},t.prototype.getLength=function(){return this._coordinates.length},t}();t.MultiPoint=i;var r=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t.map((function(t){return n.LatLng.convert(t)}))}return t.prototype.forEachLatLng=function(t){this._elements&&this._elements.forEach((function(e){return t(e)}))},t.prototype.getType=function(){return"LineString"},t}();t.LineString=r;var o=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t.map((function(t){return n.LatLng.convert(t)}))}return Object.defineProperty(t.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),t}();t.LinearRing=o;var a=function(){function t(t){if(null==t)throw new Error("Parameter element can not be null");this._elements=t}return t.prototype.forEachLatLng=function(t){this._elements.forEach((function(e){e.elements.forEach((function(e){return t(e)}))}))},t.prototype.getArray=function(){return this._elements},t.prototype.getAt=function(t){return this._elements[t]},t.prototype.getLength=function(){return this._elements.length},t.prototype.getType=function(){return"Polygon"},t}();t.Polygon=a;var s=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t}return t.prototype.forEachLatLng=function(t){this._elements.forEach((function(e){return e.forEachLatLng(t)}))},t.prototype.getAt=function(t){if(t<0||t>=this._elements.length)throw new Error("Index out of size");return this._elements[t]},t.prototype.getLength=function(){return this._elements.length},t.prototype.getType=function(){return"MultiPolygon"},t}();t.MultiPolygon=s;var l=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t}return t.prototype.forEachLatLng=function(t){this._elements.forEach((function(e){return e.forEachLatLng(t)}))},t.prototype.getAt=function(t){if(t<0||t>=this._elements.length)throw new Error("Index out of size");return this._elements[t]},t.prototype.getLength=function(){return this._elements.length},t.prototype.getType=function(){return"MultiLineString"},t}();t.MultiLineString=l;var u=function(){function t(t,e,i){this._id=t,this._geometry=e,this._properties=i}return t.prototype.getId=function(){return this._id},t.prototype.getGeometry=function(){return this._geometry},t.prototype.getProperties=function(){return this._properties},t}();t.Feature=u}(e.Data||(e.Data={}));var r=function(){function t(t){this._mapView=t}return t.prototype.addGeoJson=function(t){return this._mapView.getGeoJsonManager().addGeoJson(t)},t.prototype.add=function(t){return this._mapView.getGeoJsonManager().addFeature(t)},t.prototype.remove=function(t){return this._mapView.getGeoJsonManager().removeFeature(t)},t.prototype.clear=function(){return this._mapView.getGeoJsonManager().removeAllFeatures()},t.prototype.addListener=function(t,e){return this._mapView.addGeoJsonListener(t,e)},t.prototype.setMinZoom=function(t){if(null==t)throw Error("Parameter can not be null");this._mapView.setDataLayerMinZoom(t)},t.prototype.setMaxZoom=function(t){if(null==t)throw Error("Parameter can not be null");this._mapView.setDataLayerMaxZoom(t)},t.prototype.getMinZoom=function(){return this._mapView.getDataLayerMinZoom()},t.prototype.getMaxZoom=function(){return this._mapView.getDataLayerMaxZoom()},t}();e.MapData=r},function(t,e,i){"use strict";function n(t,e,i,n,r,o){var a=r-i,s=o-n;if(0!==a||0!==s){var l=((t-i)*a+(e-n)*s)/(a*a+s*s);l>1?(i=r,n=o):l>0&&(i+=a*l,n+=s*l)}return(a=t-i)*a+(s=e-n)*s}function r(t,e,i,n){var r={id:void 0===t?null:t,type:e,geometry:i,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)o(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var n=0;n<e.length;n++)o(t,e[n]);else if("MultiPolygon"===i)for(n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)o(t,e[n][r])}(r),r}function o(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function a(t,e,i,n){if(e.geometry){var o=e.geometry.coordinates,h=e.geometry.type,c=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),f=[],p=e.id;if(i.promoteId?p=e.properties[i.promoteId]:i.generateId&&(p=n||0),"Point"===h)s(o,f);else if("MultiPoint"===h)for(var d=0;d<o.length;d++)s(o[d],f);else if("LineString"===h)l(o,f,c,!1);else if("MultiLineString"===h){if(i.lineMetrics){for(d=0;d<o.length;d++)f=[],l(o[d],f,c,!1),t.push(r(p,"LineString",f,e.properties));return}u(o,f,c,!1)}else if("Polygon"===h)u(o,f,c,!0);else{if("MultiPolygon"!==h){if("GeometryCollection"===h){for(d=0;d<e.geometry.geometries.length;d++)a(t,{id:p,geometry:e.geometry.geometries[d],properties:e.properties},i,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(d=0;d<o.length;d++){var g=[];u(o[d],g,c,!0),f.push(g)}}t.push(r(p,h,f,e.properties))}}function s(t,e){e.push(h(t[0])),e.push(c(t[1])),e.push(0)}function l(t,e,i,r){for(var o,a,s=0,l=0;l<t.length;l++){var u=h(t[l][0]),f=c(t[l][1]);e.push(u),e.push(f),e.push(0),l>0&&(s+=r?(o*f-u*a)/2:Math.sqrt(Math.pow(u-o,2)+Math.pow(f-a,2))),o=u,a=f}var p=e.length-3;e[2]=1,function t(e,i,r,o){for(var a,s=o,l=r-i>>1,u=r-i,h=e[i],c=e[i+1],f=e[r],p=e[r+1],d=i+3;d<r;d+=3){var g=n(e[d],e[d+1],h,c,f,p);if(g>s)a=d,s=g;else if(g===s){var y=Math.abs(d-l);y<u&&(a=d,u=y)}}s>o&&(a-i>3&&t(e,i,a,o),e[a+2]=s,r-a>3&&t(e,a,r,o))}(e,0,p,i),e[p+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function u(t,e,i,n){for(var r=0;r<t.length;r++){var o=[];l(t[r],o,i,n),e.push(o)}}function h(t){return t/360+.5}function c(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function f(t,e,i,n,o,a,s,l){if(n/=e,a>=(i/=e)&&s<n)return t;if(s<i||a>=n)return null;for(var u=[],h=0;h<t.length;h++){var c=t[h],f=c.geometry,g=c.type,m=0===o?c.minX:c.minY,v=0===o?c.maxX:c.maxY;if(m>=i&&v<n)u.push(c);else if(!(v<i||m>=n)){var _=[];if("Point"===g||"MultiPoint"===g)p(f,_,i,n,o);else if("LineString"===g)d(f,_,i,n,o,!1,l.lineMetrics);else if("MultiLineString"===g)y(f,_,i,n,o,!1);else if("Polygon"===g)y(f,_,i,n,o,!0);else if("MultiPolygon"===g)for(var b=0;b<f.length;b++){var w=[];y(f[b],w,i,n,o,!0),w.length&&_.push(w)}if(_.length){if(l.lineMetrics&&"LineString"===g){for(b=0;b<_.length;b++)u.push(r(c.id,g,_[b],c.tags));continue}"LineString"!==g&&"MultiLineString"!==g||(1===_.length?(g="LineString",_=_[0]):g="MultiLineString"),"Point"!==g&&"MultiPoint"!==g||(g=3===_.length?"Point":"MultiPoint"),u.push(r(c.id,g,_,c.tags))}}}return u.length?u:null}function p(t,e,i,n,r){for(var o=0;o<t.length;o+=3){var a=t[o+r];a>=i&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function d(t,e,i,n,r,o,a){for(var s,l,u=g(t),h=0===r?v:_,c=t.start,f=0;f<t.length-3;f+=3){var p=t[f],d=t[f+1],y=t[f+2],b=t[f+3],w=t[f+4],M=0===r?p:d,x=0===r?b:w,T=!1;a&&(s=Math.sqrt(Math.pow(p-b,2)+Math.pow(d-w,2))),M<i?x>i&&(l=h(u,p,d,b,w,i),a&&(u.start=c+s*l)):M>n?x<n&&(l=h(u,p,d,b,w,n),a&&(u.start=c+s*l)):m(u,p,d,y),x<i&&M>=i&&(l=h(u,p,d,b,w,i),T=!0),x>n&&M<=n&&(l=h(u,p,d,b,w,n),T=!0),!o&&T&&(a&&(u.end=c+s*l),e.push(u),u=g(t)),a&&(c+=s)}var A=t.length-3;p=t[A],d=t[A+1],y=t[A+2],(M=0===r?p:d)>=i&&M<=n&&m(u,p,d,y),A=u.length-3,o&&A>=3&&(u[A]!==u[0]||u[A+1]!==u[1])&&m(u,u[0],u[1],u[2]),u.length&&e.push(u)}function g(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function y(t,e,i,n,r,o){for(var a=0;a<t.length;a++)d(t[a],e,i,n,r,o,!1)}function m(t,e,i,n){t.push(e),t.push(i),t.push(n)}function v(t,e,i,n,r,o){var a=(o-e)/(n-e);return t.push(o),t.push(i+(r-i)*a),t.push(1),a}function _(t,e,i,n,r,o){var a=(o-i)/(r-i);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function b(t,e){for(var i=[],n=0;n<t.length;n++){var o,a=t[n],s=a.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)o=w(a.geometry,e);else if("MultiLineString"===s||"Polygon"===s){o=[];for(var l=0;l<a.geometry.length;l++)o.push(w(a.geometry[l],e))}else if("MultiPolygon"===s)for(o=[],l=0;l<a.geometry.length;l++){for(var u=[],h=0;h<a.geometry[l].length;h++)u.push(w(a.geometry[l][h],e));o.push(u)}i.push(r(a.id,s,o,a.tags))}return i}function w(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var n=0;n<t.length;n+=3)i.push(t[n]+e,t[n+1],t[n+2]);return i}function M(t,e){if(t.transformed)return t;var i,n,r,o=1<<t.z,a=t.x,s=t.y;for(i=0;i<t.features.length;i++){var l=t.features[i],u=l.geometry,h=l.type;if(l.geometry=[],1===h)for(n=0;n<u.length;n+=2)l.geometry.push(x(u[n],u[n+1],e,o,a,s));else for(n=0;n<u.length;n++){var c=[];for(r=0;r<u[n].length;r+=2)c.push(x(u[n][r],u[n][r+1],e,o,a,s));l.geometry.push(c)}}return t.transformed=!0,t}function x(t,e,i,n,r,o){return[Math.round(i*(t*n-r)),Math.round(i*(e*n-o))]}function T(t,e,i,n,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,A(a,t[s],o,r);var l=t[s].minX,u=t[s].minY,h=t[s].maxX,c=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),h>a.maxX&&(a.maxX=h),c>a.maxY&&(a.maxY=c)}return a}function A(t,e,i,n){var r=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<r.length;s+=3)a.push(r[s]),a.push(r[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)L(a,r,t,i,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<r.length;s++)L(a,r[s],t,i,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var u=r[l];for(s=0;s<u.length;s++)L(a,u[s],t,i,!0,0===s)}if(a.length){var h=e.tags||null;if("LineString"===o&&n.lineMetrics){for(var c in h={},e.tags)h[c]=e.tags[c];h.mapbox_clip_start=r.start/r.size,h.mapbox_clip_end=r.end/r.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:h};null!==e.id&&(f.id=e.id),t.features.push(f)}}function L(t,e,i,n,r,o){var a=n*n;if(n>0&&e.size<(r?a:n))i.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===n||e[l+2]>a)&&(i.numSimplified++,s.push(e[l]),s.push(e[l+1])),i.numPoints++;r&&function(t,e){for(var i=0,n=0,r=t.length,o=r-2;n<r;o=n,n+=2)i+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(i>0===e)for(n=0,r=t.length;n<r/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[r-2-n],t[n+1]=t[r-1-n],t[r-2-n]=a,t[r-1-n]=s}}(s,o),t.push(s)}}function S(t,e){return new E(t,e)}function E(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)a(i,t.features[n],e,n);else"Feature"===t.type?a(i,t,e):a(i,{geometry:t},e);return i}(t,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(t,e){var i=e.buffer/e.extent,n=t,r=f(t,1,-1-i,i,0,-1,2,e),o=f(t,1,1-i,2+i,0,-1,2,e);return(r||o)&&(n=f(t,1,-i,1+i,0,-1,2,e)||[],r&&(n=b(r,1).concat(n)),o&&(n=n.concat(b(o,-1)))),n}(n,e)).length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function I(t,e,i){return 32*((1<<t)*i+e)+t}i.r(e),i.d(e,"default",(function(){return S})),E.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},E.prototype.splitTile=function(t,e,i,n,r,o,a){for(var s=[t,e,i,n],l=this.options,u=l.debug;s.length;){n=s.pop(),i=s.pop(),e=s.pop(),t=s.pop();var h=1<<e,c=I(e,i,n),p=this.tiles[c];if(!p&&(u>1&&console.time("creation"),p=this.tiles[c]=T(t,e,i,n,l),this.tileCoords.push({z:e,x:i,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=t,r){if(e===l.maxZoom||e===r)continue;var g=1<<r-e;if(i!==Math.floor(o/g)||n!==Math.floor(a/g))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var y,m,v,_,b,w,M=.5*l.buffer/l.extent,x=.5-M,A=.5+M,L=1+M;y=m=v=_=null,b=f(t,h,i-M,i+A,0,p.minX,p.maxX,l),w=f(t,h,i+x,i+L,0,p.minX,p.maxX,l),t=null,b&&(y=f(b,h,n-M,n+A,1,p.minY,p.maxY,l),m=f(b,h,n+x,n+L,1,p.minY,p.maxY,l),b=null),w&&(v=f(w,h,n-M,n+A,1,p.minY,p.maxY,l),_=f(w,h,n+x,n+L,1,p.minY,p.maxY,l),w=null),u>1&&console.timeEnd("clipping"),s.push(y||[],e+1,2*i,2*n),s.push(m||[],e+1,2*i,2*n+1),s.push(v||[],e+1,2*i+1,2*n),s.push(_||[],e+1,2*i+1,2*n+1)}}},E.prototype.getTile=function(t,e,i){var n=this.options,r=n.extent,o=n.debug;if(t<0||t>24)return null;var a=1<<t,s=I(t,e=(e%a+a)%a,i);if(this.tiles[s])return M(this.tiles[s],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var l,u=t,h=e,c=i;!l&&u>0;)u--,h=Math.floor(h/2),c=Math.floor(c/2),l=this.tiles[I(u,h,c)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,h,c),o>1&&console.time("drilling down"),this.splitTile(l.source,u,h,c,t,e,i),o>1&&console.timeEnd("drilling down"),this.tiles[s]?M(this.tiles[s],r):null):null}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.geojson="json",t.mvt="mvt"}(e.VectorFormat||(e.VectorFormat={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(5),o=i(153),a=i(6),s=i(7),l=i(13),u=i(2),h=i(154),c=i(10),f=i(1),p=function(){};e.CameraAnimationOptions=p;var d=function(){this.anchor=null,this.target=null,this.zoom=null,this.tilt=null,this.bearing=null};function g(t,e,i,n){var r=new o.UnitBezier(t,e,i,n);return function(t){return r.solve(t,u.MathConstants.epsilon)}}e.CameraOptions=d,e.bezier=g,e.defaultEasing=g(0,0,.25,1);var y=function(){function t(t,e,i){this.onUpdateTransitions=null,this.mapState=t,this.cameraAnimationObserver=e,this.mapSettings=i,this.flingTracker=new h.FlingTracker(u.MapConstants.flingTimeConstant,e)}return t.prototype.moveBy=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1);var r=new d,o=this.mapState.getTarget(),s=a.ProjectionMercator.getMetersPerPixelAtLatitude(u.MapConstants.metersPerPixelAtLatitude,this.mapState.getZoom()),l=new n.Vector2(t.x,t.y).multiply(s);l=l.rotateBy(-this.mapState.cameraPosition.getBearing()),r.target=a.ProjectionMercator.convertToLatLngFromMeter(a.ProjectionMercator.convertToMeterFromLatLng(o).add(l)),null==e?e=new p:null==e.duration&&(e.duration=f.MapUtils.getTimePanTo(this.mapState.getTarget(),r.target,this.mapState.getZoom())),e.gesture=i,this.mapState.gesture=i,this.mapState.movingTo=!0,this.easeTo(r,e)},t.prototype.moveTo=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),null==e&&(e=new p),e.gesture=i,this.mapState.gesture=i,t.zoom<u.MapConstants.defaultMinZoom3d&&this.mapState.enable3dMode(!1),this.mapState.movingTo=!0,this.easeTo(t,e)},t.prototype.zoom=function(t,e,i){this.mapState.startedZoom=!0,this.flingTracker.stopFling(),i.duration||(i.duration=u.MapConstants.defaultAnimationDuration);var n=new d;n.zoom=t,n.anchor=e,this.easeTo(n,i)},t.prototype.isAnimated=function(){return this.mapState.panning||this.mapState.zoomIn||this.mapState.zoomOut||this.mapState.flyingTo},t.prototype.moveByVelocity=function(t){this.flingTracker.startFling(t.x,t.y)},t.prototype.setTilt=function(t,e){void 0===e&&(e=!1);var i=new d,n=new p;n.gesture=e,this.mapState.gesture=e,t=l.MathUtils.clamp(t,this.mapSettings.getMinTilt(),this.mapSettings.getMaxTilt()),i.tilt=t,this.mapState.tilting=!0,this.easeTo(i,n)},t.prototype.setBearing=function(t,e,i){void 0===i&&(i=!1);var n=new d,r=new p;r.gesture=i,this.mapState.gesture=i,n.bearing=t,e&&e>0&&(r.duration=1e3*e),this.mapState.bearing=!0,this.easeTo(n,r)},t.prototype.easeTo=function(t,e){var i=this,n=this.mapState.getZoom(),o=null!=t.zoom?t.zoom:this.mapState.getZoom(),l=this.mapState.getBearing(),h=this.mapState.getTilt(),c=this.mapState.getTarget(),f=t.bearing,p=t.tilt,d=null!=t.target?t.target:this.mapState.getTarget(),g=t.anchor,y=new r.LatLng(0,0);g&&((y=s.GeometryUtils.screenCoordinateToLatLng(g,this.mapState.cameraPosition,this.mapState.getScreenSize())).valid()||(y=this.mapState.getCamera().getTarget())),this.mapState.zoomIn=o>n&&o-n>u.MathConstants.epsilon,this.mapState.zoomOut=n>o&&n-o>u.MathConstants.epsilon,this.mapState.panning=c!=d;this.startTransition(e,(function(t){var e=+(n*(1-t)+o*t).toFixed(4);if(null!=f){var u=(l+(f-l)*t)%360;i.mapState.setBearing(u)}if(null!=p){var m=h+(p-h)*t;i.mapState.setTilt(m)}var v=c.lat*(1-t)+d.lat*t,_=c.lng*(1-t)+d.lng*t,b=new r.LatLng(v,_);if(i.mapState.setZoom(e),i.mapState.setTarget(b),g){var w=Math.pow(2,e),M=a.ProjectionMercator.projectScale(i.mapState.getTarget(),w),x=a.ProjectionMercator.projectScale(y,w),T=s.GeometryUtils.screenCoordinateToLatLng(g,i.mapState.cameraPosition,i.mapState.getScreenSize());T.valid()||(T=i.mapState.getTarget());var A=a.ProjectionMercator.projectScale(T,Math.pow(2,e));i.mapState.setTarget(a.ProjectionMercator.unproject(M.add(x).subtract(A),w))}}))},t.prototype.startTransition=function(t,i){var n=this,r=t.duration?t.duration:0,o=t.easing?t.easing:e.defaultEasing,a=0!=r;this.transitionStart=Date.now(),this.transitionDuration=r,this.mapState.isWillChange()||(this.mapState.willChange=!0,this.cameraAnimationObserver.notifyCameraWillChange(t.gesture)),this.onUpdateTransitions=function(e){var r=a?(e-n.transitionStart)/n.transitionDuration:1;return i(r>=1?1:o(r)),n.cameraAnimationObserver.notifyCameraIsChanging(),!(r<1)&&((n.mapState.isZoomIn()||n.mapState.isZoomOut()||(n.mapState.isMoving()||n.mapState.isBearing()||n.mapState.isTilting())&&!n.mapState.isGesture()||n.mapState.isFlyingTo()||n.mapState.isBearing()&&null!=t.duration)&&n.cameraAnimationObserver.notifyCameraDidChange(),!0)},a||(this.updateTransitions(),this.onUpdateTransitions=null)},t.prototype.stopAnimation=function(){this.mapState.isBearing()&&(this.mapState.bearing=!1,this.onUpdateTransitions=null,this.mapState.isWillChange()&&this.cameraAnimationObserver.notifyCameraDidChange()),this.mapState.gesture=!1},t.prototype.updateTransitions=function(){if(null!=this.onUpdateTransitions){var t=Date.now(),e=this.onUpdateTransitions;this.onUpdateTransitions=null,e&&e(t)?(this.mapState.zoomIn=!1,this.mapState.zoomOut=!1,this.mapState.panning=!1,this.mapState.flyingTo=!1,this.mapState.movingTo=!1,this.mapState.bearing=!1,this.mapState.tilting=!1,e=null,this.onUpdateTransitions=null):null==this.onUpdateTransitions&&(this.onUpdateTransitions=e)}else this.flingTracker.isFlingInProgress()&&this.flingTracker.trackMovement()&&this.moveBy(new c.Point(this.flingTracker.dx,this.flingTracker.dy),null,!0)},t.prototype.flyTo=function(t,e){var i=this;if(this.flingTracker.stopFling(),!this.isAnimated()){var r=this.mapState.getZoom(),o=t.target,s=r;null!=t.zoom&&(s=l.MathUtils.clamp(+t.zoom,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()));var h=this.mapState.getTarget(),c=a.ProjectionMercator.projectScale(h,this.mapState.getScale()),f=a.ProjectionMercator.projectScale(o,this.mapState.getScale()),p=Math.max(this.mapState.getScreenSize().x,this.mapState.getScreenSize().y),d=p/Math.pow(2,s-r),g=Math.hypot(f.x-c.x,f.y-c.y),y=1.42;if(null!=e.minZoom){var m=l.MathUtils.clamp(Math.min(e.minZoom,r,s),this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),v=p/Math.pow(2,m-r);y=Math.sqrt(v/g*2)}var _=y*y,b=function(t){var e=(d*d-p*p+(t?-1:1)*_*_*g*g)/(2*(t?d:p)*_*g);return Math.log(Math.sqrt(e*e+1)-e)},w=b(0),M=b(1),x=function(t){return D(w)/D(w+y*t)},T=function(t){return p*(D(w)*(R(e=w+y*t)/D(e))-R(w))/_/g;var e},A=(M-w)/y;if(Math.abs(g)<u.MathConstants.epsilon||!isFinite(A)){if(Math.abs(p-d)<u.MathConstants.epsilon)return this.easeTo(t,e);var L=d<p?-1:1;A=Math.abs(Math.log(d/p))/y,T=function(){return 0},x=function(t){return Math.exp(L*y*t)}}if(null!=e.duration)e.duration=+e.duration;else{var S=null!=e.velocity?+e.velocity/y:1.2;e.duration=1e3*A/S}e.duration>u.MapConstants.maxDurationFlyTo&&(e.duration=u.MapConstants.maxDurationFlyTo);var E=this.mapState.getScale(),I=this.mapState.getBearing(),P=this.mapState.getTilt(),C=t.bearing,O=t.tilt;this.mapState.flyingTo=!0,s<u.MapConstants.defaultMinZoom3d&&this.mapState.enable3dMode(!1),this.startTransition(e,(function(t){var e=function(t){var e=t*A,o=1===t?1:T(e),h=new n.Vector2(c.x*(1-o)+f.x*o,c.y*(1-o)+f.y*o),p=1/x(e),d=1===t?s:r+Math.log(p)/Math.LN2;return d=l.MathUtils.clamp(d,i.mapSettings.getPreferMinZoom(),i.mapSettings.getMaxZoom()),Math.abs(t-1)<u.MathConstants.epsilon&&(d=s),d!=d&&(d=s),{target:a.ProjectionMercator.unproject(h,E),zoom:d}}(t);if(i.mapState.setZoom(e.zoom),i.mapState.setTarget(e.target),null!=C){var o=(I+(C-I)*t)%360;i.mapState.setBearing(o)}if(null!=O){var h=P+(O-P)*t;i.mapState.setTilt(h)}}))}function R(t){return(Math.exp(t)-Math.exp(-t))/2}function D(t){return(Math.exp(t)+Math.exp(-t))/2}},t}();e.CameraAnimation=y},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(5),a=function(t){function e(){var e=t.call(this)||this;return e.rank=0,e.iconUrl=null,e.position=new o.LatLng(0,0),e}return r(e,t),e.prototype.getId=function(){return this.id},e.prototype.setId=function(t){this.id=t},e.prototype.getPosition=function(){return this.position},e.prototype.setPosition=function(t){this.position=t},e.prototype.getTitle=function(){return this.title},e.prototype.setTitle=function(t){this.title=t},e.prototype.getSubtitle=function(){return this.subtitle},e.prototype.setSubtitle=function(t){this.subtitle=t},e.prototype.getTitleColor=function(){return this.titleColor},e.prototype.setTitleColor=function(t){this.titleColor=t},e.prototype.getType=function(){return this.type},e.prototype.setType=function(t){this.type=t},e.prototype.getTypes=function(){return this.types},e.prototype.setTypes=function(t){this.types=t},e.prototype.getRank=function(){return this.rank},e.prototype.setRank=function(t){this.rank=t},e.prototype.getIconUrl=function(){return this.iconUrl},e.prototype.setIconUrl=function(t){this.iconUrl=t},e.prototype.getFontSize=function(){return this.fontSize},e.prototype.setFontSize=function(t){this.fontSize=t},e.prototype.hasHalo=function(){return null!=this.haloColor},e.prototype.getHaloColor=function(){return this.haloColor},e.prototype.setHaloColor=function(t){this.haloColor=t},e}(i(25).LayerProperties);e.POILayerProperties=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(25),a=i(5),s=function(t){function e(){var e=t.call(this)||this;return e.modelType="Object",e.location=new a.LatLng(0,0),e.scale=1,e.bearing=0,e.elevation=0,e.height=0,e.minZoom=0,e.maxZoom=0,e.startDate=0,e.endDate=0,e.selected=!1,e.location=new a.LatLng(0,0),e.scale=1,e.bearing=0,e.name="Unknown name",e.elevation=0,e.objData=null,e.textureData=null,e.selected=!1,e}return r(e,t),e.prototype.getColor=function(){return this.color},e.prototype.setColor=function(t){this.color=t},e.prototype.getModelType=function(){return this.modelType},e.prototype.setModelType=function(t){this.modelType=t},e.prototype.getId=function(){return this.id},e.prototype.setId=function(t){this.id=t},e.prototype.getName=function(){return this.name},e.prototype.setName=function(t){this.name=t},e.prototype.setPlaces=function(t){this.places=t},e.prototype.getPlaces=function(){return this.places},e.prototype.getScale=function(){return this.scale},e.prototype.setScale=function(t){this.scale=t},e.prototype.setBearing=function(t){this.bearing=t},e.prototype.getBearing=function(){return this.bearing},e.prototype.setLocation=function(t){this.location=a.LatLng.convert(t)},e.prototype.getLocation=function(){return this.location},e.prototype.getElevation=function(){return this.elevation},e.prototype.setElevation=function(t){this.elevation=t},e.prototype.setCoordinates=function(t){this.coordinates=t},e.prototype.getCoordinates=function(){return this.coordinates},e.prototype.setCamera=function(t){this.camera=t},e.prototype.getCamera=function(){return this.camera},e.prototype.setTypes=function(t){this.types=t},e.prototype.getTypes=function(){return this.types},e.prototype.setVerified=function(t){this._isVerified=t},e.prototype.isVerified=function(){return this._isVerified},e.prototype.setMinZoom=function(t){this.minZoom=t},e.prototype.getMinZoom=function(){return this.minZoom},e.prototype.setMaxZoom=function(t){this.maxZoom=t},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.setStartDate=function(t){this.startDate=t},e.prototype.getStartDate=function(){return this.startDate},e.prototype.setEndDate=function(t){this.endDate=t},e.prototype.getEndDate=function(){return this.endDate},e.prototype.getTextureName=function(){return this.textureName},e.prototype.setTextureName=function(t){this.textureName=t},e.prototype.getTextureUrl=function(){return this.textureUrl},e.prototype.setTextureUrl=function(t){this.textureUrl=t},e.prototype.getTextureData=function(){return this.textureData},e.prototype.setTextureData=function(t){this.textureData=t},e.prototype.getModelName=function(){return this.modelName},e.prototype.setModelName=function(t){this.modelName=t},e.prototype.getModelUrl=function(){return this.modelUrl},e.prototype.setModelUrl=function(t){this.modelUrl=t},e.prototype.getObjData=function(){return this.objData},e.prototype.setObjData=function(t){this.objData=t},e.prototype.getBuildingType=function(){return this.buildingType},e.prototype.setBuildingType=function(t){this.buildingType=t},e.prototype.setHighestPosition=function(t){this.highestPosition=t},e.prototype.getHighestPosition=function(){return this.highestPosition},e.prototype.setHeight=function(t){this.height=t},e.prototype.getHeight=function(){return this.height},e.prototype.setSelected=function(t){this.selected=t},e.prototype.isSelected=function(){return this.selected},e}(o.LayerProperties);e.BuildingLayerProperties=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.generate=function(){return Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)+this.count++},t.count=0,t}();e.UUID=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this._text=t,this._size=e}return Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"text: "+this._text+" size: "+this._size},t}();e.TextLabel=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(74),r=function(){function t(){this.layerIds=[],this.layers=new Map}return t.prototype.setTileLayers=function(t){this.layers=t},t.prototype.setTileLayer=function(t,e){this.layers.has(t)&&console.warn("TileLayer exist!!!",t),-1==this.layerIds.indexOf(t)&&this.layerIds.push(t),this.layers.set(t,e)},t.prototype.addTileLayer=function(t,e){return this.layers.has(t)||(this.layerIds.push(t),this.layers.set(t,new n.TileLayer(t,e))),this.layers.get(t)},t.prototype.removeTileLayer=function(t){this.layers.delete(t);var e=this.layerIds.indexOf(t);e>=0&&this.layerIds.splice(e,1)},t.prototype.getTileLayer=function(t){return this.layers.get(t)},t.prototype.getLayerIds=function(){return this.layerIds},t.prototype.hasLayerType=function(t){var e=!1;return this.layers.forEach((function(i){e||i.getType()===t&&(e=!0)})),e},t}();e.TileData=r},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(17),a=function(t){function e(e,i){return t.call(this,o.Kind.VECTOR,e,i)||this}return r(e,t),e.prototype.destroy=function(){this.layerDatas.forEach((function(t){return t.destroy()}))},e}(i(178).GeometryTile);e.VectorTile=a},function(t,e,i){"use strict";t.exports=r,t.exports.default=r;var n=i(179);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,a=e;a<i;a++)o=t.children[a],l(r,t.leaf?n(o):o);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,e,i,r,o){for(var a,s=[e,i];s.length;)(i=s.pop())-(e=s.pop())<=r||(a=e+Math.ceil((i-e)/r/2)*r,n(t,a,e,i,o),s.push(e,a,a,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!d(t,e))return i;for(var r,o,a,s,l=[];e;){for(r=0,o=e.children.length;r<o;r++)a=e.children[r],d(t,s=e.leaf?n(a):a)&&(e.leaf?i.push(a):p(t,s)?this._all(a,i):l.push(a));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!d(t,e))return!1;for(var n,r,o,a,s=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],d(t,a=e.leaf?i(o):o)){if(e.leaf||p(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,a,s=this.data,l=this.toBBox(t),u=[],h=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],i=h.pop(),a=!0),s.leaf&&-1!==(r=o(t,s.children,e)))return s.children.splice(r,1),u.push(s),this._condense(u),this;a||s.leaf||!p(s,l)?n?(i++,s=n.children[i],a=!1):s=null:(u.push(s),h.push(i),i=0,n=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,s=this._maxEntries;if(o<=s)return a(r=g(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,n-1))),(r=g([])).leaf=!1,r.height=n;var l,u,h,c,f=Math.ceil(o/s),p=f*Math.ceil(Math.sqrt(s));for(y(t,e,i,p,this.compareMinX),l=e;l<=i;l+=p)for(y(t,l,h=Math.min(l+p-1,i),f,this.compareMinY),u=l;u<=h;u+=f)c=Math.min(u+f-1,h),r.children.push(this._build(t,u,c,n-1));return a(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,a,s,l,u,h,f,p,d;n.push(e),!e.leaf&&n.length-1!==i;){for(h=f=1/0,r=0,o=e.children.length;r<o;r++)l=c(a=e.children[r]),p=t,d=a,(u=(Math.max(d.maxX,p.maxX)-Math.min(d.minX,p.minX))*(Math.max(d.maxY,p.maxY)-Math.min(d.minY,p.minY))-l)<f?(f=u,h=l<h?l:h,s=a):u===f&&l<h&&(h=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],a=this._chooseSubtree(r,this.data,e,o);for(a.children.push(t),l(a,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),s=g(i.children.splice(o,i.children.length-o));s.height=i.height,s.leaf=i.leaf,a(i,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,a,l,u,h,f,p,d,g,y,m,v;for(u=h=1/0,n=e;n<=i-e;n++)r=s(t,0,n,this.toBBox),o=s(t,n,i,this.toBBox),p=r,d=o,g=void 0,y=void 0,m=void 0,v=void 0,g=Math.max(p.minX,d.minX),y=Math.max(p.minY,d.minY),m=Math.min(p.maxX,d.maxX),v=Math.min(p.maxY,d.maxY),a=Math.max(0,m-g)*Math.max(0,v-y),l=c(r)+c(o),a<u?(u=a,f=n,h=l<h?l:h):a===u&&l<h&&(h=l,f=n);return f},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,a=this.toBBox,u=s(t,0,e,a),h=s(t,i-e,i,a),c=f(u)+f(h);for(r=e;r<i-e;r++)o=t.children[r],l(u,t.leaf?a(o):o),c+=f(u);for(r=i-e-1;r>=e;r--)o=t.children[r],l(h,t.leaf?a(o):o),c+=f(h);return c},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)l(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(96),r=i(2),o=i(28),a=i(43),s=function(){function t(t){this.id=t,this.layerId=a.AnnotationManager.annotationLayerId+t.toString()}return t.prototype.reloadLayout=function(){this.geoJsonIndexer=null},t.prototype.updateTileData=function(t,e,i){var a=this;if(!this.geoJsonIndexer){var s={maxZoom:i,buffer:0,extent:r.MapConstants.tileExtend,tolerance:4};this.geoJsonIndexer=n.default(this.getFeatures(),s)}var l=this.geoJsonIndexer.getTile(t.getZoom(),t.getX(),t.getY());if(null!=l&&0!==l.features.length){var u=this.addTileLayer(e,this.layerId);l.features.forEach((function(t){var e=t.type,i=new o.GeometryCollection(t.geometry);u.addFeature(a.id.toString(),e,i,a.getProperties())}))}},t.prototype.getLayerId=function(){return this.layerId},t.prototype.clearIndex=function(){this.geoJsonIndexer=null},t}();e.ShapeAnnotationData=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(27),a=i(14),s=i(0),l=i(38),u=i(1),h=i(3),c=i(8),f=function(t){function e(e,i,n){void 0===n&&(n=null);var r=t.call(this,s.LayerType.LINE)||this;return r.gl=i,r.buildPolyline(e,n),r}return r(e,t),e.prototype.getModel=function(){return this.lineModel},e.prototype.buildPolyline=function(t,e){void 0===e&&(e=null);var i=[],n=new l.PolylineBuilderContext;n.addVertex=function(t,e,n){i.push(t.x,t.y,e.x,e.y,n.x,n.y)},n.lineCapType=l.LineCapType.Butt,n.lineJoinType=l.LineJoinType.Round;for(var r=u.MapUtils.getTileSize(),s=t.featureCount(),f=0;f<s;++f){var p=t.getFeature(f);if(p.getType()!=a.GeometryType.LineString)return void console.warn("Invalid geometry type: "+p.getType());for(var d=p.getGeometries().geometryCoordinates,g=0;g<d.length;++g){for(var y=[],m=0;m<d[g].length;++m){var v=new h.Vector2(d[g][m][0],d[g][m][1]);v.x=v.x*r,v.y=v.y*r,y.push(v)}n.buildPolyLine(y,null,e)}}this.lineModel=new o.Model(this.gl),this.lineModel.init(i,[new c.AttributeInfo("a_position",2,0,6),new c.AttributeInfo("a_extrude",2,2,6),new c.AttributeInfo("a_uv",2,4,6)],n.indices)},e.prototype.destroy=function(){this.lineModel&&this.lineModel.destroy()},e.prototype.init=function(t){var e=t[0].getProperties();this.setLayerProperties(e)},e.prototype.upload=function(t,e){},e.defaultStrokeWidth=5,e}(i(22).LayerRenderData);e.LineLayerRenderData=f},function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n,s,l,u,h,p,d,y=e&&e.length,m=y?e[0]*i:t.length,v=r(t,0,m,i,!0),_=[];if(!v||v.next===v.prev)return _;if(y&&(v=function(t,e,i,n){var a,s,l,u,h,p=[];for(a=0,s=e.length;a<s;a++)l=e[a]*n,u=a<s-1?e[a+1]*n:t.length,(h=r(t,l,u,n,!1))===h.next&&(h.steiner=!0),p.push(g(h));for(p.sort(c),a=0;a<p.length;a++)f(p[a],i),i=o(i,i.next);return i}(t,e,v,i)),t.length>80*i){n=l=t[0],s=u=t[1];for(var b=i;b<m;b+=i)(h=t[b])<n&&(n=h),(p=t[b+1])<s&&(s=p),h>l&&(l=h),p>u&&(u=p);d=0!==(d=Math.max(l-n,u-s))?1/d:0}return a(v,_,i,n,s,d),_}function r(t,e,i,n,r){var o,a;if(r===E(t,e,i,n)>0)for(o=e;o<i;o+=n)a=A(o,t[o],t[o+1],a);else for(o=i-n;o>=e;o-=n)a=A(o,t[o],t[o+1],a);return a&&_(a,a.next)&&(L(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!_(n,n.next)&&0!==v(n.prev,n,n.next))n=n.next;else{if(L(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function a(t,e,i,n,r,c,f){if(t){!f&&c&&function(t,e,i,n){var r=t;do{null===r.z&&(r.z=d(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,o,a,s,l,u=1;do{for(i=t,t=null,o=null,a=0;i;){for(a++,n=i,s=0,e=0;e<u&&(s++,n=n.nextZ);e++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,u*=2}while(a>1)}(r)}(t,n,r,c);for(var p,g,y=t;t.prev!==t.next;)if(p=t.prev,g=t.next,c?l(t,n,r,c):s(t))e.push(p.i/i),e.push(t.i/i),e.push(g.i/i),L(t),t=g.next,y=g.next;else if((t=g)===y){f?1===f?a(t=u(o(t),e,i),e,i,n,r,c,2):2===f&&h(t,e,i,n,r,c):a(o(t),e,i,n,r,c,1);break}}}function s(t){var e=t.prev,i=t,n=t.next;if(v(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(y(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&v(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function l(t,e,i,n){var r=t.prev,o=t,a=t.next;if(v(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,u=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,h=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,c=d(s,l,e,i,n),f=d(u,h,e,i,n),p=t.prevZ,g=t.nextZ;p&&p.z>=c&&g&&g.z<=f;){if(p!==t.prev&&p!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,g!==t.prev&&g!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&v(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;g&&g.z<=f;){if(g!==t.prev&&g!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&v(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function u(t,e,i){var n=t;do{var r=n.prev,a=n.next.next;!_(r,a)&&b(r,n,n.next,a)&&x(r,a)&&x(a,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(a.i/i),L(n),L(n.next),n=t=a),n=n.next}while(n!==t);return o(n)}function h(t,e,i,n,r,s){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&m(l,u)){var h=T(l,u);return l=o(l,l.next),h=o(h,h.next),a(l,e,i,n,r,s),void a(h,e,i,n,r,s)}u=u.next}l=l.next}while(l!==t)}function c(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var i,n=e,r=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a){if(a=s,s===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===a)return i;var l,u=i,h=i.x,c=i.y,f=1/0;n=i;do{r>=n.x&&n.x>=h&&r!==n.x&&y(o<c?r:a,o,h,c,o<c?a:r,o,n.x,n.y)&&(l=Math.abs(o-n.y)/(r-n.x),x(n,t)&&(l<f||l===f&&(n.x>i.x||n.x===i.x&&p(i,n)))&&(i=n,f=l)),n=n.next}while(n!==u);return i}(t,e)){var i=T(e,t);o(e,e.next),o(i,i.next)}}function p(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function d(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function y(t,e,i,n,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(i-a)*(e-s)>=0&&(i-a)*(o-s)-(r-a)*(n-s)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&b(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(x(t,e)&&x(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||_(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,i,n){var r=M(v(t,e,i)),o=M(v(t,e,n)),a=M(v(i,n,t)),s=M(v(i,n,e));return r!==o&&a!==s||(!(0!==r||!w(t,i,e))||(!(0!==o||!w(t,n,e))||(!(0!==a||!w(i,t,n))||!(0!==s||!w(i,e,n)))))}function w(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function M(t){return t>0?1:t<0?-1:0}function x(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function T(t,e){var i=new S(t.i,t.x,t.y),n=new S(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function A(t,e,i,n){var r=new S(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function L(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,i,n){for(var r=0,o=e,a=i-n;o<i;o+=n)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}t.exports=n,t.exports.default=n,n.deviation=function(t,e,i,n){var r=e&&e.length,o=r?e[0]*i:t.length,a=Math.abs(E(t,0,o,i));if(r)for(var s=0,l=e.length;s<l;s++){var u=e[s]*i,h=s<l-1?e[s+1]*i:t.length;a-=Math.abs(E(t,u,h,i))}var c=0;for(s=0;s<n.length;s+=3){var f=n[s]*i,p=n[s+1]*i,d=n[s+2]*i;c+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)i.vertices.push(t[r][o][a]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(110),s=i(16),l=i(2),u=i(13),h=i(1),c=function(t){function e(e,i){var n=t.call(this,o.LayerType.USERPOI)||this;return n.gl=i,n}return r(e,t),e.prototype.init=function(t){var e=t[0].getProperties();this.setLayerProperties(e)},e.prototype.upload=function(t,e){var i=s.MapResourceManager.getInstance(t),n=this.properties;if(null!=n.getIcon())n.isTextureDirty()?(i.releaseTexture(n.getId()),this.texture=i.createMarkerTexture(n.getId(),n.getIcon()),n.setTextureDirty(!1)):(this.texture=i.getTexture(n.getId()),null==this.texture&&(this.texture=i.createMarkerTexture(n.getId(),n.getIcon())));else{var r=n.getType();null!=r&&""!=r||(r="point");var o="!user_"+r;if(this.texture=i.getTexture(o),null==this.texture){var a=u.MathUtils.clamp(h.MapUtils.resourceScale,1,3)+"x",c=l.ServerConstants.getPOIImageUrl(1,r,a);this.texture=i.createPOITexture(o,c)}}},e}(a.POILayerRenderData);e.UserPOILayerRenderData=c},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(16),s=i(22),l=i(2),u=i(13),h=i(1),c=i(55),f=function(t){function e(e){var i=t.call(this,e||o.LayerType.POI)||this;return i.texture=null,i.textData=null,i}return r(e,t),e.prototype.destroy=function(){this.textData&&this.textData.destroy()},e.prototype.init=function(t){var e=this;t&&t.forEach((function(t){e.properties=t.getProperties()}))},e.prototype.upload=function(t,e){var i=a.MapResourceManager.getInstance(t),n=this.properties,r=n.getType(),o=n.getIconUrl();if(c.UrlUtils.isUrlRequest(o))this.texture=i.getTexture(o),null==this.texture&&(this.texture=i.createPOITexture(o,o));else if(null!=r&&""!=r){if(this.texture=i.getTexture(r),null==this.texture){var s=u.MathUtils.clamp(h.MapUtils.resourceScale,1,3)+"x",f=l.ServerConstants.getPOIImageUrl(0,r,s);this.texture=i.createPOITexture(r,f)}}else this.texture=i.getTexture("default_point")},e.prototype.getTexture=function(){return this.texture},e.prototype.isVisible=function(){return this.visible},e.prototype.setVisible=function(t){this.visible=t},e.prototype.isTextVisible=function(){return this.textVisible},e.prototype.setTextVisible=function(t){this.textVisible=t},e.prototype.isHideTextOnly=function(){return this.hideTextOnly},e.prototype.setHideTextOnly=function(t){this.hideTextOnly=t},e.prototype.getTextData=function(){return this.textData},e.prototype.setTextData=function(t){this.textData=t},e}(s.LayerRenderData);e.POILayerRenderData=f},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(112),a=i(0),s=i(16),l=i(57),u=i(72),h=function(t){function e(){return t.call(this,a.LayerType.USERBUILDING)||this}return r(e,t),e.prototype.upload=function(t,e,i){void 0===i&&(i=null),this.gl=t;var n=this.properties,r=n.getModelName(),o=s.MapResourceManager.getInstance(t);n.isGrowUp()?(o.hasVisibleBuildingId(n.getId())?this.growUpscale=n.growUpscale:n.growUpscale=0,o.retainVisibleBuildingId(n.getId())):this.growUpscale=1,n.updateExtrudeModel&&o.getModel(r)&&(this.model&&(this.model.release(),this.model=null),o.releaseModel(r),n.updateExtrudeModel=!1);var a=s.MapResourceManager.getInstance(t).getModel(r);a&&a.points.length>0&&(n.setCoverPoints(a.points),n.updateBounds(new u.BoundingBox(a.minX,a.minY,a.maxX,a.maxY)),n.onModelLoaded&&n.onModelLoaded(),n.onModelLoaded=null,n.annotationManager.setDirty()),this.bind(i)},e.prototype.destroy=function(){var e=this.properties;e.isGrowUp()&&s.MapResourceManager.getInstance(this.gl).removeVisibleBuildingId(e.getId()),this.getBuildingType()!=l.BuildingType.Polygon&&t.prototype.destroy.call(this)},e.prototype.updateMatrices=function(e,i){void 0===i&&(i=!1),t.prototype.updateMatrices.call(this,e,i),this.properties.growUpscale=this.growUpscale},e}(o.BuildingLayerRenderData);e.UserBuildingLayerRenderData=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(22),a=i(14),s=i(57),l=i(9),u=i(0),h=i(3),c=i(2),f=i(6),p=i(7),d=i(16),g=i(192),y=i(10),m=function(t){function e(e){var i=t.call(this,e)||this;return i.model=null,i.texture=null,i.extrudeData=null,i.growUpscale=0,i.isGrowing=!0,i.modelMatrix=new l.Matrix4,i.mvpMatrix=new l.Matrix4,i.scaledModelMatrix=new l.Matrix4,i.scaledMvpMatrix=new l.Matrix4,i}return r(e,t),e.prototype.destroy=function(){var t=this.properties,e=d.MapResourceManager.getInstance(this.gl);this.model&&(this.model.release(),this.model=null,e.releaseModel(t.getModelName())),this.texture&&this.type==s.BuildingType.Texture&&(this.texture.release(),this.texture=null,e.releaseTexture(t.getTextureName()))},e.prototype.getId=function(){return this.properties.getId()},e.prototype.getModel=function(){return this.model||this.bind(),this.model},e.prototype.getTexture=function(){return this.texture||this.bind(),this.texture},e.prototype.getBuildingType=function(){return this.type},e.prototype.getSelectionCode=function(){return this.selectionCode},e.prototype.setSelectionCode=function(t){this.selectionCode=t},e.prototype.getModelMatrix=function(){return this.modelMatrix},e.prototype.getMvpMatrix=function(){return this.mvpMatrix},e.prototype.getScaledModelMatrix=function(){return this.scaledModelMatrix},e.prototype.getScaledMvpMatrix=function(){return this.scaledMvpMatrix},e.prototype.finishedGrowUp=function(){return!this.isGrowing},e.prototype.resetScaleZ=function(){this.growUpscale=0,this.isGrowing=!0},e.prototype.init=function(t){var e=this;t.forEach((function(t){var i=t.getProperties();if(e.properties=i,t.getType()==a.GeometryType.Polygon){e.type=s.BuildingType.Polygon;for(var n=[],r=[],o=i.getCoordinates(),l=f.ProjectionMercator.convertToMeterFromLatLng(i.getLocation()),u=0;u<o.length;u++){var h=f.ProjectionMercator.convertToMeterFromLatLng(o[u]);r.push(new y.Point(h.x-l.x,l.y-h.y))}n.push(r),e.extrudeData=g.BuildingExtrudeUtils.extrudePolygon(n,1)}else e.type=s.BuildingType.Texture}))},e.prototype.bind=function(t){void 0===t&&(t=null);var e=this.properties,i=d.MapResourceManager.getInstance(this.gl);if(this.model=i.getModel(e.getModelName()),this.type==s.BuildingType.Polygon){if(null==this.model&&null!=this.extrudeData){this.model=i.createExtrudeModel(e.getModelName());var n=[].concat.apply([],this.extrudeData.vertices);this.model.init3dObject(n,this.extrudeData.indices),this.model.retain(),t&&t()}this.extrudeData=null}else this.model||(this.model=i.createModel(e.getModelName(),e.getModelUrl(),t)),this.texture=i.getTexture(e.getTextureName()),this.texture||(this.texture=i.createBuildingTexture(e.getTextureName(),e.getTextureUrl())),this.model&&this.model.retain(),this.texture&&this.texture.retain()},e.prototype.upload=function(t,e,i){void 0===i&&(i=null),this.gl=t;var n=this.properties,r=d.MapResourceManager.getInstance(this.gl);r.hasVisibleBuildingId(n.getId())&&(this.growUpscale=1),r.retainVisibleBuildingId(n.getId()),(null==e||e.mapSettings.objectsEnabled||this.layerType!=u.LayerType.BUILDING)&&this.bind(i)},e.prototype.updateMatrices=function(t,i){void 0===i&&(i=!1);var n=this.properties,r=1/f.ProjectionMercator.getMetersPerPixelAtLatitude(c.MapConstants.metersPerPixelAtLatitude,t.getZoom()),o=f.ProjectionMercator.projectScale(n.getLocation(),t.getScale()),a=p.GeometryUtils.pixelCoordinateToCameraCoordinate(new h.Vector2(o.x,o.y),t.cameraPosition),l=t.is3dMode()?p.GeometryUtils.getElevationPixelFromMeter(n.getElevation(),t.cameraPosition):0;i&&this.isGrowing&&(this.growUpscale+=.05,this.growUpscale>1&&(this.growUpscale=1,this.isGrowing=!1));var u=n.getScale()*r,d=this.growUpscale*n.getScale()*r;this.type!=s.BuildingType.Extrude&&this.type!=s.BuildingType.Polygon||(d*=n.getHeight()),this.modelMatrix.setRotationX(e.buildingRotationX),this.modelMatrix.rotateZ(n.getBearing()),this.modelMatrix.scale(u,u,d),this.modelMatrix.translate(a.x,a.y,l),this.mvpMatrix.copy(this.modelMatrix),this.mvpMatrix.concat(t.getViewProjectionMatrix());var g=.1,y=.1,m=.015;if(this.model&&this.model.minX&&this.model.minY&&this.model.maxX&&this.model.maxY){var v=5/(this.model.maxX-this.model.minX);v=v==1/0?.1:v,g=Math.max(g,v),v=(v=5/(this.model.maxY-this.model.minY))==1/0?.1:v,y=Math.max(y,v),v=(v=.5/(this.model.maxZ-this.model.minZ))==1/0?.1:v,m=Math.max(m,v)}this.scaledModelMatrix.setRotationX(e.buildingRotationX),this.scaledModelMatrix.rotateZ(n.getBearing()),this.scaledModelMatrix.scale(u+g,u+y,d+m),this.scaledModelMatrix.translate(a.x,a.y,l),this.scaledMvpMatrix.copy(this.scaledModelMatrix),this.scaledMvpMatrix.concat(t.getViewProjectionMatrix())},e.buildingRotationX=90,e}(o.LayerRenderData);e.BuildingLayerRenderData=m},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(195),a=function(t){function e(e,i,n,r){var o=t.call(this,i,n,r)||this;return o.id=e,o}return r(e,t),e.prototype.getId=function(){return this.id},e}(o.GeometryTileFeature);e.VectorTileFeature=a;var s=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.addFeature=function(t,e,i,n){void 0===n&&(n=new Map),this.features.push(new a(t,e,i,n))},e}(o.GeometryTileLayer);e.VectorTileLayer=s;var l=function(t){function e(){var e=t.call(this)||this;return e.layerIds=[],e.layers=new Map,e}return r(e,t),e.prototype.addLayer=function(t){return this.layers.has(t)||(this.layerIds.push(t),this.layers.set(t,new s(t))),this.layers.get(t)},e.prototype.getLayerIds=function(){return this.layerIds},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e}(o.GeometryTileData);e.VectorTileData=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(100),r=i(99),o=i(197),a=i(0),s=i(112),l=i(110),u=i(198),h=i(37),c=i(28),f=i(14),p=i(74),d=i(12),g=i(63),y=i(2),m=i(57),v=i(6),_=i(50),b=i(1),w=i(199),M=function(){function t(t,e,i,n){this.mapView=t,this.taskManager=e,this.requestRender=i,this.requestsMap=n}return t.prototype.update=function(){},t.prototype.isAllRequestFinished=function(){return 0==this.requestsMap.size},t.prototype.requestData=function(t,e,i,n,r,o){switch(e){case h.Resource.Tile:this.requestTileData(t,i);break;case h.Resource.RasterOverlay:this.requestRasterOverlayData(t,i,n);break;case h.Resource.POIOverlay:this.requestPOIOverlayData(t,i,n,r,o);break;case h.Resource.BuildingOverlay:this.requestBuildingOverlayData(t,i,n,r,o);break;default:console.warn("Unsupport request data for type:",e)}},t.prototype.requestRasterOverlayData=function(t,e,i){var n=this,r=t.getTileCoordinate(),s=new h.RequestTask(h.Resource.Texture);s.url=e,s.completion=function(e){if(e.success&&null!=e.data){var s=n.mapView.gl,l=n.mapView.mapState,h=t.getTileData(),d=t.getTileRenderData(),g=new p.TileLayer(i,a.LayerType.RASTER_OVERLAY),y=new o.RasterLayerProperties(e.data),m=new c.GeometryCollection([]);g.addFeature(i,f.GeometryType.Raster,m,y),h.setTileLayer(i,g);var v=new u.RasterLayerRenderData;v.init(g.getFeatures()),v.upload(s,l),d.setLayerRenderData(i,v),t.setRenderable(),n.requestRender(),n.requestsMap.delete(r.toString())}},this.requestsMap.set(r.toString(),s),this.taskManager.postTask(s)},t.prototype.requestPOIOverlayData=function(t,e,i,n,o){var s=this,u=t.getTileCoordinate(),m=new h.RequestTask(h.Resource.POIOverlay);m.url=e,m.completion=function(e){if(e.success&&null!=e.data){var h=s.mapView.gl,m=s.mapView.mapState,v=t.getTileData(),_=t.getTileRenderData(),w=s.mapView.mapStyle,M=o(e.data)||[];if(M.length>0){var x=new p.TileLayer(i,a.LayerType.POI_OVERLAY);M.forEach((function(t){if(null!=t){var e=new r.POILayerProperties;e.setId(n+t.id||""),e.setTitle(t.title||""),e.setPosition(g.LatLng.convert(t.position||{lat:0,lng:0})),e.setRank(t.zIndex||0),e.setType(t.type?t.type:"point"),e.setTypes([e.getType()]),e.setTitleColor(t.titleColor?d.Color.fromHex(t.titleColor):null),e.setIconUrl(t.icon?t.icon:null);var i=w.build("pois","points",u.getZoom(),null,null);i?(e.setFontSize(i.size),e.setHaloColor(i.halo.color)):e.setFontSize(y.MapConstants.placeFontSize*b.MapUtils.pixelScale);var o=new c.GeometryCollection([]);x.addFeature(e.getId(),f.GeometryType.Point,o,e)}})),v.setTileLayer(i,x),x.getFeatures().forEach((function(t){var e=new l.POILayerRenderData(a.LayerType.POI_OVERLAY);e.init([t]),e.upload(h,m),_.setLayerRenderData(t.getId(),e)}))}t.setRenderable(),s.requestRender(),s.requestsMap.delete(u.toString())}},this.requestsMap.set(u.toString(),m),this.taskManager.postTask(m)},t.prototype.requestBuildingOverlayData=function(t,e,i,r,o){var l=this,u=t.getTileCoordinate(),d=new h.RequestTask(h.Resource.BuildingOverlay);d.url=e,d.completion=function(e){if(e.success&&null!=e.data){var h=l.mapView.gl,d=l.mapView.mapState,y=t.getTileData(),_=t.getTileRenderData(),b=o(e.data)||[];if(b.length>0){for(var w=l.mapView.mapSettings.getDate().getTime(),M=b.length;M--;){var x=b[M],T=null!=x.startDate?x.startDate:Number.NEGATIVE_INFINITY,A=null!=x.endDate?x.endDate:Number.POSITIVE_INFINITY;(T>w||A<w)&&b.splice(M,1)}var L=new p.TileLayer(i,a.LayerType.BUILDING_OVERLAY);b.forEach((function(t){if(null!=t){var e=new n.BuildingLayerProperties;e.setId(r+t.id),e.setName(t.name||"Unknown name"),e.setHeight(t.height||1),e.setScale(t.scale||1),e.setBearing(t.bearing),e.setLocation(g.LatLng.convert(t.position||{lat:0,lng:0})),e.setElevation(t.elevation||0),e.setTypes([]),e.setStartDate(t.startDate||Number.NEGATIVE_INFINITY),e.setEndDate(t.endDate||Number.POSITIVE_INFINITY),e.setModelName(l.getNameFromUrl(t.model)),e.setModelUrl(t.model||""),e.setTextureName(l.getNameFromUrl(t.texture)),e.setTextureUrl(t.texture||""),null!=t.model?e.setModelType("Object"):e.setModelType("Polygon");var i=l.getBuildingType(e.getModelType()),o=new c.GeometryCollection([]);if(i==m.BuildingType.Extrude){for(var a=v.ProjectionMercator.convertToMeterFromLatLng(e.getLocation()),s=[],u=[],h=0;h<t.coordinates.length;++h){var p=t.coordinates[h],d=g.LatLng.convert(p);u.push(d);var y=v.ProjectionMercator.convertToMeterFromLatLng(d);s.push(new g.Point(y.x-a.x,a.y-y.y))}e.setCoordinates(u),o.geometryCoordinates.push(s),e.setModelName(e.getId()),L.addFeature(e.getId(),f.GeometryType.Polygon,o,e)}else L.addFeature(e.getId(),f.GeometryType.Building,o,e)}})),y.setTileLayer(i,L),L.getFeatures().forEach((function(t){var e=new s.BuildingLayerRenderData(L.getType());e.init([t]),e.upload(h,d),_.setLayerRenderData(t.getId(),e)})),l.mapView.overlayManager.dirtyBuildingOverlay()}t.setRenderable(),l.requestRender(),l.requestsMap.delete(u.toString())}},this.requestsMap.set(u.toString(),d),this.taskManager.postTask(d)},t.prototype.requestTileData=function(t,e){var i=this,d=this.mapView.getMapType(),M=t.getTileCoordinate(),x=new h.RequestTask(h.Resource.Tile);x.url=e,x.completion=function(e){if(e.success&&null!=e.data){var h=i.mapView.gl,x=i.mapView.mapState,T=t.getTileData(),A=t.getTileRenderData(),L=i.mapView.mapStyle,S=e.data.result||{};if(null!=S.rasterTile){var E=new p.TileLayer(y.LayerConstants.rasterTileLayerId,a.LayerType.RASTER),I=new o.RasterLayerProperties(S.rasterTile),P=new c.GeometryCollection([]);E.addFeature(y.LayerConstants.rasterTileLayerId,f.GeometryType.Raster,P,I),T.setTileLayer(y.LayerConstants.rasterTileLayerId,E);var C=new u.RasterLayerRenderData;C.init(E.getFeatures()),C.upload(h,x),A.setLayerRenderData(y.LayerConstants.rasterTileLayerId,C)}var O=S.places||[];if(O.length>0){var R=new p.TileLayer(y.LayerConstants.pointTileLayerId,a.LayerType.POI);O.forEach((function(t){var e=new r.POILayerProperties;e.setId(t.id),e.setTitle(t.name),e.setPosition(g.LatLng.convert(t.location)),e.setSubtitle(t.address);var i=t.types||[];e.setTypes(i),e.setRank((t.rank||{}).value||0),e.setType(i.length>0?i[0]:"point");var n=L.build("pois","points",M.getZoom(),null,null);n?(e.setFontSize(n.size),e.setHaloColor(n.halo.color)):e.setFontSize(y.MapConstants.placeFontSize*b.MapUtils.pixelScale);var o=new c.GeometryCollection([]);R.addFeature(e.getId(),f.GeometryType.Point,o,e)})),T.setTileLayer(y.LayerConstants.pointTileLayerId,R),R.getFeatures().forEach((function(t){var e=new l.POILayerRenderData;e.init([t]),e.upload(h,x),A.setLayerRenderData(t.getId(),e)}))}var D=S.objects||[];if(D.length>0){for(var k=i.mapView.mapSettings.getDate().getTime(),B=D.length;B--;){var U=D[B],N=null!=U.startDate?U.startDate:Number.NEGATIVE_INFINITY,F=null!=U.endDate?U.endDate:Number.POSITIVE_INFINITY;(N>k||F<k)&&D.splice(B,1)}var j=new p.TileLayer(y.LayerConstants.buildingTileLayerId,a.LayerType.BUILDING);D.forEach((function(t){if(null!=t){var e=new n.BuildingLayerProperties;e.setId(t.id||""),e.setName(t.name||"Unknown name"),e.setHeight(t.model.height||1),e.setScale(t.scale||1),e.setBearing(t.bearing),e.setLocation(g.LatLng.convert(t.location||{lat:0,lng:0})),e.setElevation(t.elevation||0),e.setCamera(t.camera),e.setTypes(t.types||[]),e.setMinZoom(t.minZoom||0),e.setMaxZoom(t.maxZoom||0),e.setStartDate(t.startDate||Number.NEGATIVE_INFINITY),e.setEndDate(t.endDate||Number.POSITIVE_INFINITY);var r=t.model.objName||"";e.setModelName(r),e.setModelUrl(y.ServerConstants.getModelObjUrl(r));var o=t.model.textureName||"";e.setTextureName(o),e.setTextureUrl(y.ServerConstants.getModelTextureUrl(o));var a=t.model.type||"Object";e.setModelType(a);var s=i.getBuildingType(t.model.type),l=new c.GeometryCollection([]);if(s==m.BuildingType.Extrude||s==m.BuildingType.ExternalExtrude){for(var u=v.ProjectionMercator.convertToMeterFromLatLng(e.getLocation()),h=[],p=[],d=0;d<t.model.coordinates.length;++d){var _=t.model.coordinates[d],b=g.LatLng.convert(_);p.push(b);var w=v.ProjectionMercator.convertToMeterFromLatLng(b);h.push(new g.Point(w.x-u.x,u.y-w.y))}e.setCoordinates(p),l.geometryCoordinates.push(h),e.setModelName(e.getId()),j.addFeature(e.getId(),f.GeometryType.Polygon,l,e)}else j.addFeature(e.getId(),f.GeometryType.Building,l,e)}})),T.setTileLayer(y.LayerConstants.buildingTileLayerId,j),j.getFeatures().forEach((function(t){var e=new s.BuildingLayerRenderData(j.getType());e.init([t]),e.upload(h,x),A.setLayerRenderData(t.getId(),e)})),i.mapView.dirtyLayer(a.LayerType.BUILDING)}if(d==_.MapType.roadmap&&null!=S.vectorTile)new w.VectorTileParser(t,h,L,S.format,i.mapView.mapSettings.getMapLanguage()).parse(S.vectorTile),i.mapView.dirtyLayer(a.LayerType.SURFACE),i.mapView.dirtyLayer(a.LayerType.ROADS);t.setRenderable(),i.requestRender(),i.requestsMap.delete(M.toString())}},this.requestsMap.set(M.toString(),x),this.taskManager.postTask(x)},t.prototype.reload=function(){var t=this;this.requestsMap.forEach((function(e){t.taskManager.cancelTask(e)})),this.requestsMap.clear()},t.prototype.cancelOutdatedTasks=function(t){var e=this;this.requestsMap.forEach((function(i,n,r){t.some((function(t){return t.getTileCoordinate().toString()==n}))||(r.delete(n),e.taskManager.cancelTask(i))}))},t.prototype.removeTaskResult=function(t,e){void 0===e&&(e=!1);var i=t.toString();if(e){var n=this.requestsMap.get(i);null!=n&&this.taskManager.cancelTask(n)}this.requestsMap.delete(i)},t.prototype.getBuildingType=function(t){return"Object"==t?m.BuildingType.Texture:"Polygon"==t?m.BuildingType.Extrude:"External"==t?m.BuildingType.External:"ExternalExtrude"==t?m.BuildingType.ExternalExtrude:void console.warn("Invalid building type: ",t)},t.prototype.getNameFromUrl=function(t){if(!t)return null;var e=t.split("/");return e[e.length-1]},t}();e.TaskDataManager=M},function(t,e){e.read=function(t,e,i,n,r){var o,a,s=8*r-n-1,l=(1<<s)-1,u=l>>1,h=-7,c=i?r-1:0,f=i?-1:1,p=t[e+c];for(c+=f,o=p&(1<<-h)-1,p>>=-h,h+=s;h>0;o=256*o+t[e+c],c+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=256*a+t[e+c],c+=f,h-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=u}return(p?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,i,n,r,o){var a,s,l,u=8*o-r-1,h=(1<<u)-1,c=h>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+c>=1?f/l:f*Math.pow(2,1-c))*l>=2&&(a++,l/=2),a+c>=h?(s=0,a=h):a+c>=1?(s=(e*l-1)*Math.pow(2,r),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,r),a=0));r>=8;t[i+p]=255&s,p+=d,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;t[i+p]=255&a,p+=d,a/=256,u-=8);t[i+p-d]|=128*g}},function(t,e,i){"use strict";var n=i(117);function r(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(o,this,e),this.length=this._features.length}function o(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){var e=null,i=t.readVarint()+t.pos;for(;t.pos<i;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(i))}t.exports=r,r.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,e,this.extent,this._keys,this._values)}},function(t,e,i){"use strict";var n=i(39);function r(t,e,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=r,t.readFields(o,this,e)}function o(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){var i=t.readVarint()+t.pos;for(;t.pos<i;){var n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function a(t){for(var e,i,n=0,r=0,o=t.length,a=o-1;r<o;a=r++)e=t[r],n+=((i=t[a]).x-e.x)*(e.y+i.y);return n}t.exports=r,r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,o=0,a=0,s=0,l=[];t.pos<i;){if(o<=0){var u=t.readVarint();r=7&u,o=u>>3}if(o--,1===r||2===r)a+=t.readSVarint(),s+=t.readSVarint(),1===r&&(e&&l.push(e),e=[]),e.push(new n(a,s));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&l.push(e),l},r.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,r=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var h=t.readVarint();i=7&h,n=h>>3}if(n--,1===i||2===i)(r+=t.readSVarint())<a&&(a=r),r>s&&(s=r),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==i)throw new Error("unknown command "+i)}return[a,l,s,u]},r.prototype.toGeoJSON=function(t,e,i){var n,o,s=this.extent*Math.pow(2,i),l=this.extent*t,u=this.extent*e,h=this.loadGeometry(),c=r.types[this.type];function f(t){for(var e=0;e<t.length;e++){var i=t[e],n=180-360*(i.y+u)/s;t[e]=[360*(i.x+l)/s-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(n=0;n<h.length;n++)p[n]=h[n][0];f(h=p);break;case 2:for(n=0;n<h.length;n++)f(h[n]);break;case 3:for(h=function(t){var e=t.length;if(e<=1)return[t];for(var i,n,r=[],o=0;o<e;o++){var s=a(t[o]);0!==s&&(void 0===n&&(n=s<0),n===s<0?(i&&r.push(i),i=[t[o]]):i.push(t[o]))}i&&r.push(i);return r}(h),n=0;n<h.length;n++)for(o=0;o<h[n].length;o++)f(h[n][o])}1===h.length?h=h[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:h},properties:this.properties};return"id"in this&&(d.id=this.id),d}},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(65),a=i(12),s=function(t){function e(e,i,n,r){var s=t.call(this)||this;s.id=e,s.layer=i;var l=n||{};switch(s.osmId=l.id||0,r){case o.MapLanguage.en:s.name=l["name:en"]||l.name;break;default:s.name=l["name:vi"]||l.name}return s.operator=l.operator,s.kind=l.kind,s.kindDetail=l.kind_detail,s.sortRank=l.sort_rank||0,s.minZoom=l.min_zoom||0,s.collisionRank=l.collision_rank||0,s.visible=!0,s.color=l.color||a.Color.fromInt(0),s.width=l.width||0,s.outlineWidth=l.outlineWidth||0,s.outlineColor=l.outlineColor||a.Color.fromInt(0),s}return r(e,t),e.prototype.isVisible=function(){return this.visible},e.prototype.getId=function(){return this.id},e.prototype.getOsmId=function(){return this.osmId},e.prototype.getName=function(){return this.name},e.prototype.getOperator=function(){return this.operator},e.prototype.getKind=function(){return this.kind},e.prototype.getKindDetail=function(){return this.kindDetail},e.prototype.getSortRank=function(){return this.sortRank},e.prototype.getMinZoom=function(){return this.minZoom},e.prototype.getCollisionRank=function(){return this.collisionRank},e.prototype.getColor=function(){return this.color},e.prototype.getWidth=function(){return this.width},e.prototype.hasOutline=function(){return this.outlineWidth>0},e.prototype.getOutlineWidth=function(){return this.outlineWidth},e.prototype.getOutlineColor=function(){return this.outlineColor},e}(i(25).LayerProperties);e.VectorLayerProperties=s},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){"use strict";var n=i(212),r=i(215);t.exports=function t(e){if(!e)return null;if(e instanceof ArrayBuffer)return e;if("string"==typeof e)return n(e);if(ArrayBuffer.isView(e))return e.byteOffset?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):e.buffer;var i;if(e.buffer||e.data||e._data)return i=t(e.buffer||e.data||e._data);if(Array.isArray(e))for(var o=0;o<e.length;o++)if(null!=e[o].length){e=r(e);break}return(i=new Uint8Array(e)).length?i.buffer:null}},function(t,e,i){"use strict";(function(e,n){var r=i(59);t.exports=_;var o,a=i(119);_.ReadableState=v;i(82).EventEmitter;var s=function(t,e){return t.listeners(e).length},l=i(122),u=i(60).Buffer,h=e.Uint8Array||function(){};var c=i(44);c.inherits=i(33);var f=i(220),p=void 0;p=f&&f.debuglog?f.debuglog("stream"):function(){};var d,g=i(221),y=i(123);c.inherits(_,l);var m=["error","close","destroy","pause","resume"];function v(t,e){t=t||{};var n=e instanceof(o=o||i(34));this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=i(124).StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function _(t){if(o=o||i(34),!(this instanceof _))return new _(t);this._readableState=new v(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function b(t,e,i,n,r){var o,a=t._readableState;null===e?(a.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,x(t)}(t,a)):(r||(o=function(t,e){var i;n=e,u.isBuffer(n)||n instanceof h||"string"==typeof e||void 0===e||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk"));var n;return i}(a,e)),o?t.emit("error",o):a.objectMode||e&&e.length>0?("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=function(t){return u.from(t)}(e)),n?a.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,a,e,!0):a.ended?t.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!i?(e=a.decoder.write(e),a.objectMode||0!==e.length?w(t,a,e,!1):A(t,a)):w(t,a,e,!1))):n||(a.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(a)}function w(t,e,i,n){e.flowing&&0===e.length&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,n?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&x(t)),A(t,e)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),_.prototype.destroy=y.destroy,_.prototype._undestroy=y.undestroy,_.prototype._destroy=function(t,e){this.push(null),e(t)},_.prototype.push=function(t,e){var i,n=this._readableState;return n.objectMode?i=!0:"string"==typeof t&&((e=e||n.defaultEncoding)!==n.encoding&&(t=u.from(t,e),e=""),i=!0),b(this,t,e,!1,i)},_.prototype.unshift=function(t){return b(this,t,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(t){return d||(d=i(124).StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};function M(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function x(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?r.nextTick(T,t):T(t))}function T(t){p("emit readable"),t.emit("readable"),I(t)}function A(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(L,t,e))}function L(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}function S(t){p("readable nexttick read 0"),t.read(0)}function E(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),I(t),e.flowing&&!e.reading&&t.read(0)}function I(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function P(t,e){return 0===e.length?null:(e.objectMode?i=e.buffer.shift():!t||t>=e.length?(i=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):i=function(t,e,i){var n;t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):n=t===e.head.data.length?e.shift():i?function(t,e){var i=e.head,n=1,r=i.data;t-=r.length;for(;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(a===o.length?r+=o:r+=o.slice(0,t),0===(t-=a)){a===o.length?(++n,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(a));break}++n}return e.length-=n,r}(t,e):function(t,e){var i=u.allocUnsafe(t),n=e.head,r=1;n.data.copy(i),t-=n.data.length;for(;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,a),0===(t-=a)){a===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(a));break}++r}return e.length-=r,i}(t,e);return n}(t,e.buffer,e.decoder),i);var i}function C(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,r.nextTick(O,e,t))}function O(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function R(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}_.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?C(this):x(this),null;if(0===(t=M(t,e))&&e.ended)return 0===e.length&&C(this),null;var n,r=e.needReadable;return p("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",r=!0),e.ended||e.reading?p("reading or ended",r=!1):r&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=M(i,e))),null===(n=t>0?P(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&C(this)),null!==n&&this.emit("data",n),n},_.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(t,e){var i=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var l=(!e||!1!==e.end)&&t!==n.stdout&&t!==n.stderr?h:_;function u(e,n){p("onunpipe"),e===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,p("cleanup"),t.removeListener("close",m),t.removeListener("finish",v),t.removeListener("drain",c),t.removeListener("error",y),t.removeListener("unpipe",u),i.removeListener("end",h),i.removeListener("end",_),i.removeListener("data",g),f=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||c())}function h(){p("onend"),t.end()}o.endEmitted?r.nextTick(l):i.once("end",l),t.on("unpipe",u);var c=function(t){return function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,I(t))}}(i);t.on("drain",c);var f=!1;var d=!1;function g(e){p("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==R(o.pipes,t))&&!f&&(p("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,d=!0),i.pause())}function y(e){p("onerror",e),_(),t.removeListener("error",y),0===s(t,"error")&&t.emit("error",e)}function m(){t.removeListener("finish",v),_()}function v(){p("onfinish"),t.removeListener("close",m),_()}function _(){p("unpipe"),i.unpipe(t)}return i.on("data",g),function(t,e,i){if("function"==typeof t.prependListener)return t.prependListener(e,i);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]:t.on(e,i)}(t,"error",y),t.once("close",m),t.once("finish",v),t.emit("pipe",i),o.flowing||(p("pipe resume"),i.resume()),t},_.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i)),this;if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,i);return this}var a=R(e.pipes,t);return-1===a||(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i)),this},_.prototype.on=function(t,e){var i=l.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&x(this):r.nextTick(S,this))}return i},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(E,t,e))}(this,t)),this},_.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(t){var e=this,i=this._readableState,n=!1;for(var r in t.on("end",(function(){if(p("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(r){(p("wrapped data"),i.decoder&&(r=i.decoder.write(r)),i.objectMode&&null==r)||(i.objectMode||r&&r.length)&&(e.push(r)||(n=!0,t.pause()))})),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(e){return function(){return t[e].apply(t,arguments)}}(r));for(var o=0;o<m.length;o++)t.on(m[o],this.emit.bind(this,m[o]));return this._read=function(e){p("wrapped _read",e),n&&(n=!1,t.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=P}).call(this,i(32),i(18))},function(t,e,i){t.exports=i(82).EventEmitter},function(t,e,i){"use strict";var n=i(59);function r(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var i=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||n.nextTick(r,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(n.nextTick(r,i,t),i._writableState&&(i._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,i){"use strict";var n=i(60).Buffer,r=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=u,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=h,this.end=c,e=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var n=i.charCodeAt(i.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function h(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function c(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var i=function(t,e,i){var n=e.length-1;if(n<i)return 0;var r=a(e[n]);if(r>=0)return r>0&&(t.lastNeed=r-1),r;if(--n<i||-2===r)return 0;if((r=a(e[n]))>=0)return r>0&&(t.lastNeed=r-2),r;if(--n<i||-2===r)return 0;if((r=a(e[n]))>=0)return r>0&&(2===r?r=0:t.lastNeed=r-3),r;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var n=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,i){"use strict";t.exports=a;var n=i(34),r=i(44);function o(t,e){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=e&&this.push(e),n(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function a(t){if(!(this instanceof a))return new a(t);n.call(this,t),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush((function(e,i){l(t,e,i)})):l(this,null,null)}function l(t,e,i){if(e)return t.emit("error",e);if(null!=i&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}r.inherits=i(33),r.inherits(a,n),a.prototype.push=function(t,e){return this._transformState.needTransform=!1,n.prototype.push.call(this,t,e)},a.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")},a.prototype._write=function(t,e,i){var n=this._transformState;if(n.writecb=i,n.writechunk=t,n.writeencoding=e,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},a.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},a.prototype._destroy=function(t,e){var i=this;n.prototype._destroy.call(this,t,(function(t){e(t),i.emit("close")}))}},function(t,e,i){"use strict";var n,r=i(30),o=i(234),a=i(127),s=i(128),l=i(87);function u(t,e){return t.msg=l[e],e}function h(t){return(t<<1)-(t>4?9:0)}function c(t){for(var e=t.length;--e>=0;)t[e]=0}function f(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function p(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,f(t.strm)}function d(t,e){t.pending_buf[t.pending++]=e}function g(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function y(t,e){var i,n,r=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,u=t.window,h=t.w_mask,c=t.prev,f=t.strstart+258,p=u[o+a-1],d=u[o+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(u[(i=e)+a]===d&&u[i+a-1]===p&&u[i]===u[o]&&u[++i]===u[o+1]){o+=2,i++;do{}while(u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&o<f);if(n=258-(f-o),o=f-258,n>a){if(t.match_start=e,a=n,n>=s)break;p=u[o+a-1],d=u[o+a]}}}while((e=c[e&h])>l&&0!=--r);return a<=t.lookahead?a:t.lookahead}function m(t){var e,i,n,o,l,u,h,c,f,p,d=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=d+(d-262)){r.arraySet(t.window,t.window,d,d,0),t.match_start-=d,t.strstart-=d,t.block_start-=d,e=i=t.hash_size;do{n=t.head[--e],t.head[e]=n>=d?n-d:0}while(--i);e=i=d;do{n=t.prev[--e],t.prev[e]=n>=d?n-d:0}while(--i);o+=d}if(0===t.strm.avail_in)break;if(u=t.strm,h=t.window,c=t.strstart+t.lookahead,f=o,p=void 0,(p=u.avail_in)>f&&(p=f),i=0===p?0:(u.avail_in-=p,r.arraySet(h,u.input,u.next_in,p,c),1===u.state.wrap?u.adler=a(u.adler,h,p,c):2===u.state.wrap&&(u.adler=s(u.adler,h,p,c)),u.next_in+=p,u.total_in+=p,p),t.lookahead+=i,t.lookahead+t.insert>=3)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+3-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function v(t,e){for(var i,n;;){if(t.lookahead<262){if(m(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-262&&(t.match_length=y(t,i)),t.match_length>=3)if(n=o._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}function _(t,e){for(var i,n,r;;){if(t.lookahead<262){if(m(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-262&&(t.match_length=y(t,i),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(p(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=o._tr_tally(t,0,t.window[t.strstart-1]))&&p(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}function b(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),c(this.dyn_ltree),c(this.dyn_dtree),c(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),c(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),c(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function M(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=0,o._tr_init(e),0):u(t,-2)}function x(t){var e,i=M(t);return 0===i&&((e=t.state).window_size=2*e.w_size,c(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),i}function T(t,e,i,n,o,a){if(!t)return-2;var s=1;if(-1===e&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>9||8!==i||n<8||n>15||e<0||e>9||a<0||a>4)return u(t,-2);8===n&&(n=9);var l=new w;return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=i,x(t)}n=[new b(0,0,0,0,(function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(m(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,p(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(p(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(p(t,!1),t.strm.avail_out),1)})),new b(4,4,8,4,v),new b(4,5,16,8,v),new b(4,6,32,32,v),new b(4,4,16,16,_),new b(8,16,32,32,_),new b(8,16,128,128,_),new b(8,32,128,256,_),new b(32,128,258,1024,_),new b(32,258,258,4096,_)],e.deflateInit=function(t,e){return T(t,e,8,15,8,0)},e.deflateInit2=T,e.deflateReset=x,e.deflateResetKeep=M,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=e,0):-2},e.deflate=function(t,e){var i,r,a,l;if(!t||!t.state||e>5||e<0)return t?u(t,-2):-2;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||666===r.status&&4!==e)return u(t,0===t.avail_out?-5:-2);if(r.strm=t,i=r.last_flush,r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,d(r,31),d(r,139),d(r,8),r.gzhead?(d(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),d(r,255&r.gzhead.time),d(r,r.gzhead.time>>8&255),d(r,r.gzhead.time>>16&255),d(r,r.gzhead.time>>24&255),d(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),d(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(d(r,255&r.gzhead.extra.length),d(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=s(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(d(r,0),d(r,0),d(r,0),d(r,0),d(r,0),d(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),d(r,3),r.status=113);else{var y=8+(r.w_bits-8<<4)<<8;y|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(y|=32),y+=31-y%31,r.status=113,g(r,y),0!==r.strstart&&(g(r,t.adler>>>16),g(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),f(t),a=r.pending,r.pending!==r.pending_buf_size));)d(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),f(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,d(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),f(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,d(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&f(t),r.pending+2<=r.pending_buf_size&&(d(r,255&t.adler),d(r,t.adler>>8&255),t.adler=0,r.status=113)):r.status=113),0!==r.pending){if(f(t),0===t.avail_out)return r.last_flush=-1,0}else if(0===t.avail_in&&h(e)<=h(i)&&4!==e)return u(t,-5);if(666===r.status&&0!==t.avail_in)return u(t,-5);if(0!==t.avail_in||0!==r.lookahead||0!==e&&666!==r.status){var v=2===r.strategy?function(t,e){for(var i;;){if(0===t.lookahead&&(m(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var i,n,r,a,s=t.window;;){if(t.lookahead<=258){if(m(t),t.lookahead<=258&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=s[r=t.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){a=t.strstart+258;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<a);t.match_length=258-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=o._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}(r,e):n[r.level].func(r,e);if(3!==v&&4!==v||(r.status=666),1===v||3===v)return 0===t.avail_out&&(r.last_flush=-1),0;if(2===v&&(1===e?o._tr_align(r):5!==e&&(o._tr_stored_block(r,0,0,!1),3===e&&(c(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),f(t),0===t.avail_out))return r.last_flush=-1,0}return 4!==e?0:r.wrap<=0?1:(2===r.wrap?(d(r,255&t.adler),d(r,t.adler>>8&255),d(r,t.adler>>16&255),d(r,t.adler>>24&255),d(r,255&t.total_in),d(r,t.total_in>>8&255),d(r,t.total_in>>16&255),d(r,t.total_in>>24&255)):(g(r,t.adler>>>16),g(r,65535&t.adler)),f(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},e.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?u(t,-2):(t.state=null,113===e?u(t,-3):0):-2},e.deflateSetDictionary=function(t,e){var i,n,o,s,l,u,h,f,p=e.length;if(!t||!t.state)return-2;if(2===(s=(i=t.state).wrap)||1===s&&42!==i.status||i.lookahead)return-2;for(1===s&&(t.adler=a(t.adler,e,p,0)),i.wrap=0,p>=i.w_size&&(0===s&&(c(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new r.Buf8(i.w_size),r.arraySet(f,e,p-i.w_size,i.w_size,0),e=f,p=i.w_size),l=t.avail_in,u=t.next_in,h=t.input,t.avail_in=p,t.next_in=0,t.input=e,m(i);i.lookahead>=3;){n=i.strstart,o=i.lookahead-2;do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+3-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--o);i.strstart=n,i.lookahead=2,m(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=u,t.input=h,t.avail_in=l,i.wrap=s,0},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,i){"use strict";t.exports=function(t,e,i,n){for(var r=65535&t|0,o=t>>>16&65535|0,a=0;0!==i;){i-=a=i>2e3?2e3:i;do{o=o+(r=r+e[n++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16|0}},function(t,e,i){"use strict";var n=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=function(t,e,i,r){var o=n,a=r+i;t^=-1;for(var s=r;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},function(t,e,i){"use strict";var n=i(30),r=i(127),o=i(128),a=i(235),s=i(236);function l(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(852),e.distcode=e.distdyn=new n.Buf32(592),e.sane=1,e.back=-1,0):-2}function c(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,h(t)):-2}function f(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?-2:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,c(t))):-2}function p(t,e){var i,n;return t?(n=new u,t.state=n,n.window=null,0!==(i=f(t,e))&&(t.state=null),i):-2}var d,g,y=!0;function m(t){if(y){var e;for(d=new n.Buf32(512),g=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(1,t.lens,0,288,d,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(2,t.lens,0,32,g,0,t.work,{bits:5}),y=!1}t.lencode=d,t.lenbits=9,t.distcode=g,t.distbits=5}function v(t,e,i,r){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),r>=a.wsize?(n.arraySet(a.window,e,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>r&&(o=r),n.arraySet(a.window,e,i-r,o,a.wnext),(r-=o)?(n.arraySet(a.window,e,i-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}e.inflateReset=c,e.inflateReset2=f,e.inflateResetKeep=h,e.inflateInit=function(t){return p(t,15)},e.inflateInit2=p,e.inflate=function(t,e){var i,u,h,c,f,p,d,g,y,_,b,w,M,x,T,A,L,S,E,I,P,C,O,R,D=0,k=new n.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return-2;12===(i=t.state).mode&&(i.mode=13),f=t.next_out,h=t.output,d=t.avail_out,c=t.next_in,u=t.input,p=t.avail_in,g=i.hold,y=i.bits,_=p,b=d,C=0;t:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;y<16;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(2&i.wrap&&35615===g){i.check=0,k[0]=255&g,k[1]=g>>>8&255,i.check=o(i.check,k,2,0),g=0,y=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&g)<<8)+(g>>8))%31){t.msg="incorrect header check",i.mode=30;break}if(8!=(15&g)){t.msg="unknown compression method",i.mode=30;break}if(y-=4,P=8+(15&(g>>>=4)),0===i.wbits)i.wbits=P;else if(P>i.wbits){t.msg="invalid window size",i.mode=30;break}i.dmax=1<<P,t.adler=i.check=1,i.mode=512&g?10:12,g=0,y=0;break;case 2:for(;y<16;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(i.flags=g,8!=(255&i.flags)){t.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=g>>8&1),512&i.flags&&(k[0]=255&g,k[1]=g>>>8&255,i.check=o(i.check,k,2,0)),g=0,y=0,i.mode=3;case 3:for(;y<32;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}i.head&&(i.head.time=g),512&i.flags&&(k[0]=255&g,k[1]=g>>>8&255,k[2]=g>>>16&255,k[3]=g>>>24&255,i.check=o(i.check,k,4,0)),g=0,y=0,i.mode=4;case 4:for(;y<16;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}i.head&&(i.head.xflags=255&g,i.head.os=g>>8),512&i.flags&&(k[0]=255&g,k[1]=g>>>8&255,i.check=o(i.check,k,2,0)),g=0,y=0,i.mode=5;case 5:if(1024&i.flags){for(;y<16;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}i.length=g,i.head&&(i.head.extra_len=g),512&i.flags&&(k[0]=255&g,k[1]=g>>>8&255,i.check=o(i.check,k,2,0)),g=0,y=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&((w=i.length)>p&&(w=p),w&&(i.head&&(P=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,u,c,w,P)),512&i.flags&&(i.check=o(i.check,u,w,c)),p-=w,c+=w,i.length-=w),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===p)break t;w=0;do{P=u[c+w++],i.head&&P&&i.length<65536&&(i.head.name+=String.fromCharCode(P))}while(P&&w<p);if(512&i.flags&&(i.check=o(i.check,u,w,c)),p-=w,c+=w,P)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===p)break t;w=0;do{P=u[c+w++],i.head&&P&&i.length<65536&&(i.head.comment+=String.fromCharCode(P))}while(P&&w<p);if(512&i.flags&&(i.check=o(i.check,u,w,c)),p-=w,c+=w,P)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;y<16;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(g!==(65535&i.check)){t.msg="header crc mismatch",i.mode=30;break}g=0,y=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=12;break;case 10:for(;y<32;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}t.adler=i.check=l(g),g=0,y=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=f,t.avail_out=d,t.next_in=c,t.avail_in=p,i.hold=g,i.bits=y,2;t.adler=i.check=1,i.mode=12;case 12:if(5===e||6===e)break t;case 13:if(i.last){g>>>=7&y,y-=7&y,i.mode=27;break}for(;y<3;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}switch(i.last=1&g,y-=1,3&(g>>>=1)){case 0:i.mode=14;break;case 1:if(m(i),i.mode=20,6===e){g>>>=2,y-=2;break t}break;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=30}g>>>=2,y-=2;break;case 14:for(g>>>=7&y,y-=7&y;y<32;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if((65535&g)!=(g>>>16^65535)){t.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&g,g=0,y=0,i.mode=15,6===e)break t;case 15:i.mode=16;case 16:if(w=i.length){if(w>p&&(w=p),w>d&&(w=d),0===w)break t;n.arraySet(h,u,c,w,f),p-=w,c+=w,d-=w,f+=w,i.length-=w;break}i.mode=12;break;case 17:for(;y<14;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(i.nlen=257+(31&g),g>>>=5,y-=5,i.ndist=1+(31&g),g>>>=5,y-=5,i.ncode=4+(15&g),g>>>=4,y-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;y<3;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}i.lens[B[i.have++]]=7&g,g>>>=3,y-=3}for(;i.have<19;)i.lens[B[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,O={bits:i.lenbits},C=s(0,i.lens,0,19,i.lencode,0,i.work,O),i.lenbits=O.bits,C){t.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;A=(D=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,L=65535&D,!((T=D>>>24)<=y);){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(L<16)g>>>=T,y-=T,i.lens[i.have++]=L;else{if(16===L){for(R=T+2;y<R;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(g>>>=T,y-=T,0===i.have){t.msg="invalid bit length repeat",i.mode=30;break}P=i.lens[i.have-1],w=3+(3&g),g>>>=2,y-=2}else if(17===L){for(R=T+3;y<R;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}y-=T,P=0,w=3+(7&(g>>>=T)),g>>>=3,y-=3}else{for(R=T+7;y<R;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}y-=T,P=0,w=11+(127&(g>>>=T)),g>>>=7,y-=7}if(i.have+w>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=30;break}for(;w--;)i.lens[i.have++]=P}}if(30===i.mode)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,O={bits:i.lenbits},C=s(1,i.lens,0,i.nlen,i.lencode,0,i.work,O),i.lenbits=O.bits,C){t.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,O={bits:i.distbits},C=s(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,O),i.distbits=O.bits,C){t.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===e)break t;case 20:i.mode=21;case 21:if(p>=6&&d>=258){t.next_out=f,t.avail_out=d,t.next_in=c,t.avail_in=p,i.hold=g,i.bits=y,a(t,b),f=t.next_out,h=t.output,d=t.avail_out,c=t.next_in,u=t.input,p=t.avail_in,g=i.hold,y=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;A=(D=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,L=65535&D,!((T=D>>>24)<=y);){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(A&&0==(240&A)){for(S=T,E=A,I=L;A=(D=i.lencode[I+((g&(1<<S+E)-1)>>S)])>>>16&255,L=65535&D,!(S+(T=D>>>24)<=y);){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}g>>>=S,y-=S,i.back+=S}if(g>>>=T,y-=T,i.back+=T,i.length=L,0===A){i.mode=26;break}if(32&A){i.back=-1,i.mode=12;break}if(64&A){t.msg="invalid literal/length code",i.mode=30;break}i.extra=15&A,i.mode=22;case 22:if(i.extra){for(R=i.extra;y<R;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}i.length+=g&(1<<i.extra)-1,g>>>=i.extra,y-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;A=(D=i.distcode[g&(1<<i.distbits)-1])>>>16&255,L=65535&D,!((T=D>>>24)<=y);){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(0==(240&A)){for(S=T,E=A,I=L;A=(D=i.distcode[I+((g&(1<<S+E)-1)>>S)])>>>16&255,L=65535&D,!(S+(T=D>>>24)<=y);){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}g>>>=S,y-=S,i.back+=S}if(g>>>=T,y-=T,i.back+=T,64&A){t.msg="invalid distance code",i.mode=30;break}i.offset=L,i.extra=15&A,i.mode=24;case 24:if(i.extra){for(R=i.extra;y<R;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}i.offset+=g&(1<<i.extra)-1,g>>>=i.extra,y-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===d)break t;if(w=b-d,i.offset>w){if((w=i.offset-w)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=30;break}w>i.wnext?(w-=i.wnext,M=i.wsize-w):M=i.wnext-w,w>i.length&&(w=i.length),x=i.window}else x=h,M=f-i.offset,w=i.length;w>d&&(w=d),d-=w,i.length-=w;do{h[f++]=x[M++]}while(--w);0===i.length&&(i.mode=21);break;case 26:if(0===d)break t;h[f++]=i.length,d--,i.mode=21;break;case 27:if(i.wrap){for(;y<32;){if(0===p)break t;p--,g|=u[c++]<<y,y+=8}if(b-=d,t.total_out+=b,i.total+=b,b&&(t.adler=i.check=i.flags?o(i.check,h,b,f-b):r(i.check,h,b,f-b)),b=d,(i.flags?g:l(g))!==i.check){t.msg="incorrect data check",i.mode=30;break}g=0,y=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;y<32;){if(0===p)break t;p--,g+=u[c++]<<y,y+=8}if(g!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=30;break}g=0,y=0}i.mode=29;case 29:C=1;break t;case 30:C=-3;break t;case 31:return-4;case 32:default:return-2}return t.next_out=f,t.avail_out=d,t.next_in=c,t.avail_in=p,i.hold=g,i.bits=y,(i.wsize||b!==t.avail_out&&i.mode<30&&(i.mode<27||4!==e))&&v(t,t.output,t.next_out,b-t.avail_out)?(i.mode=31,-4):(_-=t.avail_in,b-=t.avail_out,t.total_in+=_,t.total_out+=b,i.total+=b,i.wrap&&b&&(t.adler=i.check=i.flags?o(i.check,h,b,t.next_out-b):r(i.check,h,b,t.next_out-b)),t.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0===_&&0===b||4===e)&&0===C&&(C=-5),C)},e.inflateEnd=function(t){if(!t||!t.state)return-2;var e=t.state;return e.window&&(e.window=null),t.state=null,0},e.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?-2:(i.head=e,e.done=!1,0):-2},e.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&11!==i.mode?-2:11===i.mode&&r(1,e,n,0)!==i.check?-3:v(t,e,n,n)?(i.mode=31,-4):(i.havedict=1,0):-2},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){"use strict";(function(e,n){var r=i(29),o=i(58),a=t.exports=function(){o.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};r.inherits(a,o),a.prototype.read=function(t,i){this._reads.push({length:Math.abs(t),allowLess:t<0,func:i}),e.nextTick(function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},a.prototype.write=function(t,e){return this.writable?(i=n.isBuffer(t)?t:new n(t,e||this._encoding),this._buffers.push(i),this._buffered+=i.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",new Error("Stream not writable")),!1);var i},a.prototype.end=function(t,e){t&&this.write(t,e),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},a.prototype.destroySoon=a.prototype.end,a.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},a.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},a.prototype._processReadAllowingLess=function(t){this._reads.shift();var e=this._buffers[0];e.length>t.length?(this._buffered-=t.length,this._buffers[0]=e.slice(t.length),t.func.call(this,e.slice(0,t.length))):(this._buffered-=e.length,this._buffers.shift(),t.func.call(this,e))},a.prototype._processRead=function(t){this._reads.shift();for(var e=0,i=0,r=new n(t.length);e<t.length;){var o=this._buffers[i++],a=Math.min(o.length,t.length-e);o.copy(r,e,0,a),e+=a,a!==o.length&&(this._buffers[--i]=o.slice(a))}i>0&&this._buffers.splice(0,i),this._buffered-=t.length,t.func.call(this,r)},a.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var t=this._reads[0];if(t.allowLess)this._processReadAllowingLess(t);else{if(!(this._buffered>=t.length))break;this._processRead(t)}}this._buffers&&!this.writable&&this._end()}catch(t){this.emit("error",t)}}}).call(this,i(18),i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=i(132),r=i(133);function o(t,e,i){var n=t*e;return 8!==i&&(n=Math.ceil(n/(8/i))),n}var a=t.exports=function(t,e){var i=t.width,r=t.height,a=t.interlace,s=t.bpp,l=t.depth;if(this.read=e.read,this.write=e.write,this.complete=e.complete,this._imageIndex=0,this._images=[],a)for(var u=n.getImagePasses(i,r),h=0;h<u.length;h++)this._images.push({byteWidth:o(u[h].width,s,l),height:u[h].height,lineIndex:0});else this._images.push({byteWidth:o(i,s,l),height:r,lineIndex:0});this._xComparison=8===l?s:16===l?2*s:1};a.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},a.prototype._unFilterType1=function(t,e,i){for(var n=this._xComparison,r=n-1,o=0;o<i;o++){var a=t[1+o],s=o>r?e[o-n]:0;e[o]=a+s}},a.prototype._unFilterType2=function(t,e,i){for(var n=this._lastLine,r=0;r<i;r++){var o=t[1+r],a=n?n[r]:0;e[r]=o+a}},a.prototype._unFilterType3=function(t,e,i){for(var n=this._xComparison,r=n-1,o=this._lastLine,a=0;a<i;a++){var s=t[1+a],l=o?o[a]:0,u=a>r?e[a-n]:0,h=Math.floor((u+l)/2);e[a]=s+h}},a.prototype._unFilterType4=function(t,e,i){for(var n=this._xComparison,o=n-1,a=this._lastLine,s=0;s<i;s++){var l=t[1+s],u=a?a[s]:0,h=s>o?e[s-n]:0,c=s>o&&a?a[s-n]:0,f=r(h,u,c);e[s]=l+f}},a.prototype._reverseFilterLine=function(t){var i,n=t[0],r=this._images[this._imageIndex],o=r.byteWidth;if(0===n)i=t.slice(1,o+1);else switch(i=new e(o),n){case 1:this._unFilterType1(t,i,o);break;case 2:this._unFilterType2(t,i,o);break;case 3:this._unFilterType3(t,i,o);break;case 4:this._unFilterType4(t,i,o);break;default:throw new Error("Unrecognised filter type - "+n)}this.write(i),r.lineIndex++,r.lineIndex>=r.height?(this._lastLine=null,this._imageIndex++,r=this._images[this._imageIndex]):this._lastLine=i,r?this.read(r.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";var n=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];e.getImagePasses=function(t,e){for(var i=[],r=t%8,o=e%8,a=(t-r)/8,s=(e-o)/8,l=0;l<n.length;l++){for(var u=n[l],h=a*u.x.length,c=s*u.y.length,f=0;f<u.x.length&&u.x[f]<r;f++)h++;for(f=0;f<u.y.length&&u.y[f]<o;f++)c++;h>0&&c>0&&i.push({width:h,height:c,index:l})}return i},e.getInterlaceIterator=function(t){return function(e,i,r){var o=e%n[r].x.length,a=(e-o)/n[r].x.length*8+n[r].x[o],s=i%n[r].y.length;return 4*a+((i-s)/n[r].y.length*8+n[r].y[s])*t*4}}},function(t,e,i){"use strict";t.exports=function(t,e,i){var n=t+e-i,r=Math.abs(n-t),o=Math.abs(n-e),a=Math.abs(n-i);return r<=o&&r<=a?t:o<=a?e:i}},function(t,e,i){"use strict";(function(e){var n=i(46),r=i(135),o=t.exports=function(t,e){this._options=t,t.checkCRC=!1!==t.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[n.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[n.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[n.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[n.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[n.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[n.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=e.read,this.error=e.error,this.metadata=e.metadata,this.gamma=e.gamma,this.transColor=e.transColor,this.palette=e.palette,this.parsed=e.parsed,this.inflateData=e.inflateData,this.finished=e.finished,this.simpleTransparency=e.simpleTransparency,this.headersFinished=e.headersFinished||function(){}};o.prototype.start=function(){this.read(n.PNG_SIGNATURE.length,this._parseSignature.bind(this))},o.prototype._parseSignature=function(t){for(var e=n.PNG_SIGNATURE,i=0;i<e.length;i++)if(t[i]!==e[i])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},o.prototype._parseChunkBegin=function(t){for(var i=t.readUInt32BE(0),o=t.readUInt32BE(4),a="",s=4;s<8;s++)a+=String.fromCharCode(t[s]);var l=Boolean(32&t[4]);if(this._hasIHDR||o===n.TYPE_IHDR){if(this._crc=new r,this._crc.write(new e(a)),this._chunks[o])return this._chunks[o](i);l?this.read(i+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+a))}else this.error(new Error("Expected IHDR on beggining"))},o.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},o.prototype._parseChunkEnd=function(t){var e=t.readInt32BE(0),i=this._crc.crc32();this._options.checkCRC&&i!==e?this.error(new Error("Crc error - "+e+" - "+i)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleIHDR=function(t){this.read(t,this._parseIHDR.bind(this))},o.prototype._parseIHDR=function(t){this._crc.write(t);var e=t.readUInt32BE(0),i=t.readUInt32BE(4),r=t[8],o=t[9],a=t[10],s=t[11],l=t[12];if(8===r||4===r||2===r||1===r||16===r)if(o in n.COLORTYPE_TO_BPP_MAP)if(0===a)if(0===s)if(0===l||1===l){this._colorType=o;var u=n.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:e,height:i,depth:r,interlace:Boolean(l),palette:Boolean(o&n.COLORTYPE_PALETTE),color:Boolean(o&n.COLORTYPE_COLOR),alpha:Boolean(o&n.COLORTYPE_ALPHA),bpp:u,colorType:o}),this._handleChunkEnd()}else this.error(new Error("Unsupported interlace method"));else this.error(new Error("Unsupported filter method"));else this.error(new Error("Unsupported compression method"));else this.error(new Error("Unsupported color type"));else this.error(new Error("Unsupported bit depth "+r))},o.prototype._handlePLTE=function(t){this.read(t,this._parsePLTE.bind(this))},o.prototype._parsePLTE=function(t){this._crc.write(t);for(var e=Math.floor(t.length/3),i=0;i<e;i++)this._palette.push([t[3*i],t[3*i+1],t[3*i+2],255]);this.palette(this._palette),this._handleChunkEnd()},o.prototype._handleTRNS=function(t){this.simpleTransparency(),this.read(t,this._parseTRNS.bind(this))},o.prototype._parseTRNS=function(t){if(this._crc.write(t),this._colorType===n.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(t.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(var e=0;e<t.length;e++)this._palette[e][3]=t[e];this.palette(this._palette)}this._colorType===n.COLORTYPE_GRAYSCALE&&this.transColor([t.readUInt16BE(0)]),this._colorType===n.COLORTYPE_COLOR&&this.transColor([t.readUInt16BE(0),t.readUInt16BE(2),t.readUInt16BE(4)]),this._handleChunkEnd()},o.prototype._handleGAMA=function(t){this.read(t,this._parseGAMA.bind(this))},o.prototype._parseGAMA=function(t){this._crc.write(t),this.gamma(t.readUInt32BE(0)/n.GAMMA_DIVISION),this._handleChunkEnd()},o.prototype._handleIDAT=function(t){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-t,this._parseIDAT.bind(this,t))},o.prototype._parseIDAT=function(t,e){if(this._crc.write(e),this._colorType===n.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(e);var i=t-e.length;i>0?this._handleIDAT(i):this._handleChunkEnd()},o.prototype._handleIEND=function(t){this.read(t,this._parseIEND.bind(this))},o.prototype._parseIEND=function(t){this._crc.write(t),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";var n=[];!function(){for(var t=0;t<256;t++){for(var e=t,i=0;i<8;i++)1&e?e=3988292384^e>>>1:e>>>=1;n[t]=e}}();var r=t.exports=function(){this._crc=-1};r.prototype.write=function(t){for(var e=0;e<t.length;e++)this._crc=n[255&(this._crc^t[e])]^this._crc>>>8;return!0},r.prototype.crc32=function(){return-1^this._crc},r.crc32=function(t){for(var e=-1,i=0;i<t.length;i++)e=n[255&(e^t[i])]^e>>>8;return-1^e}},function(t,e,i){"use strict";(function(t){var n=i(132),r=[function(){},function(t,e,i,n){if(n===e.length)throw new Error("Ran out of data");var r=e[n];t[i]=r,t[i+1]=r,t[i+2]=r,t[i+3]=255},function(t,e,i,n){if(n+1>=e.length)throw new Error("Ran out of data");var r=e[n];t[i]=r,t[i+1]=r,t[i+2]=r,t[i+3]=e[n+1]},function(t,e,i,n){if(n+2>=e.length)throw new Error("Ran out of data");t[i]=e[n],t[i+1]=e[n+1],t[i+2]=e[n+2],t[i+3]=255},function(t,e,i,n){if(n+3>=e.length)throw new Error("Ran out of data");t[i]=e[n],t[i+1]=e[n+1],t[i+2]=e[n+2],t[i+3]=e[n+3]}],o=[function(){},function(t,e,i,n){var r=e[0];t[i]=r,t[i+1]=r,t[i+2]=r,t[i+3]=n},function(t,e,i){var n=e[0];t[i]=n,t[i+1]=n,t[i+2]=n,t[i+3]=e[1]},function(t,e,i,n){t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=n},function(t,e,i){t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3]}];function a(t,e,i,n,o,a){for(var s=t.width,l=t.height,u=t.index,h=0;h<l;h++)for(var c=0;c<s;c++){var f=i(c,h,u);r[n](e,o,f,a),a+=n}return a}function s(t,e,i,n,r,a){for(var s=t.width,l=t.height,u=t.index,h=0;h<l;h++){for(var c=0;c<s;c++){var f=r.get(n),p=i(c,h,u);o[n](e,f,p,a)}r.resetAfterLine()}}e.dataToBitMap=function(e,i){var r,o=i.width,l=i.height,u=i.depth,h=i.bpp,c=i.interlace;if(8!==u)var f=function(t,e){var i=[],n=0;function r(){if(n===t.length)throw new Error("Ran out of data");var r,o,a,s,l,u,h,c,f=t[n];switch(n++,e){default:throw new Error("unrecognised depth");case 16:h=t[n],n++,i.push((f<<8)+h);break;case 4:h=15&f,c=f>>4,i.push(c,h);break;case 2:l=3&f,u=f>>2&3,h=f>>4&3,c=f>>6&3,i.push(c,h,u,l);break;case 1:r=1&f,o=f>>1&1,a=f>>2&1,s=f>>3&1,l=f>>4&1,u=f>>5&1,h=f>>6&1,c=f>>7&1,i.push(c,h,u,l,s,a,o,r)}}return{get:function(t){for(;i.length<t;)r();var e=i.slice(0,t);return i=i.slice(t),e},resetAfterLine:function(){i.length=0},end:function(){if(n!==t.length)throw new Error("extra data found")}}}(e,u);r=u<=8?new t(o*l*4):new Uint16Array(o*l*4);var p,d,g=Math.pow(2,u)-1,y=0;if(c)p=n.getImagePasses(o,l),d=n.getInterlaceIterator(o,l);else{var m=0;d=function(){var t=m;return m+=4,t},p=[{width:o,height:l}]}for(var v=0;v<p.length;v++)8===u?y=a(p[v],r,d,h,e,y):s(p[v],r,d,h,f,g);if(8===u){if(y!==e.length)throw new Error("extra data found")}else f.end();return r}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){t.exports=function(t,i){var n=i.depth,r=i.width,o=i.height,a=i.colorType,s=i.transColor,l=i.palette,u=t;return 3===a?function(t,e,i,n,r){for(var o=0,a=0;a<n;a++)for(var s=0;s<i;s++){var l=r[t[o]];if(!l)throw new Error("index "+t[o]+" not in palette");for(var u=0;u<4;u++)e[o+u]=l[u];o+=4}}(t,u,r,o,l):(s&&function(t,e,i,n,r){for(var o=0,a=0;a<n;a++)for(var s=0;s<i;s++){var l=!1;if(1===r.length?r[0]===t[o]&&(l=!0):r[0]===t[o]&&r[1]===t[o+1]&&r[2]===t[o+2]&&(l=!0),l)for(var u=0;u<4;u++)e[o+u]=0;o+=4}}(t,u,r,o,s),8!==n&&(16===n&&(u=new e(r*o*4)),function(t,e,i,n,r){for(var o=Math.pow(2,r)-1,a=0,s=0;s<n;s++)for(var l=0;l<i;l++){for(var u=0;u<4;u++)e[a+u]=Math.floor(255*t[a+u]/o+.5);a+=4}}(t,u,r,o,n))),u}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=i(46),r=i(135),o=i(239),a=i(240),s=i(45),l=t.exports=function(t){if(this._options=t,t.deflateChunkSize=t.deflateChunkSize||32768,t.deflateLevel=null!=t.deflateLevel?t.deflateLevel:9,t.deflateStrategy=null!=t.deflateStrategy?t.deflateStrategy:3,t.inputHasAlpha=null==t.inputHasAlpha||t.inputHasAlpha,t.deflateFactory=t.deflateFactory||s.createDeflate,t.bitDepth=t.bitDepth||8,t.colorType="number"==typeof t.colorType?t.colorType:n.COLORTYPE_COLOR_ALPHA,t.inputColorType="number"==typeof t.inputColorType?t.inputColorType:n.COLORTYPE_COLOR_ALPHA,-1===[n.COLORTYPE_GRAYSCALE,n.COLORTYPE_COLOR,n.COLORTYPE_COLOR_ALPHA,n.COLORTYPE_ALPHA].indexOf(t.colorType))throw new Error("option color type:"+t.colorType+" is not supported at present");if(-1===[n.COLORTYPE_GRAYSCALE,n.COLORTYPE_COLOR,n.COLORTYPE_COLOR_ALPHA,n.COLORTYPE_ALPHA].indexOf(t.inputColorType))throw new Error("option input color type:"+t.inputColorType+" is not supported at present");if(8!==t.bitDepth&&16!==t.bitDepth)throw new Error("option bit depth:"+t.bitDepth+" is not supported at present")};l.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},l.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},l.prototype.filterData=function(t,e,i){var r=o(t,e,i,this._options),s=n.COLORTYPE_TO_BPP_MAP[this._options.colorType];return a(r,e,i,this._options,s)},l.prototype._packChunk=function(t,i){var n=i?i.length:0,o=new e(n+12);return o.writeUInt32BE(n,0),o.writeUInt32BE(t,4),i&&i.copy(o,8),o.writeInt32BE(r.crc32(o.slice(4,o.length-4)),o.length-4),o},l.prototype.packGAMA=function(t){var i=new e(4);return i.writeUInt32BE(Math.floor(t*n.GAMMA_DIVISION),0),this._packChunk(n.TYPE_gAMA,i)},l.prototype.packIHDR=function(t,i){var r=new e(13);return r.writeUInt32BE(t,0),r.writeUInt32BE(i,4),r[8]=this._options.bitDepth,r[9]=this._options.colorType,r[10]=0,r[11]=0,r[12]=0,this._packChunk(n.TYPE_IHDR,r)},l.prototype.packIDAT=function(t){return this._packChunk(n.TYPE_IDAT,t)},l.prototype.packIEND=function(){return this._packChunk(n.TYPE_IEND,null)}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";var n=t.exports=function(t){this._buffer=t,this._reads=[]};n.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e})},n.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var t=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=t.length||t.allowLess))break;this._reads.shift();var e=this._buffer;this._buffer=e.slice(t.length),t.func.call(this,e.slice(0,t.length))}return this._reads.length>0?new Error("There are some read requests waitng on finished stream"):this._buffer.length>0?new Error("unrecognised content at end of stream"):void 0}},function(t,e,i){"use strict";var n=i(30),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var i="",a=0;a<e;a++)i+=String.fromCharCode(t[a]);return i}a[254]=a[254]=1,e.string2buf=function(t){var e,i,r,o,a,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(e=new n.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),i<128?e[a++]=i:i<2048?(e[a++]=192|i>>>6,e[a++]=128|63&i):i<65536?(e[a++]=224|i>>>12,e[a++]=128|i>>>6&63,e[a++]=128|63&i):(e[a++]=240|i>>>18,e[a++]=128|i>>>12&63,e[a++]=128|i>>>6&63,e[a++]=128|63&i);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new n.Buf8(t.length),i=0,r=e.length;i<r;i++)e[i]=t.charCodeAt(i);return e},e.buf2string=function(t,e){var i,n,r,o,s=e||t.length,u=new Array(2*s);for(n=0,i=0;i<s;)if((r=t[i++])<128)u[n++]=r;else if((o=a[r])>4)u[n++]=65533,i+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&i<s;)r=r<<6|63&t[i++],o--;o>1?u[n++]=65533:r<65536?u[n++]=r:(r-=65536,u[n++]=55296|r>>10&1023,u[n++]=56320|1023&r)}return l(u,n)},e.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+a[t[i]]>e?i:e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),r=i(5),o=i(7),a=i(9),s=i(8),l=i(12),u=i(1),h=function(){function t(){}return t.render=function(t,e,i,a,h,c,f){void 0===h&&(h=l.Color.fromHex("#000000")),void 0===c&&(c=!0),void 0===f&&(f=l.Color.fromHex("#FFFFFF"));var p=n.ResourceManager.getInstance(t).getShader(n.ShaderEnum.TEXT_LABEL_SHADER);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),p.bind();var d=i.font.texture;i.model.bind(),p.setAttributes(i.model.attributeInfos);var g=null;g=a instanceof r.LatLng?o.GeometryUtils.latLngToScreenCoordinate(a,0,e.cameraPosition,e.getScreenSize()):a,this.mvpMatrix.setIdentity(),this.mvpMatrix.translate(g.x,g.y,0),this.mvpMatrix.concat(e.getOrthoProjectionMatrix()),p.setUniforms([new s.UniformInfo("u_mvpMatrix","matrix",this.mvpMatrix),new s.UniformInfo("u_texture","texture",d),new s.UniformInfo("u_pixel_scale","1f",u.MapUtils.pixelScale),new s.UniformInfo("u_text_size","1f",i.size),new s.UniformInfo("u_texsize","2fv",new Float32Array([d.width,d.height]))]),c&&(p.setUniforms([new s.UniformInfo("u_color","4fv",f.buffer()),new s.UniformInfo("u_is_halo","1i",!0)]),i.model.render(t.TRIANGLES)),p.setUniforms([new s.UniformInfo("u_color","4fv",h.buffer()),new s.UniformInfo("u_gamma_scale","1f",1),new s.UniformInfo("u_is_halo","1i",!1)]),i.model.render(t.TRIANGLES)},t.mvpMatrix=new a.Matrix4,t}();e.TextLabelRenderer=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(23),a=i(0),s=i(16),l=i(3),u=i(2),h=i(1),c=i(7),f=i(143),p=i(24),d=i(26),g=i(61),y=i(92),m=i(47),v=function(t){function e(e,i,n,r){var o=t.call(this,e,i,r||a.LayerType.POI,n)||this;return o.poiRenderDatas=null,o}return r(e,t),e.prototype.destroy=function(){this.poiRenderDatas=null},e.prototype.queryFeature=function(t){var e=null;if(null!=this.poiRenderDatas&&this.poiRenderDatas.length>0){var i=this.poiRenderDatas.get(t);if(null!=i){var n=i.getLayerProperties();e=new f.PlaceQueryResult(0,n.getId(),n.getTitle(),n.getSubtitle(),n.getPosition(),n.getType())}}return e},e.prototype.placePOIRenderData=function(t,e,i,n){e.setVisible(!1),e.setTextVisible(!1);var r=e.getTexture();if(null!=r&&r.isLoaded){var o=e.getLayerProperties();if(this.isInFilterPOITypes(o.getTypes())){var a=o.getPosition(),f=c.GeometryUtils.latLngToScreenCoordinate(a,0,i.cameraPosition,i.getScreenSize(),n),p=u.MapConstants.placeWidth*h.MapUtils.pixelScale,d=u.MapConstants.placeHeight*h.MapUtils.pixelScale,v=f.x-p/2,_=f.x+p/2,b=f.y-d,w=f.y,M=new l.Vector2((v+_)/2,(b+w)/2),x=this.mapView.getCollision2DManager(),T=new g.OBB(M.x,M.y,0,_-v,w-b);x.insert(new y.POICollisionIconRenderData(T,m.CollisionType.POI,e)),e.setVisible(!0),null==e.getTextData()&&e.setTextData(s.MapResourceManager.getInstance(this.mapView.gl).acquireText(o.getTitle(),o.getFontSize()));var A=e.getTextData(),L=A.width,S=A.height,E=new l.Vector2(f.x+p/2+L/2+1,f.y-d/2);v=E.x-L/2,_=E.x+L/2,b=E.y-S/2,w=E.y+S/2;var I=new l.Vector2((v+_)/2,(b+w)/2);e.setTextVisible(!0);var P=new g.OBB(I.x,I.y,0,_-v,w-b);x.insert(new y.POICollisionTextRenderData(P,m.CollisionType.POITEXT,e))}}},e.prototype.update=function(t){var e=this;if(this.poiRenderDatas=o(p.compareOrderDESC),this.mapView.isPOIsEnabled()&&!t.is3dMode()){this.mapView.tileManager.getTilePyramid().getRenderTiles().forEach((function(t){t.getTile().getTileRenderData().getLayerRenderDatas().forEach((function(t){if(t.getType()==a.LayerType.POI){var i=t,n=i.getLayerProperties();e.poiRenderDatas=e.poiRenderDatas.insert(new p.Order(n.getId(),n.getRank()),i)}}))}));var i=t.getScreenSize(),n=d.CameraUtils.calculateViewProjectionMatrix(t.cameraPosition,i.x,i.y);this.poiRenderDatas.forEach((function(i,r){e.placePOIRenderData(i,r,t,n)}))}},e.prototype.isInFilterPOITypes=function(t){var e=this.mapView.mapSettings.filterPOITypes;return null==e||null==e.length||e.length<1||!(null==t||t.length<=0)&&e.some((function(e){return-1!==t.indexOf(e)}))},e}(a.Layer);e.POILayer=v},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,i,n,r,o){this.annotationId=t,this.placeId=e,this.name=i,this.address=n,this.location=r,this.type=o};e.PlaceQueryResult=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(23),a=i(9),s=i(6),l=i(0),u=i(3),h=i(7),c=i(1),f=i(24),p=function(t,e){this.layerRenderData=t,this.matrixIndex=e};e.SurfaceRenderData=p;var d=function(t){function e(e,i,n,r){var o=t.call(this,e,i,r||l.LayerType.SURFACE,n)||this;return o.dirty=!0,o.renderDatas=null,o.mvpMatrixs=[],o}return r(e,t),e.prototype.destroy=function(){this.renderDatas=null},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.update=function(t){this.updateLayer(t,l.LayerType.SURFACE)},e.prototype.updateLayer=function(t,e){var i=this;if(this.dirty){this.dirty=!1;var n=c.MapUtils.getTileSize(),r=s.ProjectionMercator.worldSize(t.getScale()),l=t.cameraPosition,d=t.getViewProjectionMatrix(),g=this.mapView.tileManager.getTilePyramid().getRenderTiles();this.renderDatas=o(f.compareOrderASC);var y=0;g.forEach((function(t,o){var s=t.getTile(),c=1<<s.getTileCoordinate().getZoom(),g=r/c,m=t.getUnwrappedTileCoordinate().toVec2(),v=m.x*g+g/2,_=m.y*g+g/2,b=h.GeometryUtils.pixelCoordinateToCameraCoordinate(new u.Vector2(v,_),l),w=void 0;o<i.mvpMatrixs.length?w=i.mvpMatrixs[o]:(w=new a.Matrix4,i.mvpMatrixs.push(w));var M=g/n;w.setIdentity(M,M,1),w.translate(b.x,b.y,0),w.concat(d),s.getTileRenderData().getLayerRenderDatas().forEach((function(t,n){if(t.getType()==e){var r=t.getLayerProperties();if(r.isVisible()){var a=new p(t,o);i.renderDatas=i.renderDatas.insert(new f.Order(y++,r.getSortRank()),a)}}}))})),this.mvpMatrixs.length>g.length&&(this.mvpMatrixs.length=g.length)}},e}(l.Layer);e.SurfaceLayer=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(42),r=function(){function t(t,e,i){this.gl=t,this.width=e,this.height=i,this.isReady=!1,this.init()}return t.prototype.init=function(){var t=this.gl,e=new n.TextureFiltering(t.NEAREST,t.NEAREST),i=new n.TextureWrapping(t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE),r=new n.TextureOptions(t.TEXTURE_2D,t.RGB,t.RGB,t.UNSIGNED_BYTE,e,i);this.colorTexture=new n.Texture(t,r),this.colorTexture.initFrameBufferTexture(this.width||1,this.height||1),this.depthBuffer=this.gl.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width||1,this.height||1),t.bindRenderbuffer(t.RENDERBUFFER,null),this.frameBufferId=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBufferId),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.colorTexture.textureId,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer);var o=t.checkFramebufferStatus(t.FRAMEBUFFER);if(o!=t.FRAMEBUFFER_COMPLETE){switch(o){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case t.FRAMEBUFFER_UNSUPPORTED:console.warn("FRAMEBUFFER_UNSUPPORTED");break;default:console.warn("Unknown framebuffer issue")}return t.bindFramebuffer(t.FRAMEBUFFER,null),!1}return this.isReady=!0,t.bindFramebuffer(t.FRAMEBUFFER,null),!0},t.prototype.bind=function(){this.isReady&&this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.frameBufferId)},t.prototype.unbind=function(){this.isReady&&this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)},t.prototype.drawDebug=function(){},t.prototype.destroy=function(){this.gl&&(this.colorTexture&&this.colorTexture.destroy(),this.gl.deleteRenderbuffer(this.depthBuffer),this.gl.deleteFramebuffer(this.frameBufferId),this.colorTexture=null,this.depthBuffer=null,this.frameBufferId=null)},t}();e.FrameBuffer=r},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(306),a=i(8),s=i(11),l=i(9),u=function(t){function e(e,i,n,r){var o=t.call(this,r)||this;return o.transformMatrix=new l.Matrix4,o._shader=i,o._particleTexture=n,o._gl=e,o}return r(e,t),e.prototype.render=function(t){var e=s.ResourceManager.getInstance(this._gl).getModel(s.ModelEnum.PARTICLE_QUAD_MODEL),i=t.getOrthoProjectionMatrix();this._shader.bind(),e.bind(),this._shader.setAttributes(e.attributeInfos),this._shader.setUniforms([new a.UniformInfo("u_texture","texture",this._particleTexture)]);for(var n=this._activeParticlesFirst;n;n=n.next){var r=n.position;this.transformMatrix.setIdentity(this._particleTexture.width*n.scale,this._particleTexture.height*n.scale,1),this.transformMatrix.rotateZ(n.rotation),this.transformMatrix.translate(r.x,r.y,0),this.transformMatrix.concat(i),this._shader.setUniforms([new a.UniformInfo("u_mvpMatrix","matrix",this.transformMatrix)]),e.render(this._gl.TRIANGLES)}e.unbind()},e}(o.ParticleSystem);e.ParticleSystemQuad=u},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(25),a=i(12),s=i(1),l=i(2),u=function(t){function e(e,i,n,r,o,u,h,c,f,p){var d=t.call(this)||this;return d._center=e,d._radius=i,d._fillColor=a.Color.fromHex(n),d._fillColor.alpha=r,d._fillOpacity=r,d._strokeColor=a.Color.fromHex(o),d._strokeWidth=u*s.MapUtils.pixelScale,d._hypotenuseStrokeWidth=d._strokeWidth/Math.cos(Math.PI/l.PolyConstants.numTrianglesPerCircle),d._visible=c,d._draggable=f,d._elevation=h,d.userInteraction=p,d}return r(e,t),e.prototype.getCenter=function(){return this._center},e.prototype.setCenter=function(t){this._center=t},e.prototype.getRadius=function(){return this._radius},e.prototype.setRadius=function(t){this._radius=t},e.prototype.getFillColor=function(){return this._fillColor},e.prototype.setFillColor=function(t){t?(this._fillColor=a.Color.fromHex(t),this._fillColor.alpha=this._fillOpacity):this._fillColor=new a.Color(255,0,0,this._fillOpacity)},e.prototype.getFillOpacity=function(){return this._fillOpacity},e.prototype.setFillOpacity=function(t){this._fillOpacity=t,this._fillColor.alpha=t},e.prototype.getStrokeColor=function(){return this._strokeColor},e.prototype.setStrokeColor=function(t){t?(this._strokeColor=a.Color.fromHex(t),this._strokeColor.alpha=1):this._strokeColor=new a.Color(255,0,0,1)},e.prototype.getHypotenuseStrokeWidth=function(){return this._hypotenuseStrokeWidth},e.prototype.getStrokeWidth=function(){return this._strokeWidth},e.prototype.setStrokeWidth=function(t){var e=5*s.MapUtils.pixelScale;null!==t&&(e=t*s.MapUtils.pixelScale)<1&&(e=0),this._strokeWidth=e,this._hypotenuseStrokeWidth=e/Math.cos(Math.PI/l.PolyConstants.numTrianglesPerCircle)},e.prototype.getElevation=function(){return this._elevation},e.prototype.setElevation=function(t){this._elevation=t},e.prototype.isVisible=function(){return this._visible},e.prototype.setVisible=function(t){this._visible=t},e.prototype.isDraggable=function(){return this._draggable},e.prototype.setDraggable=function(t){this._draggable=t},e.prototype.isUserInteractionEnabled=function(){return this.userInteraction},e.prototype.setUserInteraction=function(t){this.userInteraction=t},e}(o.LayerProperties);e.CircleLayerProperties=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r=i(149),o=i(21),a=i(10),s=i(19),l=i(1),u=i(95),h=function(){function t(t,e){this._mapView=new r.MapView(t,e),this._data=new u.MapData(this._mapView)}return Object.defineProperty(t.prototype,"mapView",{get:function(){return this._mapView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.enable3dMode=function(t){this.mapView.enable3dMode(t)},t.prototype.getBounds=function(t){return this.mapView.getBounds(t)},t.prototype.setMinZoom=function(t){this.mapView.setMinZoom(t)},t.prototype.setMaxZoom=function(t){this.mapView.setMaxZoom(t)},t.prototype.getCamera=function(){var t=this.mapView.getCamera();return new s.CameraPosition(t.getTarget(),t.getTilt(),t.getBearing(),t.getZoom())},t.prototype.setWeather=function(t,e){this.mapView.setWeather(t,e)},t.prototype.getWeather=function(){return this.mapView.getWeather()},t.prototype.panBy=function(t,e){var i=a.Point.convert(t),n=l.MapUtils.pointToPixel(i);this.mapView.panBy(n,e)},t.prototype.panTo=function(t,e){this.mapView.panTo(n.LatLng.convert(t),e)},t.prototype.moveCamera=function(t,e){this.mapView.moveCamera(t,e)},t.prototype.fitBounds=function(t,e,i){this._mapView.fitBounds(o.LatLngBounds.convert(t),e,i)},t.prototype.getCameraWithBounds=function(t,e){return this._mapView.getCameraPositionForLatLngBounds(o.LatLngBounds.convert(t),e)},t.prototype.addListener=function(t,e,i){return void 0===i&&(i={}),this.mapView.addListener(t,e,i)},t.prototype.setDate=function(t){this.mapView.setDate(t)},t.prototype.moveToMyLocation=function(t){void 0===t&&(t=!0),this.mapView.moveToMyLocation(t)},t.prototype.is3dMode=function(){return this.mapView.mapState.is3dMode()},t.prototype.getMinZoom=function(){return this.mapView.mapSettings.getMinZoom()},t.prototype.getPreferMinZoom=function(){return this.mapView.mapSettings.getPreferMinZoom()},t.prototype.getMaxZoom=function(){return this.mapView.mapSettings.getMaxZoom()},t.prototype.setMaxNativeZoom=function(t){if(null==t)throw Error("Parameter can not be null");return this.mapView.setMaxNativeZoom(t)},t.prototype.getMaxNativeZoom=function(){return this.mapView.getMaxNativeZoom()},t.prototype.setTimeEffect=function(t){this.mapView.setTimeEffect(t)},t.prototype.getTimeEffect=function(){return this.mapView.getTimeEffect()},t.prototype.setShadowEffect=function(t){this.mapView.setShadowEffect(t)},t.prototype.setWaterEffect=function(t){this.mapView.setWaterEffect(t)},t.prototype.setBuildingsEnabled=function(t){this.mapView.setBuildingsEnabled(t)},t.prototype.isBuildingsEnabled=function(){return this.mapView.isBuildingsEnabled()},t.prototype.setPOIsEnabled=function(t){this.mapView.setPOIsEnabled(t)},t.prototype.isPOIsEnabled=function(){return this.mapView.isPOIsEnabled()},t.prototype.getRestrictionBounds=function(){return this.mapView.getRestrictionBounds()},t.prototype.setRestrictionBounds=function(t){this.mapView.setRestrictionBounds(t)},t.prototype.setFilterPOIs=function(t){this.mapView.setFilterPOIs(t)},t.prototype.getFilterPOIs=function(){return this.mapView.getFilterPOIs()},t.prototype.setFilterBuildings=function(t){this.mapView.setFilterBuildings(t)},t.prototype.getFilterBuildings=function(){return this.mapView.getFilterBuildings()},t.prototype.setSelectedBuildings=function(t){this.mapView.setSelectedBuildings(t)},t.prototype.getSelectedBuildings=function(){return this.mapView.getSelectedBuildings()},t.prototype.setHiddenBuilding=function(t){console.warn("Method setHiddenBuilding(string) is deprecated. Use setHiddenBuildings(string[]) instead"),this.setHiddenBuildings([t])},t.prototype.setUnhiddenBuilding=function(t){console.warn("Method setUnhiddenBuilding(string) is deprecated. Use setHiddenBuildings([]) instead.In this case, all hidden building will be show on Map"),this.setHiddenBuildings([])},t.prototype.setHiddenBuildings=function(t){this.mapView.setHiddenBuildings(t)},t.prototype.setVisibleBuildings=function(t){this.mapView.setVisibleBuildings(t)},t.prototype.setZoomGesturesEnabled=function(t){this._mapView.setZoomGesturesEnabled(t)},t.prototype.setScrollGesturesEnabled=function(t){this._mapView.setScrollGesturesEnabled(t)},t.prototype.setRotateGesturesEnabled=function(t){this._mapView.setRotateGesturesEnabled(t)},t.prototype.setTiltGesturesEnabled=function(t){this._mapView.setTiltGesturesEnabled(t)},t.prototype.setAllGesturesEnabled=function(t){this._mapView.setAllGesturesEnabled(t)},t.prototype.setMapType=function(t){this._mapView.setMapType(t)},t.prototype.getMapType=function(){return this._mapView.getMapType()},t.prototype.setMapStyle=function(t){this._mapView.setMapStyle(t)},t}();e.Map4D=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(150),a=i(12),s=i(151),l=i(3),u=i(56),h=i(170),c=i(171),f=i(172),p=i(173),d=i(206),g=i(64),y=i(268),m=i(0),v=i(98),_=i(43),b=i(5),w=i(2),M=i(286),x=i(13),T=i(7),A=i(1),L=i(302),S=i(21),E=i(19),I=i(303),P=i(11),C=i(145),O=i(71),R=i(304),D=i(93),k=i(40),B=i(310),U=i(314),N=i(315),F=i(316),j=i(317),V=i(319),Z=i(94),z=i(66),G=i(320),Y=i(70),W=i(321),H=i(16),X=i(73),q=i(323),J=i(325),Q=i(15),K=i(327),$=i(50),tt=i(328),et=i(332),it=function(t){function e(e,i){var n=t.call(this)||this;n.clientContainer=e,n.gl=null,n.disableShadowMapByTime=!1,n.lastTime=0,n.defaultMapOptions={center:[-1,-1],zoom:12,tilt:0,bearing:0,minZoom:w.MapConstants.defaultMinZoom,maxZoom:w.MapConstants.defaultMaxZoom,maxNativeZoom:w.MapConstants.defaultMaxNativeZoom,geolocate:!1,controls:!1,controlOptions:z.ControlOptions.BOTTOM_RIGHT,shouldChangeMapMode:null,mapType:$.MapType.raster},n.defaultAnimationOptions={duration:null,easing:null,animate:!1},n.defaultPaddingOptions={top:0,bottom:0,left:0,right:0};var r={};return A.MapUtils.extendOptions(r,n.defaultMapOptions,i),n.options=r,n.options.shouldChangeMapMode||(n.options.shouldChangeMapMode=function(){return!1}),n.container=u.DOMUtils.create("div","mf-map4d",n.clientContainer),n.createStyleNode(),n.init(),n.createMapControlNode(n.container,n.options),n.createLogoNode(n.container),n}return r(e,t),e.prototype.init=function(){this.setupMapViews(this.container,this.options),this.setupComponents(this.options),this.renderTaskQueue=new F.TaskQueue,this.loop(0)},e.prototype.requestRender=function(){this.dirty=!0},e.prototype.requestRenderFrame=function(t){return this.dirty=!0,this.renderTaskQueue.add(t)},e.prototype.cancelRenderFrame=function(t){this.renderTaskQueue.remove(t)},e.prototype.loop=function(t){var e=this,i=t-this.lastTime,n=w.MapConstants.FPS-i;!this.dirty&&n>0?setTimeout((function(){requestAnimationFrame(e.loop.bind(e))}),n):(this.lastTime=t,this.resize(),(this.dirty||this.effectDirty)&&(this.dirty=!1,this.effectDirty=!1,this.update(),this.render()),(this.weatherManager.dirty()||this.timeEffectManager.dirty()||this.effectManager.dirty())&&(this.effectDirty=!0),this.mapState.dirty()&&(this.dirty=!0),requestAnimationFrame(this.loop.bind(this)))},e.prototype.update=function(){var t=this;this.cameraAnimation.updateTransitions(),this.tileManager.update(),this.annotationManager.update(),this.overlayManager.update(),this.geoJsonManager.update(),this.collision2DManager.clearCollision(),this.layers.forEach((function(e){e.update(t.mapState)})),this.mapSettings.is3dMode()&&(this.weatherManager.update(),this.mapState.getTilt()>w.MapConstants.maxTiltIntersectWithScreen&&this.skyObject.updateMatrices(this.mapState)),!this.effectManager.enableShadowEffect||this.disableShadowMapByTime||this.timeEffectManager.getTimeEffect()!=Z.TimeEffect.Evening&&!this.timeEffectManager.isEveningTime()?this.disableShadowMapByTime&&this.timeEffectManager.getTimeEffect()!=Z.TimeEffect.Evening&&!this.timeEffectManager.isEveningTime()&&(this.disableShadowMapByTime=!1,this.effectManager.enableShadowEffect=!0):(this.disableShadowMapByTime=!0,this.effectManager.enableShadowEffect=!1),this.compassImage&&(this.compassImage.style.transform="rotate("+this.mapState.getBearing()+"deg)"),this.collision2DManager.hitTest()},e.prototype.hasTouch=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},e.prototype.resize=function(){if(null!=this.canvas){A.MapUtils.pixelScale=window.devicePixelRatio||1;var t=Math.round(this.canvas.offsetWidth*A.MapUtils.pixelScale),e=Math.round(this.canvas.offsetHeight*A.MapUtils.pixelScale);this.offsetWidth==this.canvas.offsetWidth&&this.offsetHeight==this.canvas.offsetHeight||(this.offsetWidth=this.canvas.offsetWidth,this.offsetHeight=this.canvas.offsetHeight,(this.width==t&&this.height==e||this.devicePixelRatio!=A.MapUtils.pixelScale)&&(this.devicePixelRatio=A.MapUtils.pixelScale,this.mapsEventManager.notify(k.MapEvent.boundsChanged),this.reload(),this.setDirtyAfterResize())),this.width==t&&this.height==e||(this.width=t,this.height=e,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.mapState.setScreenSize(this.width,this.height),this.weatherManager.resize(t,e),this.effectManager.resize(t,e),null!=this.frameBuffer&&(this.frameBuffer.destroy(),this.frameBuffer=null),this.frameBuffer=new C.FrameBuffer(this.gl,this.width,this.height),this.mapsEventManager.notify(k.MapEvent.boundsChanged),this.setDirtyAfterResize())}},e.prototype.setDirtyAfterResize=function(){this.tileManager.updateVisibleTiles(),this.surfaceLayer.setDirty(),this.boundaryLayer.setDirty(),this.roadLayer.setDirty(),this.buildingLayer.setDirty(),this.userBuildingLayer.setDirty(),this.overlayManager.dirtyBuildingOverlay(),this.dirty=!0},e.prototype.render=function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this.mapRenderer.render(),this.renderTaskQueue.run(),this.mapSettings.is3dMode()&&(t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.weatherManager.render(this.mapState),t.disable(t.BLEND)),this.collision2DManager.drawDebug()},e.prototype.renderSelection=function(){var t=this.gl;t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),Q.LayerRenderer.resetSelectionCode(),this.mapRenderer.renderSelection();var e=a.Color.fromHex(this.mapState.is3dMode()?w.MapConstants.mapBackgroundColor3D:w.MapConstants.mapBackgroundColor2D);t.clearColor(e.red,e.green,e.blue,1)},e.prototype.getSelectionCode=function(t){if(null!=this.frameBuffer){this.frameBuffer.bind(),this.renderSelection();var e=A.MapUtils.touchBoxSize,i=4*e*e,n=new Uint8Array(i).fill(0);this.gl.readPixels(t.min.x,this.height-t.min.y-e,e,e,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this.frameBuffer.unbind();for(var r=new Map,o=0,a=0;a<i;a+=4){var s=n[a]<<16|n[a+1]<<8|n[a+2],l=r.get(s)?r.get(s):0;r.set(s,l+1),o=s}return r.forEach((function(t,e){t>r.get(o)&&(o=e)})),o}return-1},e.prototype.createLayer=function(t,e,i){if(this.layers.has(t))return console.log("Cannot create layer which layer id already exist"),null;var n=M.LayerFactory.createLayer(t,e,this,i);return null!=n?(this.mapRenderer.addLayer(n),this.layers.set(t,n),n):null},e.prototype.removeLayer=function(t,e){this.mapRenderer.removeLayer(t,e),this.layers.delete(t)},e.createCameraAnimationOptions=function(t){var e=new v.CameraAnimationOptions;if(t.animate){if(null!=t.duration&&t.duration<0)throw new Error("Animation duration must be greater or equal to 0");e.easing=t.easing}return e.duration=t.duration,e.gesture=!1,e},e.prototype.panBy=function(t,i){i=A.MapUtils.extendOptions({},this.defaultAnimationOptions,i),this.cameraAnimation.moveBy(t,e.createCameraAnimationOptions(i))},e.prototype.panTo=function(t,i){null==(i=A.MapUtils.extendOptions({},this.defaultAnimationOptions,i)).duration&&(i.duration=A.MapUtils.getTimePanTo(this.mapState.getTarget(),t,this.mapState.getZoom())),this.cameraAnimation.moveTo({target:t,zoom:this.mapState.getZoom()},e.createCameraAnimationOptions(i))},e.prototype.moveCamera=function(t,i){var n=E.CameraPosition.convert(t),r=new v.CameraOptions;if(null!=n.getZoom()?r.zoom=x.MathUtils.clamp(n.getZoom(),this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()):r.zoom=this.mapState.getZoom(),null!=n.getTilt()){var o=(a=r.zoom||this.mapState.getZoom())<w.MapConstants.defaultMinZoom3d?w.MapConstants.maxTilt2D:this.mapSettings.getPreferMaxTilt();r.tilt=x.MathUtils.clamp(n.getTilt(),this.mapSettings.getMinTilt(),o)}else{var a=r.zoom||this.mapState.getZoom();r.tilt=this.mapSettings.getPreferMaxTilt()==w.MapConstants.maxTilt2D||a<w.MapConstants.defaultMinZoom3d?0:w.MapConstants.maxTilt2D}var s=n.getBearing();if(r.bearing=null!=s?s:this.mapState.getBearing(),r.target=n.getTarget()||this.mapState.getTarget(),null!=i&&i.animate){var u=this.latLngToScreenCoordinate(r.target),h=new l.Vector2(this.mapState.screenWidth/2,this.mapState.screenHeight/2),c=x.MathUtils.distance(u,h);i=A.MapUtils.extendOptions({},this.defaultAnimationOptions,i),c<h.x?(null==i.duration&&(i.duration=A.MapUtils.getTimePanTo(this.mapState.getTarget(),r.target,this.mapState.getZoom())),this.cameraAnimation.moveTo(r,e.createCameraAnimationOptions(i))):this.cameraAnimation.flyTo(r,e.createCameraAnimationOptions(i))}else this.cameraAnimation.moveTo(r)},e.prototype.fitBounds=function(t,e,i){var n=this.getCameraPositionForLatLngBounds(t,e);this.moveCamera(n,i)},e.prototype.moveBy=function(t){this.cameraAnimation.moveBy(t,null,!0)},e.prototype.moveByVelocity=function(t){this.mapState.isPanning()||this.mapState.isZoomIn()||this.mapState.isZoomOut()||this.cameraAnimation.moveByVelocity(t)},e.prototype.getCameraPositionForLatLngBounds=function(t,e){if((e=A.MapUtils.extendOptions({},this.defaultPaddingOptions,e)).top<0||e.bottom<0||e.left<0||e.right<0)throw new Error("Padding value must be greater or equal to 0");var i={top:e.top*A.MapUtils.pixelScale,bottom:e.bottom*A.MapUtils.pixelScale,left:e.left*A.MapUtils.pixelScale,right:e.right*A.MapUtils.pixelScale};return A.MapUtils.getCameraPositionForLatLngBounds(t,i,this.mapState,this.mapSettings)},e.prototype.getAnnotationManager=function(){return this.annotationManager},e.prototype.getOverlayManager=function(){return this.overlayManager},e.prototype.setZoom=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var r=this.getCamera().getZoom(),o=new v.CameraAnimationOptions;o.duration=i,o.gesture=n,t<w.MapConstants.defaultMinZoom3d&&this.mapState.is3dMode()&&!this.mapState.shouldChangeMapMode()&&(t=x.MathUtils.clamp(t,w.MapConstants.defaultMinZoom3d,w.MapConstants.defaultMaxZoom)),t=x.MathUtils.clamp(t,w.MapConstants.defaultMinZoom,w.MapConstants.defaultMaxZoom),this.mapState.handleMapMode(r,t),this.cameraAnimation.zoom(t,e,o)},e.prototype.setTilt=function(t,e){void 0===e&&(e=!1),this.cameraAnimation.setTilt(t,e)},e.prototype.setBearing=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),this.cameraAnimation.setBearing(t,e,i)},e.prototype.stopAnimation=function(){this.cameraAnimation.stopAnimation()},e.prototype.setWeather=function(t,e){this.weatherManager.setProvider(e),this.weatherManager.setWeather(t),this.dirty=!0,t==D.Weather.Live&&null==e&&console.warn("Please provide `map4d.WeatherProvider` if you're using `map4d.Live` weather mode")},e.prototype.getWeather=function(){return this.weatherManager.getWeather()},e.prototype.enable3dMode=function(t){if(this.mapState.enable3dMode(t)){this.mapState.getZoom()>=w.MapConstants.defaultMinZoom3d&&this.tileManager.reload(),t?this.mapState.getZoom()<w.MapConstants.defaultMinZoom3d&&this.moveCamera({target:this.mapState.getTarget(),zoom:w.MapConstants.defaultMinZoom3d}):(this.buildingLayer.clear(),this.userBuildingLayer.clear(),H.MapResourceManager.getInstance(this.gl).clearVisibleBuildingId());var e=a.Color.fromHex(this.mapState.is3dMode()?w.MapConstants.mapBackgroundColor3D:w.MapConstants.mapBackgroundColor2D);this.gl.clearColor(e.red,e.green,e.blue,1)}},e.prototype.getBounds=function(t){if((t=A.MapUtils.extendOptions({},this.defaultPaddingOptions,t)).top<0||t.bottom<0||t.left<0||t.right<0)throw new Error("Padding value must be greater or equal to 0");t={top:t.top*A.MapUtils.pixelScale,bottom:t.bottom*A.MapUtils.pixelScale,left:t.left*A.MapUtils.pixelScale,right:t.right*A.MapUtils.pixelScale};var e=this.mapState.getScreenSize();if(!this.getCamera().getTarget()||!this.mapState.getZoom()||e.x<=0||e.y<=0)return null;var i=this.mapState.getTilt(),n=!1;i>w.MapConstants.maxTiltIntersectWithScreen&&(this.mapState.setTilt(w.MapConstants.maxTiltIntersectWithScreen),n=!0);var r=this.mapState.cameraPosition,o=T.GeometryUtils.screenCoordinateToLatLng(new l.Vector2(t.left,t.top),r,e).normalize(),a=T.GeometryUtils.screenCoordinateToLatLng(new l.Vector2(e.x-t.right,t.top),r,e).normalize();n&&this.mapState.setTilt(i);var s=T.GeometryUtils.screenCoordinateToLatLng(new l.Vector2(e.x-t.right,e.y-t.bottom),r,e).normalize(),u=T.GeometryUtils.screenCoordinateToLatLng(new l.Vector2(t.left,e.y-t.bottom),r,e).normalize();if(!s.valid()||!u.valid())return S.LatLngBounds.world();var h=new S.LatLngBounds;return h.extend(a).extend(u).extend(o).extend(s),h},e.prototype.getCurrentMousePosition=function(t){return new l.Vector2((t.clientX-this.canvas.getBoundingClientRect().left)*A.MapUtils.pixelScale,(t.clientY-this.canvas.getBoundingClientRect().top)*A.MapUtils.pixelScale)},e.prototype.hideInfoWindow=function(t){this.annotationManager.hideInfoWindow(t)},e.prototype.isInfoWindowShown=function(t){return this.annotationManager.isInfoWindowShown(t)},e.prototype.showInfoWindow=function(t){this.annotationManager.showInfoWindow(t)},e.prototype.setMinZoom=function(t){this.mapSettings.setMinZoom(t)},e.prototype.setMaxZoom=function(t){this.mapSettings.setMaxZoom(t)},e.prototype.setDataLayerMinZoom=function(t){this.dirty=!0,this.mapSettings.dataLayerMinZoom=t},e.prototype.setDataLayerMaxZoom=function(t){this.dirty=!0,this.mapSettings.dataLayerMaxZoom=t},e.prototype.getDataLayerMinZoom=function(){return this.mapSettings.dataLayerMinZoom},e.prototype.getDataLayerMaxZoom=function(){return this.mapSettings.dataLayerMaxZoom},e.prototype.setMaxNativeZoom=function(t){t=x.MathUtils.clamp(t,w.MapConstants.defaultMinZoom,w.MapConstants.defaultMaxZoom),this.getMaxNativeZoom()!=t&&(this.mapSettings.setMaxNativeZoom(t),this.tileManager.reload(),this.annotationManager.clearShapeIndexer(),t>w.MapConstants.geoJsonMinNativeZoom&&this.geoJsonManager.reloadIndexer())},e.prototype.getMaxNativeZoom=function(){return this.mapSettings.getMaxNativeZoom()},e.prototype.addOverlay=function(t){return this.dirty=!0,this.overlayManager.addOverlay(t)},e.prototype.removeOverlay=function(t){this.overlayManager.removeOverlay(t),this.dirty=!0},e.prototype.addAnnotation=function(t){return this.dirty=!0,this.annotationManager.addAnnotation(t)},e.prototype.updateAnnotationZIndex=function(t,e,i){this.annotationManager.updateAnnotationZIndex(t,e,i),this.dirty=!0},e.prototype.updateAnnotation=function(t,e){void 0===e&&(e=!1),this.annotationManager.updateAnnotation(t,e),this.dirty=!0},e.prototype.removeAnnotation=function(t){this.annotationManager.removeAnnotation(t),this.dirty=!0},e.prototype.screenCoordinateToLatLng=function(t,e){return void 0===e&&(e=0),e=this.mapState.is3dMode()?e:0,T.GeometryUtils.screenCoordinateToLatLng(t,this.mapState.cameraPosition,this.mapState.getScreenSize(),e)},e.prototype.latLngToScreenCoordinate=function(t,e){return void 0===e&&(e=0),e=this.mapState.is3dMode()?e:0,T.GeometryUtils.latLngToScreenCoordinate(t,e,this.mapState.cameraPosition,this.mapState.getScreenSize())},e.prototype.getCamera=function(){return this.mapState.getCamera()},e.prototype.setShadowEffect=function(t){this.disableShadowMapByTime=!1,this.effectManager.enableShadowEffect=t,this.dirty=!0},e.prototype.setWaterEffect=function(t){this.effectManager.enableWaterEffect=t,this.dirty=!0},e.prototype.setBuildingsEnabled=function(t){this.mapSettings.objectsEnabled!=t&&(this.mapSettings.objectsEnabled=t,this.mapState.is3dMode()&&(t&&this.buildingLayer.setDirty(),this.dirty=!0))},e.prototype.isBuildingsEnabled=function(){return this.mapSettings.objectsEnabled},e.prototype.setPOIsEnabled=function(t){this.mapSettings.placesEnabled!=t&&(this.dirty=!0,this.mapSettings.placesEnabled=t)},e.prototype.isPOIsEnabled=function(){return this.mapSettings.placesEnabled},e.prototype.getRestrictionBounds=function(){return this.mapSettings.getRestrictionBounds()},e.prototype.setRestrictionBounds=function(t){null==t?this.mapSettings.setRestrictionBounds(null):(this.mapSettings.setRestrictionBounds(S.LatLngBounds.convert(t)),this.mapState.constraintCameraWithRestrictionBounds())},e.prototype.reload=function(){this.tileManager.reload()},e.prototype.setupComponents=function(t){var e=this,i={};A.MapUtils.extendOptions(i,this.defaultMapOptions,t),P.ResourceManager.getInstance(this.gl),Y.TextLabelFactory.getInstance(this.gl),this.layers=new Map,this.httpTaskManager=new d.TaskManager,this.mapsEventManager=new I.MapsEventManager(this),this.mapSettings=new g.MapSettings(this),this.mapSettings.setMapType(this.convertMapType(this.options.mapType)),this.mapState=new f.MapState(this.mapSettings),this.mapStyle=new tt.MapStyle,this.timeEffectManager=new N.TimeEffectManager(this.mapState),this.mapRenderer=new y.MapRenderer(this.gl,this.mapState),this.skyRenderer=new V.SkyRenderer(this.gl,this.timeEffectManager),this.cameraAnimation=new v.CameraAnimation(this.mapState,this,this.mapSettings),this.dirty=!0,this.mapObserver=new h.MapObserver,this.mapState.setScreenSize(this.width,this.height),i.restrictionBounds&&this.setRestrictionBounds(i.restrictionBounds),this.mapState.setZoom(i.zoom),this.mapState.setBearing(i.bearing),this.mapState.setTarget(b.LatLng.convert(i.center)),this.mapSettings.setMinZoom(i.minZoom),this.mapSettings.setMaxZoom(i.maxZoom),this.mapSettings.setMaxNativeZoom(i.maxNativeZoom),i.zoom>=w.MapConstants.defaultMinZoom3d&&i.tilt>w.MapConstants.maxTilt2D?(i.tilt=x.MathUtils.clamp(i.tilt,w.MapConstants.minTilt,w.MapConstants.maxTilt3D),this.mapState.setTilt(i.tilt),this.mapState.enable3dMode(!0)):(i.tilt=x.MathUtils.clamp(i.tilt,w.MapConstants.minTilt,w.MapConstants.maxTilt2D),this.mapState.setTilt(i.tilt));var n=function(){e.dirty=!0};H.MapResourceManager.getInstance(this.gl).init(n,this.httpTaskManager),this.tileManager=new p.TileManager(this,this.httpTaskManager,this.mapState,this.mapSettings,n),this.overlayManager=new J.OverlayManager(this,this.httpTaskManager,n),this.directionsRendererManager=new et.DirectionsRendererManager;var r=this.createLayer(w.LayerConstants.rasterLayerId,m.LayerType.RASTER,w.MapConstants.baseMapLowestOrder);this.userPOILayer=this.createLayer(w.LayerConstants.userPOILayerId,m.LayerType.USERPOI,w.MapConstants.userPOILayerOrder),this.poiLayer=this.createLayer(w.LayerConstants.pointLayerId,m.LayerType.POI,w.MapConstants.baseMapLowestOrder),this.surfaceLayer=this.createLayer(w.LayerConstants.surfaceLayerId,m.LayerType.SURFACE,w.MapConstants.baseMapLowestOrder),this.boundaryLayer=this.createLayer(w.LayerConstants.boundaryLayerId,m.LayerType.BOUNDARY,w.MapConstants.baseMapLowestOrder),this.roadLayer=this.createLayer(w.LayerConstants.roadsLayerId,m.LayerType.ROADS,w.MapConstants.baseMapLowestOrder),this.labelLayer=this.createLayer(w.LayerConstants.labelLayerId,m.LayerType.LABEL,w.MapConstants.baseMapMiddleOrder),this.createLayer(W.GeoJsonManager.geoJsonLayerId,m.LayerType.GEOJSON,w.MapConstants.baseMapLowestOrder),this.buildingLayer=this.createLayer(w.LayerConstants.buildingLayerId,m.LayerType.BUILDING,w.MapConstants.buildingLayerOrder),this.userBuildingLayer=this.createLayer(w.LayerConstants.userBuildingLayerId,m.LayerType.USERBUILDING,w.MapConstants.buildingLayerOrder),this.hiddenBuildings=new Set,this.visibleBuildings=new Set,this.selectedBuildings=new Set,this.lightManager=new B.LightingManager(this.timeEffectManager),this.buildingLayer.timeEffectManager=this.timeEffectManager,this.buildingLayer.setLightingManager(this.lightManager),this.userBuildingLayer.timeEffectManager=this.timeEffectManager,this.userBuildingLayer.setLightingManager(this.lightManager);var o=new U.ShadowMap(this.gl,this.lightManager.sunLight,this.mapState);this.effectManager=new G.EffectManager(o,this.mapState),this.mapRenderer.setEffectManager(this.effectManager),r.effectManager=this.effectManager,r.timeEffectManager=this.timeEffectManager,r.setLightingManager(this.lightManager),this.buildingLayer.effectManager=this.effectManager,this.userBuildingLayer.effectManager=this.effectManager,this._annotationManager=new _.AnnotationManager(this,this.tileManager),this.weatherManager=new R.WeatherManager(this.gl,this.mapState),this.weatherManager.resize(this.width,this.height),this.lightManager.setOnLightPositionChanged((function(){o.updateMatrices()})),this.geoJsonManager=new W.GeoJsonManager(this),this.collision2DManager=new q.Collision2DManager(this.gl,this.mapState),this.uiSettings=new K.UISettings,this.skyObject=new j.SkyObject,r.skyObject=this.skyObject,r.skyRenderer=this.skyRenderer,this.frameBuffer=new C.FrameBuffer(this.gl,this.width,this.height),this.canvas.width=this.width,this.canvas.height=this.height,this.dirty=!0,this.tileManager.updateVisibleTiles(),this.mapState.setShouldChangeMapMode(this.options.shouldChangeMapMode)},e.prototype.createStyleNode=function(){var t=document.getElementsByTagName("head")[0],e=t.getElementsByClassName("map-style");if(!(e&&e.length>0)){var i=document.createElement("style");i.innerHTML=o.Style.content,i.className="map-style",t.appendChild(i)}},e.prototype.setupMapViews=function(t,i){var n=u.DOMUtils.create("div","mf-mapgl",t);this.mapContainer=n,this.canvas=u.DOMUtils.create("canvas","",n),this.gl=this.canvas.getContext("experimental-webgl",{stencil:!0,premultipliedAlpha:!1}),++e.idContextCounting,this.gl.id=e.idContextCounting.toString();var r=a.Color.fromHex(w.MapConstants.mapBackgroundColor2D);this.gl.clearColor(r.red,r.green,r.blue,r.alpha),this.gl.stencilOp(this.gl.KEEP,this.gl.REPLACE,this.gl.REPLACE),A.MapUtils.pixelScale=window.devicePixelRatio||1,this.devicePixelRatio=A.MapUtils.pixelScale,this.hasTouch()&&(A.MapUtils.touchBoxSize=w.MapConstants.touchBoxSize*A.MapUtils.pixelScale),this.width=this.canvas.offsetWidth*A.MapUtils.pixelScale,this.height=this.canvas.offsetHeight*A.MapUtils.pixelScale,this.offsetWidth=this.canvas.offsetWidth,this.offsetHeight=this.canvas.offsetHeight,this.mouseEventHandler=new s.MouseEventHandler(this.canvas,this),window.addEventListener("resize",this.resize,!1)},e.prototype.createMapControlNode=function(t,e){var i=u.DOMUtils.create("div","mf-ui "+o.Style.getStyleForControlOptions(e.controlOptions),t),n=null,r=null,a=null;e.geolocate&&(this.geolocateControl=new L.GeolocateControl(this)),e.controls&&(r=u.DOMUtils.create("div","vertical",i),this.geolocateControl&&this.geolocateControl.updateMapUI(r),this.zoomInButton=u.DOMUtils.create("div","mf-button",r),this.zoomInButton.innerHTML="<a class='mf-zoom-in-icon'></a>",this.zoomOutButton=u.DOMUtils.create("div","mf-button",r),this.zoomOutButton.innerHTML="<a class='mf-zoom-out-icon'></a>",this.modeButton=u.DOMUtils.create("div","mf-button",r),this.modeButton.innerHTML="<a class='mf-mode-icon'></a>",n=u.DOMUtils.create("div","right",i),this.upButton=u.DOMUtils.create("div","mf-button",n),this.upButton.innerHTML="<a class='mf-up-icon'></a>",this.downButton=u.DOMUtils.create("div","mf-button",n),this.downButton.innerHTML="<a class='mf-down-icon'></a>",this.leftButton=u.DOMUtils.create("div","mf-button",n),this.leftButton.innerHTML="<a class='mf-left-icon'></a>",this.rightButton=u.DOMUtils.create("div","mf-button",n),this.rightButton.innerHTML="<a class='mf-right-icon'></a>",a=u.DOMUtils.create("div","horizontal",i),this.bearingButton=u.DOMUtils.create("div","mf-button",a),this.compassImage=u.DOMUtils.create("a","mf-direct-icon",this.bearingButton),this.compassImage.style.transform=null),this.addControlEvents()},e.prototype.createLogoNode=function(t){var e=this.options.controlOptions==z.ControlOptions.BOTTOM_LEFT?"mf-right":"mf-left",i=u.DOMUtils.create("div","mf-logo-container "+e,t),n=O.Images.get("logoIcon");i.innerHTML="<a target='_blank' href='https://www.map4d.vn/' aria-label='Map4D Logo'>\n      <img src="+n+" class='mf-logo'/>\n      </a>"},e.prototype.addControlEvents=function(){var t=this;this.options.controls&&(this.upButton.addEventListener("click",(function(){t.setTilt(t.mapState.getTilt()+10,!1)})),this.downButton.addEventListener("click",(function(){t.setTilt(t.mapState.getTilt()+-10,!1)})),this.leftButton.addEventListener("click",(function(){t.setBearing(t.mapState.getBearing()-10,0,!1)})),this.rightButton.addEventListener("click",(function(){t.setBearing(t.mapState.getBearing()+10,0,!1)})),this.zoomInButton.addEventListener("click",(function(){t.setZoom(t.mapState.getZoom()+1,new l.Vector2(t.width/2,t.height/2),0,!1)})),this.zoomOutButton.addEventListener("click",(function(){t.setZoom(t.mapState.getZoom()-1,new l.Vector2(t.width/2,t.height/2),0,!1)})),this.modeButton.addEventListener("click",(function(){t.enable3dMode(!t.mapState.is3dMode())})),this.bearingButton.addEventListener("click",(function(){t.moveCamera({target:t.mapState.getTarget(),bearing:0},{animate:!0})})))},e.prototype.addListener=function(t,e,i){return this.mapsEventManager.addEvent(t,e,i)},e.prototype.addGeoJsonListener=function(t,e){return this.mapsEventManager.addGeoJsonListener(t,e)},e.prototype.updateInfoContents=function(t){this.annotationManager.updateInfoContents(t)},e.prototype.notifyCameraWillChange=function(t){this.dirty=!0,this.mapsEventManager.notify(k.MapEvent.cameraWillChange,null,t)},e.prototype.notifyCameraIsChanging=function(){this.dirty=!0,this.mapsEventManager.notify(k.MapEvent.cameraChanging),this.mapsEventManager.notify(k.MapEvent.boundsChanged),this.surfaceLayer.setDirty(),this.boundaryLayer.setDirty(),this.roadLayer.setDirty(),this.buildingLayer.setDirty(),this.userBuildingLayer.setDirty(),this.tileManager.updateVisibleTiles(),this.overlayManager.dirtyBuildingOverlay()},e.prototype.notifyCameraDidChange=function(){this.dirty=!0,this.mapState.setZoom(Math.round(this.mapState.getZoom())),this.surfaceLayer.setDirty(),this.boundaryLayer.setDirty(),this.roadLayer.setDirty(),this.buildingLayer.setDirty(),this.userBuildingLayer.setDirty(),this.tileManager.updateVisibleTiles(),this.mapsEventManager.notify(k.MapEvent.idle),this.mapState.willChange=!1},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e.prototype.queryBuildingAndAnnotation=function(t){return this.annotationManager.queryBuildingAndAnnotation(t)},e.prototype.queryPOI=function(t){var e=this.collision2DManager.query(t);if(null==e)return null;if(!this.mapState.is3dMode()){var i=null;if(this.layers.forEach((function(t){if(t.getLayerType()==m.LayerType.POI_OVERLAY){if(null!=i)return;i=t.queryFeature(e)}})),null!=i)return i;if(this.isPOIsEnabled())return this.poiLayer.queryFeature(e)}return null},e.prototype.queryUserPOI=function(t){var e=this.collision2DManager.query(t);if(null==e)return null;var i=this.userPOILayer.queryFeature(e);return i||null},e.prototype.queryPlace=function(t){var e=this.collision2DManager.query(t);if(null==e)return null;var i=this.labelLayer.queryFeature(e);return i||null},e.prototype.queryBuildingInfo=function(t){var e=this.getSelectionCode(t);return this.queryBuilding(e)},e.prototype.queryBuilding=function(t){if(t<0)return null;var e=[];this.isBuildingsEnabled()&&e.push(this.buildingLayer),e.push(this.userBuildingLayer),this.layers.forEach((function(t){if(t.getLayerType()===m.LayerType.BUILDING_OVERLAY){var i=t;i.isVisible()&&e.push(i)}}));for(var i=null,n=0,r=e;n<r.length;n++){var o=r[n];0==o.textureBuildingGroups.size&&0==o.extrudeBuildings.length||(0!=o.textureBuildingGroups.size&&o.textureBuildingGroups.forEach((function(e){e.buildings.forEach((function(e){if(e.getSelectionCode()!=t);else{var n=e.getLayerProperties(),r=0;if(e.getType()==m.LayerType.USERBUILDING){var o=n;if(!o.isVisible()||!o.isUserInteractionEnabled())return;r=o.getAnnotationId()}i=new X.BuildingQueryResult(r,n.getId(),n.getName(),n.getLocation())}}))})),0!=o.extrudeBuildings.length&&o.extrudeBuildings.forEach((function(e){if(e.getSelectionCode()!=t);else{var n=e.getLayerProperties(),r=0;if(e.getType()==m.LayerType.USERBUILDING){var o=n;if(!o.isVisible()||!o.isUserInteractionEnabled())return;r=o.getAnnotationId()}i=new X.BuildingQueryResult(r,n.getId(),n.getName(),n.getLocation())}})))}return i},e.prototype.setDate=function(t){this.mapSettings.setDate(t),this.reload(),this.mapSettings.is3dMode()&&(this.buildingLayer.clear(),this.userBuildingLayer.clear())},e.prototype.getMapContainer=function(){return this.mapContainer},e.prototype.destroy=function(){this.frameBuffer&&this.frameBuffer.destroy(),this.shader&&this.shader.destroy(),this.tileManager&&this.tileManager.destroy(),this.mapsEventManager&&this.mapsEventManager.destroy(),this.weatherManager&&this.weatherManager.destroy(),this.layers&&this.layers.clear(),this.buildingLayer&&this.buildingLayer.clear(),this.userBuildingLayer&&this.userBuildingLayer.clear(),this.effectManager&&this.effectManager.destroy(),P.ResourceManager.releaseInstance(this.gl),Y.TextLabelFactory.releaseInstance(this.gl),H.MapResourceManager.releaseInstance(this.gl),this.gl=null,this.frameBuffer=null,this.effectManager=null},Object.defineProperty(e.prototype,"annotationManager",{get:function(){return this._annotationManager},enumerable:!0,configurable:!0}),e.prototype.moveToMyLocation=function(t){void 0===t&&(t=!0),this.geolocateControl&&this.geolocateControl.moveToMyLocation(t)},e.prototype.setTimeEffect=function(t){this.timeEffectManager.setTimeEffect(t),this.buildingLayer.setDirty(),this.userBuildingLayer.setDirty(),this.dirty=!0},e.prototype.getTimeEffect=function(){return this.timeEffectManager.getTimeEffect()},e.prototype.setFilterPOIs=function(t){this.mapSettings.filterPOITypes=t,this.mapState.is3dMode()||(this.dirty=!0)},e.prototype.getFilterPOIs=function(){return this.mapSettings.filterPOITypes},e.prototype.setFilterBuildings=function(t){this.buildingLayer.filterBuildingTypes=t,this.effectManager.shadowMap.clear(),this.dirty=!0},e.prototype.getFilterBuildings=function(){return this.buildingLayer.filterBuildingTypes},e.prototype.getSelectedBuildings=function(){return Array.from(this.selectedBuildings)},e.prototype.setSelectedBuildings=function(t){var e=this;this.selectedBuildings.clear(),t.forEach((function(t){e.selectedBuildings.add(t)})),this.buildingLayer.setDirty(),this.overlayManager.dirtyBuildingOverlay(),this.dirty=!0},e.prototype.setHiddenBuildings=function(t){var e=this;null!=t&&(this.hiddenBuildings.clear(),t.length>0&&t.forEach((function(t){e.hiddenBuildings.add(t)})),this.dirty=!0)},e.prototype.setVisibleBuildings=function(t){var e=this;null!=t&&(this.visibleBuildings.clear(),t.length>0&&t.forEach((function(t){e.visibleBuildings.add(t)})),this.dirty=!0)},e.prototype.isHiddenBuilding=function(t){return this.hiddenBuildings.has(t)},e.prototype.isVisibleBuilding=function(t){return this.visibleBuildings.has(t)},e.prototype.hasVisibleBuildings=function(){return this.visibleBuildings.size>0},e.prototype.getGeoJsonManager=function(){return this.geoJsonManager},e.prototype.getCollision2DManager=function(){return this.collision2DManager},e.prototype.onMapModeChanged=function(){this.mapsEventManager.notify(k.MapEvent.modeChanged),this.mapSettings.is3dMode()||this.effectManager.shadowMap.clear(),this.modeButton&&(this.modeButton.className=this.mapSettings.is3dMode()?"mf-button mf-mode-2d":"mf-button")},e.prototype.isZoomGesturesEnabled=function(){return this.uiSettings.isZoomGesturesEnabled()},e.prototype.setZoomGesturesEnabled=function(t){this.uiSettings.setZoomGesturesEnabled(t)},e.prototype.isScrollGesturesEnabled=function(){return this.uiSettings.isScrollGesturesEnabled()},e.prototype.setScrollGesturesEnabled=function(t){this.uiSettings.setScrollGesturesEnabled(t)},e.prototype.isRotateGesturesEnabled=function(){return this.uiSettings.isRotateGesturesEnabled()},e.prototype.setRotateGesturesEnabled=function(t){this.uiSettings.setRotateGesturesEnabled(t)},e.prototype.isTiltGesturesEnabled=function(){return this.uiSettings.isTiltGesturesEnabled()},e.prototype.setTiltGesturesEnabled=function(t){this.uiSettings.setTiltGesturesEnabled(t)},e.prototype.setAllGesturesEnabled=function(t){this.uiSettings.setAllGesturesEnabled(t)},e.prototype.convertMapType=function(t){return"string"==typeof t?"roadmap"==t?$.MapType.roadmap:"satellite"==t?$.MapType.satellite:$.MapType.raster:t},e.prototype.setMapType=function(t){var e=this.convertMapType(t);this.mapSettings.getMapType()!==e&&(this.mapSettings.setMapType(e),this.mapState.is3dMode()?t==$.MapType.roadmap&&(this.enable3dMode(!1),this.requestRender()):this.reload())},e.prototype.getMapType=function(){return this.mapSettings.getMapType()},e.prototype.setMapStyle=function(t){this.mapStyle.load(t),this.reload()},e.prototype.dirtyLayer=function(t){switch(t){case m.LayerType.SURFACE:case m.LayerType.BOUNDARY:this.surfaceLayer.setDirty(),this.boundaryLayer.setDirty();break;case m.LayerType.ROADS:this.roadLayer.setDirty();break;case m.LayerType.BUILDING:this.buildingLayer.setDirty();break;case m.LayerType.USERBUILDING:this.userBuildingLayer.setDirty();break;case m.LayerType.BUILDING_OVERLAY:this.overlayManager.dirtyBuildingOverlay();break;default:console.warn("Missing implement dirty layer type:",t)}},e.idContextCounting=0,e}(c.CameraAnimationObserver);e.MapView=it},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(66),r=function(){function t(){}return t.getStyleForControlOptions=function(t){switch(t){case n.ControlOptions.TOP_LEFT:return"mf-ui-top-left";case n.ControlOptions.TOP_RIGHT:return"mf-ui-top-right";case n.ControlOptions.BOTTOM_LEFT:return"mf-ui-bottom-left";case n.ControlOptions.BOTTOM_RIGHT:return"mf-ui-bottom-right"}},t.bgColor="rgba(255,255,255,1)",t.size="29px",t.controlDistance="10px",t.content="\n.mf-map4d {\n  height: 100%;\n  width: 100%;\n  position: relative;\n  box-sizing: content-box;\n  overflow: hidden;\n}\n\n.mf-mapgl {    \n    position: absolute;\n    height: 100%;\n    width: 100%;\n    box-sizing: content-box;  \n  }\n  \n.mf-mapgl canvas {\n  width: inherit;\n  height: inherit;\n  position: absolute;\n  display: inherit;\n}\n\n.mf-map4d .mf-ui {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n}\n\n.mf-map4d .mf-ui .right {\n  display: flex;\n  flex-direction: column;\n}\n\n.mf-map4d .mf-ui .vertical {\n  display: flex;\n  flex-direction: column;\n}\n\n.mf-map4d .mf-ui .horizontal {\n    display: block;\n    align-self: flex-end;\n    height: 35px;\n}\n\n.mf-ui.mf-ui-top-left {\n  top: "+t.controlDistance+";\n  left: "+t.controlDistance+";\n  flex-direction: inherit;\n}\n.mf-ui.mf-ui-top-right {\n  top: "+t.controlDistance+";\n  right: "+t.controlDistance+";\n  flex-direction: row-reverse;\n}\n.mf-ui.mf-ui-bottom-right {\n  bottom: "+t.controlDistance+";\n  right: "+t.controlDistance+";\n  flex-direction: row-reverse;\n}\n.mf-ui.mf-ui-bottom-left {\n  left: "+t.controlDistance+";\n  bottom: "+t.controlDistance+";\n  flex-direction: inherit;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-left .vertical {\n  flex-direction: column-reverse;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-left .horizontal {\n  align-self: flex-start;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-right .vertical {\n  flex-direction: column-reverse;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-right .horizontal {\n  align-self: flex-start;\n}\n\n.mf-map4d .mf-ui .mf-button {\n  margin: 3px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: "+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n    box-shadow: 0px 0px 4px #666;\n    background-color: #fff;\n  }\n\n.mf-map4d .mf-ui .mf-button:hover {\n    background-color: darken("+t.bgColor+", 5%);\n  }\n\n.mf-map4d .mf-ui .mf-button:active {\n    background-color: darken("+t.bgColor+', 10%);\n  }\n \n.mf-map4d .mf-ui.mf-ui-bottom-right .mf-location-box,\n.mf-map4d .mf-ui.mf-ui-bottom-left .mf-location-box {\n    margin-bottom: 9px;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-right .mf-location-box,\n.mf-map4d .mf-ui.mf-ui-top-left .mf-location-box {\n    margin-top: 9px;\n}\n\n.mf-map4d .mf-ui a{\n  background-position: center !important;\n  background-repeat: no-repeat !important;\n  background-size: cover !important;\n  opacity: 0.5;\n  width: 29px;\n  height: 29px;\n}\n\n.mf-scrollbar::-webkit-scrollbar {\n  width: 10px;\n}\n \n.mf-scrollbar::-webkit-scrollbar-track {\n  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); \n  border-radius: 10px;\n}\n \n.mf-scrollbar::-webkit-scrollbar-thumb {\n  border-radius: 10px;\n  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); \n  background-color: #555;\n}\n\n.mf-map4d .mf-ui .mf-up-icon { \n  background-size: 21px 21px !important;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PGRlZnM+PHN0eWxlPi5he2NsaXAtcGF0aDp1cmwoI2EpO30uYntmaWxsOiM3YzgzOTE7fTwvc3R5bGU+PGNsaXBQYXRoIGlkPSJhIj48cmVjdCB3aWR0aD0iMjQiIGhlaWdodD0iMjQiLz48L2NsaXBQYXRoPjwvZGVmcz48ZyBjbGFzcz0iYSI+PHBhdGggY2xhc3M9ImIiIGQ9Ik0xOSwxNS41bC03LTctNyw3WiIvPjwvZz48L3N2Zz4=);       \n}\n\n.mf-map4d .mf-ui .mf-down-icon { \n  background-size: 21px 21px !important;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PGRlZnM+PHN0eWxlPi5he2NsaXAtcGF0aDp1cmwoI2EpO30uYntmaWxsOiM3YzgzOTE7fTwvc3R5bGU+PGNsaXBQYXRoIGlkPSJhIj48cmVjdCB3aWR0aD0iMjQiIGhlaWdodD0iMjQiLz48L2NsaXBQYXRoPjwvZGVmcz48ZyBjbGFzcz0iYSI+PHBhdGggY2xhc3M9ImIiIGQ9Ik01LDguNWw3LDcsNy03WiIvPjwvZz48L3N2Zz4=);       \n}\n\n.mf-map4d .mf-ui .mf-left-icon { \n  background-size: 21px 21px !important;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyBpZD0iYXJyb3ctdW5kbyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPgogIDxkZWZzPgogICAgPGNsaXBQYXRoIGlkPSJjbGlwLXBhdGgiPgogICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlXzEzNzciIGRhdGEtbmFtZT0iUmVjdGFuZ2xlIDEzNzciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIvPgogICAgPC9jbGlwUGF0aD4KICA8L2RlZnM+CiAgPGcgaWQ9Ikdyb3VwXzIwNzciIGRhdGEtbmFtZT0iR3JvdXAgMjA3NyIgY2xpcC1wYXRoPSJ1cmwoI2NsaXAtcGF0aCkiPgogICAgPHBhdGggaWQ9IlBhdGhfMjYxOSIgZGF0YS1uYW1lPSJQYXRoIDI2MTkiIGQ9Ik0xMy4yNzEsOC4wNjZhNy45NDIsNy45NDIsMCwwLDEsMi4wMTcsNS40NTgsOC4xOTMsOC4xOTMsMCwwLDEtNS43LDcuODMxTDksMTkuNDU2YTYuNDE4LDYuNDE4LDAsMCwwLDQuMzktNi4wNTEsNi4wODMsNi4wODMsMCwwLDAtMS41NDItNC4wMzRMOSwxMi4yMTlWNS4xaDcuMTE5WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNTU5IC0xLjI3NykiIGZpbGw9IiM3YzgzOTEiLz4KICA8L2c+Cjwvc3ZnPgo=);       \n}\n\n.mf-map4d .mf-ui .mf-right-icon { \n  background-size: 21px 21px !important;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyBpZD0iYXJyb3ctdW5kbyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiPgogIDxkZWZzPgogICAgPGNsaXBQYXRoIGlkPSJjbGlwLXBhdGgiPgogICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlXzEzNzciIGRhdGEtbmFtZT0iUmVjdGFuZ2xlIDEzNzciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIvPgogICAgPC9jbGlwUGF0aD4KICA8L2RlZnM+CiAgPGcgaWQ9Ikdyb3VwXzIwNzciIGRhdGEtbmFtZT0iR3JvdXAgMjA3NyIgY2xpcC1wYXRoPSJ1cmwoI2NsaXAtcGF0aCkiPgogICAgPHBhdGggaWQ9IlBhdGhfMjYxOSIgZGF0YS1uYW1lPSJQYXRoIDI2MTkiIGQ9Ik0xMS44NDksOC4wNjdhNy45NDUsNy45NDUsMCwwLDAtMi4wMTgsNS40Niw4LjIsOC4yLDAsMCwwLDUuNyw3LjgzM2wuNTkzLTEuOWE2LjQyLDYuNDIsMCwwLDEtNC4zOTEtNi4wNTMsNi4wODYsNi4wODYsMCwwLDEsMS41NDMtNC4wMzVsMi44NDgsMi44NDlWNS4xSDlaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41NjEgLTEuMjgpIiBmaWxsPSIjN2M4MzkxIi8+CiAgPC9nPgo8L3N2Zz4K);       \n}\n\n.mf-map4d .mf-ui .mf-zoom-in-icon { \n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMGSURBVHgB7ZrPTxNBFMdfjQm9CDWx0ioJShNJLyoeJHqAYNIL6gWihyaYKPGkN/8OT+rJoESjBxOOctCkDb2Uein2QKMJKRBIIZCw6sH2pPPdMussWaGlb0kznU+y6a9ZMp99b968LQ38EVAbcIzaBCOqG0ZUN4yobhhR3TCiumFEdcOI6oYR1Y3j5DOllXXKf12k0uoaWdYv+71gsIOi3aco3h+zj1DXCfKbgF9fpUAwnZm3Hw/i+tXLNDI8SMGODvILX0SzuQWa/Zxp6JxQVydN3hv3LbrsoulMjlLikCBNr4mIXbkYp1Co036vUqlSeXOL8oWiSOuiM9ZPWVZR68dPevps2nkd7++jsdsJW/Z/FL8t0eynjDi3tn7P956lBxPjxA1r1Z16M+M8h2Tyzi2XJIoRjkq1qoyLucbZxatQJG7YRDFBGRWk4Ghi2PW5ZYloP39tH+8+fHR9Fo2EaWRo0HmdzeWJGzZRbCGSgUtYj42tM1ReGdXy5ra9hjlhE90Qk5MgbSUyXXd2ow2qlYpnGg+IgiWpZ1tqBLaGQY1AtDtsP9bSddpj7LadwuBcbw9NTozVzouEnTGozJy0bAvILcoWUawvOTmko+xyEDHJ8sqaMzayG3W0gpIdkQHq3+OETRQTluuqvLEl9sMeu0GQaammMSTl+yryQoAzShpzwJa6auTSSmdUL2g21AIUOd2iotgeJJhwSYmOBBcDh5quktTcv4tzmO3pIFhbQLRy2S8L9nOssUcPk3X1rXv74yeP77OLslbdG6K7kWIoTC9evnfEvUC6vno745IE+cIiccN+94KiMyUmbykNAlpCNOvYJ2V1RjO/X1OAi6a2hc3iy/2ol+xh4JQN+PljDdyFpObm9xVGcRpNDFHx+5JnteaSDRzFr1Kwry6vrtNvkbKINvbXk+KIX+hzNQZYq16yybs3xdgYNcORiDbCXllsNbh5b5aW63XVVOWSBC0XUQmqMr594KJlRbkx/5LQDSOqG0ZUN4yobhhR3TCiumFEdaNtRP8C9QdgiPBj+C8AAAAASUVORK5CYII=);       \n}\n\n.mf-map4d .mf-ui .mf-zoom-out-icon { \n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALdSURBVHgB7ZrBTxNBFIdfjbH1INREpFUSlCaSXlQ8iJoIgaQX1AtEDyR4kL/Hk3oyGKIJF8NRDpq0oZdSL8Ue2GhCCgRSCCauerA96fy2mWVqyrbQt2QznS9p2Da7ZL6+N++9bRv6K6AO4BR1CEZUN4yobhhR3TCiumFEdcOI6oYR1Y3T5DOlzR0qfFmj0tY22fZv57VIJEzx3guUHEw4j2j3OfKbkF833hDMZFecv824d/smjY0OUyQcJr/wRTSXX6WlT9kjXRPt7qLZp1O+RZddNJPNU1o8JEjTuyJit64nKRrtcl6rVKpU3tunQtESaW255/opyypq//xFz1/Mu8+TgwM0+SjlyB6G9XWdlj5mxbW1/Xu1/zI9m5kiblir7tzbRfcYktOPH3pK1s5L1J3nFK+iRdywiWKBMipIwYnUaMvXxmM9NDYy7D7P5QvEDZsoWohk6Ab249H2GSqvjGp577uzhzlh66O7YnESpK1E9s7DiJw947aVIVGwcp9XnWNkSLy3h7hgE1UjIBdo26I4vZz3vO5Kfx/NzkzWrosdiKEycxLYEZBblC2i2F9ycZVq1U1HRMwLjIKSHyID1P/HCZsoFizHvfLuvuiHfc6AINOyFTY2t93jSzG+/QnYUleNXEaZjFoFw4Y6F8cuBlQU7UGCBZeU6LRCevngzTlOe2oGm6icaSUL7z+4A0QzkAHqNDR+/w5xw1p1x8V0IwdyFKZXrxfcvtgIpOubd4t1NwGgUFwjbtjvXtA758Ti1WhiJMSwjj4pqzOGea97Vbxp6ljYLr7cjzaSPQ6csiE/v9rHvksvr3gKo1pPpEbI+rbesFpzyYZO4jcM6KsbWzv0R6Qsoo3+el48ktcG6gYD7NVGstNPHohzE9QOoaD9WON/WbQa3Ly3S+BmXTVVuSRB4CIqQVXGpw9cBFaUG/OVhG4YUd0worphRHXDiOqGEdUNI6obRlQ3Okb0H+xvLgcbOwA8AAAAAElFTkSuQmCC);  \n}\n\n.mf-map4d .mf-ui .mf-location {\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMlSURBVHgB7Zo/a1NRGMbfiJAuthnUJlSsMWBNB9s4tKZgwaCCgw7tpKCDFZd+FidnK1hwEMyg4hKIWKExXZI6NFYwsaIktQGjLsmk5znJSU9i0lya9y6n57dcuDkH7nPef8+9xPNXQAeAQ3RAsEJNwwo1DSvUNKxQ07BCTcMKNQ0r1DSsUNM4TC5TrdUos56jwtY3Km7vUKXyR94fGPBSYPgoRSbGKTh6gnxDR8hNPG59SoHAVDpLq2tZqlZrPdfHZqcpOj1JA14vuYErQiu/ftOjJ8/FtR69UyJi5yfCFDw5Qj7foLxXLO1Q6UeZNjbz9HHzs7znGxqkhTvzrkSXXaguEg8+d+OyTM0991TEnuXdPW6IZRf64OFj+cCov7u352UtOgHpHX+ZoJyIMMQu3r/JmsasXffNSroZlW4i0YxQv+1g7dz1K/KAkBWror45Yeu6eLikEAoWOohEY0q+SzcbEw4DdXtJNCEF9ly7OktLy3FKiSY2w9ic2CJa2Pour+Gx06LhtNYXUvJ1YqWl+6qDWRK1qYN6Do6OyLWcUWUTmlnfkNfwWKj1/oecnKPdwAGpTFBEpyLy+kXMXi7YhP4UEQJ+UWM6ybfve+5FmuogoqC4XSYu2IQqxxMYPta8h/RTs3Qv5LrK7jpV306MhlNc9bqcD9ovbEJVA9IjAxfkZI6iA+sNTB2Q0xnsBDah/uP1lM1/bW0g0anJnnsjYszoqA7u18qgX9iEKpuXbXRfBcy6ai6dgEGIabMU5BreF6OKCzahGP5INUSj0DYW4JJgDHT/irW4h990MF8xksD4mRBxwep1MQ9hAwP+hs/1drKA9TGk3mLaUV4Z6QxLyAVr150R9YioFUtlir9IdPS0ENhNJByU8sqxixeIE/7XtH28ciFdnz57JQ0CUnrx3q3/bGS/uPPirYkFkXNhCp8Nyaak0hnRRuRTaxn5agbkwYiU5xYJ3PuUImYharbd3nUDYwjdl3N26njc/vsNopv7lJefTEri45huBjAnEWXUtlsCFR77PyPDsEJNwwo1DSvUNKxQ07BCTcMKNQ0r1DSsUNP4By5Rba+rOeGSAAAAAElFTkSuQmCC);    \n}\n\n.mf-map4d .mf-ui .mf-mode-icon { \n  background-image: url(data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSgBBwcHCggKEwoKEygaFhooKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKP/AABEIAB0AHQMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APqmgAoAKAPAP21f+SWaV/2Gov8A0RPQB75ceb5En2cIZtp2CQkLuxxnHOKAPPpNX1/TJdVtr3U4bmaGwNwGMCxGKT0QEDzF/wBrBH0rSyZN2T2l94g08aDe3uqx6haajLFDJC1ssRjMgGCCvXH+R6Kydw1PPf21f+SWaV/2Gov/AERPUFHvd1D9otpYS8kfmKV3xttZcjqD2NAHHnwVc3PmtqmtzXsotmtbd3hC+UGGCTg/Ofcmr5uyFYlsPCN4txpx1XXJL2009leC3W2WIBlxtJIJzjHehy7ILHl/7av/ACSzSv8AsNRf+iJ6gYf8NV+B/wDoFeJP/AeD/wCPUAH/AA1X4H/6BXiT/wAB4P8A49QAf8NV+B/+gV4k/wDAeD/49QB5f+0L8a/DnxH8F2WkaHZavBcw6gl2zXkUaoUWORSAVkY5y47etAH/2Q==);    \n}\n\n.mf-map4d .mf-ui .mf-button.mf-mode-2d .mf-mode-icon {\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALcSURBVHgB7ZpBaxNBFIBfREg82C7S2IaKpl6kPVTjwVoPDYa2oJiCW3qwqAfFk7/Fm1cjFOmhYA5FLxZaUGiJHmI9GLwolpYktNBtekhyaudNSNlNJrvJm00P0/lgSbLsTObbmffebEjgiAFngHNwRtCiqqFFVUOLqoYWVQ0tqhpaVDW0qGpoUdU4D5JUqlXIF/bAOijxz6FQECL9YTB6L7q2W8/85G1FXGB9GEYPDF0bhFAwCH5AFsVBbrDBrn9nA640Dzg2OgyJ+N2Wwhs/smBZh+DF8I3r8HA67nnjvAhQfjPC2Vtc+gT54p7rdUZvD7x8Pisc5Ju379sSrZOYGIP77KBCitHFpc+ekgjekPTyF/CD1a8ZWGMHFdLSfZychNSHNF+yOGvmzCSPy32rBGvfMpD78/fk2n//d9ixzeLtimufuNTNmSneZ764C9lfOchu5hzXoGyUxa1XXyJIMxoZCMOLpyb/wtevnvBXnoTY+fm5R/y9HZRtF2yL/ZnJKeFSpc4qubxw2WdmkxSCCcSOZZWAAsYlZl47GDKtsrUbXamj5bJzIFgqqMRujjg+86Vd2IVO6YpooegcSOOsdMLQ1ea2+wftZ+s6votiDFm2gWCyoiSPOqLQoISCr6JYTlYbkkUiTq99iEiUgm+iKPlu4aPjXJTNJJYNqX4Fs0eR90UUsyDulBqX7CwrEbKI4vESIblJi6Jkis1k404J66lhyO1Pkezm76ZzA5fD0ClSoq0kH0xPsDrbB7JgOOAOyU6kv490A6WeXkSSuJu5d+cWyIK7KdE+eXwsBhRIoq0kMS4xeaSXV06eT+tg4XdLTDWxldr7rW3hkw3OJjW5kURTC2nh00ttqYlrXNSjlrq1RfAmzs8lgQpJtFytwGkyzkIB970yNVX6p5RugHvj2o5qEG6PjviSvQP6XymKoUVVQ4uqhhZVDS2qGlpUNbSoamhR1dCiqqFFVeMYfD4SpVZLd6IAAAAASUVORK5CYII=);\n}\n\n.mf-map4d .mf-ui .mf-direct-icon { \n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAD6UlEQVR42u2Y608VRxjG+aL/gDHYals1aUtBoAiJ4g2lmqAJWjFiE0VMsV5jNJE2eKm0XnLUqkExKEFTG2krF6PU1hta1KgR5aKHY0UJahRN/ErKu5dZzuM75yCHAwQO8csumSd5s5vs7mR++8zM+86EhSkpKSkpKSkpKSkpKSkNdrW3txdxnOAolFfLssr4esrr9V7jqOG4G2pb/G6jbMOuoNs4jnL8zpAXJRzfP+T7RUHvtbzOC6GtfwzDiLYlKIAohmvqcK+SAau6PjcbHoJydkD7PhfmH6eBN2/C+2pPCLHflqAMls2RyR1M5WsGu1Igh20naHE5KDkNFDkJtHglzNt30c+PG27beVpTUzNE1/VPGTKH404nZJ3bS1kbQGMTQCMiGXg+jNKzcORi5PF4hvK8imDArexoXddnEopS0kGjYkHhDPr5RGhbdkF4Gp0Hy5CxDJnLkO6gufbgP2g//AyKnuqHlDEmAdqydTAvX3MeKEPuk2mhxw8oYTfnLQF9EhcAHREFmjEfetFJiFevDzoNdHuPldPNbv7oAo1PBn0QFQCVEZPETv8Es/aBM+dqDze/XhrsZufwjQct/BbGXxedDSo8j6Bt2w2Kne5fabuDfjgONDEF+v4jzhu+QQXC35dB6ctBH3/ZE/LdPI2cAm3dJoj6Bvu7ap064+t4kJtNT6G78kBxyX6g3kB9rkaDZi6AUV5hf1Cd00R3UKPqJuib7wJ5s6+IToK+8wCXhP+H29vRC1ehJczsBJXzTc8rZIBp/UPKkAvVktUw693OWpTE7Xvc8TX+YRkKqBzavCgZ5eecAyp3JHr+MVD8V6FBvouoKdD35MN60VLiDDfr3KDlXLyPjhsY6Eh2P2MNRD87GvssTIW/gSbN8efI7jAxnE+npoI+m9A7LD8zTpbaH1TcbwBlrWc34wOdHxUD+oL3n3MzoO89DKO4DNr2X0DT5/ld7Jp65I5m807I1GTvck9urCWAXIRkRE4GzVoALTsXRsUFiCfNvhQiXry8YZZw7k3NAEUkcg08LvBT0pbBvPSvvUF110F/gSBr2MTZ0FZmQyv4FWZ1ba8dN89XQluxETQhBfRRrB+Yh71xvNjmjp74E5S5Flp6FiS0eeU6RPPzPjstblbDcB3iTfkiHrqJvh9k5BfZu3iwGpsgXTIrq2DxMA35u+ZnMEoroK3N8dW9xrlL3o5tX33YYJSodUMWG6Ll1b52Xa+1LGuVLTs6kAPqPjfwQtxiyBVtbW0j7Xrcuep9h5s8b+I2XHxN45hjS9DW1tZh3LmN3Q/HBngcU8DfV3fE4zAlJSUlJSUlJSUlJSWlwaS37MjGJ48GqSYAAAAASUVORK5CYII=);     \n}\n\n.mf-map4d .mf-ui a:hover {\n  opacity: 1;  \n}\n\n.mf-logo-container {\n  position: absolute;\n  bottom: 10px;  \n}\n\n.mf-logo-container.mf-right {\n  right: 10px;\n}\n\n.mf-logo-container.mf-left {\n  left: 10px;\n}\n\n.mf-logo {\n  cursor: pointer;\n  width: 75px;\n  opacity: 1;\n}\n\n.mf-info-window-container {\n  position: relative;\n  display: inline-block;\n  transform: translateY(-5px);\n  border: 1px solid #ddd;\n  border-radius: 5px;\n}\n\n.mf-info-window-content:after, .mf-info-window-content:before {\n\ttop: 100%;\n\tleft: 50%;\n\tborder: solid transparent;\n\tcontent: " ";\n\theight: 0;\n\twidth: 0;\n\tposition: absolute;\n\tpointer-events: none;\n}\n\n.mf-info-window-content:after {\n\tborder-color: rgba(255, 255, 255, 0);\n\tborder-top-color: #ffffff;\n\tborder-width: 7px;\n\tmargin-left: -7px;\n}\n\n.mf-info-window-content:before {\n\tborder-color: rgba(221, 221, 221, 0);\n\tborder-top-color: #ddd;\n\tborder-width: 8px;\n\tmargin-left: -8px;\n}\n\n.mf-info-window-content p, h4{\n  margin-bottom: 0;\n  margin-top: 0;\n}\n\n.mf-info-window-content p:empty, h4:empty{\n  display: none;\n}\n\n.mf-info-window-content {\n  background-color: #ffffff;\n  overflow: auto;\n  max-width: 636px;\n  max-height: 298px;\n  text-align: left;\n  padding: 5px;\n}\n\n.mf-info-window-content h4{\n  font-family: Georgia, serif;\n  font-size: 14px;\n  font-weight: normal;\n  text-align: center;\n}\n\n.mf-info-window-content p{\n  font-family: Georgia, serif;\n  font-size: 12px;  \n}\n\n.mf-map4d .mf-ui .mf-button-mode {\n  position: fixed;\n  bottom: 130px;\n  right :13px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: '+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n}\n.mf-iconview-marker-container {\n  position: absolute;\n  display: inline-block;\n}\n",t}();e.Style=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r,o=i(3),a=i(1),s=i(40),l=i(152),u=i(155),h=i(156),c=i(13);!function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Drag=2]="Drag",t[t.DragEnd=3]="DragEnd",t[t.Wheel=4]="Wheel",t[t.Move=5]="Move",t[t.Over=6]="Over",t[t.Out=7]="Out",t[t.Double=8]="Double",t[t.None=9]="None"}(n=e.MouseAction||(e.MouseAction={})),function(t){t[t.Left=0]="Left",t[t.Wheel=1]="Wheel",t[t.Right=2]="Right",t[t.None=3]="None"}(r=e.MouseButton||(e.MouseButton={}));var f=function(){function t(t,e){this.canvas=t,this.mapView=e,this.checkDragStart=!0,this.mouseOverTimeout=250,this.longClickTimeout=500,this.longClickIsCalled=!1,this.lastTimeTouch=0,this.currentTouchZoom=0,this.inertia=[],t.addEventListener("mousedown",this.mouseDown.bind(this)),t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("mouseup",this.mouseUp.bind(this)),t.addEventListener("wheel",this.mouseWheel.bind(this)),t.addEventListener("mouseover",this.mouseOver.bind(this)),t.addEventListener("mouseout",this.mouseOut.bind(this)),t.addEventListener("dblclick",this.doubleClick.bind(this)),t.addEventListener("contextmenu",(function(t){return t.preventDefault()})),t.addEventListener("touchstart",this.touchStart.bind(this),!1),t.addEventListener("touchmove",this.touchMove.bind(this),!1),t.addEventListener("touchcancel",this.touchCancel.bind(this),!1),t.addEventListener("touchend",this.touchEnd.bind(this),!1),this.scrollZoomHandler=new l.ScrollZoomHandler(this.mapView),this.dragRotateHandler=new u.DragRotateHandler(this.mapView),this.dragPanHandler=new h.DragPanHandler(this.mapView)}return t.prototype.touchStart=function(e){e.preventDefault();var i=e.touches.item(0);if(this.touchEvent=i,null!=i){if(e.touches.length<t.MAX_TOUCH_POINTS){i.button=r.Left;var n=Date.now(),o=n-this.lastTimeTouch;if(this.lastTimeTouch=n,o<t.TIME_DETECT_DOUBLE_TOUCH)return void this.doubleClick(i);this.handleGestureStop()}else{var a=e.touches.item(1),s=this.mapView.getCurrentMousePosition(i),l=this.mapView.getCurrentMousePosition(a);this.handleGestureStart(s.x,s.y,l.x,l.y),i.button=r.Right}this.mouseDown(i)}},t.prototype.touchMove=function(e){e.preventDefault();var i=e.touches.item(0);if(this.touchEvent=i,null!=i)if(e.touches.length<t.MAX_TOUCH_POINTS&&!this.isMultiTouch)i.button=r.Left,this.mouseMove(i);else if(e.touches.length>=t.MAX_TOUCH_POINTS){var n=e.touches.item(1),o=this.mapView.getCurrentMousePosition(i),a=this.mapView.getCurrentMousePosition(n);this.handleGesture(o.x,o.y,a.x,a.y)}},t.prototype.touchCancel=function(t){console.log("touch cancel")},t.prototype.touchEnd=function(t){if(t.preventDefault(),0==t.touches.length){var e=void 0;this.isMultiTouch?(e=r.Right,this.handleGestureStop()):e=r.Left;var i=new o.Vector2(this.touchEvent.clientX,this.touchEvent.clientY),n=new MouseEvent("mouseup",{view:window,bubbles:!0,cancelable:!0,clientX:i.x,clientY:i.y,button:e});this.mouseUp(n)}},t.prototype.doubleClick=function(t){this.longClickIsCalled=!1;var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.onDoubleClickEvent(e,t)||(this.mapView.mapsEventManager.notify(s.MapEvent.dblClick,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:n.Double,button:t.button}))},t.prototype.mouseOut=function(t){this.mouseOutside=!0,this.longClickIsCalled=!1,window.clearTimeout(this.longClickTimeoutHandler),window.clearTimeout(this.mouseOverTimeoutHandler);var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.notify(s.MapEvent.mouseOut,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:n.Out,button:t.button}),this.mousePosition=null},t.prototype.mouseWheel=function(t){if(this.longClickIsCalled=!1,0!=t.deltaY){var e=this.mapView.getCurrentMousePosition(t);this.dispatch({dx:t.deltaX,dy:1===t.deltaMode?40*t.deltaY:t.deltaY,x:e.x,y:e.y,action:n.Wheel,button:t.button},t)}},t.prototype.mouseDown=function(t){var e=this;return window.getSelection&&(window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges()),this.longClickIsCalled=!1,this.mapView.stopAnimation(),this.mousePosition=this.mapView.getCurrentMousePosition(t),this.mouseDownPosition=this.mousePosition,this.mouseDownTime=Date.now(),t.button==r.Right?this.dragRotateHandler.onDragStart(this.mousePosition):this.dragPanHandler.onDragStart(this.mousePosition),this.dispatch({x:this.mousePosition.x,y:this.mousePosition.y,dx:0,dy:0,action:n.Down,button:t.button}),this.mapView.mapState.isStill()&&(window.clearTimeout(this.longClickTimeoutHandler),this.longClickTimeoutHandler=window.setTimeout((function(){t.button==r.Left&&(e.mapView.mapsEventManager.onLongClickEvent(e.mousePosition,t)||(e.longClickIsCalled=!0,e.mapView.mapsEventManager.notify(s.MapEvent.longClick,t)))}),this.longClickTimeout)),this.preMouseDown=t,!1},t.prototype.mouseMove=function(t){var e=this;this.longClickIsCalled=!1,window.clearTimeout(this.longClickTimeoutHandler);var i=this.mapView.getCurrentMousePosition(t),o=null!=this.preMouseDown?this.preMouseDown.button:t.button;if(this.mousePosition){var a=i.subtract(this.mousePosition);if(this.mousePosition=i,0==a.x&&0==a.y)return;var l={x:i.x,y:i.y,dx:a.x,dy:a.y,action:n.Drag,button:o};o==r.Left&&this.dragPanHandler.onDrag(l);var u=this.dragPanHandler.draggableAnnotation;this.checkDragStart&&(u?this.mapView.mapsEventManager.onDragEvent(s.MapEvent.dragStart,t,u):this.mapView.mapsEventManager.notify(s.MapEvent.dragStart,t),this.checkDragStart=!1),u?this.mapView.mapsEventManager.onDragEvent(s.MapEvent.drag,t,u):this.mapView.mapsEventManager.notify(s.MapEvent.drag,t),this.dispatch(l)}else this.mapView.mapState.isStill()&&(window.clearTimeout(this.mouseOverTimeoutHandler),this.mouseOverTimeoutHandler=window.setTimeout((function(){var i=e.mapView.getCurrentMousePosition(t);e.mapView.mapsEventManager.onHoverEvent(i,t)||e.mapView.mapsEventManager.notify(s.MapEvent.hover,t,!1)}),this.mouseOverTimeout)),this.mapView.mapsEventManager.notify(s.MapEvent.mouseMove,t),this.dispatch({x:i.x,y:i.y,dx:0,dy:0,action:n.Move,button:o});return!1},t.prototype.mouseOver=function(t){this.mouseOutside=!1,this.longClickIsCalled=!1;var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.notify(s.MapEvent.mouseOver,t),this.dispatch({x:e.x,y:e.y,dx:0,dy:0,action:n.Over,button:t.button})},t.prototype.mouseUp=function(e){window.clearTimeout(this.longClickTimeoutHandler);var i=this.mapView.getCurrentMousePosition(e);this.mouseUpTime=Date.now();var o=i.subtract(this.mouseDownPosition),l=this.mouseUpTime-this.mouseDownTime;if(o.length<a.MapUtils.touchBoxSize){if(this.dispatch({x:i.x,y:i.y,dx:0,dy:0,action:n.Up,button:e.button}),this.mapView.mapState.isStill()&&!this.longClickIsCalled)if(e.button==r.Left){var u=this.mapView.getCurrentMousePosition(e);this.mapView.mapsEventManager.onClickEvent(u,e)||this.mapView.mapsEventManager.notify(s.MapEvent.click,e)}else if(e.button==r.Right){u=this.mapView.getCurrentMousePosition(e);this.mapView.mapsEventManager.onRightClickEvent(u,e)||this.mapView.mapsEventManager.notify(s.MapEvent.rightClick,e)}}else{var h=this.dragPanHandler.draggableAnnotation;h?this.mapView.mapsEventManager.onDragEvent(s.MapEvent.dragEnd,e,h):this.mapView.mapsEventManager.notify(s.MapEvent.dragEnd,e),this.checkDragStart=!0,this.dispatch({x:i.x,y:i.y,dx:l<t.TIME_DRAG_DETECT?o.x:0,dy:l<t.TIME_DRAG_DETECT?o.y:0,action:n.DragEnd,button:e.button})}return this.mousePosition=null,this.preMouseDown=null,this.longClickIsCalled=!1,!1},t.prototype.dispatch=function(t,e){this.mouseEventHandler(t,e)},t.prototype.mouseEventHandler=function(t,e){switch(t.action){case n.Drag:t.button==r.Right&&this.dragRotateHandler.onDrag(t);break;case n.Wheel:this.scrollZoomHandler.onWheel(t,e);break;case n.DragEnd:t.button==r.Left&&this.dragPanHandler.onDragEnd(t),t.button==r.Right&&this.dragRotateHandler.onDragEnd();break;case n.Double:if(t.button==r.Left){var i=this.mapView.mapState.getZoom()+1,a=new o.Vector2(t.x,t.y);this.mapView.setZoom(i,a,0,!0)}}},t.prototype.handleGestureStart=function(t,e,i,n){var r=i-t,a=n-e;this.inertia=[[Date.now(),this.mapView.mapState.getBearing()]],this.touchX1Prev=t,this.touchY1Prev=e,this.touchX2Prev=i,this.touchY2Prev=n,this.anchorZoom=new o.Vector2((t+i)/2,(e+n)/2),this.touchPrevDistance=Math.sqrt(r*r+a*a),this.touchStartAngle=Math.atan2(a,r),this.isMultiTouch=!0,this.isMultiTouchZoom=!1,this.isMultiTouchTilt=!1},t.prototype.handleGesture=function(e,i,n,r){var o=n-e,s=r-i,l=Math.sqrt(o*o+s*s),u=e-this.touchX1Prev,h=i-this.touchY1Prev,c=n-this.touchX2Prev,f=r-this.touchY2Prev;if(this.touchX1Prev=e,this.touchY1Prev=i,this.touchX2Prev=n,this.touchY2Prev=r,u*c>=0&&h*f>0){var p=Math.max(h,f)/a.MapUtils.pixelScale;this.mapView.setTilt(this.mapView.mapState.cameraPosition.getTilt()-p,!0),this.isMultiTouchTilt=!0}if(this.currentTouchZoom=(l-this.touchPrevDistance)/a.MapUtils.pixelScale,Math.abs(this.currentTouchZoom)>t.STEP_DETECT_ZOOM){this.inertia=[[Date.now(),this.mapView.mapState.getBearing()]];var d=1;return this.currentTouchZoom<0&&(d=-1),this.mapView.setZoom(this.mapView.mapState.getZoom()+d,this.anchorZoom,200),this.mapView.notifyCameraIsChanging(),this.touchPrevDistance=l,void(this.isMultiTouchZoom=!0)}var g=Math.atan2(s,o),y=g-this.touchStartAngle;if(Math.abs(y)>Math.PI/180&&!this.isMultiTouchZoom&&!this.isMultiTouchTilt){var m=this.mapView.mapState.getBearing()-180*y/Math.PI;this.inertia.push([Date.now(),-m]),this.mapView.setBearing(m,0,!0),this.mapView.notifyCameraIsChanging(),this.touchStartAngle=g}},t.prototype.handleGestureStop=function(){this.isMultiTouch=!1,this.isMultiTouchZoom=!1,this.isMultiTouchTilt=!1,this.currentTouchZoom=0;for(var t=this.inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift();if(this.inertia.length>2){var i=t.length,n=t[i-1],r=t[i-2],o=n[1]-r[1]>0?1:-1,a=n[1]-r[1],s=3*Math.abs(a);Math.abs(s)>360&&(s=360),s*=o;var l=Math.abs(s)/90;l=c.MathUtils.clamp(l,.5,1),this.mapView.setBearing(this.mapView.mapState.getBearing()-s,l,!0)}},t.TIME_DRAG_DETECT=300,t.MAX_TOUCH_POINTS=2,t.STEP_DETECT_ZOOM=100,t.TIME_DETECT_DOUBLE_TOUCH=300,t}();e.MouseEventHandler=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(98),r=i(3),o=i(7),a=function(){function t(t){this._mapView=t,this._delta=0,this._enabled=!0,this.onTimeout=this.onTimeout.bind(this),this.onScrollFrame=this.onScrollFrame.bind(this)}return t.prototype.isEnabled=function(){return!!this._enabled},t.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0)},t.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},t.prototype.isActive=function(){return!!this._active},t.prototype.onWheel=function(t,e){if(this.data=t,this.isEnabled()){var i=Date.now(),n=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i;var r=t.dy;0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=r,this._timeout=window.setTimeout(this.onTimeout,40,t)):this._type||(this._type=Math.abs(n*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._delta-=r,this.isActive()||this.start(t)),e.preventDefault()}},t.prototype.onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this.start(t)},t.prototype.start=function(t){this._delta&&(this._frameId&&(this._mapView.cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isTrackpad()&&this._finishTrackpadTimeout&&clearTimeout(this._finishTrackpadTimeout),this.isWheel()&&this._finishTimeout&&clearTimeout(this._finishTimeout),this._anchor=new r.Vector2(t.x,t.y),this._anchorLatLng=o.GeometryUtils.screenCoordinateToLatLng(this._anchor,this._mapView.mapState.cameraPosition,this._mapView.mapState.getScreenSize()),this._anchorLatLng.valid()||(this._anchorLatLng=this._mapView.mapState.getTarget()),this._frameId||(this._frameId=this._mapView.requestRenderFrame(this.onScrollFrame)))},t.prototype.onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){if(0!==this._delta){var e=this.isWheel()&&Math.abs(this._delta)>4.000244140625?1/450:.01,i=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==i&&(i=1/i);var n=null==this._targetZoom?this._mapView.mapState.scale:Math.pow(2,this._targetZoom);this._targetZoom=Math.min(this._mapView.mapSettings.getMaxZoom(),Math.max(this._mapView.mapSettings.getMinZoom(),Math.log2(n*i))),this.isWheel()&&(this._targetZoom>this._startZoom?this._targetZoom=Math.ceil(this._targetZoom):this._targetZoom<this._startZoom&&(this._targetZoom=Math.floor(this._targetZoom)),this._startZoom=this._mapView.mapState.getZoom(),this._easing=this.smoothOutEasing(200)),this._mapView.mapState.zoomIn=this._delta<0,this._mapView.mapState.zoomOut=this._delta>0,!this.isTrackpad||-1!=this._delta&&1!=this._delta||(this._mapView.mapState.zoomIn?this._targetZoom=Math.ceil(this._targetZoom):this._mapView.mapState.zoomOut&&(this._targetZoom=Math.round(this._targetZoom))),this._delta=0}var o=null==this._targetZoom?this._mapView.mapState.getZoom():this._targetZoom,a=this._startZoom,s=this._easing,l=!1;if(this.isWheel()&&a&&s){var u=Math.min((Date.now()-this._lastWheelEventTime)/200,1),h=s(u),c=a*(1-h)+o*h,f=new r.Vector2(this.data.x,this.data.y);this.setZoom(c,f,200),u<1?this._frameId||(this._frameId=this._mapView.requestRenderFrame(this.onScrollFrame)):l=!0}else{f=new r.Vector2(this.data.x,this.data.y);this.setZoom(o,f),l=!0}l&&(this._active=!1,this.isWheel()&&(this._finishTimeout=window.setTimeout((function(){t._finishTimeout=null,t._targetZoom=null}),200)))}},t.prototype.isWheel=function(){return"wheel"===this._type},t.prototype.isTrackpad=function(){return"trackpad"===this._type},t.prototype.setZoom=function(t,e,i){void 0===i&&(i=0),this._mapView.mapState.getZoom()!=t&&this._mapView.isZoomGesturesEnabled()&&(this._mapView.setZoom(t,e,i),this._mapView.notifyCameraIsChanging())},t.prototype.smoothOutEasing=function(t){var e=n.bezier(.25,.1,.25,1);if(this._prevEase){var i=this._prevEase,r=(Date.now()-i.start)/i.duration,o=i.easing(r+.01)-i.easing(r),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);e=n.bezier(a,s,.25,1)}return this._prevEase={start:Date.now(),duration:t,easing:e},e},t}();e.ScrollZoomHandler=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by}return t.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},t.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},t.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},t.prototype.solveCurveX=function(t,e){var i,n,r,o,a,s;for(r=t,s=0;s<8;++s){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;if(a=this.sampleCurveDerivativeX(r),Math.abs(a)<1e-6)break;r-=o/a}if((r=t)<(i=0))return i;if(r>(n=1))return n;for(;i<n;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?i=r:n=r,r=.5*(n-i)+i}return r},t.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))},t}();e.UnitBezier=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(13),r=i(2),o=function(){function t(t,e){this.dx=0,this.dy=0,this.timeConstant=t,this.initialSpeedRate=0,this.velocityRatioX=0,this.velocityRatioY=0,this.cameraAnimationObserver=e}return t.prototype.getDisplacement=function(t,e,i){return t*e*-Math.expm1(-i/t)},t.prototype.getDuration=function(e,i){return-e*Math.log(t.minTrackSpeed/i)},t.prototype.startFling=function(e,i){return e=n.MathUtils.clamp(e,r.MapConstants.flingMinVelocity,r.MapConstants.flingMaxVelocity),i=n.MathUtils.clamp(i,r.MapConstants.flingMinVelocity,r.MapConstants.flingMaxVelocity),e*=t.secToMs,i*=t.secToMs,this.initialSpeedRate=Math.sqrt(e*e+i*i),this.initialSpeedRate<t.minTrackSpeed?(this.stopFling(),void this.cameraAnimationObserver.notifyCameraDidChange()):(this.flingDuration=this.getDuration(this.timeConstant,this.initialSpeedRate),this.getDisplacement(this.timeConstant,this.initialSpeedRate,this.flingDuration)<t.minDisplacement?(this.stopFling(),void this.cameraAnimationObserver.notifyCameraDidChange()):(this.velocityRatioX=e/this.initialSpeedRate,this.velocityRatioY=i/this.initialSpeedRate,this.previousPositionX=0,this.previousPositionY=0,void(this.flingStart=Date.now())))},t.prototype.stopFling=function(){this.initialSpeedRate=0},t.prototype.isFlingInProgress=function(){return this.initialSpeedRate>0},t.prototype.trackMovement=function(){if(!this.isFlingInProgress())return!1;var t=Date.now()-this.flingStart;if(t>this.flingDuration)return this.stopFling(),this.cameraAnimationObserver.notifyCameraDidChange(),!1;var e=this.getDisplacement(this.timeConstant,this.initialSpeedRate,t),i=e*this.velocityRatioX,n=e*this.velocityRatioY;return this.dx=i-this.previousPositionX,this.dy=n-this.previousPositionY,this.previousPositionX=i,this.previousPositionY=n,!0},t.secToMs=.001,t.minTrackSpeed=.01,t.minDisplacement=20,t}();e.FlingTracker=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(13),o=function(){function t(t){this.inertia=[],this._mapView=t}return t.prototype.onDragStart=function(t){this.lastDragRotatePosition=new n.Vector2(t.x,t.y),this.inertia=[[Date.now(),this._mapView.mapState.getBearing()]]},t.prototype.onDrag=function(t){if(this.inertia.push([Date.now(),-t.x]),this._mapView.isRotateGesturesEnabled()){var e=.4*(this.lastDragRotatePosition.x-t.x);this._mapView.setBearing(this._mapView.mapState.getBearing()-e,0,!0)}if(this._mapView.isTiltGesturesEnabled()){var i=-.5*(this.lastDragRotatePosition.y-t.y);this._mapView.setTilt(this._mapView.mapState.cameraPosition.getTilt()-i,!0)}this.lastDragRotatePosition=new n.Vector2(t.x,t.y)},t.prototype.onDragEnd=function(){if(this.drainInertiaBuffer(),this.inertia.length<2)this._mapView.notifyCameraDidChange();else if(this._mapView.isRotateGesturesEnabled()){var t=this.inertia,e=t.length,i=t[e-1],n=t[e-2],o=i[1]-n[1]>0?1:-1,a=i[1]-n[1],s=3*Math.abs(a);Math.abs(s)>360&&(s=360),s*=o;var l=Math.abs(s)/90;l=r.MathUtils.clamp(l,.5,1),this._mapView.setBearing(this._mapView.mapState.getBearing()-s,l,!0)}},t.prototype.drainInertiaBuffer=function(){for(var t=this.inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},t}();e.DragRotateHandler=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(1),o=i(2),a=i(10),s=i(31),l=i(36),u=i(41),h=i(6),c=i(51),f=i(53),p=i(54),d=i(73),g=function(){function t(t){this._mapView=t,this._targetStart=null}return t.prototype.onDragStart=function(t){if(this._draggableAnnotation=null,this._targetStart=this._mapView.screenCoordinateToLatLng(t),this._targetStart.valid()){var e=this._mapView.queryUserPOI(t);if(e&&e.isDraggable())this._draggableAnnotation=e;else{var i=this._mapView.queryBuildingAndAnnotation(t);if(null!=i){if(i instanceof d.BuildingQueryResult){var n=this._mapView.annotationManager.getBuilding(i.annotationId);if(n&&n.isDraggable())return void(this._draggableAnnotation=n)}(i instanceof s.Marker&&i.isDraggable()||i instanceof l.Polyline&&i.isDraggable()||i instanceof u.Polygon&&i.isDraggable()||i instanceof c.Circle&&i.isDraggable())&&(this._draggableAnnotation=i)}}}else this._targetStart=null},t.prototype.onDrag=function(t){var e=this,i=this._mapView.screenCoordinateToLatLng(new n.Vector2(t.x,t.y),0);if(i.valid())if(this._draggableAnnotation){if(this._draggableAnnotation instanceof s.Marker){var r=this._draggableAnnotation,o=i.subtract(this._targetStart),d=r.getPosition().add(o);r.setPosition(d),this._targetStart=i}else if(this._draggableAnnotation instanceof l.Polyline){var g=this._draggableAnnotation,y=i.subtract(this._targetStart),m=g.getPath();m.forEach((function(t,e){var i=t.add(y);m[e]=i})),g.setPath(m),this._targetStart=i}else if(this._draggableAnnotation instanceof u.Polygon){var v=this._draggableAnnotation,_=v.getPaths(),b=[],w=this._mapView.mapState.getScale();_.forEach((function(t){var r=[];t.forEach((function(t){var o=h.ProjectionMercator.projectScale(i,w),a=h.ProjectionMercator.projectScale(e._targetStart,w),s=o.subtract(a),l=h.ProjectionMercator.projectScale(t,w);l=l.add(new n.Vector2(s.x,s.y));var u=h.ProjectionMercator.unproject(l,w);r.push(u)})),b.push(r)})),v.setPaths(b),this._targetStart=i}else if(this._draggableAnnotation instanceof c.Circle){var M=this._draggableAnnotation,x=i.subtract(this._targetStart),T=M.getCenter().add(x);M.setCenter(T),this._targetStart=i}else if(this._draggableAnnotation instanceof f.POI){var A=this._draggableAnnotation;o=i.subtract(this._targetStart),d=A.getPosition().add(o);A.setPosition(d),this._targetStart=i}else if(this._draggableAnnotation instanceof p.Building){var L=this._draggableAnnotation;o=i.subtract(this._targetStart),d=L.getPosition().add(o);L.setPosition(d),this._targetStart=i}}else if(this._mapView.isScrollGesturesEnabled()){var S=new a.Point(-t.dx,t.dy);this._mapView.moveBy(S)}},t.prototype.onDragEnd=function(t){if(null==this._draggableAnnotation&&this._mapView.isScrollGesturesEnabled()){var e=new n.Vector2(-t.dx,t.dy);this._mapView.moveByVelocity(new n.Vector2(e.x,e.y).multiply(o.MapConstants.flingSpeedMultiply*r.MapUtils.pixelScale))}this._draggableAnnotation=null},Object.defineProperty(t.prototype,"draggableAnnotation",{get:function(){return this._draggableAnnotation},enumerable:!0,configurable:!0}),t}();e.DragPanHandler=g},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,i,n,r,o,a,s,l,u,h,c,f,p,d,g,y,m){var v=t.call(this)||this;return v._position=r,v._anchor=o,v._title=e,v._snippet=i,v._windowAnchor=n,v._width=a,v._height=s,v._url=l,v._iconView=u,v._icon=h,v._rotation=f,v._elevation=c,v._markerLabel=p,v._labelAnchor=d,v._visible=g,v._draggable=y,v.userInteraction=m,v.textureDirty=!1,v._needUpdateIconView=!1,v}return r(e,t),e.prototype.getId=function(){return this._id},e.prototype.setId=function(t){this._id=t},e.prototype.getTitle=function(){return this._title},e.prototype.setTitle=function(t){this._title=t},e.prototype.getSnippet=function(){return this._snippet},e.prototype.setSnippet=function(t){this._snippet=t},e.prototype.getWindowAnchor=function(){return this._windowAnchor},e.prototype.setWindowAnchor=function(t){this._windowAnchor=t},e.prototype.getPosition=function(){return this._position},e.prototype.setPosition=function(t){this._position=t},e.prototype.getAnchor=function(){return this._anchor},e.prototype.setAnchor=function(t){this._anchor=t},e.prototype.getWidth=function(){return this._width},e.prototype.setWidth=function(t){this._width=t},e.prototype.getHeight=function(){return this._height},e.prototype.setHeight=function(t){this._height=t},e.prototype.getLabelAnchor=function(){return this._labelAnchor},e.prototype.setLabelAnchor=function(t){this._labelAnchor=t},e.prototype.getMarkerLabel=function(){return this._markerLabel},e.prototype.setMarkerLabel=function(t){this._markerLabel=t},e.prototype.getUrl=function(){return this._url},e.prototype.setUrl=function(t){this._url=t},e.prototype.getIconView=function(){return this._iconView},e.prototype.setIconView=function(t){this._needUpdateIconView=!0,this._iconView=t},e.prototype.getIcon=function(){return this._icon},e.prototype.setIcon=function(t){this._icon=t},e.prototype.getRotation=function(){return this._rotation},e.prototype.setRotation=function(t){this._rotation=t},e.prototype.getElevation=function(){return this._elevation},e.prototype.setElevation=function(t){this._elevation=t},e.prototype.isVisible=function(){return this._visible},e.prototype.setVisible=function(t){this._visible=t},e.prototype.isDraggable=function(){return this._draggable},e.prototype.setDraggable=function(t){this._draggable=t},e.prototype.isUserInteractionEnabled=function(){return this.userInteraction},e.prototype.setUserInteraction=function(t){this.userInteraction=t},e.prototype.isTextureDirty=function(){return this.textureDirty},e.prototype.setTextureDirty=function(t){this.textureDirty=t},e.prototype.getInfoWindow=function(){return this.infoWindow},e.prototype.setInfoWindow=function(t){this.infoWindow=t},e.prototype.getInfoContents=function(){return this.infoContents},e.prototype.setInfoContents=function(t){this.infoContents=t},Object.defineProperty(e.prototype,"needUpdateIconView",{get:function(){return this._needUpdateIconView},set:function(t){this._needUpdateIconView=t},enumerable:!0,configurable:!0}),e}(i(25).LayerProperties);e.SymbolLayerProperties=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(25),a=i(12),s=i(1),l=function(t){function e(e,i,n,r,o,l,u,h,c){var f=t.call(this)||this;return f.strokeWidth=e*s.MapUtils.pixelScale,f.strokeColor=a.Color.fromHex(i),f.strokeColor.alpha=n,f.strokeOpacity=n,f.closed=o,f.visible=l,f.draggable=u,f.style=h,f.elevation=r,f.userInteraction=c,f}return r(e,t),e.prototype.getStrokeWidth=function(){return this.strokeWidth},e.prototype.setStrokeWidth=function(t){this.strokeWidth=t*s.MapUtils.pixelScale},e.prototype.getStrokeColor=function(){return this.strokeColor},e.prototype.setStrokeColor=function(t){null!=t?(this.strokeColor=a.Color.fromHex(t),this.strokeColor.alpha=this.strokeOpacity):this.strokeColor=new a.Color(255,0,0,this.strokeOpacity)},e.prototype.getStrokeOpacity=function(){return this.strokeOpacity},e.prototype.setStrokeOpacity=function(t){this.strokeOpacity=t,this.strokeColor.alpha=t},e.prototype.isVisible=function(){return this.visible},e.prototype.setVisible=function(t){this.visible=t},e.prototype.isClosed=function(){return this.closed},e.prototype.setClosed=function(t){this.closed=t},e.prototype.getElevation=function(){return this.elevation},e.prototype.setElevation=function(t){this.elevation=t},e.prototype.isDraggable=function(){return this.draggable},e.prototype.setDraggable=function(t){this.draggable=t},e.prototype.getStyle=function(){return this.style},e.prototype.setStyle=function(t){this.style=t},e.prototype.isUserInteractionEnabled=function(){return this.userInteraction},e.prototype.setUserInteraction=function(t){this.userInteraction=t},e}(o.LayerProperties);e.LineLayerProperties=l},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(25),a=i(12),s=i(1),l=function(t){function e(e,i,n,r,o,l,u,h){var c=t.call(this)||this;return c.fillColor=a.Color.fromHex(e),c.fillColor.alpha=i,c.fillOpacity=i,c.strokeColor=a.Color.fromHex(n),c.strokeWidth=r*s.MapUtils.pixelScale,c.visible=l,c.draggable=u,c.elevation=o,c.userInteraction=h,c}return r(e,t),e.prototype.getFillColor=function(){return this.fillColor},e.prototype.setFillColor=function(t){null!=t?(this.fillColor=a.Color.fromHex(t),this.fillColor.alpha=this.fillOpacity):this.fillColor=new a.Color(255,0,0,this.fillOpacity)},e.prototype.getFillOpacity=function(){return this.fillOpacity},e.prototype.setFillOpacity=function(t){this.fillOpacity=t,this.fillColor.alpha=t},e.prototype.isVisible=function(){return this.visible},e.prototype.setVisible=function(t){this.visible=t},e.prototype.getStrokeColor=function(){return this.strokeColor},e.prototype.setStrokeColor=function(t){this.strokeColor=null!=t?a.Color.fromHex(t):new a.Color(255,0,0,1)},e.prototype.getStrokeWidth=function(){return this.strokeWidth},e.prototype.setStrokeWidth=function(t){this.strokeWidth=t*s.MapUtils.pixelScale},e.prototype.getElevation=function(){return this.elevation},e.prototype.setElevation=function(t){this.elevation=t},e.prototype.isDraggable=function(){return this.draggable},e.prototype.setDraggable=function(t){this.draggable=t},e.prototype.isUserInteractionEnabled=function(){return this.userInteraction},e.prototype.setUserInteraction=function(t){this.userInteraction=t},e}(o.LayerProperties);e.FillLayerProperties=l},function(t,e,i){
/**
 * greiner-hormann v1.4.1
 * Greiner-Hormann clipping algorithm
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */
!function(t){"use strict";var e=function(t,e){1===arguments.length&&(Array.isArray(t)?(e=t[1],t=t[0]):(e=t.y,t=t.x)),this.x=t,this.y=e,this.next=null,this.prev=null,this._corresponding=null,this._distance=0,this._isEntry=!0,this._isIntersection=!1,this._visited=!1};e.createIntersection=function(t,i,n){var r=new e(t,i);return r._distance=n,r._isIntersection=!0,r._isEntry=!1,r},e.prototype.visit=function(){this._visited=!0,null===this._corresponding||this._corresponding._visited||this._corresponding.visit()},e.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},e.prototype.isInside=function(t){var e=!1,i=t.first,n=i.next,r=this.x,o=this.y;do{(i.y<o&&n.y>=o||n.y<o&&i.y>=o)&&(i.x<=r||n.x<=r)&&(e^=i.x+(o-i.y)/(n.y-i.y)*(n.x-i.x)<r),n=(i=i.next).next||t.first}while(!i.equals(t.first));return e};var i=function(t,e,i,n){this.x=0,this.y=0,this.toSource=0,this.toClip=0;var r=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);0!==r&&(this.toSource=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/r,this.toClip=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r,this.valid()&&(this.x=t.x+this.toSource*(e.x-t.x),this.y=t.y+this.toSource*(e.y-t.y)))};i.prototype.valid=function(){return 0<this.toSource&&this.toSource<1&&0<this.toClip&&this.toClip<1};var n=function(t,i){this.first=null,this.vertices=0,this._lastUnprocessed=null,this._arrayVertices=void 0===i?Array.isArray(t[0]):i;for(var n=0,r=t.length;n<r;n++)this.addVertex(new e(t[n]))};function r(t,e,i,r){var o=new n(t),a=new n(e);return o.clip(a,i,r)}n.prototype.addVertex=function(t){if(null===this.first)this.first=t,this.first.next=t,this.first.prev=t;else{var e=this.first,i=e.prev;e.prev=t,t.next=e,t.prev=i,i.next=t}this.vertices++},n.prototype.insertVertex=function(t,e,i){for(var n,r=e;!r.equals(i)&&r._distance<t._distance;)r=r.next;t.next=r,n=r.prev,t.prev=n,n.next=t,r.prev=t,this.vertices++},n.prototype.getNext=function(t){for(var e=t;e._isIntersection;)e=e.next;return e},n.prototype.getFirstIntersect=function(){var t=this._firstIntersect||this.first;do{if(t._isIntersection&&!t._visited)break;t=t.next}while(!t.equals(this.first));return this._firstIntersect=t,t},n.prototype.hasUnprocessed=function(){var t=this._lastUnprocessed||this.first;do{if(t._isIntersection&&!t._visited)return this._lastUnprocessed=t,!0;t=t.next}while(!t.equals(this.first));return this._lastUnprocessed=null,!1},n.prototype.getPoints=function(){var t=[],e=this.first;if(this._arrayVertices)do{t.push([e.x,e.y]),e=e.next}while(e!==this.first);else do{t.push({x:e.x,y:e.y}),e=e.next}while(e!==this.first);return t},n.prototype.clip=function(t,r,o){var a,s,l=this.first,u=t.first,h=!r&&!o,c=r&&o;do{if(!l._isIntersection)do{if(!u._isIntersection){var f=new i(l,this.getNext(l.next),u,t.getNext(u.next));if(f.valid()){var p=e.createIntersection(f.x,f.y,f.toSource),d=e.createIntersection(f.x,f.y,f.toClip);p._corresponding=d,d._corresponding=p,this.insertVertex(p,l,this.getNext(l.next)),t.insertVertex(d,u,t.getNext(u.next))}}u=u.next}while(!u.equals(t.first));l=l.next}while(!l.equals(this.first));l=this.first,u=t.first,r^=a=l.isInside(t),o^=s=u.isInside(this);do{l._isIntersection&&(l._isEntry=r,r=!r),l=l.next}while(!l.equals(this.first));do{u._isIntersection&&(u._isEntry=o,o=!o),u=u.next}while(!u.equals(t.first));for(var g=[];this.hasUnprocessed();){var y=this.getFirstIntersect(),m=new n([],this._arrayVertices);m.addVertex(new e(y.x,y.y));do{if(y.visit(),y._isEntry)do{y=y.next,m.addVertex(new e(y.x,y.y))}while(!y._isIntersection);else do{y=y.prev,m.addVertex(new e(y.x,y.y))}while(!y._isIntersection);y=y._corresponding}while(!y._visited);g.push(m.getPoints())}return 0===g.length&&(h?a?g.push(t.getPoints()):s?g.push(this.getPoints()):g.push(this.getPoints(),t.getPoints()):c?a?g.push(this.getPoints()):s&&g.push(t.getPoints()):a?g.push(t.getPoints(),this.getPoints()):s?g.push(this.getPoints(),t.getPoints()):g.push(this.getPoints()),0===g.length&&(g=null)),g};var o=r;t.union=function(t,e){return r(t,e,!1,!1)},t.intersection=function(t,e){return r(t,e,!0,!0)},t.diff=function(t,e){return r(t,e,!1,!0)},t.clip=o,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,i,n,r,o,a,s,l,u,h){var c=t.call(this)||this;return c.id="",c.annotationId=0,c.title=e,c.position=r,c.visible=l,c.draggable=u,c.titleColor=i,c.subtitle=n,c.type=o,c.icon=a,c.rank=s,c.userInteraction=h,c.textureDirty=!1,c}return r(e,t),e.prototype.getAnnotationId=function(){return this.annotationId},e.prototype.setAnnotationId=function(t){this.annotationId=t},e.prototype.getIcon=function(){return this.icon},e.prototype.setIcon=function(t){this.icon=t},e.prototype.isVisible=function(){return this.visible},e.prototype.setVisible=function(t){this.visible=t},e.prototype.isDraggable=function(){return this.draggable},e.prototype.setDraggable=function(t){this.draggable=t},e.prototype.isTextureDirty=function(){return this.textureDirty},e.prototype.setTextureDirty=function(t){this.textureDirty=t},e.prototype.isUserInteractionEnabled=function(){return this.userInteraction},e.prototype.setUserInteraction=function(t){this.userInteraction=t},e}(i(99).POILayerProperties);e.UserPOILayerProperties=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(100),a=i(10),s=i(6),l=i(3),u=i(21),h=function(t){function e(e,i,n,r,o,a,s,l,u,h,c,f,p,d){void 0===u&&(u=[]);var g=t.call(this)||this;return g.growUpscale=0,g.name=e,g.scale=i,g.bearing=n,g.location=r,g.height=o,g.elevation=a,g.modelUrl=s,g.modelName=g.getNameFromUrl(s),g.textureUrl=l,g.textureName=g.getNameFromUrl(l),g.coordinates=u,g.visible=h,g.draggable=c,g.userInteraction=f,g.selected=p,g.growUp=d,g._annotationId=0,g._hasBounds=!1,g._updateExtrudeModel=!1,g._coverPoints=null,g._onModelLoaded=null,g._map=null,g._annotationManager=null,g}return r(e,t),e.prototype.getAnnotationId=function(){return this._annotationId},e.prototype.setAnnotationId=function(t){this._annotationId=t},e.prototype.setModelUrl=function(t){t?(this.modelUrl=t,this.modelName=this.getNameFromUrl(t),this.coordinates=[]):console.warn("Can not set Model Url with null")},e.prototype.setTextureUrl=function(t){t?(this.textureUrl=t,this.textureName=this.getNameFromUrl(t)):console.warn("Can not set Texture Url with null")},e.prototype.setCoordinates=function(e){t.prototype.setCoordinates.call(this,e),this.modelUrl=null,this.modelName=null,this._updateExtrudeModel=!0},e.prototype.isVisible=function(){return this.visible},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setDraggable=function(t){this.draggable=t},e.prototype.isDraggable=function(){return this.draggable},e.prototype.isUserInteractionEnabled=function(){return this.userInteraction},e.prototype.setUserInteraction=function(t){this.userInteraction=t},e.prototype.isGrowUp=function(){return this.growUp},e.prototype.setGrowUp=function(t){this.growUp=t},Object.defineProperty(e.prototype,"updateExtrudeModel",{get:function(){return this._updateExtrudeModel},set:function(t){this._updateExtrudeModel=t},enumerable:!0,configurable:!0}),e.prototype.getNameFromUrl=function(t){if(!t)return null;var e=t.split("/");return e[e.length-1]},e.prototype.getCoverPoints=function(){return this._coverPoints},e.prototype.setCoverPoints=function(t){if(null!=t&&0!=t.length&&(t.sort((function(t,e){return t.y==e.y?t.x-e.x:t.y-e.y})),t=t.filter((function(t,e,i){return 0==e||t.x!=i[e-1].x||t.y!=i[e-1].y}))),null!=t&&0!=t.length){for(var e=this.getBearing(),i=this.getScale(),n=s.ProjectionMercator.convertToMeterFromLatLng(this.getLocation()),r=[],o=t.map((function(t){return new a.Point(t.x,t.y)})),u=0;u<o.length;++u){if(0!=e){var h=o[u].x,c=o[u].y;o[u].x=(h*Math.cos(e*Math.PI/180)+c*Math.sin(e*Math.PI/180))*i,o[u].y=(h*Math.sin(e*Math.PI/180)-c*Math.cos(e*Math.PI/180))*i}else o[u].x=o[u].x*i,o[u].y=-o[u].y*i;var f=s.ProjectionMercator.convertToLatLngFromMeter(new l.Vector2(n.x+o[u].x,n.y+o[u].y));r.push(f)}this._coverPoints=r}},e.prototype.updateBounds=function(t){this._boundingBox=t;var e=0,i=0,n=0,r=0;if(this._boundingBox){var o=this.getScale();e=this._boundingBox.minX*o,i=this._boundingBox.minY*o,n=this._boundingBox.maxX*o,r=this._boundingBox.maxY*o;var a=-this.getBearing();if(0!=a){var h=new l.Vector2(n,i),c=new l.Vector2(e,r),f=new l.Vector2(n,r),p=new l.Vector2(e,i);c=new l.Vector2(c.x*Math.cos(a*Math.PI/180)-c.y*Math.sin(a*Math.PI/180),c.x*Math.sin(a*Math.PI/180)+c.y*Math.cos(a*Math.PI/180)),h=new l.Vector2(h.x*Math.cos(a*Math.PI/180)-h.y*Math.sin(a*Math.PI/180),h.x*Math.sin(a*Math.PI/180)+h.y*Math.cos(a*Math.PI/180)),f=new l.Vector2(f.x*Math.cos(a*Math.PI/180)-f.y*Math.sin(a*Math.PI/180),f.x*Math.sin(a*Math.PI/180)+f.y*Math.cos(a*Math.PI/180)),p=new l.Vector2(p.x*Math.cos(a*Math.PI/180)-p.y*Math.sin(a*Math.PI/180),p.x*Math.sin(a*Math.PI/180)+p.y*Math.cos(a*Math.PI/180)),e=Math.min(c.x,h.x,f.x,p.x),n=Math.max(c.x,h.x,f.x,p.x),i=Math.min(c.y,h.y,f.y,p.y),r=Math.max(c.y,h.y,f.y,p.y)}}var d=this.getLocation(),g=s.ProjectionMercator.convertToMeterFromLatLng(d),y=new l.Vector2(g.x+e,g.y-r),m=new l.Vector2(g.x+n,g.y-i),v=new u.LatLngBounds(s.ProjectionMercator.convertToLatLngFromMeter(y),s.ProjectionMercator.convertToLatLngFromMeter(m));this.updateBoundsFromLatLngBounds(v)},e.prototype.updateBoundsFromLatLngBounds=function(t){var e=t.getSouthwest(),i=t.getNortheast();if(this.getMap()&&!this._boundingBox){var n=this.getScale();if(n>0){var r=this.getMap().mapView.mapState.getScale(),o=s.ProjectionMercator.projectScale(e,r),a=s.ProjectionMercator.projectScale(i,r),u=s.ProjectionMercator.projectScale(this.getLocation(),r),h=new l.Vector2(a.x-u.x,u.y-a.y),c=new l.Vector2(u.x-o.x,o.y-u.y),f=new l.Vector2(u.x+n*h.x,u.y-n*h.y),p=new l.Vector2(u.x-n*c.x,u.y+n*c.y);i=s.ProjectionMercator.unproject(f,r),e=s.ProjectionMercator.unproject(p,r)}}this._minX=e.lng,this._minY=e.lat,this._maxX=i.lng,this._maxY=i.lat,this._hasBounds=!0},Object.defineProperty(e.prototype,"onModelLoaded",{get:function(){return this._onModelLoaded},set:function(t){this._onModelLoaded=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasBounds",{get:function(){return this._hasBounds},set:function(t){this._hasBounds=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"annotationManager",{get:function(){return this._annotationManager},set:function(t){this._annotationManager=t},enumerable:!0,configurable:!0}),e.prototype.getMap=function(){return this._map},e.prototype.setMap=function(t){this._map=t},Object.defineProperty(e.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),e}(o.BuildingLayerProperties);e.UserBuildingLayerProperties=h},function(t,e,i){"use strict";var n=i(164);function r(t){return{type:"Feature",geometry:n.tileToGeoJSON(t),properties:{}}}function o(t,e){var i,r,o=t.coordinates,s=e.max_zoom,c={},f=[];if("Point"===t.type)return[n.pointToTile(o[0],o[1],s)];if("MultiPoint"===t.type)for(i=0;i<o.length;i++)c[h((r=n.pointToTile(o[i][0],o[i][1],s))[0],r[1],r[2])]=!0;else if("LineString"===t.type)l(c,o,s);else if("MultiLineString"===t.type)for(i=0;i<o.length;i++)l(c,o[i],s);else if("Polygon"===t.type)a(c,f,o,s);else{if("MultiPolygon"!==t.type)throw new Error("Geometry type not implemented");for(i=0;i<o.length;i++)a(c,f,o[i],s)}if(e.min_zoom!==s){var p=f.length;for(u(c,f),i=0;i<p;i++){var d=f[i];c[h(d[0],d[1],d[2])]=!0}return function(t,e,i){for(var n=[],r=i.max_zoom;r>i.min_zoom;r--){for(var o={},a=[],s=0;s<e.length;s++){var l=e[s];if(l[0]%2==0&&l[1]%2==0){var u=h(l[0]+1,l[1],r),c=h(l[0],l[1]+1,r),f=h(l[0]+1,l[1]+1,r);if(t[u]&&t[c]&&t[f]){t[h(l[0],l[1],l[2])]=!1,t[u]=!1,t[c]=!1,t[f]=!1;var p=[l[0]/2,l[1]/2,r-1];r-1===i.min_zoom?n.push(p):(o[h(l[0]/2,l[1]/2,r-1)]=!0,a.push(p))}}}for(s=0;s<e.length;s++)l=e[s],t[h(l[0],l[1],l[2])]&&n.push(l);t=o,e=a}return n}(c,f,e)}return u(c,f),f}function a(t,e,i,n){for(var r=[],o=0;o<i.length;o++){var a=[];l(t,i[o],n,a);for(var u=0,c=a.length,f=c-1;u<c;f=u++){var p=(u+1)%c,d=a[u][1];(d>a[f][1]||d>a[p][1])&&(d<a[f][1]||d<a[p][1])&&d!==a[p][1]&&r.push(a[u])}}for(r.sort(s),o=0;o<r.length;o+=2){d=r[o][1];for(var g=r[o][0]+1;g<r[o+1][0];g++){t[h(g,d,n)]||e.push([g,d,n])}}}function s(t,e){return t[1]-e[1]||t[0]-e[0]}function l(t,e,i,r){for(var o,a,s=0;s<e.length-1;s++){var l=n.pointToTileFraction(e[s][0],e[s][1],i),u=n.pointToTileFraction(e[s+1][0],e[s+1][1],i),c=l[0],f=l[1],p=u[0]-c,d=u[1]-f;if(0!==d||0!==p){var g=p>0?1:-1,y=d>0?1:-1,m=Math.floor(c),v=Math.floor(f),_=0===p?1/0:Math.abs(((p>0?1:0)+m-c)/p),b=0===d?1/0:Math.abs(((d>0?1:0)+v-f)/d),w=Math.abs(g/p),M=Math.abs(y/d);for(m===o&&v===a||(t[h(m,v,i)]=!0,r&&v!==a&&r.push([m,v]),o=m,a=v);_<1||b<1;)_<b?(_+=w,m+=g):(b+=M,v+=y),t[h(m,v,i)]=!0,r&&v!==a&&r.push([m,v]),o=m,a=v}}r&&v===r[0][1]&&r.pop()}function u(t,e){for(var i,n,r,o,a,s=Object.keys(t),l=0;l<s.length;l++)e.push((i=+s[l],n=void 0,r=void 0,o=void 0,a=void 0,void 0,[a=(o=(i-(n=i%32))/32)%(r=2*(1<<n)),(o-a)/r%r,n]))}function h(t,e,i){return 32*(2*(1<<i)*e+t)+i}e.geojson=function(t,e){return{type:"FeatureCollection",features:o(t,e).map(r)}},e.tiles=o,e.indexes=function(t,e){return o(t,e).map(n.tileToQuadkey)}},function(t,e,i){"use strict";var n=Math.PI/180,r=180/Math.PI;function o(t){var e=a(t[0]+1,t[2]);return[a(t[0],t[2]),s(t[1]+1,t[2]),e,s(t[1],t[2])]}function a(t,e){return t/Math.pow(2,e)*360-180}function s(t,e){var i=Math.PI-2*Math.PI*t/Math.pow(2,e);return r*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))}function l(t,e,i){var n=d(t,e,i);return n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n}function u(t){return[[2*t[0],2*t[1],t[2]+1],[2*t[0]+1,2*t[1],t[2]+1],[2*t[0]+1,2*t[1]+1,t[2]+1],[2*t[0],2*t[1]+1,t[2]+1]]}function h(t){return t[0]%2==0&&t[1]%2==0?[t[0]/2,t[1]/2,t[2]-1]:t[0]%2==0&&!t[1]%2==0?[t[0]/2,(t[1]-1)/2,t[2]-1]:!t[0]%2==0&&t[1]%2==0?[(t[0]-1)/2,t[1]/2,t[2]-1]:[(t[0]-1)/2,(t[1]-1)/2,t[2]-1]}function c(t){return u(h(t))}function f(t,e){for(var i=0;i<t.length;i++)if(p(t[i],e))return!0;return!1}function p(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function d(t,e,i){var r=Math.sin(e*n),o=Math.pow(2,i);return[o*(t/360+.5),o*(.5-.25*Math.log((1+r)/(1-r))/Math.PI),i]}t.exports={tileToGeoJSON:function(t){var e=o(t);return{type:"Polygon",coordinates:[[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]]]}},tileToBBOX:o,getChildren:u,getParent:h,getSiblings:c,hasTile:f,hasSiblings:function(t,e){for(var i=c(t),n=0;n<i.length;n++)if(!f(e,i[n]))return!1;return!0},tilesEqual:p,tileToQuadkey:function(t){for(var e="",i=t[2];i>0;i--){var n=0,r=1<<i-1;0!=(t[0]&r)&&n++,0!=(t[1]&r)&&(n+=2),e+=n.toString()}return e},quadkeyToTile:function(t){for(var e=0,i=0,n=t.length,r=n;r>0;r--){var o=1<<r-1,a=+t[n-r];1===a&&(e|=o),2===a&&(i|=o),3===a&&(e|=o,i|=o)}return[e,i,n]},pointToTile:l,bboxToTile:function(t){var e=l(t[0],t[1],32),i=l(t[2],t[3],32),n=[e[0],e[1],i[0],i[1]],r=function(t){for(var e=0;e<28;e++){var i=1<<32-(e+1);if((t[0]&i)!=(t[2]&i)||(t[1]&i)!=(t[3]&i))return e}return 28}(n);return 0===r?[0,0,0]:[n[0]>>>32-r,n[1]>>>32-r,r]},pointToTileFraction:d}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.makeHullPresorted=function(t){if(t.length<=1)return t.slice();for(var e=[],i=0;i<t.length;i++){for(var n=t[i];e.length>=2;){var r=e[e.length-1],o=e[e.length-2];if(!((r.lng-o.lng)*(n.lat-o.lat)>=(r.lat-o.lat)*(n.lng-o.lng)))break;e.pop()}e.push(n)}e.pop();var a=[];for(i=t.length-1;i>=0;i--){for(n=t[i];a.length>=2;){r=a[a.length-1],o=a[a.length-2];if(!((r.lng-o.lng)*(n.lat-o.lat)>=(r.lat-o.lat)*(n.lng-o.lng)))break;a.pop()}a.push(n)}return a.pop(),1==e.length&&1==a.length&&e[0].lng==a[0].lng&&e[0].lat==a[0].lat?e:e.concat(a)},t.POINT_COMPARATOR=function(t,e){return t.lng<e.lng?-1:t.lng>e.lng?1:t.lat<e.lat?-1:t.lat>e.lat?1:0},t.makeHull=function(e){var i=e.slice();return i.sort(t.POINT_COMPARATOR),t.makeHullPresorted(i)},t}();e.ConvexHull=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.rgbToHex=function(e,i,n){if(e>255||i>255||n>255)throw Error("Invalid color component");return"#"+t.componentToHex(e)+t.componentToHex(i)+t.componentToHex(n)},t.componentToHex=function(t){var e=t.toString(16);return 1==e.length?"0"+e:e},t}();e.ColorUtils=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(16),r=function(){function t(t,e,i,n,r,o,a,s,l,u){void 0===u&&(u=[]),this.gl=t,this._id=e,this._text=i,this._font=n,this._size=r,this._width=o,this._height=a,this._widthPerLine=s,this._model=l,this._vertices=u}return t.prototype.destroy=function(){n.MapResourceManager.getInstance(this.gl).releaseText(this._id)},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"widthPerLine",{get:function(){return this._widthPerLine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertices",{get:function(){return this._vertices},enumerable:!0,configurable:!0}),t}();e.TextLabelData=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(169),r=i(42),o=i(2),a=function(){function t(t,e,i,n,r){this.chars=" !&quot;#$%&amp;'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`\\abcdefghijklmnopqrstuvwxyz{|}~ăâđêôơưáàảãạắằẳẵặấầẩẫậéèẻẽẹếềểễệíìỉĩịóòỏõọốồổỗộớờởỡợúùủũụứừửữựýỳỷỹỵĂÂĐÊÔƠƯÁÀẢÃẠẮẰẲẴẶẤẦẨẪẬÉÈẺẼẸẾỀỂỄỆÍÌỈĨỊÓÒỎÕỌỐỒỔỖỘỚỜỞỠỢÚÙỦŨỤỨỪỬỮỰÝỲỶỸỴ",this.gl=t,this._fontSize=e,this.fontImageData=[],this._metrics=new Array(this.chars.length),this.update(e,i,n,r)}return t.prototype.update=function(t,e,i,a){this.fontImageData=new Array(o.FontConstant.fontTextureWidth*o.FontConstant.fontTextureHeight*4).fill(0);var s=t/8,l=t/3,u=o.FontConstant.fontTextureWidth,h=o.FontConstant.fontTextureHeight;this._tinySDFGenerator=new n(t,s,l,e,i,a);for(var c=this._tinySDFGenerator,f=0,p=0;f+c.size<=h&&p<this.chars.length;f+=c.size)for(var d=0;d+c.size<=u&&p<this.chars.length;d+=c.size){var g=this.makeRGBAImageData(c.draw(this.chars[p]),c.size);g&&this.putImageData(g,d,f),this._metrics[this.chars[p]]={x:d,y:f},p++}var y=new Uint8Array(this.fontImageData);this._texture=new r.Texture(this.gl),this._texture.loadImageDataArray(y,u,h,this.gl.LINEAR)},t.prototype.makeRGBAImageData=function(t,e){for(var i=new Array(e*e*4),n=0;n<t.length;n++)i[4*n+0]=t[n],i[4*n+1]=t[n],i[4*n+2]=t[n],i[4*n+3]=255;return i},t.prototype.putImageData=function(t,e,i){for(var n=o.FontConstant.fontTextureWidth,r=this._tinySDFGenerator.size,a=0;a<r;++a)for(var s=0;s<r;++s)this.fontImageData[4*(i+a)*n+(4*e+4*s)]=t[4*a*r+4*s],this.fontImageData[4*(i+a)*n+(4*e+4*s+1)]=t[4*a*r+(4*s+1)],this.fontImageData[4*(i+a)*n+(4*e+4*s+2)]=t[4*a*r+(4*s+2)],this.fontImageData[4*(i+a)*n+(4*e+4*s+3)]=t[4*a*r+(4*s+3)]},Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tinySDFGenerator",{get:function(){return this._tinySDFGenerator},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this._metrics},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._texture.destroy()},t}();e.FontSDF=a},function(t,e,i){"use strict";t.exports=r;var n=1e20;function r(t,e,i,n,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=n||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=i||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,i,n,r,o,s){for(var l=0;l<e;l++){for(var u=0;u<i;u++)n[u]=t[u*e+l];for(a(n,r,o,s,i),u=0;u<i;u++)t[u*e+l]=r[u]}for(u=0;u<i;u++){for(l=0;l<e;l++)n[l]=t[u*e+l];for(a(n,r,o,s,e),l=0;l<e;l++)t[u*e+l]=Math.sqrt(r[l])}}function a(t,e,i,r,o){i[0]=0,r[0]=-n,r[1]=+n;for(var a=1,s=0;a<o;a++){for(var l=(t[a]+a*a-(t[i[s]]+i[s]*i[s]))/(2*a-2*i[s]);l<=r[s];)s--,l=(t[a]+a*a-(t[i[s]]+i[s]*i[s]))/(2*a-2*i[s]);i[++s]=a,r[s]=l,r[s+1]=+n}for(a=0,s=0;a<o;a++){for(;r[s+1]<a;)s++;e[a]=(a-i[s])*(a-i[s])+t[i[s]]}}r.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var a=e.data[4*r+3]/255;this.gridOuter[r]=1===a?0:0===a?n:Math.pow(Math.max(0,.5-a),2),this.gridInner[r]=1===a?n:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var s=this.gridOuter[r]-this.gridInner[r];i[r]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return i}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.onMapWillChange=function(t){},t.prototype.onMapIsChanging=function(t){},t.prototype.onMapDidChange=function(t){},t}();e.MapObserver=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.notifyCameraWillChange=function(t){},t.prototype.notifyCameraIsChanging=function(){},t.prototype.notifyCameraDidChange=function(){},t}();e.CameraAnimationObserver=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(19),r=i(9),o=i(2),a=i(6),s=i(3),l=i(20),u=i(7),h=i(13),c=i(26),f=function(){function t(t){this.scale=1,this.willChange=!1,this.zoomIn=!1,this.zoomOut=!1,this.panning=!1,this.flyingTo=!1,this.tilting=!1,this.bearing=!1,this.gesture=!1,this.constraining=!1,this.mapSettings=t,this.cameraPosition=new n.CameraPosition([0,0],0,0,0),this.projectionMatrix=new r.Matrix4,this.orthoProjectionMatrix=new r.Matrix4,this.viewProjectionMatrix=new r.Matrix4,this.shouldChangeMapMode=null}return t.prototype.setScreenSize=function(t,e){this.screenWidth=t,this.screenHeight=e,this.projectionMatrix.setPerspective(o.CameraConstants.fov,t/e,o.CameraConstants.nearPlane,o.CameraConstants.farPlane),this.orthoProjectionMatrix.setOrtho(0,t,e,0),this.constraintCameraWithRestrictionBounds(),this.recalculateMatrices()},t.prototype.matrixFor=function(t,e){var i=1<<e.getTileCoordinate().getZoom(),n=a.ProjectionMercator.worldSize(this.scale)/i,r=e.toVec2(),o=r.x*n+n/2,l=r.y*n+n/2,h=u.GeometryUtils.pixelCoordinateToCameraCoordinate(new s.Vector2(o,l),this.cameraPosition);return t.setIdentity(n/2,n/2,1),t.translate(h.x,h.y,0)},t.prototype.recalculateMatrices=function(){this.viewProjectionMatrix.setRotationX(this.cameraPosition.getTilt());var t=this.viewProjectionMatrix.transform(new l.Vector3(0,0,1),0);this.viewProjectionMatrix.rotateZ(this.cameraPosition.getBearing()),this.cameraPositionVector=this.viewProjectionMatrix.transform(t,0),c.CameraUtils.calculateViewMatrix(this.viewProjectionMatrix,this.cameraPosition,this.screenHeight),this.viewProjectionMatrix.concat(this.projectionMatrix)},t.prototype.constraintCameraWithRestrictionBounds=function(){if(null!=this.mapSettings.getRestrictionBounds()&&!this.constraining&&0!=this.getScreenSize().x&&0!=this.getScreenSize().y){this.constraining=!0;var t,e,i=this.mapSettings.getRestrictionBounds(),n=this.getScale(),r=null,o=null,l=this.getScreenSize(),u=a.ProjectionMercator.projectScale(i.getSouthwest(),n),h=a.ProjectionMercator.projectScale(i.getNortheast(),n),c=u.x,f=h.y,p=h.x,d=u.y;t=p-c<l.x?l.x/(p-c):0,e=d-f<l.y?l.y/(d-f):0;var g=a.ProjectionMercator.projectScale(this.getTarget(),n),y=Math.min(t,e);if(y)return this.setTarget(a.ProjectionMercator.unproject(new s.Vector2(t?(p+c)/2:g.x,e?(d+f)/2:g.y),n)),this.setZoom(Math.floor(this.getZoom()+Math.log2(y))),void(this.constraining=!1);if(p-c<l.x)g.x=(p+c)/2;else{var m=l.x/2;g.x-m<c&&(r=c+m),g.x+m>p&&(r=p-m)}if(d-f<l.y)g.y=(d+f)/2;else{var v=l.y/2;g.y-v<f&&(o=f+v),g.y+v>d&&(o=d-v)}this.setTarget(a.ProjectionMercator.unproject(new s.Vector2(null!=r?r:g.x,null!=o?o:g.y),n)),this.constraining=!1}},t.prototype.setTarget=function(t){this.cameraPosition.setTarget(t),this.constraintCameraWithRestrictionBounds(),this.recalculateMatrices()},t.prototype.setTilt=function(t){this.cameraPosition.setTilt(t),this.constraintCameraWithRestrictionBounds(),this.recalculateMatrices()},t.prototype.setBearing=function(t){this.cameraPosition.setBearing(t),this.constraintCameraWithRestrictionBounds(),this.recalculateMatrices()},t.prototype.setZoom=function(t){this.cameraPosition.setZoom(t),this.scale=Math.pow(2,t),this.constraintCameraWithRestrictionBounds(),this.recalculateMatrices()},t.prototype.enable3dMode=function(t){if(t==this.mapSettings.is3dMode())return!1;if(!t){var e=h.MathUtils.clamp(this.getTilt(),this.getMinTilt(),o.MapConstants.maxTilt2D);this.setTilt(e)}return this.mapSettings.enable3dMode(t)},t.prototype.getProjectionMatrix=function(){return this.projectionMatrix},t.prototype.getViewProjectionMatrix=function(){return this.viewProjectionMatrix},t.prototype.getOrthoProjectionMatrix=function(){return this.orthoProjectionMatrix},t.prototype.getScreenSize=function(){return new s.Vector2(this.screenWidth,this.screenHeight)},t.prototype.getTilt=function(){return this.cameraPosition.getTilt()},t.prototype.getMinTilt=function(){return this.mapSettings.getMinTilt()},t.prototype.getMaxTilt=function(){return this.mapSettings.getMaxTilt()},t.prototype.getDistanceToSky=function(){return this.distanceToSky},t.prototype.setDistanceToSky=function(t){this.distanceToSky=t},t.prototype.getBearing=function(){return this.cameraPosition.getBearing()},t.prototype.getScale=function(){return this.scale},t.prototype.getZoom=function(){return this.cameraPosition.getZoom()},t.prototype.getTarget=function(){return this.cameraPosition.getTarget()},t.prototype.isGesture=function(){return this.gesture},t.prototype.isZoomIn=function(){return this.zoomIn},t.prototype.isZoomOut=function(){return this.zoomOut},t.prototype.isTilting=function(){return this.tilting},t.prototype.isBearing=function(){return this.bearing},t.prototype.isPanning=function(){return this.panning},t.prototype.isFlyingTo=function(){return this.flyingTo},t.prototype.isMoving=function(){return this.movingTo},t.prototype.isStill=function(){return!(this.isBearing()||this.isFlyingTo()||this.isMoving()||this.isPanning()||this.isTilting()||this.isZoomIn()||this.isZoomOut())},t.prototype.dirty=function(){return this.isFlyingTo()||this.isPanning()||this.isZoomIn()||this.isZoomOut()||this.isMoving()||this.isBearing()},t.prototype.getCamera=function(){return this.cameraPosition},t.prototype.isWillChange=function(){return this.willChange},t.prototype.setCamera=function(t){this.cameraPosition=t},t.prototype.getMaxNativeZoom=function(){return this.mapSettings.getMaxNativeZoom()},t.prototype.is3dMode=function(){return this.mapSettings.is3dMode()},t.prototype.getSkyRatio=function(){return this.skyRatio},t.prototype.setSkyRatio=function(t){this.skyRatio=t},t.prototype.setShouldChangeMapMode=function(t){this.shouldChangeMapMode=t},t.prototype.handleMapMode=function(t,e){!this.is3dMode()&&Math.round(e)>=o.MapConstants.defaultMinZoom3d&&Math.floor(t)>o.MapConstants.defaultMinZoom3d-1||!this.is3dMode()&&Math.round(e)==o.MapConstants.defaultMinZoom3d&&e-t<0||e<o.MapConstants.defaultMinZoom3d-1||e>o.MapConstants.defaultMinZoom3d||this.shouldChangeMapMode()&&this.enable3dMode(Math.round(e)>=o.MapConstants.defaultMinZoom3d)},t}();e.MapState=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(17),r=i(75),o=i(7),a=i(3),s=i(175),l=i(2),u=i(55),h=i(37),c=i(6),f=i(1),p=i(176),d=i(40),g=i(77),y=i(114),m=i(0),v=i(16),_=function(){function t(t,e,i,n,r){var o=this;this.visibleTiles=[],this.mapView=t,this.mapState=i,this.finishedLoad=!0,this.dirtyOverriddenTile=!1,this.overriddenTiles=new Set,this.tilesLoaded=!0,this.mapSettings=n,this.lastZoom=this.mapState.getZoom(),this.lastZoomUpdateVisibleTiles=this.mapState.getZoom(),this.tileRequestsMap=new Map,this.requestRender=r;this.tilePyramid=new g.TilePyramid(this.mapView,l.MapConstants.tileCacheSize,(function(t){return o.createTile(t)}),(function(t){o.removeTile(t)}),(function(t){o.updateTileFromCache(t)}),this.tileRequestsMap),this.taskDataManager=new y.TaskDataManager(t,e,r,this.tileRequestsMap)}return t.prototype.isDirty=function(){var t=this.mapState.getZoom(),e=!0;return(this.finishedLoad||this.mapState.isZoomIn()||this.mapState.isZoomOut()||!this.mapState.isFlyingTo()&&(Math.ceil(t-l.MathConstants.epsilon)>t||Math.floor(t+l.MathConstants.epsilon)<t))&&(e=!1),e},t.prototype.removeTile=function(t){var e=t.getTileCoordinate();if(this.overriddenTiles.delete(e),t.isRenderable()){if(this.mapState.is3dMode()){var i=v.MapResourceManager.getInstance(this.mapView.gl);t.getTileRenderData().getLayerRenderDatas().forEach((function(t){if(t.getType()==m.LayerType.BUILDING){var e=t;i.removeVisibleBuildingId(e.getId())}}))}this.tilePyramid.getTileCache()||t.destroy()}else this.taskDataManager.removeTaskResult(e)},t.prototype.update=function(){this.isDirty()&&(this.tilePyramid.update(this.visibleTiles,this.mapState,this.lastZoom),this.dirtyOverriddenTile&&(this.dirtyOverriddenTile=!1,this.updateOverriddenTile()),this.taskDataManager.isAllRequestFinished()&&(0==this.tilesLoaded&&this.mapView.mapsEventManager.notify(d.MapEvent.tilesLoaded),this.tilesLoaded=!0,this.finishedLoad=!0,this.lastZoom=this.mapState.getZoom()))},t.prototype.reload=function(){this.mapView.getGeoJsonManager().removeAllTiles(),this.tilePyramid.getTiles().forEach((function(t){t.tile.destroy()})),this.mapView.getAnnotationManager().reload(),this.mapView.getOverlayManager().reload(),this.tilePyramid.clear(),this.finishedLoad=!1,this.mapView.dirty=!0,this.taskDataManager.reload()},t.prototype.destroy=function(){this.reload(),this.visibleTiles=[]},t.prototype.getTilePyramid=function(){return this.tilePyramid},t.prototype.getVisibleTiles=function(){return this.visibleTiles},t.prototype.updateVisibleTilesForZoom=function(t){var e=this;this.mapState.getZoom()>this.mapSettings.getMaxNativeZoom()&&(t=this.mapSettings.getMaxNativeZoom());var i=this.mapState.cameraPosition,n=this.mapState.getScreenSize(),u=Math.pow(2,t),h=this.mapState.getTilt(),d=!1;h>l.MapConstants.maxTiltIntersectWithScreen&&(this.mapState.setTilt(l.MapConstants.maxTiltIntersectWithScreen),d=!0);var g=o.GeometryUtils.screenCoordinateToLatLngZoom(new a.Vector2(0,0),i,n,t),y=c.ProjectionMercator.projectScale(g,u).multiply(1/f.MapUtils.getTileSize()),m=o.GeometryUtils.screenCoordinateToLatLngZoom(new a.Vector2(n.x,0),i,n,t),v=c.ProjectionMercator.projectScale(m,u).multiply(1/f.MapUtils.getTileSize());d&&this.mapState.setTilt(h);var _=o.GeometryUtils.screenCoordinateToLatLngZoom(new a.Vector2(n.x,n.y),i,n,t),b=c.ProjectionMercator.projectScale(_,u).multiply(1/f.MapUtils.getTileSize()),w=o.GeometryUtils.screenCoordinateToLatLngZoom(new a.Vector2(0,n.y),i,n,t),M=c.ProjectionMercator.projectScale(w,u).multiply(1/f.MapUtils.getTileSize()),x=o.GeometryUtils.screenCoordinateToLatLngZoom(new a.Vector2(n.x/2,n.y/2),i,n,t),T=c.ProjectionMercator.projectScale(x,u).multiply(1/f.MapUtils.getTileSize());this.mapState.is3dMode()&&(this.mapState.setSkyRatio(o.GeometryUtils.latLngToScreenCoordinate(g,0,i,n).y/n.y),this.mapState.setDistanceToSky(p.Geometry2DUtils.calculateDistanceBetweenPointToLineBy2Point(v,M,b)*f.MapUtils.getTileSize()));var A=1<<Math.floor(t),L=[],S=function(t,e,i){if(i>=0&&i<=A)for(var n=t;n<e;++n){var r=n+.5-T.x,o=i+.5-T.y,a={x:n,y:i,sqDist:r*r+o*o};L.push(a)}};s.Rasterize.scanTriangle(y,v,b,0,A,S),s.Rasterize.scanTriangle(b,M,y,0,A,S),L.sort((function(t,e){return t.sqDist==e.sqDist?t.x==e.x?t.y-e.y:t.x-e.x:t.sqDist-e.sqDist})),L.filter((function(t,e,i){return 0==e||t.x!=i[e-1].x||t.y!=i[e-1].y})).forEach((function(i){return e.visibleTiles.push(r.UnwrappedTileCoordinate.createWithXYZoom(i.x,i.y,t,e.mapState.is3dMode()))}))},t.prototype.updateVisibleTiles=function(){this.finishedLoad=!1,this.mapView.overlayManager.visibleTilesChanged(),this.visibleTiles=[];var t=this.mapState.getZoom();this.lastZoomUpdateVisibleTiles<t?this.updateVisibleTilesForZoom(Math.ceil(t)):this.updateVisibleTilesForZoom(Math.floor(t)),this.lastZoomUpdateVisibleTiles=t,this.taskDataManager.cancelOutdatedTasks(this.visibleTiles)},t.prototype.updateTileFromCache=function(t){var e=this,i=t.getTileCoordinate(),n=t.getTileData().getLayerIds();if(this.mapView.overlayManager.isOverrideBaseMapTile(i))n.forEach((function(i){e.removeTileLayer(t,i)})),this.overriddenTiles.add(i);else{var r=t.getTileData();if(this.mapState.is3dMode()&&null!=r.getTileLayer(l.LayerConstants.buildingTileLayerId)){var o=v.MapResourceManager.getInstance(this.mapView.gl);t.getTileRenderData().getLayerRenderDatas().forEach((function(t){if(t.getType()==m.LayerType.BUILDING){var e=t,i=e.getId();o.hasVisibleBuildingId(i)||e.resetScaleZ(),o.retainVisibleBuildingId(i)}}))}0==n.length&&this.requestTileData(t,i)}},t.prototype.createTile=function(t){var e=new n.Tile(n.Kind.BASEMAP,t,this.mapView.gl);return this.mapView.overlayManager.isOverrideBaseMapTile(t)?(this.overriddenTiles.add(t),e.setRenderable()):this.requestTileData(e,t),e},t.prototype.requestTileData=function(t,e){this.tilesLoaded=!1;var i=this.mapSettings.getMapUrl(),n=u.UrlUtils.getTileUrl(i,e.getX(),e.getY(),e.getZoom());this.taskDataManager.requestData(t,h.Resource.Tile,n)},t.prototype.reloadTileData=function(t){this.tilePyramid.getTiles().get(t.toString())},t.prototype.dirtyOverriddenTiles=function(){this.dirtyOverriddenTile=!0,this.finishedLoad=!1},t.prototype.updateOverriddenTile=function(){var t=this,e=this.mapView.overlayManager;this.mapState.is3dMode();this.visibleTiles.forEach((function(i){var n=i.getTileCoordinate(),r=t.tilePyramid.getTile(n);null!=r&&(e.isOverrideBaseMapTile(n)?(t.overriddenTiles.add(n),r.isRenderable()?r.getTileData().getLayerIds().forEach((function(e){t.removeTileLayer(r,e)})):t.taskDataManager.removeTaskResult(n,!0)):t.overriddenTiles.has(n)&&(t.requestTileData(r,n),t.overriddenTiles.delete(n)))}))},t.prototype.removeTileLayer=function(t,e){var i=t.getTileData(),n=i.getTileLayer(e);if(null!=n){var r=t.getTileRenderData();n.getFeatures().forEach((function(t){r.removeLayerRenderData(t.getId())})),i.removeTileLayer(e)}},t}();e.TileManager=_},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.layerRenderDatas=new Map}return t.prototype.destroy=function(){this.layerRenderDatas.forEach((function(t){return t.destroy()})),this.layerRenderDatas.clear()},t.prototype.getLayerRenderDatas=function(){return this.layerRenderDatas},t.prototype.getLayerRenderData=function(t){return this.layerRenderDatas.get(t)},t.prototype.setLayerRenderData=function(t,e){this.layerRenderDatas.has(t)&&this.layerRenderDatas.get(t).destroy(),this.layerRenderDatas.set(t,e)},t.prototype.removeLayerRenderData=function(t){var e=this.layerRenderDatas.get(t);e&&(e.destroy(),this.layerRenderDatas.delete(t))},t.prototype.hasLayerRenderData=function(t){return this.layerRenderDatas.has(t)},t}();e.TileRenderData=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.scanTriangle=function(t,e,i,n,a,s){var l=new r(t,e),u=new r(e,i),h=new r(i,t);if(l.dy>u.dy){var c=l;l=u,u=c}if(l.dy>h.dy){c=l;l=h,h=c}if(u.dy>h.dy){c=u;u=h,h=c}l.dy&&o(h,l,n,a,s),u.dy&&o(h,u,n,a,s)},t}();e.Rasterize=n;var r=function(t,e){if(this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.dx=0,this.dy=0,t.y>e.y){var i=t;t=e,e=i}this.x0=t.x,this.y0=t.y,this.x1=e.x,this.y1=e.y,this.dx=e.x-t.x,this.dy=e.y-t.y};function o(t,e,i,n,r){var o=Math.max(i,Math.floor(e.y0)),a=Math.min(n,Math.ceil(e.y1));if(t.x0==e.x0&&t.y0==e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,h=t.dx>0?1:0,c=e.dx<0?1:0,f=o;f<a;++f){var p=l*Math.max(0,Math.min(t.dy,f+h-t.y0))+t.x0,d=u*Math.max(0,Math.min(e.dy,f+c-e.y0))+e.x0;r(Math.floor(d),Math.ceil(p),f)}}e.Edge=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=function(){function t(){}return t.calculateDistanceBetweenPointToLineBy2Point=function(e,i,n){return Math.sqrt(t.distToSegmentSquared(e,i,n))},t.calculateDistanceBetweenPointToLine=function(e,i){return Math.sqrt(t.distToSegmentSquared(e,new n.Vector2(i[0][0],i[0][1]),new n.Vector2(i[1][0],i[1][1])))},t.distToSegmentSquared=function(e,i,r){var o=t.dist2(i,r);if(0==o)return t.dist2(e,i);var a=((e.x-i.x)*(r.x-i.x)+(e.y-i.y)*(r.y-i.y))/o;return a=Math.max(0,Math.min(1,a)),t.dist2(e,new n.Vector2(i.x+a*(r.x-i.x),i.y+a*(r.y-i.y)))},t.dist2=function(e,i){return t.sqr(e.x-i.x)+t.sqr(e.y-i.y)},t.sqr=function(t){return t*t},t}();e.Geometry2DUtils=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.orderedKeys=[],this.size=t,this.tiles=new Map}return t.prototype.setSize=function(t){for(this.size=t;this.orderedKeys.length>t;){var e=this.orderedKeys[0];this.orderedKeys.shift(),this.tiles.delete(e.toString())}},t.prototype.add=function(t,e){if(e.isRenderable()&&this.size){if(this.tiles.has(t)){var i=this.orderedKeys.indexOf(t,0);i>-1&&this.orderedKeys.splice(i,1);var n=this.tiles.get(t);n!=e&&n.destroy()}if(this.tiles.set(t,e),this.orderedKeys.push(t),this.orderedKeys.length>this.size-1)this.pop(this.orderedKeys[0]).destroy()}else e.destroy()},t.prototype.get=function(t){return this.tiles.get(t)},t.prototype.pop=function(t){var e=this.tiles.get(t);if(this.tiles.delete(t)){var i=this.orderedKeys.indexOf(t,0);i>-1&&this.orderedKeys.splice(i,1)}return e},t.prototype.has=function(t){return null!=this.tiles.get(t)},t.prototype.clear=function(){this.orderedKeys=[],this.tiles.forEach((function(t){t.destroy()})),this.tiles.clear()},t}();e.TileCache=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(17),a=i(0),s=i(43),l=i(193),u=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this;return r.gl=n,r.layerDatas=new Map,r.geometryTileDatas=null,r}return r(e,t),e.prototype.getTexture=function(){return null},e.prototype.init=function(t,e){},e.prototype.setData=function(t){var e=this;this.geometryTileDatas=t,null!=t&&t.getLayerIds().forEach((function(t){t.startsWith(s.AnnotationManager.pointLayerId)&&e.removeLayerData(t)}))},e.prototype.hasData=function(t){return null!=this.geometryTileDatas&&null!=this.geometryTileDatas.getLayer(t)},e.prototype.removeLayerData=function(t){var e=this.layerDatas.get(t);e&&(e.destroy(),this.layerDatas.delete(t))},e.prototype._getLayerData=function(t,e,i){if(void 0===i&&(i=null),!this.layerDatas.has(t)){var n=this.geometryTileDatas.getLayer(t);if(null==n)return console.error("_getLayerData not reachable"),null;switch(e){case a.LayerType.GEOJSON:var r=new l.GeoJsonLayerData(n,this.gl);return this.layerDatas.set(t,r),this.layerDatas.get(t);default:return console.error("_getLayerData not reachable"),null}}return this.layerDatas.get(t)},e.prototype.getGeometryTileData=function(){return this.geometryTileDatas},e}(o.Tile);e.GeometryTile=u},function(t,e,i){t.exports=function(){"use strict";function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(i,n,r,o,a){!function e(i,n,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=n-r+1,u=Math.log(s),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(s-h)/s)*(l-s/2<0?-1:1),f=Math.max(r,Math.floor(n-l*h/s+c)),p=Math.min(o,Math.floor(n+(s-l)*h/s+c));e(i,n,f,p,a)}var d=i[n],g=r,y=o;for(t(i,r,n),a(i[o],d)>0&&t(i,r,o);g<y;){for(t(i,g,y),g++,y--;a(i[g],d)<0;)g++;for(;a(i[y],d)>0;)y--}0===a(i[r],d)?t(i,r,y):(y++,t(i,y,o)),y<=n&&(r=y+1),n<=y&&(o=y-1)}}(i,n,r||0,o||i.length-1,a||e)}}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21),r=i(43),o=i(6),a=i(3),s=i(0),l=i(14),u=i(28),h=function(){function t(t,e){this._id=t,this._layerId=r.AnnotationManager.annotationLayerId+t.toString(),this._circleAnnotation=e,this.updateBounds()}return t.prototype.createLayer=function(t){null==t.getLayer(this._layerId)&&t.createLayer(this._layerId,s.LayerType.CIRCLE,this._circleAnnotation.getZIndex())},t.prototype.updateTileData=function(t,e){var i=e.addTileLayer(this._layerId,s.LayerType.CIRCLE),n=new u.GeometryCollection([]);i.addFeature(this._layerId,l.GeometryType.Unknown,n,this._circleAnnotation.getProperties())},t.prototype.updateBounds=function(){var t=this._circleAnnotation.getCenter(),e=this._circleAnnotation.getRadius(),i=o.ProjectionMercator.convertToMeterFromLatLng(t),r=new a.Vector2(i.x-e,i.y-e),s=new a.Vector2(i.x+e,i.y+e),l=new n.LatLngBounds(o.ProjectionMercator.convertToLatLngFromMeter(r),o.ProjectionMercator.convertToLatLngFromMeter(s));this._minX=l.getSouthwest().lng,this._minY=l.getSouthwest().lat,this._maxX=l.getNortheast().lng,this._maxY=l.getNortheast().lat},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.getLayerId=function(){return this._layerId},t.prototype.getAnnotation=function(){return this._circleAnnotation},Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}();e.CircleAnnotationData=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){var n=t.call(this,e)||this;return n.polygonAnnotation=i,n}return r(e,t),e.prototype.getAnnotation=function(){return this.polygonAnnotation},e.prototype.createLayer=function(t){var e=this.getLayerId();null==t.getLayer(e)&&t.createLayer(e,o.LayerType.FILL,this.polygonAnnotation.getZIndex())},e.prototype.getFeatures=function(){var t,e=[];this.polygonAnnotation.getPaths().forEach((function(t){var i=[];t.forEach((function(t){return i.push([t.lng,t.lat])})),e.push(i)}));var i={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:e}},{type:"Feature",properties:{},geometry:{type:"MultiLineString",coordinates:e}}]};return t=JSON.stringify(i,null,2),JSON.parse(t)},e.prototype.getProperties=function(){return this.polygonAnnotation.getProperties()},e.prototype.addTileLayer=function(t,e){return t.addTileLayer(e,o.LayerType.FILL)},e}(i(106).ShapeAnnotationData);e.PolygonAnnotationData=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){var n=t.call(this,e)||this;return n.polylineAnnotation=i,n}return r(e,t),e.prototype.getAnnotation=function(){return this.polylineAnnotation},e.prototype.createLayer=function(t){var e=this.getLayerId();null==t.getLayer(e)&&t.createLayer(e,o.LayerType.LINE,this.polylineAnnotation.getZIndex())},e.prototype.getFeatures=function(){var t,e=[];this.polylineAnnotation.getPath().forEach((function(t){e.push([t.lng,t.lat])})),this.polylineAnnotation.isClosed()&&0!=e.length&&e.push(e[0]);var i={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}}]};return t=JSON.stringify(i,null,2),JSON.parse(t)},e.prototype.getProperties=function(){return this.polylineAnnotation.getProperties()},e.prototype.addTileLayer=function(t,e){return t.addTileLayer(e,o.LayerType.LINE)},e}(i(106).ShapeAnnotationData);e.PolylineAnnotationData=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(52),r=i(1),o=i(0),a=i(43),s=i(55),l=i(28),u=i(14),h=i(2),c=function(){function t(t,e,i){this._gl=t,this._id=e,this._layerId=a.AnnotationManager.pointLayerId+e.toString(),this._symbolAnnotation=i,this._symbolAnnotation.getProperties().setId(this._layerId),this.updateBounds(),this.updateIcon()}return t.prototype.createLayer=function(t){null==t.getLayer(this._layerId)&&t.createLayer(this._layerId,o.LayerType.SYMBOL,h.MapConstants.buildingLayerOrder+this._symbolAnnotation.getZIndex())},t.prototype.updateTileData=function(t,e){var i=e.addTileLayer(this._layerId,o.LayerType.SYMBOL),n=this._symbolAnnotation.getProperties();n.setUrl(this._url),n.setWidth(this._width?this._width:-1),n.setHeight(this._height?this._height:-1);var r=new l.GeometryCollection([]);i.addFeature(this._layerId,u.GeometryType.Point,r,n)},t.prototype.updateBounds=function(){var t=this._symbolAnnotation.getPosition();this._minX=t.lng,this._minY=t.lat,this._maxX=t.lng,this._maxY=t.lat},t.prototype.updateAnnotationData=function(){var t=this._symbolAnnotation.getPosition();t.lat!=this._minY||t.lng!=this._minX?this.updateBounds():this.updateIcon()},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.getLayerId=function(){return this._layerId},Object.defineProperty(t.prototype,"symbolAnnotation",{get:function(){return this._symbolAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t.prototype.updateIcon=function(){this._width=null,this._height=null;var e=this._symbolAnnotation.getIcon();e instanceof n.Icon?(this._url=e.getUrl(),this._width=e.getWidth()*r.MapUtils.pixelScale,this._height=e.getHeight()*r.MapUtils.pixelScale):this._url=e,s.UrlUtils.isUrlRequest(this._url)||null!=this._width&&null!=this._height||(this._width=t.DEFAULT_SYMBOL_WIDTH*r.MapUtils.pixelScale,this._height=t.DEFAULT_SYMBOL_HEIGHT*r.MapUtils.pixelScale)},t.DEFAULT_SYMBOL_WIDTH=32,t.DEFAULT_SYMBOL_HEIGHT=32,t}();e.SymbolAnnotationData=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(185),r=i(56),o=i(1),a=function(){function t(t,e,i){this.map=t,this.symbolAnnotations=e,this.iconViewMarkerManager=i,this.infoWindows=new Map,this.createInfoWindowContainer()}return t.prototype.createInfoWindowContainer=function(){this.infoWindowContainer||(this.infoWindowContainer=r.DOMUtils.create("div","mf-info-window-container",this.map.getMapContainer()))},t.prototype.createInfoContentsContainer=function(){this.infoContentsContainer||(this.createInfoWindowContainer(),this.infoContentsContainer=r.DOMUtils.create("div","mf-info-window-content mf-scrollbar",this.infoWindowContainer))},t.prototype.createInfoWindow=function(t){var e=this.getInfoWindow(t);return null!=e?(null==this.infoContentsContainer&&(this.infoContentsContainer=r.DOMUtils.create("div",null,this.infoWindowContainer)),this.setContentsHTMLElement(e),this.infoContentsContainer):null},t.prototype.createInfoContents=function(t){var e=this.getInfoContents(t);return null!=e?(this.createInfoContentsContainer(),this.setContentsHTMLElement(e),this.infoContentsContainer):null},t.prototype.createDefaultInfoContents=function(t){var e=t.getTitle(),i=t.getSnippet();if(!(""!==e&&null!=e||""!==i&&null!=i))return null;this.createInfoContentsContainer();var n=this.getDefaultContents(t);return this.setContentsHTMLElement(n),this.infoContentsContainer},t.prototype.deselectMarker=function(){null!=this.selectedMarkerId&&this.hideInfoWindow(this.selectedMarkerId)},t.prototype.getDefaultContents=function(t){var e=t.getTitle()||"",i=t.getSnippet()||"";return(e.length>0?"<h4>"+e+"</h4>":"")+(i.length>0?"<p>"+t.getSnippet()+"</p>":"")},t.prototype.getInfoContents=function(t){var e=t.getInfoContents();return null!=e?e:null},t.prototype.getInfoWindow=function(t){var e=t.getInfoWindow();return null!=e?e:null},t.prototype.getInfoWindowHTMLElement=function(t){var e=this.createInfoWindow(t);if(null!=e)return e;var i=this.createInfoContents(t);return null!=i?i:this.createDefaultInfoContents(t)},t.prototype.isInfoWindowShown=function(t){return null!=this.selectedMarkerId&&this.selectedMarkerId==t},t.prototype.removeContent=function(){this.infoContentsContainer&&(r.DOMUtils.remove(this.infoContentsContainer),this.infoContentsContainer=null)},t.prototype.render=function(t){null!=this.selectedMarkerId&&(t.indexOf(this.selectedMarkerId)>-1?this.update():this.infoWindowContainer.style.visibility="hidden")},t.prototype.update=function(){var t=this.iconViewMarkerManager.getIconViewMarkers().get(this.selectedMarkerId),e=this.symbolAnnotations.get(this.selectedMarkerId);if(e||t){var i=null,n=this.infoWindows.get(this.selectedMarkerId);if(e)i=n.getPositionBySymbolAnnotationData(e,this.map.mapState);else{var r=this.iconViewMarkerManager.getIconViewsHTML().get(this.selectedMarkerId),a=document.getElementById(""+r.id),s=a.clientWidth*o.MapUtils.pixelScale,l=a.clientHeight*o.MapUtils.pixelScale;s=s%2?s+1:s,l=l%2?l+1:l,i=n.getPosition(t.getPosition(),t.getElevation(),s,l,t.getAnchor(),this.map.mapState)}if(null==i)return;var u=i.x,h=i.y,c=this.infoWindowContainer.style;c.top=h.toString()+"px",c.left=u.toString()+"px","hidden"==c.visibility&&(c.visibility="visible")}},t.prototype.hideInfoWindow=function(t){var e=t||this.selectedMarkerId;null!=e&&(this.removeContent(),this.infoWindows.delete(e),this.selectedMarkerId=null)},t.prototype.showInfoWindow=function(t){if(t!==this.selectedMarkerId){this.deselectMarker();var e=this.iconViewMarkerManager.getIconViewMarkers().get(t),i=this.symbolAnnotations.get(t);if(null!=i&&i.symbolAnnotation.isVisible()||e&&e.isVisible()){var r=i?i.symbolAnnotation:e,o=this.getInfoWindowHTMLElement(r);if(o&&o.children.length>0){for(var a="",s=0;s<o.children.length;++s)a+=o.children[s].innerHTML;""==a&&(console.error("All content you set for Info Window is NULL, Please check your custom setInfoContents() method."),o=null)}var l=new n.InfoWindow(o,r.getWindowAnchor());this.infoWindows.clear(),this.infoWindows.set(t,l),this.selectedMarkerId=t,this.update()}}},t.prototype.setContentsHTMLElement=function(t){this.infoContentsContainer&&(this.infoContentsContainer.innerHTML=t.toString())},t.prototype.updateInfoContents=function(t){var e=this.iconViewMarkerManager.getIconViewMarkers().get(t),i=this.symbolAnnotations.get(t),n=i?i.symbolAnnotation:e,r=this.infoWindows.get(t);null!=r&&(r.setContent(this.getInfoWindowHTMLElement(n)),this.update())},t}();e.InfoWindowManager=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=i(10),o=i(7),a=i(2),s=function(){function t(t,e){this.content=t,this.windowAnchor=e}return t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(t,e,i,s,l,u){if(null==this.content)return null;e=u.is3dMode()?e:0;var h=o.GeometryUtils.latLngToScreenCoordinate(t,e,u.cameraPosition,u.getScreenSize());h.x/=n.MapUtils.pixelScale,h.y/=n.MapUtils.pixelScale,h.x-=this.content.offsetWidth/2,h.y-=this.content.offsetHeight;var c=i/n.MapUtils.pixelScale,f=s/n.MapUtils.pixelScale,p=this.windowAnchor||new r.Point(.5,.5);return h.x+=(.5-l.x)*c-(.5-p.x)*c,h.y+=(.5-l.y)*f-(.5-p.y)*f-a.MapConstants.infoWindowPadding,new r.Point(h.x,h.y)},t.prototype.getPositionBySymbolAnnotationData=function(t,e){var i=t.symbolAnnotation;return this.getPosition(i.getPosition(),i.getElevation(),t.width,t.height,i.getAnchor(),e)},t.prototype.setContent=function(t){this.content=t},t}();e.InfoWindow=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(56),r=i(1),o=function(){function t(t){this._mapView=t,this._iconViewMarkers=new Map,this._iconViewsHTML=new Map}return t.prototype.update=function(){var t=this;this._iconViewMarkers.forEach((function(e){t.updateIconView(e.getId())}))},t.prototype.updateIconView=function(t){if(this._iconViewMarkers.get(t)){var e=this._iconViewMarkers.get(t),i=this._mapView.latLngToScreenCoordinate(e.getPosition(),e.getElevation());i.x/=r.MapUtils.pixelScale,i.y/=r.MapUtils.pixelScale,e.getProperties().needUpdateIconView&&this._iconViewsHTML.has(t)&&(this.removeContainer(t),this._iconViewsHTML.delete(t),e.getProperties().needUpdateIconView=!1);var o=this._iconViewsHTML.get(t);o||((o=n.DOMUtils.create("div","mf-iconview-marker-container",this._mapView.getMapContainer())).style.pointerEvents="none",o.id="mf-iconview-marker-"+t,o.innerHTML=""+e.getIconView(),this._iconViewsHTML.set(t,o));var a=document.getElementById(""+o.id),s=o.style,l=a.clientWidth%2?a.clientWidth+1:a.clientWidth,u=a.clientHeight%2?a.clientHeight+1:a.clientHeight,h=i.x-e.getAnchor().x*l,c=i.y-e.getAnchor().y*u;s.top=c.toString()+"px",s.left=h.toString()+"px",s.zIndex=e.getZIndex().toString(),e.isVisible()?s.visibility="visible":s.visibility="hidden";var f=this._mapView.getMaxNativeZoom();i.y=this._mapView.mapState.getZoom()>f?i.y:i.y+24;var p=this._mapView.screenCoordinateToLatLng(i);(o.offsetLeft>this._mapView.mapState.getScreenSize().x/r.MapUtils.pixelScale||o.offsetLeft<-o.offsetWidth||o.offsetTop>this._mapView.mapState.getScreenSize().y/r.MapUtils.pixelScale||o.offsetTop<-o.offsetHeight||p.lng==1/0||p.lat==1/0)&&(s.visibility="hidden")}},t.prototype.add=function(t,e){this._iconViewMarkers.set(t,e),this.updateIconView(t)},t.prototype.getIconViewMarkers=function(){return this._iconViewMarkers},t.prototype.getIconViewsHTML=function(){return this._iconViewsHTML},t.prototype.remove=function(t){this.removeContainer(t),this._iconViewsHTML.delete(t),this._iconViewMarkers.delete(t)},t.prototype.removeContainer=function(t){if(this._iconViewsHTML.has(t)){var e=this._iconViewsHTML.get(t);n.DOMUtils.remove(e),e=null}},t.prototype.removeAllContainers=function(){this._iconViewsHTML.forEach((function(t){n.DOMUtils.remove(t),t=null})),this._iconViewsHTML.clear()},t.prototype.destroy=function(){this.removeAllContainers(),this._iconViewMarkers.clear()},t}();e.IconViewMarkerManager=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(2),o=i(28),a=i(14),s=function(){function t(t,e){this._id=t,this._userPOIAnnotation=e;var i=this._userPOIAnnotation.getProperties();i.setId(r.LayerConstants.userPOILayerId+t),i.setAnnotationId(t),this.updateBounds()}return t.prototype.updateTileData=function(t,e){var i=e.addTileLayer(r.LayerConstants.userPOILayerId,n.LayerType.USERPOI),s=this._userPOIAnnotation.getProperties(),l=new o.GeometryCollection([]),u=s.getId();i.addFeature(u,a.GeometryType.Point,l,s)},t.prototype.updateBounds=function(){var t=this._userPOIAnnotation.getPosition();this._minX=t.lng,this._minY=t.lat,this._maxX=t.lng,this._maxY=t.lat},Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t.prototype.getUserPOIAnnotation=function(){return this._userPOIAnnotation},t}();e.UserPOIAnnotationData=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),r=i(0),o=i(28),a=i(14),s=i(6),l=i(10),u=function(){function t(t,e){this._id=t,this._userBuildingAnnotation=e,this._boundsUpdated=!1;var i=this._userBuildingAnnotation.getProperties();i.setId(n.LayerConstants.userBuildingLayerId+t),i.setAnnotationId(t),this.updateBounds()}return t.prototype.updateTileData=function(t,e){var i=e.addTileLayer(n.LayerConstants.userBuildingLayerId,r.LayerType.USERBUILDING),u=this._userBuildingAnnotation.getProperties(),h=new o.GeometryCollection([]),c=u.getCoordinates(),f=u.getId();if(0==c.length)i.addFeature(f,a.GeometryType.Building,h,u);else{for(var p=s.ProjectionMercator.convertToMeterFromLatLng(u.getLocation()),d=[],g=0;g<c.length;++g){var y=c[g],m=s.ProjectionMercator.convertToMeterFromLatLng(y);d.push(new l.Point(m.x-p.x,p.y-m.y))}h.geometryCoordinates.push(d),u.setModelName(f),i.addFeature(f,a.GeometryType.Polygon,h,u)}},t.prototype.updateBounds=function(t){var e=this._userBuildingAnnotation.getPosition();this._minX=e.lng,this._minY=e.lat,this._maxX=e.lng,this._maxY=e.lat,t&&(this._minX=t.minX,this._minY=t.minY,this._maxX=t.maxX,this._maxY=t.maxY,this._boundsUpdated=!0)},Object.defineProperty(t.prototype,"boundsUpdated",{get:function(){return this._boundsUpdated},set:function(t){this._boundsUpdated=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t.prototype.getUserBuildingAnnotation=function(){return this._userBuildingAnnotation},t}();e.UserBuildingAnnotationData=u},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(27),a=i(14),s=i(0),l=i(38),u=i(1),h=i(3),c=i(8),f=function(t){function e(e,i){var n=t.call(this,s.LayerType.FILL)||this;return n.fillVertices=[],n.fillIndices=[],n.lineVertices=[],n.lineIndices=[],n.gl=i,n.tileLayer=e,n}return r(e,t),e.prototype.getFillModel=function(){return this.fillModel},e.prototype.getLineModel=function(){return this.lineModel},e.prototype.buildPolyline=function(t){var e=this,i=new l.PolylineBuilderContext;i.addVertex=function(t,i,n){e.lineVertices.push(t.x,t.y,i.x,i.y,n.x,n.y)},i.lineCapType=l.LineCapType.Round,i.lineJoinType=l.LineJoinType.Round;for(var n=u.MapUtils.getTileSize(),r=t.featureCount(),o=this.properties,s=0;s<r;++s){var c=t.getFeature(s);if(c.getType()==a.GeometryType.LineString)for(var f=c.getGeometries().geometryCoordinates,p=0;p<f.length;++p){for(var d=[],g=0;g<f[p].length;++g){var y=new h.Vector2(f[p][g][0],f[p][g][1]);y.x=y.x*n,y.y=y.y*n,d.push(y)}i.buildPolyLine(d,null,o.getStrokeWidth()),i.indices.forEach((function(t){return e.lineIndices.push(t)}))}}},e.prototype.buildPolygon=function(t){var e=this,i=this.fillVertices.length/2,n=new l.PolygonBuilderContext;n.addVertex=function(t){e.fillVertices.push(t.x,t.y)};for(var r=u.MapUtils.getTileSize(),o=t.featureCount(),s=0;s<o;++s){var c=t.getFeature(s);if(c.getType()==a.GeometryType.Polygon){for(var f=c.getGeometries().geometryCoordinates,p=[],d=0;d<f.length;++d){for(var g=[],y=0;y<f[d].length;++y){var m=new h.Vector2(f[d][y][0],f[d][y][1]);m.x=m.x*r,m.y=m.y*r,g.push(m)}p.push(g)}l.buildPolygon(p,n),n.indices.forEach((function(t){return e.fillIndices.push(t+i)})),i=this.fillVertices.length/2}}},e.prototype.destroy=function(){this.fillModel&&this.fillModel.destroy(),this.lineModel&&this.lineModel.destroy()},e.prototype.init=function(t){var e=t[0].getProperties();this.setLayerProperties(e),this.buildPolyline(this.tileLayer),this.buildPolygon(this.tileLayer),this.fillModel=new o.Model(this.gl),this.fillModel.init(this.fillVertices,[new c.AttributeInfo("a_position",2,0,2)],this.fillIndices),this.lineModel=new o.Model(this.gl),this.lineModel.init(this.lineVertices,[new c.AttributeInfo("a_position",2,0,6),new c.AttributeInfo("a_extrude",2,2,6),new c.AttributeInfo("a_uv",2,4,6)],this.lineIndices),this.fillVertices=[],this.fillIndices=[],this.lineVertices=[],this.lineIndices=[]},e.prototype.upload=function(t,e){void 0===e&&(e=null)},e}(i(22).LayerRenderData);e.FillLayerRenderData=f},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(22),a=i(0),s=function(t){function e(e,i){return t.call(this,a.LayerType.CIRCLE)||this}return r(e,t),e.prototype.destroy=function(){},e.prototype.init=function(t){var e=t[0].getProperties();this.setLayerProperties(e)},e.prototype.upload=function(t,e){},e}(o.LayerRenderData);e.CircleLayerRenderData=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(22),a=i(0),s=i(79),l=i(16),u=i(1),h=function(t){function e(e,i){var n=t.call(this,a.LayerType.SYMBOL)||this;return n.gl=i,n.textLabelData=null,n.texture=null,n}return r(e,t),e.prototype.destroy=function(){if(this.textLabelData&&this.textLabelData.destroy(),this.texture){this.texture.release(),this.texture=null;var t=this.properties;l.MapResourceManager.getInstance(this.gl).releaseTexture(t.getId())}},e.prototype.init=function(t){var e=l.MapResourceManager.getInstance(this.gl),i=t[0].getProperties(),n=i.getMarkerLabel();if(i.isTextureDirty()?(this.texture&&(this.texture.release(),e.releaseTexture(i.getId())),this.texture=e.createMarkerTexture(i.getId(),i.getUrl()),i.setTextureDirty(!1)):(this.texture=e.getTexture(i.getId()),this.texture||(this.texture=e.createMarkerTexture(i.getId(),i.getUrl()))),this.texture&&this.texture.retain(),this.textLabelData&&(this.textLabelData.destroy(),this.textLabelData=null),n){i.setMarkerLabel(n instanceof s.MarkerLabel?n:new s.MarkerLabel({text:n}));var r=i.getMarkerLabel();this.textLabelData=l.MapResourceManager.getInstance(this.gl).acquireText(r.getText(),r.getFontSize()*u.MapUtils.pixelScale,r.getFontWeight(),r.getMaxWidth(),r.getLine())}this.setLayerProperties(i)},e.prototype.upload=function(t,e){},e.prototype.getTextLabelData=function(){return this.textLabelData},e.prototype.getTexture=function(){return this.texture},e}(o.LayerRenderData);e.SymbolLayerRenderData=h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(108),r=i(20),o=function(){function t(){}return t.extrudePolygon=function(e,i){if(!(0==e.length||e[0].length<=2)){var o=[],a=[];t.convertToClockwise(e[0]);var s=[];e[0].forEach((function(t){s.push(t.x),s.push(t.y)}));var l=n.default(s),u=e[0],h=u.length,c=h;l.length;6*(c-0)*1,2*(2*(c-0));for(var f=0,p=0;p<u.length;++p)o.push([u[p].x,i,u[p].y,0,0,0,0,0]);for(p=0;p<l.length;++p)a.push(f+l[p]);var d=c-0,g=2*d;f=o.length;for(var y=0;y<2;++y){var m=0==y?i:0;for(p=0;p<d;++p)for(var v=0;v<2;++v){var _=(p+v)%d+0;o.push([u[_].x,m,u[_].y,0,0,0,0,0])}}for(p=0;p<d;++p)for(var b=0;b<6;++b){v=(t.quadToTriangle[b][0]+2*p)%g;var w=t.quadToTriangle[b][1]+1;a.push((w-1)*g+v+f)}for(var M=0;M<a.length;){var x=a[M++],T=a[M++],A=a[M++],L=new r.Vector3(o[x][0],o[x][1],o[x][2]),S=new r.Vector3(o[T][0],o[T][1],o[T][2]),E=new r.Vector3(o[A][0],o[A][1],o[A][2]),I=S.subtract(L);w=E.subtract(S).cross(I);o[x][5]=o[x][5]+w.x,o[x][6]=o[x][6]+w.y,o[x][7]=o[x][7]+w.z,o[T][5]=o[T][5]+w.x,o[T][6]=o[T][6]+w.y,o[T][7]=o[T][7]+w.z,o[A][5]=o[A][5]+w.x,o[A][6]=o[A][6]+w.y,o[A][7]=o[A][7]+w.z}for(p=0;p<o.length;++p){var P=new r.Vector3(o[p][5],o[p][6],o[p][7]);P=P.normalize(),o[p][5]=P.x,o[p][6]=P.y,o[p][7]=P.z}return{vertices:o,indices:a}}},t.convertToClockwise=function(e){t.calculatePolygonArea(e)>0&&t.reversePoints(e)},t.calculatePolygonArea=function(t){var e=t.length;if(!(e<3)){for(var i=0,n=0,r=e-1;n<e;){var o=t[r].x,a=t[r].y,s=t[n].x,l=t[n].y;r=n,n+=1,i+=o*l-s*a}return i}},t.reversePoints=function(t){for(var e=t.length,i=e/2,n=0;n<i;++n){var r=t[n];t[n]=t[e-n-1],t[e-n-1]=r}},t.quadToTriangle=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]],t}();e.BuildingExtrudeUtils=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(194),a=i(27),s=i(14),l=i(0),u=i(38),h=i(1),c=i(3),f=i(8),p=i(12),d=i(113),g=i(196),y=i(5),m=function(t){function e(e,i){var n=t.call(this,l.LayerType.GEOJSON)||this;return n.vertices=[],n.indices=[],n.gl=i,n.partials=new Map,n.fillOutlinedPartials=new Map,n.fillProperties=new Map,n.lineProperties=new Map,n.fillOutlinedProperties=new Map,n.pointCoordinates=new Map,n.buildFillStroke(e),n.buildModel(e),n.model=new a.Model(n.gl),n.model.init(n.vertices,[new f.AttributeInfo("a_position",2,0,4),new f.AttributeInfo("a_extrude",2,2,4)],n.indices),n.vertices=[],n.indices=[],n.initializeProperties(e),n}return r(e,t),e.prototype.getModel=function(){return this.model},e.prototype.getPartials=function(){return this.partials},e.prototype.getFillOutlinedPartials=function(){return this.fillOutlinedPartials},e.prototype.getFillProperties=function(){return this.fillProperties},e.prototype.getLineProperties=function(){return this.lineProperties},e.prototype.getFillOutlinedProperties=function(){return this.fillOutlinedProperties},e.prototype.getPointCoordinates=function(){return this.pointCoordinates},e.prototype.buildFillStroke=function(t){for(var e=h.MapUtils.getTileSize(),i=t.featureCount(),n=0,r=0,o=[],a=0;a<i;++a){var l=t.getFeature(a);if(l.getType()==s.GeometryType.LineString&&!0===l.getProperties().get("fill-outlined")){for(var u=l.getGeometries().geometryCoordinates,f=this.indices.length,p=0;p<u.length;++p){r+=u[p].length;for(var y=0;y<u[p].length;++y){var m=new c.Vector2(u[p][y][0],u[p][y][1]);m.x=m.x*e,m.y=m.y*e,this.vertices.push(m.x),this.vertices.push(m.y),this.vertices.push(0),this.vertices.push(0),n!=r-1?(this.indices.push(n++),this.indices.push(n)):n++}}var v=this.indices.length-f;o.push(new g.Range(f,v));var _="";l instanceof d.VectorTileFeature&&(_=l.getId());var b=this.fillOutlinedPartials.get(_);b?b.push(o):this.fillOutlinedPartials.set(_,[o]),o=[]}}},e.prototype.initializeProperties=function(t){if(t instanceof d.VectorTileLayer)for(var i=t.featureCount(),n=0;n<i;++n){var r=t.getFeature(n),o=r.getType(),a=r.getProperties(),l=r.getId()||"";if(o==s.GeometryType.Point){var u=a.get("coordinate-lat"),c=a.get("coordinate-lng");if(null==u||null==c){console.warn("Point feature does not have coordinate");continue}this.pointCoordinates.has(l)?this.pointCoordinates.get(l).push(new y.LatLng(u,c)):this.pointCoordinates.set(l,[new y.LatLng(u,c)])}else if(o==s.GeometryType.LineString)if(null==a)this.lineProperties.set(l,{strokeColor:e.defaultStrokeColor,strokeWidth:e.defaultStrokeWidth*h.MapUtils.pixelScale});else if(a.has("fill-outlined")){var f=a.get("stroke")||"#555555",g=a.has("stroke-opacity")?a.get("stroke-opacity"):1;(m=p.Color.fromHex(f)).alpha=g,this.fillOutlinedProperties.set(l,{strokeColor:m})}else{var m,v=a.get("stroke")||"#555555",_=a.has("stroke-opacity")?a.get("stroke-opacity"):1;(m=p.Color.fromHex(v)).alpha=_;var b=a.has("stroke-width")?a.get("stroke-width"):e.defaultStrokeWidth;b*=h.MapUtils.pixelScale,this.lineProperties.set(l,{strokeColor:m,strokeWidth:b})}else if(a){v=a.get("fill")||"#555555",_=a.has("fill-opacity")?a.get("fill-opacity"):.5;var w=p.Color.fromHex(v);w.alpha=_,this.fillProperties.set(l,{fillColor:w})}else this.fillProperties.set(l,{fillColor:e.defaultFillColor})}},e.prototype.buildModel=function(t){var e=this,i=this.vertices.length/4,n=0,r=new u.PolygonBuilderContext;r.addVertex=function(t){e.vertices.push(t.x,t.y,0,0),++n};var o=new u.PolylineBuilderContext;o.addVertex=function(t,i){e.vertices.push(t.x,t.y,i.x,i.y),++n},o.lineCapType=u.LineCapType.Butt,o.lineJoinType=u.LineJoinType.Round;for(var a=h.MapUtils.getTileSize(),l=t.featureCount(),f=0;f<l;++f){var p=t.getFeature(f),y=p.getProperties(),m=p.getType();if(m==s.GeometryType.Point);else if(m==s.GeometryType.Polygon){for(var v=this.indices.length,_=p.getGeometries().geometryCoordinates,b=[],w=0;w<_.length;++w){for(var M=[],x=0;x<_[w].length;++x){(S=new c.Vector2(_[w][x][0],_[w][x][1])).x=S.x*a,S.y=S.y*a,M.push(S)}b.push(M)}r.clear(),u.buildPolygon(b,r);var T="";p instanceof d.VectorTileFeature&&(T=p.getId()),r.indices.forEach((function(t){return e.indices.push(t+i)})),i+=n,n=0;var A=this.indices.length-v;this.partials.has(T)?this.partials.get(T).push(new g.Range(v,A)):this.partials.set(T,[new g.Range(v,A)])}else{if(null==y||y.has("fill-outlined"))continue;o.clear();for(v=this.indices.length,_=p.getGeometries().geometryCoordinates,w=0;w<_.length;++w){var L=[];for(x=0;x<_[w].length;++x){var S;(S=new c.Vector2(_[w][x][0],_[w][x][1])).x=S.x*a,S.y=S.y*a,L.push(S)}o.buildPolyLine(L)}o.indices.forEach((function(t){return e.indices.push(t+i)})),i+=n,n=0;A=this.indices.length-v,T="";p instanceof d.VectorTileFeature&&(T=p.getId()),this.partials.set(T,[new g.Range(v,A)])}}},e.prototype.destroy=function(){this.model&&this.model.destroy()},e.defaultFillColor=p.Color.fromHex("#555555"),e.defaultStrokeColor=p.Color.fromHex("#555555"),e.defaultStrokeWidth=5,e}(o.LayerData);e.GeoJsonLayerData=m},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.layerType=t}return t.prototype.getType=function(){return this.layerType},t}();e.LayerData=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i){this.properties=new Map,this.type=t,this.geometries=e,this.properties=i}return t.prototype.getType=function(){return this.type},t.prototype.getGeometries=function(){return this.geometries},t.prototype.getProperties=function(){return this.properties},t}();e.GeometryTileFeature=n;var r=function(){function t(t){this.features=[],this.name=t}return t.prototype.featureCount=function(){return this.features.length},t.prototype.getFeature=function(t){return this.features[t]},t.prototype.getName=function(){return this.name},t}();e.GeometryTileLayer=r;var o=function(){};e.GeometryTileData=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this._start=t,this._length=e}return Object.defineProperty(t.prototype,"start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),t}();e.Range=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var i=t.call(this)||this;return i.data=e.data,i.width=e.width,i.height=e.height,i}return r(e,t),e.prototype.getData=function(){return this.data},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e}(i(25).LayerProperties);e.RasterLayerProperties=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(22),a=i(0),s=i(42),l=function(t){function e(){var e=t.call(this,a.LayerType.RASTER)||this;return e.texture=null,e}return r(e,t),e.prototype.destroy=function(){this.texture&&this.texture.destroy()},e.prototype.init=function(t){if(t&&t.length>0){var e=t[0];this.properties=e.getProperties()}},e.prototype.upload=function(t,e){if(this.properties){var i=this.properties;this.texture=new s.Texture(t),this.texture.loadImageFromArrayBuffer(i.getData(),i.getWidth(),i.getHeight(),!1,!1,(function(){}))}},e.prototype.getTexture=function(){return this.texture},e}(o.LayerRenderData);e.RasterLayerRenderData=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(96),r=i(200),o=i(201),a=i(23),s=i(97),l=i(0),u=i(2),h=i(203),c=i(80),f=i(118),p=i(204),d=i(205),g=i(81),y=i(28),m=i(14),v=i(74),_=i(24),b=function(){function t(t,e,i,n,r){this.tile=t,this.gl=e,this.style=i,this.format=n,this.language=r;var o=t.getTileCoordinate();this.x=o.getX(),this.y=o.getY(),this.zoom=o.getZoom(),this.scale=Math.pow(2,this.zoom)}return t.prototype.getLayers=function(t){if(this.format==s.VectorFormat.geojson)return t;var e=new r(this.base64ToArrayBuffer(t));return new o.VectorTile(e).layers},t.prototype.getFeatureCollection=function(t,e){var i=t[e];if(this.format==s.VectorFormat.geojson)return null==i||"FeatureCollection"!=i.type||null==i.features||0==i.features.length?null:n.default(i,{maxZoom:this.zoom,buffer:0,extent:u.MapConstants.tileExtend,tolerance:4}).getTile(this.zoom,this.x,this.y).features;for(var r=[],o=0;o<i.length;o++)r.push(i.feature(o));return r},t.prototype.getFeatureProperties=function(t){return this.format==s.VectorFormat.geojson?t.tags:t.properties},t.prototype.getFeatureGeometry=function(t){if(this.format==s.VectorFormat.geojson)return t.geometry;var e=t.loadGeometry().map((function(t){return t.map((function(t){return[t.x,t.y]}))}));return 1==t.type?e[0]:e},t.prototype.parse=function(t){var e=this,i=this.tile.getTileData(),n=this.tile.getTileRenderData(),r=i.addTileLayer(u.LayerConstants.roadTileLayerId,l.LayerType.ROADS),o=i.addTileLayer(u.LayerConstants.labelTileLayerId,l.LayerType.LABEL),s=this.getLayers(t),b=function(t){var b=w.getFeatureCollection(s,t);if(null==b||0==b.length)return"continue";var M=void 0;"roads"===t&&(M=a(_.compareOrderASC));for(var x=function(a){var s=b[a],d=t+"|"+w.zoom+"|"+w.x+"|"+w.y+"|"+a,x=w.getFeatureGeometry(s),T=w.getFeatureProperties(s);switch(s.type){case 1:if("places"!=t&&1!=x.length)return"continue";if(T.coordinates=w.project(x[0],s.extent||u.MapConstants.tileExtend),E=w.style.build(t,"text",w.zoom,T.kind,T.kind_detail)){T.size=E.size,T.color=E.color,T.haloColor=E.halo.color;var A=new c.LabelLayerProperties(t,c.LabelType.PLACE,T,w.language);if(A.getName()&&A.position.length>0)o.addFeature(d,m.GeometryType.Point,new y.GeometryCollection([]),A),(j=new p.LabelLayerRenderData(w.gl)).init([o.getFeature(o.featureCount()-1)]),n.setLayerRenderData(d,j)}break;case 2:case 3:var L=s.type,S=w.style.build(t,L==m.GeometryType.LineString?"lines":"polygons",w.zoom,T.kind,T.kind_detail);if(null==S)return"continue";var E,I=new y.GeometryCollection(x),P=l.LayerType.SURFACE;if(L==m.GeometryType.LineString)if("roads"===t){if(P=l.LayerType.ROADS,1==x.length)if(T.coordinates=x[0].map((function(t){return e.project(t,s.extent||u.MapConstants.tileExtend)})),E=w.style.build(t,"text",w.zoom,T.kind,T.kind_detail)){T.size=E.size,T.color=E.color,T.haloColor=E.halo.color;var C=new c.LabelLayerProperties(t,c.LabelType.ROAD,T,w.language);if(C.getName()&&C.position.length>0)o.addFeature(C.getId(),m.GeometryType.LineString,I,C),(j=new p.LabelLayerRenderData(w.gl)).init([o.getFeature(o.featureCount()-1)]),n.setLayerRenderData(C.getId(),j)}}else if("boundaries"===t){P=l.LayerType.BOUNDARY;var O=h.BoundaryLabelLayerProperties.getNameLeft(T,w.language),R=h.BoundaryLabelLayerProperties.getNameRight(T,w.language);if(O&&R&&1==x.length){T.coordinates=x[0].map((function(t){return e.project(t,s.extent||u.MapConstants.tileExtend)}));var D=w.style.build(t,"text",w.zoom,T.kind,T.kind_detail);if(D){T.size=D.size,T.color=D.color,T.haloColor=D.halo.color;var k=new h.BoundaryLabelLayerProperties(O,t,"left",T,w.language);o.addFeature(k.getId(),m.GeometryType.LineString,I,k);var B=new p.LabelLayerRenderData(w.gl);B.init([o.getFeature(o.featureCount()-1)]),n.setLayerRenderData(k.getId(),B);var U=new h.BoundaryLabelLayerProperties(R,t,"right",T,w.language);o.addFeature(U.getId(),m.GeometryType.LineString,I,U);var N=new p.LabelLayerRenderData(w.gl);N.init([o.getFeature(o.featureCount()-1)]),n.setLayerRenderData(U.getId(),N)}}}switch(L){case m.GeometryType.LineString:T.width=S.width,T.color=S.color,T.outlineWidth=S.outline.width,T.outlineColor=S.outline.color;break;case m.GeometryType.Polygon:T.color=S.color}var F=new f.VectorLayerProperties(d,t,T,w.language);if(P==l.LayerType.ROADS)r.addFeature(d,L,I,F),M=M.insert(new _.Order(a,F.getSortRank()),r.getFeature(r.featureCount()-1));else{var j,V=new v.TileLayer(d,P);V.addFeature(d,L,I,F),i.setTileLayer(d,V),(j=new g.SurfaceLayerRenderData(P,w.gl)).init(V.getFeatures()),n.setLayerRenderData(d,j)}break;default:console.error("Invalid type")}},T=0;T<b.length;T++)x(T);if("roads"===t){var A="",L="",S=0,E=0,I=[];if(M.forEach((function(t,i){var r=i.getProperties();if(r.getColor().code==A&&r.getOutlineColor().code==L&&Math.round(r.getWidth())==S&&Math.round(r.getOutlineWidth())==E)I.push(i);else{if(I.length>0){var o=new d.RoadLayerRenderData(e.gl);o.init(I),n.setLayerRenderData(I[0].getId(),o)}I=[i],A=r.getColor().code,S=Math.round(r.getWidth()),L=r.getOutlineColor().code,E=Math.round(r.getOutlineWidth())}})),I.length>0){var P=new d.RoadLayerRenderData(w.gl);P.init(I),n.setLayerRenderData(I[0].getId(),P)}}},w=this;for(var M in s)b(M)},t.prototype.project=function(t,e){var i=e*this.scale,n=e*this.x,r=e*this.y,o=180-360*(t[1]+r)/i;return[360*(t[0]+n)/i-180,360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90]},t.prototype.base64ToArrayBuffer=function(t){for(var e=window.atob(t),i=e.length,n=new Uint8Array(i),r=0;r<i;r++)n[r]=e.charCodeAt(r);return n.buffer},t}();e.VectorTileParser=b},function(t,e,i){"use strict";t.exports=r;var n=i(115);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var o="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function a(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function s(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function l(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=t;r--)i.buf[r+n]=i.buf[r]}function u(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function h(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function g(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function y(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function m(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function v(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function _(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,o=this.pos;this.type=7&n,t(r,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=v(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=v(this.buf,this.pos)+4294967296*v(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=v(this.buf,this.pos)+4294967296*b(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,r,o=i.buf;if(r=o[i.pos++],n=(112&r)>>4,r<128)return s(t,n,e);if(r=o[i.pos++],n|=(127&r)<<3,r<128)return s(t,n,e);if(r=o[i.pos++],n|=(127&r)<<10,r<128)return s(t,n,e);if(r=o[i.pos++],n|=(127&r)<<17,r<128)return s(t,n,e);if(r=o[i.pos++],n|=(127&r)<<24,r<128)return s(t,n,e);if(r=o[i.pos++],n|=(1&r)<<31,r<128)return s(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&o?function(t,e,i){return o.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var n="",r=e;for(;r<i;){var o,a,s,l=t[r],u=null,h=l>239?4:l>223?3:l>191?2:1;if(r+h>i)break;1===h?l<128&&(u=l):2===h?128==(192&(o=t[r+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===h?(o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===h&&(o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,h=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),r+=h}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==r.Bytes)return t.push(this.readVarint(e));var i=a(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==r.Bytes)return t.push(this.readSVarint());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==r.Bytes)return t.push(this.readBoolean());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==r.Bytes)return t.push(this.readFloat());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==r.Bytes)return t.push(this.readDouble());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed32());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed32());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed64());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed64());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),_(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),_(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),_(this.buf,-1&t,this.pos),_(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),_(this.buf,-1&t,this.pos),_(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){n>56319||o+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&l(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&l(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,r.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,u,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,m,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,i){t.exports.VectorTile=i(202),t.exports.VectorTileFeature=i(117),t.exports.VectorTileLayer=i(116)},function(t,e,i){"use strict";var n=i(116);function r(t,e,i){if(3===t){var r=new n(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r)}}t.exports=function(t,e){this.layers=t.readFields(r,{},e)}},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(65),a=i(80),s=function(t){function e(e,i,n,r,o){var s=t.call(this,i,a.LabelType.BOUNDARY,r,o)||this;return s.id=s.id+"|"+n,s.name=e,s.align=n,s}return r(e,t),e.prototype.setId=function(t){this.id=t},e.getNameLeft=function(t,e){return t[e==o.MapLanguage.vi?"name:left:vi":"name:left:en"]||t["name:left"]},e.getNameRight=function(t,e){return t[e==o.MapLanguage.vi?"name:right:vi":"name:right:en"]||t["name:right"]},e}(a.LabelLayerProperties);e.BoundaryLabelLayerProperties=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(14),s=i(22),l=i(39),u=i(1),h=i(19),c=i(7),f=i(3),p=function(t){function e(e){var i=t.call(this,o.LayerType.LABEL)||this;return i.gl=e,i.lineCoords=[],i.screenLineCoords=[],i}return r(e,t),e.prototype.init=function(t){if(0!=t.length)for(var e=u.MapUtils.getTileSize(),i=0;i<t.length;++i){var n=t[i];if(n.getType()==a.GeometryType.Point||n.getType()==a.GeometryType.LineString)if(this.properties=n.getProperties(),this.properties){if(n.getType()==a.GeometryType.Point)return;for(var r=n.getGeometries().geometryCoordinates,o=0;o<r.length;++o){for(var s=0;s<r[o].length;++s){var h=new l(r[o][s][0],r[o][s][1]);h.x*=e,h.y*=e,this.lineCoords.push(h)}break}this.pathLength=this.calculatePathLength(this.lineCoords);break}}},e.prototype.upload=function(t,e){},e.prototype.destroy=function(){},e.prototype.calculatePathLength=function(t){for(var e=0,i=0;i<t.length-1;++i){var n=t[i];e+=t[i+1].dist(n)}return e},e.prototype.setTextData=function(t){this.textData=t},e.prototype.getTextData=function(){return this.textData},e.prototype.setCameraPosition=function(t){var e=!1;return this.camera?this.camera.getTilt()!=t.getTilt()||this.camera.getBearing()!=t.getBearing()||this.camera.getZoom()!=t.getZoom()?e=!0:this.camera.getTarget().equals(t.getTarget())||0!=t.getTilt()&&(e=!0):(this.camera=new h.CameraPosition([0,0],0,0,0),e=!0),e&&(this.camera.setTarget(t.getTarget()),this.camera.setTilt(t.getTilt()),this.camera.setBearing(t.getBearing()),this.camera.setZoom(t.getZoom())),e},e.prototype.buildScreenLineCoords=function(t,e,i,n){var r=this;this.screenLineCoords=[],this.lineCoords.forEach((function(o){var a=c.GeometryUtils.pixelCoordinateToScreenCoordinate(new f.Vector2(i.x+o.x*n,i.y-o.y*n),t,e,0);r.screenLineCoords.push(new l(a.x,a.y))})),this.pathLength=this.calculatePathLength(this.screenLineCoords)},e.prototype.getScreenLineCoords=function(){return this.screenLineCoords},e.prototype.getLineCoordinates=function(){return this.lineCoords},e}(s.LayerRenderData);e.LabelLayerRenderData=p},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(27),a=i(8),s=i(3),l=i(0),u=i(14),h=i(1),c=i(38),f=function(t){function e(e){var i=t.call(this,l.LayerType.ROADS)||this;return i.gl=e,i}return r(e,t),e.prototype.init=function(t){if(0!=t.length){this.properties=t[0].getProperties();var e=this.properties.getWidth();if(!(e<=0)){var i=h.MapUtils.getTileSize(),n=[],r=new c.PolylineBuilderContext;r.lineCapType=c.LineCapType.Round,r.lineJoinType=c.LineJoinType.Round,r.addVertex=function(t,e,i){n.push(t.x,t.y,e.x,e.y,i.x,i.y)},t.forEach((function(t){if(t.getType()==u.GeometryType.LineString)for(var n=t.getGeometries().geometryCoordinates,o=0;o<n.length;++o){for(var a=[],l=0;l<n[o].length;++l){var h=new s.Vector2(n[o][l][0],n[o][l][1]);h.x=h.x*i,h.y=h.y*i,a.push(h)}r.buildPolyLine(a,null,e)}})),this.model=new o.Model(this.gl),this.model.init(n,[new a.AttributeInfo("a_position",2,0,6),new a.AttributeInfo("a_extrude",2,2,6),new a.AttributeInfo("a_uv",2,4,6)],r.indices)}}},e.prototype.upload=function(t,e){},e.prototype.destroy=function(){this.model&&this.model.destroy()},e.prototype.getModel=function(){return this.model},e}(i(22).LayerRenderData);e.RoadLayerRenderData=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(37),r=i(207),o=function(){function t(){var t=this;this.maxConcurrentRequest=5,this.maxWorker=3,this.workers=[],this.pendingTasks=[],this.activedTasks=[],r.WorkerHelper.createWorker(this.maxWorker,(function(e){t.onCompletionTask(e)}),(function(e){t.workers=e,t.executeTasks()}));for(var e=0;e<n.Resource.MAX;e++)this.pendingTasks.push([])}return t.prototype.postTask=function(t){this.pendingTasks[t.type].unshift(t),this.executeTasks()},t.prototype.executeTasks=function(){if(!(this.activedTasks.length>this.maxConcurrentRequest))for(var t=0,e=this.workers;t<e.length;t++){var i=e[t];if(i.canExecuteTask()&&this.hasTask()){var n=this.getTask();this.activedTasks.push(n),n.worker=i,i.executeTask(n)}}},t.prototype.hasTask=function(){for(var t=0;t<n.Resource.MAX;t++)if(this.pendingTasks[t].length>0)return!0;return!1},t.prototype.getTask=function(){for(var t=0;t<n.Resource.MAX;t++)if(this.pendingTasks[t].length>0)return this.pendingTasks[t].pop();return null},t.prototype.cancelTask=function(t){if(t){var e=this.removeTask(t.id);null!=e&&(e.worker&&e.worker.cancel(e),e.completion&&e.completion(new n.ResponseTask(t.id)))}},t.prototype.onCompletionTask=function(t){var e=this.activedTasks.findIndex((function(e){return e.id==t.id}));if(e<0)this.executeTasks();else{var i=this.activedTasks[e];this.activedTasks.splice(e,1),i.completion&&i.completion(t),this.executeTasks()}},t.prototype.removeTask=function(t){for(var e=0;e<n.Resource.MAX;e++){var i=this.pendingTasks[e].findIndex((function(e){return e.id==t}));if(i>=0){var r=this.pendingTasks[e][i];return this.pendingTasks[e].splice(i,1),r}}var o=this.activedTasks.findIndex((function(e){return e.id==t}));if(o>=0){r=this.activedTasks[o];return this.activedTasks.splice(o,1),r}return null},t}();e.TaskManager=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(208),r=i(37),o=i(264),a=i(265),s=i(266),l=function(){function t(t){this.id=t}return t.prototype.abort=function(){null!=this.request&&this.request.abort()},t}(),u=function(){function t(){}return t.createWorker=function(t,e,i){var n=this.workerUrl,r=new XMLHttpRequest;r.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){for(var n=new Blob([this.responseText],{type:"application/javascript"}),r=window.URL.createObjectURL(n),o=[],s=function(t){var i=new Worker(r),n=new a.TaskWorker(i);i.onmessage=function(t){var i=t.data;n.finishedTask(),e(i)},o.push(n)},l=0;l<t;l++)s();i(o)}},r.open("GET",n),r.setRequestHeader("Accept","*/*"),r.responseType="text",r.send()},Object.defineProperty(t,"workerUrl",{get:function(){var e="";if(t.scriptUrl)e=t.scriptUrl;else for(var i=document.getElementsByTagName("script"),n=0;n<i.length;++n){var r=i[n];if(r.src.indexOf("map4d.vn")>-1&&r.src.indexOf("/api/js")>-1){e=r.src;break}}return e},enumerable:!0,configurable:!0}),t.setupWorkerThread=function(){var t=this;self.onmessage=function(e){var i=e.data;i.execute?t.execute(JSON.parse(i.payload)):t.cancel(JSON.parse(i.payload))}},t.getTexture=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==i.status){e.success=!0;var o=n(this.response);if(!o)return e.success=!1,void postMessage(e);o.data=o.data.buffer,e.data=o,postMessage(e,[e.data.data])}else e.success=!1,postMessage(e)}},i.open("GET",t.url),i.responseType="arraybuffer",i.send(),e.request=i},t.getModel=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==i.status){e.success=!0;var n=s.ObjModelLoader.loadModel(this.responseText,!0);e.data=n,null!=n&&n.length>0?postMessage(e,[e.data[0].data]):(e.success=!1,postMessage(e))}else e.success=!1,postMessage(e)}},i.open("GET",t.url),i.send(),e.request=i},t.getTile=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==i.status){e.success=!0;var o=JSON.parse(i.responseText);if(null==o.result)return e.success=!1,void postMessage(e);var a=o.result.rasterTile;if(null==a||a.startsWith("data:image"))o.result.rasterTile=null;else{var s=n(a="data:image;base64,"+a);s?(s.data=s.data.buffer,o.result.rasterTile=s):o.result.rasterTile=null}e.data=o,null!=o.result.rasterTile?postMessage(e,[e.data.result.rasterTile.data]):postMessage(e)}else e.success=!1,postMessage(e)}},i.open(t.method,t.url,!0),null!=t.params&&i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Accept","application/json"),this.setHeaderInfo(i),i.send(t.params),e.request=i},t.getOverlayData=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);200==i.status?(e.success=!0,e.data=i.responseText,postMessage(e)):(e.success=!1,postMessage(e))}},i.open(t.method,t.url,!0),null!=t.params&&i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Accept","application/json"),i.send(t.params),e.request=i},t.setHeaderInfo=function(t){},t.getWeather=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==i.status){e.success=!0;var n=JSON.parse(i.responseText);e.data=n,postMessage(e)}else e.success=!1,postMessage(e)}},i.open(t.method,t.url,!0),null!=t.params&&i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Accept","application/json"),this.setHeaderInfo(i),i.send(t.params),e.request=i},t.execute=function(t){var e=new l(t.id);switch(this.executeTasks.push(e),t.type){case r.Resource.Texture:case r.Resource.CustomTexture:case r.Resource.TileOverlay:this.getTexture(t,e);break;case r.Resource.Tile:this.getTile(t,e);break;case r.Resource.BuildingOverlay:case r.Resource.POIOverlay:this.getOverlayData(t,e);break;case r.Resource.Model:case r.Resource.CustomModel:this.getModel(t,e)}},t.cancel=function(t){var e=this.removeTask(t.id);null!=e&&e.abort()},t.removeTask=function(t){var e=this.executeTasks.findIndex((function(e){return e.id==t}));if(e>=0){var i=this.executeTasks[e];return this.executeTasks.splice(e,1),i}return null},t.scriptUrl="",t.executeTasks=[],t}();e.WorkerHelper=u,o.Thread.isWorker&&u.setupWorkerThread(),o.Thread.isWorker||(document.currentScript.onload=function(t){var e=null!=t.path&&t.path.length>0?t.path[0].src:null,i=null!=t.currentTarget?t.currentTarget.src:null,n=null!=t.target?t.target.src:null;u.scriptUrl=e||i||n,window.__INIT_MAP__&&window.__INIT_MAP__()})},function(t,e,i){"use strict";var n=i(209),r=i(120);function o(t,e){if(!(t=r(t)))return null;e?"string"==typeof e&&(e={type:e}):e={};var i=e.type;if(!i){if(!(i=n(new Uint8Array(t))))return null;if(!o[i=i.mime])throw Error("Type `"+i+"` does not seem to be supported")}return o[i](t,e)}t.exports=o,o.png=o["image/png"]=i(217),o.gif=o["image/gif"]=i(246),o["image/jpeg"]=o["image/jpg"]=o.jpg=o.jpeg=i(248),o.bmp=o["image/bmp"]=o["image/bitmap"]=i(253),o.tiff=o["image/tiff"]=i(257),o.webp=o["image/webp"]=i(263)},function(t,e,i){"use strict";const n=i(210),r=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),o=t=>{const e=n(t);return r.has(e&&e.ext)?e:null};t.exports=o,t.exports.default=o,Object.defineProperty(o,"minimumBytes",{value:n.minimumBytes})},function(module,exports,__webpack_require__){"use strict";(function(Buffer){const toBytes=t=>[...t].map(t=>t.charCodeAt(0)),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let i=t[e],n=1,r=0;for(;++r<8;)n*=256,i+=t[e+r]*n;return i}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const i=(t,i)=>{i=Object.assign({offset:0},i);for(let n=0;n<t.length;n++)if(i.mask){if(t[n]!==(i.mask[n]&e[n+i.offset]))return!1}else if(t[n]!==e[n+i.offset])return!1;return!0},n=(t,e)=>i(toBytes(t),e);if(i([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(i([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(i([71,73,70]))return{ext:"gif",mime:"image/gif"};if(i([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(i([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((i([73,73,42,0])||i([77,77,0,42]))&&i([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i([73,73,42,0])||i([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(i([66,77]))return{ext:"bmp",mime:"image/bmp"};if(i([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(i([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(i([80,75,3,4])){if(i([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(i(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(n("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(n("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(n("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex((t,i,n)=>i>=e&&80===n[i]&&75===n[i+1]&&3===n[i+2]&&4===n[i+3]);let r=0,o=!1,a=null;do{const s=r+30;if(o||(o=i(oxmlContentTypes,{offset:s})||i(oxmlRels,{offset:s})),a||(n("word/",{offset:s})?a={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:n("ppt/",{offset:s})?a={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:n("xl/",{offset:s})&&(a={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),o&&a)return a;r=t(e,s)}while(r>=0);if(a)return a}if(i([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(i([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(i([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(i([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(i([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(i([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(i([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(i([51,103,112,53])||i([0,0,0])&&i([102,116,121,112],{offset:4})&&(i([109,112,52,49],{offset:8})||i([109,112,52,50],{offset:8})||i([105,115,111,109],{offset:8})||i([105,115,111,50],{offset:8})||i([109,109,112,52],{offset:8})||i([77,52,86],{offset:8})||i([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(i([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(i([26,69,223,163])){const t=e.subarray(4,4100),i=t.findIndex((t,e,i)=>66===i[e]&&130===i[e+1]);if(-1!==i){const e=i+3,n=i=>[...i].every((i,n)=>t[e+n]===i.charCodeAt(0));if(n("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(n("webm"))return{ext:"webm",mime:"video/webm"}}}if(i([0,0,0,20,102,116,121,112,113,116,32,32])||i([102,114,101,101],{offset:4})||i([102,116,121,112,113,116,32,32],{offset:4})||i([109,100,97,116],{offset:4})||i([109,111,111,118],{offset:4})||i([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(i([82,73,70,70])){if(i([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(i([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(i([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(i([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const n=readUInt64LE(e,t+16);if(i([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(i([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(i([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=n}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(i([0,0,1,186])||i([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(i([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<e.length-16;t++){if(i([73,68,51],{offset:t})||i([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(i([255,228],{offset:t,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(i([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(i([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(i([79,103,103,83]))return i([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:i([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:i([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:i([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:i([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(i([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(i([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(i([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(i([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(i([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(i([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&i([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(i([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(i([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(i([119,79,70,70])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(i([119,79,70,50])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(i([76,80],{offset:34})&&(i([0,0,1],{offset:8})||i([1,0,2],{offset:8})||i([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(i([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(i([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(i([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(i([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(i([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(i([37,33]))return{ext:"ps",mime:"application/postscript"};if(i([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(i([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(i([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(i([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(i([77,83,67,70])||i([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(i([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(i([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(i([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(i([31,160])||i([31,157]))return{ext:"Z",mime:"application/x-compress"};if(i([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(i([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(i([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(i([71],{offset:4})&&(i([71],{offset:192})||i([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(i([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(i([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(i([0,0,0,12,106,80,32,32,13,10,135,10])){if(i([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(i([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(i([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(i([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(i([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(i([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(i([102,116,121,112],{offset:4})){if(i([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(i([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(i([104,101,105,99],{offset:8})||i([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(i([104,101,118,99],{offset:8})||i([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return i([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:i([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:i([77,80,43])||i([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:i([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:i([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:i([212,195,178,161])||i([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(t){reject(t)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,()=>{})):resolve(readableStream.pipe(t))})})}).call(this,__webpack_require__(4).Buffer)},function(t,e,i){"use strict";e.byteLength=function(t){var e=u(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){var e,i,n=u(t),a=n[0],s=n[1],l=new o(function(t,e,i){return 3*(e+i)/4-i}(0,a,s)),h=0,c=s>0?a-4:a;for(i=0;i<c;i+=4)e=r[t.charCodeAt(i)]<<18|r[t.charCodeAt(i+1)]<<12|r[t.charCodeAt(i+2)]<<6|r[t.charCodeAt(i+3)],l[h++]=e>>16&255,l[h++]=e>>8&255,l[h++]=255&e;2===s&&(e=r[t.charCodeAt(i)]<<2|r[t.charCodeAt(i+1)]>>4,l[h++]=255&e);1===s&&(e=r[t.charCodeAt(i)]<<10|r[t.charCodeAt(i+1)]<<4|r[t.charCodeAt(i+2)]>>2,l[h++]=e>>8&255,l[h++]=255&e);return l},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,o=[],a=0,s=i-r;a<s;a+=16383)o.push(h(t,a,a+16383>s?s:a+16383));1===r?(e=t[i-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)n[s]=a[s],r[a.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function h(t,e,i){for(var r,o,a=[],s=e;s<i;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e,i){"use strict";var n=i(213),r=i(214);function o(t){for(var e=new Uint8Array(t.length),i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e.buffer}t.exports=function(t){if("string"!=typeof t)throw Error("Argument should be a string");return/^data\:/i.test(t)?function(t){var e=(t=t.replace(/\r?\n/g,"")).indexOf(",");if(-1===e||e<=4)throw new TypeError("malformed data-URI");for(var i=t.substring(5,e).split(";"),r=!1,a="US-ASCII",s=0;s<i.length;s++)"base64"==i[s]?r=!0:0==i[s].indexOf("charset=")&&(a=i[s].substring(8));var l=unescape(t.substring(e+1));r&&(l=n(l));var u=o(l);return u.type=i[0]||"text/plain",u.charset=a,u}(t):(r(t)&&(t=n(t)),o(t))}},function(t,e){t.exports=function(t){return atob(t)}},function(t,e,i){!function(i){"use strict";function n(t,e){if(t instanceof Boolean||"boolean"==typeof t)return!1;if(e instanceof Object||(e={}),e.hasOwnProperty("allowBlank")&&!e.allowBlank&&""===t)return!1;var i="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return e.mime&&(i="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+i),!1===e.paddingRequired&&(i="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+i+"$","gi").test(t)}t.exports&&(e=t.exports=n),e.isBase64=n}()},function(t,e,i){var n=i(216);t.exports=function(t,e,i){if(!t)throw new TypeError("must specify data as first parameter");if(i=0|+(i||0),Array.isArray(t)&&t[0]&&"number"==typeof t[0][0]){var r,o,a,s,l=t[0].length,u=t.length*l;e&&"string"!=typeof e||(e=new(n(e||"float32"))(u+i));var h=e.length-i;if(u!==h)throw new Error("source length "+u+" ("+l+"x"+t.length+") does not match destination length "+h);for(r=0,a=i;r<t.length;r++)for(o=0;o<l;o++)e[a++]=null===t[r][o]?NaN:t[r][o]}else if(e&&"string"!=typeof e)e.set(t,i);else{var c=n(e||"float32");if(Array.isArray(t)||"array"===e)for(e=new c(t.length+i),r=0,a=i,s=e.length;a<s;a++,r++)e[a]=null===t[r]?NaN:t[r];else 0===i?e=new c(t):(e=new c(t.length+i)).set(t,i)}return e}},function(t,e){t.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},function(t,e,i){"use strict";(function(e){var n=i(218).PNG,r=i(120);t.exports=function(t,i){var o=n.sync.read(e.from(t));return{data:new Uint8Array(r(o.data)),width:0|o.width,height:0|o.height}}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(t,n){var r=i(29),o=i(58),a=i(231),s=i(238),l=i(241),u=e.PNG=function(e){o.call(this),e=e||{},this.width=0|e.width,this.height=0|e.height,this.data=this.width>0&&this.height>0?new t(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new a(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(t){this.data=t,this.emit("parsed",t)}.bind(this)),this._packer=new s(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};r.inherits(u,o),u.sync=l,u.prototype.pack=function(){return this.data&&this.data.length?(n.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},u.prototype.parse=function(t,e){var i,n;e&&(i=function(t){this.removeListener("error",n),this.data=t,e(null,this)}.bind(this),n=function(t){this.removeListener("parsed",i),e(t,null)}.bind(this),this.once("parsed",i),this.once("error",n));return this.end(t),this},u.prototype.write=function(t){return this._parser.write(t),!0},u.prototype.end=function(t){this._parser.end(t)},u.prototype._metadata=function(t){this.width=t.width,this.height=t.height,this.emit("metadata",t)},u.prototype._gamma=function(t){this.gamma=t},u.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},u.bitblt=function(t,e,i,n,r,o,a,s){if(n|=0,r|=0,o|=0,a|=0,s|=0,(i|=0)>t.width||n>t.height||i+r>t.width||n+o>t.height)throw new Error("bitblt reading outside image");if(a>e.width||s>e.height||a+r>e.width||s+o>e.height)throw new Error("bitblt writing outside image");for(var l=0;l<o;l++)t.data.copy(e.data,(s+l)*e.width+a<<2,(n+l)*t.width+i<<2,(n+l)*t.width+i+r<<2)},u.prototype.bitblt=function(t,e,i,n,r,o,a){return u.bitblt(this,t,e,i,n,r,o,a),this},u.adjustGamma=function(t){if(t.gamma){for(var e=0;e<t.height;e++)for(var i=0;i<t.width;i++)for(var n=t.width*e+i<<2,r=0;r<3;r++){var o=t.data[n+r]/255;o=Math.pow(o,1/2.2/t.gamma),t.data[n+r]=Math.round(255*o)}t.gamma=0}},u.prototype.adjustGamma=function(){u.adjustGamma(this)}}).call(this,i(4).Buffer,i(18))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){},function(t,e,i){"use strict";var n=i(60).Buffer,r=i(222);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var e,i,r,o=n.allocUnsafe(t>>>0),a=this.head,s=0;a;)e=a.data,i=o,r=s,e.copy(i,r),s+=a.data.length,a=a.next;return o},t}(),r&&r.inspect&&r.inspect.custom&&(t.exports.prototype[r.inspect.custom]=function(){var t=r.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,i){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(r.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i(224),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(32))},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var n,r,o,a,s,l=1,u={},h=!1,c=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick((function(){d(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},n=function(t){o.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,n=function(t){var e=c.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):n=function(t){setTimeout(d,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&d(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),n=function(e){t.postMessage(a+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var r={callback:t,args:e};return u[l]=r,n(l),l++},f.clearImmediate=p}function p(t){delete u[t]}function d(t){if(h)setTimeout(d,0,t);else{var e=u[t];if(e){h=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(void 0,i)}}(e)}finally{p(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(32),i(18))},function(t,e,i){(function(e){function i(t){try{if(!e.localStorage)return!1}catch(t){return!1}var i=e.localStorage[t];return null!=i&&"true"===String(i).toLowerCase()}t.exports=function(t,e){if(i("noDeprecation"))return t;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}).call(this,i(32))},function(t,e,i){"use strict";t.exports=o;var n=i(125),r=i(44);function o(t){if(!(this instanceof o))return new o(t);n.call(this,t)}r.inherits=i(33),r.inherits(o,n),o.prototype._transform=function(t,e,i){i(null,t)}},function(t,e,i){t.exports=i(84)},function(t,e,i){t.exports=i(34)},function(t,e,i){t.exports=i(83).Transform},function(t,e,i){t.exports=i(83).PassThrough},function(t,e,i){"use strict";var n=i(29),r=i(45),o=i(130),a=i(237),s=i(134),l=i(136),u=i(137),h=t.exports=function(t){o.call(this),this._parser=new s(t,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=t,this.writable=!0,this._parser.start()};n.inherits(h,o),h.prototype._handleError=function(t){this.emit("error",t),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},h.prototype._inflateData=function(t){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=r.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{var e=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,i=Math.max(e,r.Z_MIN_CHUNK);this._inflate=r.createInflate({chunkSize:i});var n=e,o=this.emit.bind(this,"error");this._inflate.on("error",(function(t){n&&o(t)})),this._filter.on("complete",this._complete.bind(this));var a=this._filter.write.bind(this._filter);this._inflate.on("data",(function(t){n&&(t.length>n&&(t=t.slice(0,n)),n-=t.length,a(t))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(t)},h.prototype._handleMetaData=function(t){this._metaData=t,this._bitmapInfo=Object.create(t),this._filter=new a(this._bitmapInfo)},h.prototype._handleTransColor=function(t){this._bitmapInfo.transColor=t},h.prototype._handlePalette=function(t){this._bitmapInfo.palette=t},h.prototype._simpleTransparency=function(){this._metaData.alpha=!0},h.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},h.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},h.prototype._complete=function(t){if(!this.errord){try{var e=l.dataToBitMap(t,this._bitmapInfo),i=u(e,this._bitmapInfo);e=null}catch(t){return void this._handleError(t)}this.emit("parsed",i)}}},function(t,e,i){"use strict";(function(t,n){var r=i(85),o=i(86),a=i(126),s=i(129),l=i(88);for(var u in l)e[u]=l[u];e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7;function h(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}h.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,r(this.init_done,"close before init"),r(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?a.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||s.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},h.prototype.write=function(t,e,i,n,r,o,a){return this._write(!0,t,e,i,n,r,o,a)},h.prototype.writeSync=function(t,e,i,n,r,o,a){return this._write(!1,t,e,i,n,r,o,a)},h.prototype._write=function(i,o,a,s,l,u,h,c){if(r.equal(arguments.length,8),r(this.init_done,"write before init"),r(this.mode!==e.NONE,"already finalized"),r.equal(!1,this.write_in_progress,"write already in progress"),r.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,r.equal(!1,void 0===o,"must provide flush value"),this.write_in_progress=!0,o!==e.Z_NO_FLUSH&&o!==e.Z_PARTIAL_FLUSH&&o!==e.Z_SYNC_FLUSH&&o!==e.Z_FULL_FLUSH&&o!==e.Z_FINISH&&o!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==a&&(a=t.alloc(0),l=0,s=0),this.strm.avail_in=l,this.strm.input=a,this.strm.next_in=s,this.strm.avail_out=c,this.strm.output=u,this.strm.next_out=h,this.flush=o,!i)return this._process(),this._checkError()?this._afterSync():void 0;var f=this;return n.nextTick((function(){f._process(),f._after()})),this},h.prototype._afterSync=function(){var t=this.strm.avail_out,e=this.strm.avail_in;return this.write_in_progress=!1,[e,t]},h.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflate(this.strm,this.flush);break;case e.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=s.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=s.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=s.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=s.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},h.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},h.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,e=this.strm.avail_in;this.write_in_progress=!1,this.callback(e,t),this.pending_close&&this.close()}},h.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},h.prototype.init=function(t,i,n,o,a){r(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),r(t>=8&&t<=15,"invalid windowBits"),r(i>=-1&&i<=9,"invalid compression level"),r(n>=1&&n<=9,"invalid memlevel"),r(o===e.Z_FILTERED||o===e.Z_HUFFMAN_ONLY||o===e.Z_RLE||o===e.Z_FIXED||o===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(i,t,n,o,a),this._setDictionary()},h.prototype.params=function(){throw new Error("deflateParams Not supported")},h.prototype.reset=function(){this._reset(),this._setDictionary()},h.prototype._init=function(t,i,n,r,l){switch(this.level=t,this.windowBits=i,this.memLevel=n,this.strategy=r,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=s.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=l,this.write_in_progress=!1,this.init_done=!0},h.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=a.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},h.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=a.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=s.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=h}).call(this,i(4).Buffer,i(18))},function(t,e,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,s,l=a(t),u=1;u<arguments.length;u++){for(var h in i=Object(arguments[u]))r.call(i,h)&&(l[h]=i[h]);if(n){s=n(i);for(var c=0;c<s.length;c++)o.call(i,s[c])&&(l[s[c]]=i[s[c]])}}return l}},function(t,e,i){"use strict";var n=i(30);function r(t){for(var e=t.length;--e>=0;)t[e]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);r(u);var h=new Array(60);r(h);var c=new Array(512);r(c);var f=new Array(256);r(f);var p=new Array(29);r(p);var d,g,y,m=new Array(30);function v(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function _(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function b(t){return t<256?c[t]:c[256+(t>>>7)]}function w(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function M(t,e,i){t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,w(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function x(t,e,i){M(t,i[2*e],i[2*e+1])}function T(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function A(t,e,i){var n,r,o=new Array(16),a=0;for(n=1;n<=15;n++)o[n]=a=a+i[n-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=T(o[s]++,s))}}function L(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function S(t){t.bi_valid>8?w(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function E(t,e,i,n){var r=2*e,o=2*i;return t[r]<t[o]||t[r]===t[o]&&n[e]<=n[i]}function I(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&E(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!E(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function P(t,e,i){var n,r,s,l,u=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],r=t.pending_buf[t.l_buf+u],u++,0===n?x(t,r,e):(x(t,(s=f[r])+256+1,e),0!==(l=o[s])&&M(t,r-=p[s],l),x(t,s=b(--n),i),0!==(l=a[s])&&M(t,n-=m[s],l))}while(u<t.last_lit);x(t,256,e)}function C(t,e){var i,n,r,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=573,i=0;i<l;i++)0!==o[2*i]?(t.heap[++t.heap_len]=u=i,t.depth[i]=0):o[2*i+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=a[2*r+1]);for(e.max_code=u,i=t.heap_len>>1;i>=1;i--)I(t,o,i);r=l;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],I(t,o,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,o[2*r]=o[2*i]+o[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,o[2*i+1]=o[2*n+1]=r,t.heap[1]=r++,I(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,o,a,s,l=e.dyn_tree,u=e.max_code,h=e.stat_desc.static_tree,c=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,p=e.stat_desc.extra_base,d=e.stat_desc.max_length,g=0;for(o=0;o<=15;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<573;i++)(o=l[2*l[2*(n=t.heap[i])+1]+1]+1)>d&&(o=d,g++),l[2*n+1]=o,n>u||(t.bl_count[o]++,a=0,n>=p&&(a=f[n-p]),s=l[2*n],t.opt_len+=s*(o+a),c&&(t.static_len+=s*(h[2*n+1]+a)));if(0!==g){do{for(o=d-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[d]--,g-=2}while(g>0);for(o=d;0!==o;o--)for(n=t.bl_count[o];0!==n;)(r=t.heap[--i])>u||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),n--)}}(t,e),A(o,u,t.bl_count)}function O(t,e,i){var n,r,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=a,a=e[2*(n+1)+1],++s<l&&r===a||(s<u?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,o=r,0===a?(l=138,u=3):r===a?(l=6,u=3):(l=7,u=4))}function R(t,e,i){var n,r,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),n=0;n<=i;n++)if(r=a,a=e[2*(n+1)+1],!(++s<l&&r===a)){if(s<u)do{x(t,r,t.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(x(t,r,t.bl_tree),s--),x(t,16,t.bl_tree),M(t,s-3,2)):s<=10?(x(t,17,t.bl_tree),M(t,s-3,3)):(x(t,18,t.bl_tree),M(t,s-11,7));s=0,o=r,0===a?(l=138,u=3):r===a?(l=6,u=3):(l=7,u=4)}}r(m);var D=!1;function k(t,e,i,r){M(t,0+(r?1:0),3),function(t,e,i,r){S(t),r&&(w(t,i),w(t,~i)),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i,!0)}e._tr_init=function(t){D||(!function(){var t,e,i,n,r,l=new Array(16);for(i=0,n=0;n<28;n++)for(p[n]=i,t=0;t<1<<o[n];t++)f[i++]=n;for(f[i-1]=n,r=0,n=0;n<16;n++)for(m[n]=r,t=0;t<1<<a[n];t++)c[r++]=n;for(r>>=7;n<30;n++)for(m[n]=r<<7,t=0;t<1<<a[n]-7;t++)c[256+r++]=n;for(e=0;e<=15;e++)l[e]=0;for(t=0;t<=143;)u[2*t+1]=8,t++,l[8]++;for(;t<=255;)u[2*t+1]=9,t++,l[9]++;for(;t<=279;)u[2*t+1]=7,t++,l[7]++;for(;t<=287;)u[2*t+1]=8,t++,l[8]++;for(A(u,287,l),t=0;t<30;t++)h[2*t+1]=5,h[2*t]=T(t,5);d=new v(u,o,257,286,15),g=new v(h,a,0,30,15),y=new v(new Array(0),s,0,19,7)}(),D=!0),t.l_desc=new _(t.dyn_ltree,d),t.d_desc=new _(t.dyn_dtree,g),t.bl_desc=new _(t.bl_tree,y),t.bi_buf=0,t.bi_valid=0,L(t)},e._tr_stored_block=k,e._tr_flush_block=function(t,e,i,n){var r,o,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),C(t,t.l_desc),C(t,t.d_desc),a=function(t){var e;for(O(t,t.dyn_ltree,t.l_desc.max_code),O(t,t.dyn_dtree,t.d_desc.max_code),C(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*l[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=r&&(r=o)):r=o=i+5,i+4<=r&&-1!==e?k(t,e,i,n):4===t.strategy||o===r?(M(t,2+(n?1:0),3),P(t,u,h)):(M(t,4+(n?1:0),3),function(t,e,i,n){var r;for(M(t,e-257,5),M(t,i-1,5),M(t,n-4,4),r=0;r<n;r++)M(t,t.bl_tree[2*l[r]+1],3);R(t,t.dyn_ltree,e-1),R(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),P(t,t.dyn_ltree,t.dyn_dtree)),L(t),n&&S(t)},e._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(f[i]+256+1)]++,t.dyn_dtree[2*b(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){M(t,2,3),x(t,256,u),function(t){16===t.bi_valid?(w(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,i){"use strict";t.exports=function(t,e){var i,n,r,o,a,s,l,u,h,c,f,p,d,g,y,m,v,_,b,w,M,x,T,A,L;i=t.state,n=t.next_in,A=t.input,r=n+(t.avail_in-5),o=t.next_out,L=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),l=i.dmax,u=i.wsize,h=i.whave,c=i.wnext,f=i.window,p=i.hold,d=i.bits,g=i.lencode,y=i.distcode,m=(1<<i.lenbits)-1,v=(1<<i.distbits)-1;t:do{d<15&&(p+=A[n++]<<d,d+=8,p+=A[n++]<<d,d+=8),_=g[p&m];e:for(;;){if(p>>>=b=_>>>24,d-=b,0===(b=_>>>16&255))L[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=g[(65535&_)+(p&(1<<b)-1)];continue e}if(32&b){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}w=65535&_,(b&=15)&&(d<b&&(p+=A[n++]<<d,d+=8),w+=p&(1<<b)-1,p>>>=b,d-=b),d<15&&(p+=A[n++]<<d,d+=8,p+=A[n++]<<d,d+=8),_=y[p&v];i:for(;;){if(p>>>=b=_>>>24,d-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=y[(65535&_)+(p&(1<<b)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(M=65535&_,d<(b&=15)&&(p+=A[n++]<<d,(d+=8)<b&&(p+=A[n++]<<d,d+=8)),(M+=p&(1<<b)-1)>l){t.msg="invalid distance too far back",i.mode=30;break t}if(p>>>=b,d-=b,M>(b=o-a)){if((b=M-b)>h&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(x=0,T=f,0===c){if(x+=u-b,b<w){w-=b;do{L[o++]=f[x++]}while(--b);x=o-M,T=L}}else if(c<b){if(x+=u+c-b,(b-=c)<w){w-=b;do{L[o++]=f[x++]}while(--b);if(x=0,c<w){w-=b=c;do{L[o++]=f[x++]}while(--b);x=o-M,T=L}}}else if(x+=c-b,b<w){w-=b;do{L[o++]=f[x++]}while(--b);x=o-M,T=L}for(;w>2;)L[o++]=T[x++],L[o++]=T[x++],L[o++]=T[x++],w-=3;w&&(L[o++]=T[x++],w>1&&(L[o++]=T[x++]))}else{x=o-M;do{L[o++]=L[x++],L[o++]=L[x++],L[o++]=L[x++],w-=3}while(w>2);w&&(L[o++]=L[x++],w>1&&(L[o++]=L[x++]))}break}}break}}while(n<r&&o<s);n-=w=d>>3,p&=(1<<(d-=w<<3))-1,t.next_in=n,t.next_out=o,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=o<s?s-o+257:257-(o-s),i.hold=p,i.bits=d}},function(t,e,i){"use strict";var n=i(30),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,l,u,h,c,f){var p,d,g,y,m,v,_,b,w,M=f.bits,x=0,T=0,A=0,L=0,S=0,E=0,I=0,P=0,C=0,O=0,R=null,D=0,k=new n.Buf16(16),B=new n.Buf16(16),U=null,N=0;for(x=0;x<=15;x++)k[x]=0;for(T=0;T<l;T++)k[e[i+T]]++;for(S=M,L=15;L>=1&&0===k[L];L--);if(S>L&&(S=L),0===L)return u[h++]=20971520,u[h++]=20971520,f.bits=1,0;for(A=1;A<L&&0===k[A];A++);for(S<A&&(S=A),P=1,x=1;x<=15;x++)if(P<<=1,(P-=k[x])<0)return-1;if(P>0&&(0===t||1!==L))return-1;for(B[1]=0,x=1;x<15;x++)B[x+1]=B[x]+k[x];for(T=0;T<l;T++)0!==e[i+T]&&(c[B[e[i+T]]++]=T);if(0===t?(R=U=c,v=19):1===t?(R=r,D-=257,U=o,N-=257,v=256):(R=a,U=s,v=-1),O=0,T=0,x=A,m=h,E=S,I=0,g=-1,y=(C=1<<S)-1,1===t&&C>852||2===t&&C>592)return 1;for(;;){_=x-I,c[T]<v?(b=0,w=c[T]):c[T]>v?(b=U[N+c[T]],w=R[D+c[T]]):(b=96,w=0),p=1<<x-I,A=d=1<<E;do{u[m+(O>>I)+(d-=p)]=_<<24|b<<16|w|0}while(0!==d);for(p=1<<x-1;O&p;)p>>=1;if(0!==p?(O&=p-1,O+=p):O=0,T++,0==--k[x]){if(x===L)break;x=e[i+c[T]]}if(x>S&&(O&y)!==g){for(0===I&&(I=S),m+=A,P=1<<(E=x-I);E+I<L&&!((P-=k[E+I])<=0);)E++,P<<=1;if(C+=1<<E,1===t&&C>852||2===t&&C>592)return 1;u[g=O&y]=S<<24|E<<16|m-h|0}}return 0!==O&&(u[m+O]=x-I<<24|64<<16|0),f.bits=S,0}},function(t,e,i){"use strict";(function(e){var n=i(29),r=i(130),o=i(131),a=t.exports=function(t){r.call(this);var i=[],n=this;this._filter=new o(t,{read:this.read.bind(this),write:function(t){i.push(t)},complete:function(){n.emit("complete",e.concat(i))}}),this._filter.start()};n.inherits(a,r)}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=i(29),r=i(58),o=i(46),a=i(138),s=t.exports=function(t){r.call(this);var e=t||{};this._packer=new a(e),this._deflate=this._packer.createDeflate(),this.readable=!0};n.inherits(s,r),s.prototype.pack=function(t,i,n,r){this.emit("data",new e(o.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(i,n)),r&&this.emit("data",this._packer.packGAMA(r));var a=this._packer.filterData(t,i,n);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(t){this.emit("data",this._packer.packIDAT(t))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(a)}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=i(46);t.exports=function(t,i,r,o){var a,s=-1!==[n.COLORTYPE_COLOR_ALPHA,n.COLORTYPE_ALPHA].indexOf(o.colorType);if(o.colorType===o.inputColorType){var l=(a=new ArrayBuffer(2),new DataView(a).setInt16(0,256,!0),256!==new Int16Array(a)[0]);if(8===o.bitDepth||16===o.bitDepth&&l)return t}var u=16!==o.bitDepth?t:new Uint16Array(t.buffer),h=255,c=n.COLORTYPE_TO_BPP_MAP[o.inputColorType];4!==c||o.inputHasAlpha||(c=3);var f=n.COLORTYPE_TO_BPP_MAP[o.colorType];16===o.bitDepth&&(h=65535,f*=2);var p=new e(i*r*f),d=0,g=0,y=o.bgColor||{};function m(){var t,e,i,r=h;switch(o.inputColorType){case n.COLORTYPE_COLOR_ALPHA:r=u[d+3],t=u[d],e=u[d+1],i=u[d+2];break;case n.COLORTYPE_COLOR:t=u[d],e=u[d+1],i=u[d+2];break;case n.COLORTYPE_ALPHA:r=u[d+1],e=t=u[d],i=t;break;case n.COLORTYPE_GRAYSCALE:e=t=u[d],i=t;break;default:throw new Error("input color type:"+o.inputColorType+" is not supported at present")}return o.inputHasAlpha&&(s||(r/=h,t=Math.min(Math.max(Math.round((1-r)*y.red+r*t),0),h),e=Math.min(Math.max(Math.round((1-r)*y.green+r*e),0),h),i=Math.min(Math.max(Math.round((1-r)*y.blue+r*i),0),h))),{red:t,green:e,blue:i,alpha:r}}void 0===y.red&&(y.red=h),void 0===y.green&&(y.green=h),void 0===y.blue&&(y.blue=h);for(var v=0;v<r;v++)for(var _=0;_<i;_++){var b=m();switch(o.colorType){case n.COLORTYPE_COLOR_ALPHA:case n.COLORTYPE_COLOR:8===o.bitDepth?(p[g]=b.red,p[g+1]=b.green,p[g+2]=b.blue,s&&(p[g+3]=b.alpha)):(p.writeUInt16BE(b.red,g),p.writeUInt16BE(b.green,g+2),p.writeUInt16BE(b.blue,g+4),s&&p.writeUInt16BE(b.alpha,g+6));break;case n.COLORTYPE_ALPHA:case n.COLORTYPE_GRAYSCALE:var w=(b.red+b.green+b.blue)/3;8===o.bitDepth?(p[g]=w,s&&(p[g+1]=b.alpha)):(p.writeUInt16BE(w,g),s&&p.writeUInt16BE(b.alpha,g+2));break;default:throw new Error("unrecognised color Type "+o.colorType)}d+=c,g+=f}return p}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=i(133);var r={0:function(t,e,i,n,r){for(var o=0;o<i;o++)n[r+o]=t[e+o]},1:function(t,e,i,n,r,o){for(var a=0;a<i;a++){var s=a>=o?t[e+a-o]:0,l=t[e+a]-s;n[r+a]=l}},2:function(t,e,i,n,r){for(var o=0;o<i;o++){var a=e>0?t[e+o-i]:0,s=t[e+o]-a;n[r+o]=s}},3:function(t,e,i,n,r,o){for(var a=0;a<i;a++){var s=a>=o?t[e+a-o]:0,l=e>0?t[e+a-i]:0,u=t[e+a]-(s+l>>1);n[r+a]=u}},4:function(t,e,i,r,o,a){for(var s=0;s<i;s++){var l=s>=a?t[e+s-a]:0,u=e>0?t[e+s-i]:0,h=e>0&&s>=a?t[e+s-(i+a)]:0,c=t[e+s]-n(l,u,h);r[o+s]=c}}},o={0:function(t,e,i){for(var n=0,r=e+i,o=e;o<r;o++)n+=Math.abs(t[o]);return n},1:function(t,e,i,n){for(var r=0,o=0;o<i;o++){var a=o>=n?t[e+o-n]:0,s=t[e+o]-a;r+=Math.abs(s)}return r},2:function(t,e,i){for(var n=0,r=e+i,o=e;o<r;o++){var a=e>0?t[o-i]:0,s=t[o]-a;n+=Math.abs(s)}return n},3:function(t,e,i,n){for(var r=0,o=0;o<i;o++){var a=o>=n?t[e+o-n]:0,s=e>0?t[e+o-i]:0,l=t[e+o]-(a+s>>1);r+=Math.abs(l)}return r},4:function(t,e,i,r){for(var o=0,a=0;a<i;a++){var s=a>=r?t[e+a-r]:0,l=e>0?t[e+a-i]:0,u=e>0&&a>=r?t[e+a-(i+r)]:0,h=t[e+a]-n(s,l,u);o+=Math.abs(h)}return o}};t.exports=function(t,i,n,a,s){var l;if("filterType"in a&&-1!==a.filterType){if("number"!=typeof a.filterType)throw new Error("unrecognised filter types");l=[a.filterType]}else l=[0,1,2,3,4];16===a.bitDepth&&(s*=2);for(var u=i*s,h=0,c=0,f=new e((u+1)*n),p=l[0],d=0;d<n;d++){if(l.length>1)for(var g=1/0,y=0;y<l.length;y++){var m=o[l[y]](t,c,u,s);m<g&&(p=l[y],g=m)}f[h]=p,h++,r[p](t,c,u,f,h,s),h+=u,c+=u}return f}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";var n=i(242),r=i(245);e.read=function(t,e){return n(t,e||{})},e.write=function(t,e){return r(t,e)}},function(t,e,i){"use strict";(function(e){var n=!0,r=i(45),o=i(243);r.deflateSync||(n=!1);var a=i(139),s=i(244),l=i(134),u=i(136),h=i(137);t.exports=function(t,i){if(!n)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var c,f,p;var d=[];var g=new a(t);if(new l(i,{read:g.read.bind(g),error:function(t){c=t},metadata:function(t){f=t},gamma:function(t){p=t},palette:function(t){f.palette=t},transColor:function(t){f.transColor=t},inflateData:function(t){d.push(t)},simpleTransparency:function(){f.alpha=!0}}).start(),g.process(),c)throw c;var y,m=e.concat(d);if(d.length=0,f.interlace)y=r.inflateSync(m);else{var v=(1+(f.width*f.bpp*f.depth+7>>3))*f.height;y=o(m,{chunkSize:v,maxLength:v})}if(m=null,!y||!y.length)throw new Error("bad png - invalid inflate data response");var _=s.process(y,f);m=null;var b=u.dataToBitMap(_,f);_=null;var w=h(b,f);return f.data=w,f.gamma=p||0,f}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(n,r){var o=i(85).ok,a=i(45),s=i(29),l=i(4).kMaxLength;function u(t){if(!(this instanceof u))return new u(t);t&&t.chunkSize<a.Z_MIN_CHUNK&&(t.chunkSize=a.Z_MIN_CHUNK),a.Inflate.call(this,t),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,t&&null!=t.maxLength&&(this._maxLength=t.maxLength)}function h(t,e){e&&n.nextTick(e),t._handle&&(t._handle.close(),t._handle=null)}function c(t,e){return function(t,e){if("string"==typeof e&&(e=r.from(e)),!(e instanceof r))throw new TypeError("Not a string or buffer");var i=t._finishFlushFlag;return null==i&&(i=a.Z_FINISH),t._processChunk(e,i)}(new u(e),t)}u.prototype._processChunk=function(t,e,i){if("function"==typeof i)return a.Inflate._processChunk.call(this,t,e,i);var n,s=this,u=t&&t.length,c=this._chunkSize-this._offset,f=this._maxLength,p=0,d=[],g=0;function y(t,e){if(!s._hadError){var i=c-e;if(o(i>=0,"have should not go down"),i>0){var n=s._buffer.slice(s._offset,s._offset+i);if(s._offset+=i,n.length>f&&(n=n.slice(0,f)),d.push(n),g+=n.length,0===(f-=n.length))return!1}return(0===e||s._offset>=s._chunkSize)&&(c=s._chunkSize,s._offset=0,s._buffer=r.allocUnsafe(s._chunkSize)),0===e&&(p+=u-t,u=t,!0)}}this.on("error",(function(t){n=t})),o(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(e,t,p,u,this._buffer,this._offset,c);m=m||this._writeState}while(!this._hadError&&y(m[0],m[1]));if(this._hadError)throw n;if(g>=l)throw h(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+l.toString(16)+" bytes");var v=r.concat(d,g);return h(this),v},s.inherits(u,a.Inflate),t.exports=e=c,e.Inflate=u,e.createInflate=function(t){return new u(t)},e.inflateSync=c}).call(this,i(18),i(4).Buffer)},function(t,e,i){"use strict";(function(t){var n=i(139),r=i(131);e.process=function(e,i){var o=[],a=new n(e);return new r(i,{read:a.read.bind(a),write:function(t){o.push(t)},complete:function(){}}).start(),a.process(),t.concat(o)}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=!0,r=i(45);r.deflateSync||(n=!1);var o=i(46),a=i(138);t.exports=function(t,i){if(!n)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var s=new a(i||{}),l=[];l.push(new e(o.PNG_SIGNATURE)),l.push(s.packIHDR(t.width,t.height)),t.gamma&&l.push(s.packGAMA(t.gamma));var u=s.filterData(t.data,t.width,t.height),h=r.deflateSync(u,s.getDeflateOptions());if(u=null,!h||!h.length)throw new Error("bad png - invalid compressed data response");return l.push(s.packIDAT(h)),l.push(s.packIEND()),e.concat(l)}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=i(247).GifReader;t.exports=function(t,i){var r=new n(e.from(t)),o=new Uint8Array(r.width*r.height*4);return r.decodeAndBlitFrameRGBA(0,o),{data:o,width:r.width,height:r.height}}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";function n(t,e,i,n){for(var r=t[e++],o=1<<r,a=o+1,s=a+1,l=r+1,u=(1<<l)-1,h=0,c=0,f=0,p=t[e++],d=new Int32Array(4096),g=null;;){for(;h<16&&0!==p;)c|=t[e++]<<h,h+=8,1===p?p=t[e++]:--p;if(h<l)break;var y=c&u;if(c>>=l,h-=l,y!==o){if(y===a)break;for(var m=y<s?y:g,v=0,_=m;_>o;)_=d[_]>>8,++v;var b=_;if(f+v+(m!==y?1:0)>n)return void console.log("Warning, gif stream longer than expected.");i[f++]=b;var w=f+=v;for(m!==y&&(i[f++]=b),_=m;v--;)_=d[_],i[--w]=255&_,_>>=8;null!==g&&s<4096&&(d[s++]=g<<8|b,s>=u+1&&l<12&&(++l,u=u<<1|1)),g=y}else s=a+1,u=(1<<(l=r+1))-1,g=null}return f!==n&&console.log("Warning, gif stream shorter than expected."),i}try{e.GifWriter=function(t,e,i,n){var r=0,o=void 0===(n=void 0===n?{}:n).loop?null:n.loop,a=void 0===n.palette?null:n.palette;if(e<=0||i<=0||e>65535||i>65535)throw new Error("Width/Height invalid.");function s(t){var e=t.length;if(e<2||e>256||e&e-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return e}t[r++]=71,t[r++]=73,t[r++]=70,t[r++]=56,t[r++]=57,t[r++]=97;var l=0,u=0;if(null!==a){for(var h=s(a);h>>=1;)++l;if(h=1<<l,--l,void 0!==n.background){if((u=n.background)>=h)throw new Error("Background index out of range.");if(0===u)throw new Error("Background index explicitly passed as 0.")}}if(t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&i,t[r++]=i>>8&255,t[r++]=(null!==a?128:0)|l,t[r++]=u,t[r++]=0,null!==a)for(var c=0,f=a.length;c<f;++c){var p=a[c];t[r++]=p>>16&255,t[r++]=p>>8&255,t[r++]=255&p}if(null!==o){if(o<0||o>65535)throw new Error("Loop count invalid.");t[r++]=33,t[r++]=255,t[r++]=11,t[r++]=78,t[r++]=69,t[r++]=84,t[r++]=83,t[r++]=67,t[r++]=65,t[r++]=80,t[r++]=69,t[r++]=50,t[r++]=46,t[r++]=48,t[r++]=3,t[r++]=1,t[r++]=255&o,t[r++]=o>>8&255,t[r++]=0}var d=!1;this.addFrame=function(e,i,n,o,l,u){if(!0===d&&(--r,d=!1),u=void 0===u?{}:u,e<0||i<0||e>65535||i>65535)throw new Error("x/y invalid.");if(n<=0||o<=0||n>65535||o>65535)throw new Error("Width/Height invalid.");if(l.length<n*o)throw new Error("Not enough pixels for the frame size.");var h=!0,c=u.palette;if(null==c&&(h=!1,c=a),null==c)throw new Error("Must supply either a local or global palette.");for(var f=s(c),p=0;f>>=1;)++p;f=1<<p;var g=void 0===u.delay?0:u.delay,y=void 0===u.disposal?0:u.disposal;if(y<0||y>3)throw new Error("Disposal out of range.");var m=!1,v=0;if(void 0!==u.transparent&&null!==u.transparent&&(m=!0,(v=u.transparent)<0||v>=f))throw new Error("Transparent color index.");if((0!==y||m||0!==g)&&(t[r++]=33,t[r++]=249,t[r++]=4,t[r++]=y<<2|(!0===m?1:0),t[r++]=255&g,t[r++]=g>>8&255,t[r++]=v,t[r++]=0),t[r++]=44,t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&i,t[r++]=i>>8&255,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=255&o,t[r++]=o>>8&255,t[r++]=!0===h?128|p-1:0,!0===h)for(var _=0,b=c.length;_<b;++_){var w=c[_];t[r++]=w>>16&255,t[r++]=w>>8&255,t[r++]=255&w}return r=function(t,e,i,n){t[e++]=i;var r=e++,o=1<<i,a=o-1,s=o+1,l=s+1,u=i+1,h=0,c=0;function f(i){for(;h>=i;)t[e++]=255&c,c>>=8,h-=8,e===r+256&&(t[r]=255,r=e++)}function p(t){c|=t<<h,h+=u,f(8)}var d=n[0]&a,g={};p(o);for(var y=1,m=n.length;y<m;++y){var v=n[y]&a,_=d<<8|v,b=g[_];if(void 0===b){for(c|=d<<h,h+=u;h>=8;)t[e++]=255&c,c>>=8,h-=8,e===r+256&&(t[r]=255,r=e++);4096===l?(p(o),l=s+1,u=i+1,g={}):(l>=1<<u&&++u,g[_]=l++),d=v}else d=b}p(d),p(s),f(1),r+1===e?t[r]=0:(t[r]=e-r-1,t[e++]=0);return e}(t,r,p<2?2:p,l)},this.end=function(){return!1===d&&(t[r++]=59,d=!0),r},this.getOutputBuffer=function(){return t},this.setOutputBuffer=function(e){t=e},this.getOutputBufferPosition=function(){return r},this.setOutputBufferPosition=function(t){r=t}},e.GifReader=function(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw new Error("Invalid GIF 87a/89a header.");var i=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,o=t[e++],a=o>>7,s=1<<(7&o)+1;t[e++],t[e++];var l=null,u=null;a&&(l=e,u=s,e+=3*s);var h=!0,c=[],f=0,p=null,d=0,g=null;for(this.width=i,this.height=r;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,g=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((E=t[e++])>=0))throw Error("Invalid block size");if(0===E)break;e+=E}break;case 249:if(4!==t[e++]||0!==t[e+4])throw new Error("Invalid graphics extension block.");var y=t[e++];f=t[e++]|t[e++]<<8,p=t[e++],0==(1&y)&&(p=null),d=y>>2&7,e++;break;case 254:for(;;){if(!((E=t[e++])>=0))throw Error("Invalid block size");if(0===E)break;e+=E}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var m=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++],M=w>>6&1,x=1<<(7&w)+1,T=l,A=u,L=!1;if(w>>7){L=!0;T=e,A=x,e+=3*x}var S=e;for(e++;;){var E;if(!((E=t[e++])>=0))throw Error("Invalid block size");if(0===E)break;e+=E}c.push({x:m,y:v,width:_,height:b,has_local_palette:L,palette_offset:T,palette_size:A,data_offset:S,data_length:e-S,transparent_index:p,interlaced:!!M,delay:f,disposal:d});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return g},this.frameInfo=function(t){if(t<0||t>=c.length)throw new Error("Frame index out of range.");return c[t]},this.decodeAndBlitFrameBGRA=function(e,r){var o=this.frameInfo(e),a=o.width*o.height,s=new Uint8Array(a);n(t,o.data_offset,s,a);var l=o.palette_offset,u=o.transparent_index;null===u&&(u=256);var h=o.width,c=i-h,f=h,p=4*(o.y*i+o.x),d=4*((o.y+o.height)*i+o.x),g=p,y=4*c;!0===o.interlaced&&(y+=4*i*7);for(var m=8,v=0,_=s.length;v<_;++v){var b=s[v];if(0===f&&(f=h,(g+=y)>=d&&(y=4*c+4*i*(m-1),g=p+(h+c)*(m<<1),m>>=1)),b===u)g+=4;else{var w=t[l+3*b],M=t[l+3*b+1],x=t[l+3*b+2];r[g++]=x,r[g++]=M,r[g++]=w,r[g++]=255}--f}},this.decodeAndBlitFrameRGBA=function(e,r){var o=this.frameInfo(e),a=o.width*o.height,s=new Uint8Array(a);n(t,o.data_offset,s,a);var l=o.palette_offset,u=o.transparent_index;null===u&&(u=256);var h=o.width,c=i-h,f=h,p=4*(o.y*i+o.x),d=4*((o.y+o.height)*i+o.x),g=p,y=4*c;!0===o.interlaced&&(y+=4*i*7);for(var m=8,v=0,_=s.length;v<_;++v){var b=s[v];if(0===f&&(f=h,(g+=y)>=d&&(y=4*c+4*i*(m-1),g=p+(h+c)*(m<<1),m>>=1)),b===u)g+=4;else{var w=t[l+3*b],M=t[l+3*b+1],x=t[l+3*b+2];r[g++]=w,r[g++]=M,r[g++]=x,r[g++]=255}--f}}}}catch(t){}},function(t,e,i){"use strict";var n=i(249),r=i(252);t.exports=function(t,e){var i=n.decode(t);if(!i)throw new Error("Error decoding jpeg");return{data:r(i.data),height:i.height,width:i.width}}},function(t,e,i){var n=i(250),r=i(251);t.exports={encode:n,decode:r}},function(t,e,i){(function(e){function i(t){Math.round;var i,n,r,o,a,s=Math.floor,l=new Array(64),u=new Array(64),h=new Array(64),c=new Array(64),f=new Array(65535),p=new Array(65535),d=new Array(64),g=new Array(64),y=[],m=0,v=7,_=new Array(64),b=new Array(64),w=new Array(64),M=new Array(256),x=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],O=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function R(t,e){for(var i=0,n=0,r=new Array,o=1;o<=16;o++){for(var a=1;a<=t[o];a++)r[e[n]]=[],r[e[n]][0]=i,r[e[n]][1]=o,n++,i++;i*=2}return r}function D(t){for(var e=t[0],i=t[1]-1;i>=0;)e&1<<i&&(m|=1<<v),i--,--v<0&&(255==m?(k(255),k(0)):k(m),v=7,m=0)}function k(t){y.push(t)}function B(t){k(t>>8&255),k(255&t)}function U(t,e,i,n,r){for(var o,a=r[0],s=r[240],l=function(t,e){var i,n,r,o,a,s,l,u,h,c,f=0;for(h=0;h<8;++h){i=t[f],n=t[f+1],r=t[f+2],o=t[f+3],a=t[f+4],s=t[f+5],l=t[f+6];var p=i+(u=t[f+7]),g=i-u,y=n+l,m=n-l,v=r+s,_=r-s,b=o+a,w=o-a,M=p+b,x=p-b,T=y+v,A=y-v;t[f]=M+T,t[f+4]=M-T;var L=.707106781*(A+x);t[f+2]=x+L,t[f+6]=x-L;var S=.382683433*((M=w+_)-(A=m+g)),E=.5411961*M+S,I=1.306562965*A+S,P=.707106781*(T=_+m),C=g+P,O=g-P;t[f+5]=O+E,t[f+3]=O-E,t[f+1]=C+I,t[f+7]=C-I,f+=8}for(f=0,h=0;h<8;++h){i=t[f],n=t[f+8],r=t[f+16],o=t[f+24],a=t[f+32],s=t[f+40],l=t[f+48];var R=i+(u=t[f+56]),D=i-u,k=n+l,B=n-l,U=r+s,N=r-s,F=o+a,j=o-a,V=R+F,Z=R-F,z=k+U,G=k-U;t[f]=V+z,t[f+32]=V-z;var Y=.707106781*(G+Z);t[f+16]=Z+Y,t[f+48]=Z-Y;var W=.382683433*((V=j+N)-(G=B+D)),H=.5411961*V+W,X=1.306562965*G+W,q=.707106781*(z=N+B),J=D+q,Q=D-q;t[f+40]=Q+H,t[f+24]=Q-H,t[f+8]=J+X,t[f+56]=J-X,f++}for(h=0;h<64;++h)c=t[h]*e[h],d[h]=c>0?c+.5|0:c-.5|0;return d}(t,e),u=0;u<64;++u)g[T[u]]=l[u];var h=g[0]-i;i=g[0],0==h?D(n[0]):(D(n[p[o=32767+h]]),D(f[o]));for(var c=63;c>0&&0==g[c];c--);if(0==c)return D(a),i;for(var y,m=1;m<=c;){for(var v=m;0==g[m]&&m<=c;++m);var _=m-v;if(_>=16){y=_>>4;for(var b=1;b<=y;++b)D(s);_&=15}o=32767+g[m],D(r[(_<<4)+p[o]]),D(f[o]),m++}return 63!=c&&D(a),i}function N(t){if(t<=0&&(t=1),t>100&&(t=100),a!=t){(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=s((e[i]*t+50)/100);n<1?n=1:n>255&&(n=255),l[T[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var a=s((r[o]*t+50)/100);a<1?a=1:a>255&&(a=255),u[T[o]]=a}for(var f=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,d=0;d<8;d++)for(var g=0;g<8;g++)h[p]=1/(l[T[p]]*f[d]*f[g]*8),c[p]=1/(u[T[p]]*f[d]*f[g]*8),p++})(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),a=t}}this.encode=function(t,a){(new Date).getTime();a&&N(a),y=new Array,m=0,v=7,B(65496),B(65504),B(16),k(74),k(70),k(73),k(70),k(0),k(1),k(1),k(0),B(1),B(1),k(0),k(0),function(){B(65499),B(132),k(0);for(var t=0;t<64;t++)k(l[t]);k(1);for(var e=0;e<64;e++)k(u[e])}(),function(t,e){B(65472),B(17),k(8),B(e),B(t),k(3),k(1),k(17),k(0),k(2),k(17),k(1),k(3),k(17),k(1)}(t.width,t.height),function(){B(65476),B(418),k(0);for(var t=0;t<16;t++)k(A[t+1]);for(var e=0;e<=11;e++)k(L[e]);k(16);for(var i=0;i<16;i++)k(S[i+1]);for(var n=0;n<=161;n++)k(E[n]);k(1);for(var r=0;r<16;r++)k(I[r+1]);for(var o=0;o<=11;o++)k(P[o]);k(17);for(var a=0;a<16;a++)k(C[a+1]);for(var s=0;s<=161;s++)k(O[s])}(),B(65498),B(12),k(3),k(1),k(0),k(2),k(17),k(3),k(17),k(0),k(63),k(0);var s=0,f=0,p=0;m=0,v=7,this.encode.displayName="_encode_";for(var d,g,M,T,R,F,j,V,Z,z=t.data,G=t.width,Y=t.height,W=4*G,H=0;H<Y;){for(d=0;d<W;){for(F=R=W*H+d,j=-1,V=0,Z=0;Z<64;Z++)F=R+(V=Z>>3)*W+(j=4*(7&Z)),H+V>=Y&&(F-=W*(H+1+V-Y)),d+j>=W&&(F-=d+j-W+4),g=z[F++],M=z[F++],T=z[F++],_[Z]=(x[g]+x[M+256>>0]+x[T+512>>0]>>16)-128,b[Z]=(x[g+768>>0]+x[M+1024>>0]+x[T+1280>>0]>>16)-128,w[Z]=(x[g+1280>>0]+x[M+1536>>0]+x[T+1792>>0]>>16)-128;s=U(_,h,s,i,r),f=U(b,c,f,n,o),p=U(w,c,p,n,o),d+=32}H+=8}if(v>=0){var X=[];X[1]=v+1,X[0]=(1<<v+1)-1,D(X)}return B(65497),new e(y)},function(){(new Date).getTime();t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)M[e]=t(e)}(),i=R(A,L),n=R(I,P),r=R(S,E),o=R(C,O),function(){for(var t=1,e=2,i=1;i<=15;i++){for(var n=t;n<e;n++)p[32767+n]=i,f[32767+n]=[],f[32767+n][1]=i,f[32767+n][0]=n;for(var r=-(e-1);r<=-t;r++)p[32767+r]=i,f[32767+r]=[],f[32767+r][1]=i,f[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256>>0]=38470*t,x[t+512>>0]=7471*t+32768,x[t+768>>0]=-11059*t,x[t+1024>>0]=-21709*t,x[t+1280>>0]=32768*t+8421375,x[t+1536>>0]=-27439*t,x[t+1792>>0]=-5329*t}(),N(t),(new Date).getTime()}()}t.exports=function(t,e){void 0===e&&(e=50);return{data:new i(e).encode(t,e),width:t.width,height:t.height}}}).call(this,i(4).Buffer)},function(t,e,i){(function(e){var i=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function e(){}function i(t,e){for(var i,n,r=0,o=[],a=16;a>0&&!t[a-1];)a--;o.push({children:[],index:0});var s,l=o[0];for(i=0;i<a;i++){for(n=0;n<t[i];n++){for((l=o.pop()).children[l.index]=e[r];l.index>0;)l=o.pop();for(l.index++,o.push(l);o.length<=i;)o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;r++}i+1<a&&(o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return o[0].children}function n(e,i,n,r,o,a,s,l,u){n.precision,n.samplesPerLine,n.scanLines;var h=n.mcusPerLine,c=n.progressive,f=(n.maxH,n.maxV,i),p=0,d=0;function g(){if(d>0)return d--,p>>d&1;if(255==(p=e[i++])){var t=e[i++];if(t)throw new Error("unexpected marker: "+(p<<8|t).toString(16))}return d=7,p>>>7}function y(t){for(var e,i=t;null!==(e=g());){if("number"==typeof(i=i[e]))return i;if("object"!=typeof i)throw new Error("invalid huffman sequence")}return null}function m(t){for(var e=0;t>0;){var i=g();if(null===i)return;e=e<<1|i,t--}return e}function v(t){var e=m(t);return e>=1<<t-1?e:e+(-1<<t)+1}var _=0;var b,w=0;function M(t,e,i,n,r){var o=i%h,a=(i/h|0)*t.v+n,s=o*t.h+r;e(t,t.blocks[a][s])}function x(t,e,i){var n=i/t.blocksPerLine|0,r=i%t.blocksPerLine;e(t,t.blocks[n][r])}var T,A,L,S,E,I,P=r.length;I=c?0===a?0===l?function(t,e){var i=y(t.huffmanTableDC),n=0===i?0:v(i)<<u;e[0]=t.pred+=n}:function(t,e){e[0]|=g()<<u}:0===l?function(e,i){if(_>0)_--;else for(var n=a,r=s;n<=r;){var o=y(e.huffmanTableAC),l=15&o,h=o>>4;if(0!==l){i[t[n+=h]]=v(l)*(1<<u),n++}else{if(h<15){_=m(h)+(1<<h)-1;break}n+=16}}}:function(e,i){for(var n=a,r=s,o=0;n<=r;){var l=t[n],h=i[l]<0?-1:1;switch(w){case 0:var c=y(e.huffmanTableAC),f=15&c;o=c>>4;if(0===f)o<15?(_=m(o)+(1<<o),w=4):(o=16,w=1);else{if(1!==f)throw new Error("invalid ACn encoding");b=v(f),w=o?2:3}continue;case 1:case 2:i[l]?i[l]+=(g()<<u)*h:0===--o&&(w=2==w?3:0);break;case 3:i[l]?i[l]+=(g()<<u)*h:(i[l]=b<<u,w=0);break;case 4:i[l]&&(i[l]+=(g()<<u)*h)}n++}4===w&&0===--_&&(w=0)}:function(e,i){var n=y(e.huffmanTableDC),r=0===n?0:v(n);i[0]=e.pred+=r;for(var o=1;o<64;){var a=y(e.huffmanTableAC),s=15&a,l=a>>4;if(0!==s){i[t[o+=l]]=v(s),o++}else{if(l<15)break;o+=16}}};var C,O,R,D,k=0;for(O=1==P?r[0].blocksPerLine*r[0].blocksPerColumn:h*n.mcusPerColumn,o||(o=O);k<O;){for(A=0;A<P;A++)r[A].pred=0;if(_=0,1==P)for(T=r[0],E=0;E<o;E++)x(T,I,k),k++;else for(E=0;E<o;E++){for(A=0;A<P;A++)for(R=(T=r[A]).h,D=T.v,L=0;L<D;L++)for(S=0;S<R;S++)M(T,I,k,L,S);if(++k===O)break}if(d=0,(C=e[i]<<8|e[i+1])<65280)throw new Error("marker was not found");if(!(C>=65488&&C<=65495))break;i+=2}return i-f}function r(t,e){var i,n,r=[],o=e.blocksPerLine,a=e.blocksPerColumn,s=o<<3,l=new Int32Array(64),u=new Uint8Array(64);function h(t,i,n){var r,o,a,s,l,u,h,c,f,p,d=e.quantizationTable,g=n;for(p=0;p<64;p++)g[p]=t[p]*d[p];for(p=0;p<8;++p){var y=8*p;0!=g[1+y]||0!=g[2+y]||0!=g[3+y]||0!=g[4+y]||0!=g[5+y]||0!=g[6+y]||0!=g[7+y]?(r=5793*g[0+y]+128>>8,o=5793*g[4+y]+128>>8,a=g[2+y],s=g[6+y],l=2896*(g[1+y]-g[7+y])+128>>8,c=2896*(g[1+y]+g[7+y])+128>>8,u=g[3+y]<<4,f=r-o+1>>1,r=r+o+1>>1,o=f,f=3784*a+1567*s+128>>8,a=1567*a-3784*s+128>>8,s=f,f=l-(h=g[5+y]<<4)+1>>1,l=l+h+1>>1,h=f,f=c+u+1>>1,u=c-u+1>>1,c=f,f=r-s+1>>1,r=r+s+1>>1,s=f,f=o-a+1>>1,o=o+a+1>>1,a=f,f=2276*l+3406*c+2048>>12,l=3406*l-2276*c+2048>>12,c=f,f=799*u+4017*h+2048>>12,u=4017*u-799*h+2048>>12,h=f,g[0+y]=r+c,g[7+y]=r-c,g[1+y]=o+h,g[6+y]=o-h,g[2+y]=a+u,g[5+y]=a-u,g[3+y]=s+l,g[4+y]=s-l):(f=5793*g[0+y]+512>>10,g[0+y]=f,g[1+y]=f,g[2+y]=f,g[3+y]=f,g[4+y]=f,g[5+y]=f,g[6+y]=f,g[7+y]=f)}for(p=0;p<8;++p){var m=p;0!=g[8+m]||0!=g[16+m]||0!=g[24+m]||0!=g[32+m]||0!=g[40+m]||0!=g[48+m]||0!=g[56+m]?(r=5793*g[0+m]+2048>>12,o=5793*g[32+m]+2048>>12,a=g[16+m],s=g[48+m],l=2896*(g[8+m]-g[56+m])+2048>>12,c=2896*(g[8+m]+g[56+m])+2048>>12,u=g[24+m],f=r-o+1>>1,r=r+o+1>>1,o=f,f=3784*a+1567*s+2048>>12,a=1567*a-3784*s+2048>>12,s=f,f=l-(h=g[40+m])+1>>1,l=l+h+1>>1,h=f,f=c+u+1>>1,u=c-u+1>>1,c=f,f=r-s+1>>1,r=r+s+1>>1,s=f,f=o-a+1>>1,o=o+a+1>>1,a=f,f=2276*l+3406*c+2048>>12,l=3406*l-2276*c+2048>>12,c=f,f=799*u+4017*h+2048>>12,u=4017*u-799*h+2048>>12,h=f,g[0+m]=r+c,g[56+m]=r-c,g[8+m]=o+h,g[48+m]=o-h,g[16+m]=a+u,g[40+m]=a-u,g[24+m]=s+l,g[32+m]=s-l):(f=5793*n[p+0]+8192>>14,g[0+m]=f,g[8+m]=f,g[16+m]=f,g[24+m]=f,g[32+m]=f,g[40+m]=f,g[48+m]=f,g[56+m]=f)}for(p=0;p<64;++p){var v=128+(g[p]+8>>4);i[p]=v<0?0:v>255?255:v}}for(var c=0;c<a;c++){var f=c<<3;for(i=0;i<8;i++)r.push(new Uint8Array(s));for(var p=0;p<o;p++){h(e.blocks[c][p],u,l);var d=0,g=p<<3;for(n=0;n<8;n++){var y=r[f+n];for(i=0;i<8;i++)y[g+i]=u[d++]}}}return r}function o(t){return t<0?0:t>255?255:t}return e.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var o=0;e.length;function a(){var t=e[o]<<8|e[o+1];return o+=2,t}function s(){var t=a(),i=e.subarray(o,o+t-2);return o+=i.length,i}function l(t){var e,i,n=0,r=0;for(i in t.components)t.components.hasOwnProperty(i)&&(n<(e=t.components[i]).h&&(n=e.h),r<e.v&&(r=e.v));var o=Math.ceil(t.samplesPerLine/8/n),a=Math.ceil(t.scanLines/8/r);for(i in t.components)if(t.components.hasOwnProperty(i)){e=t.components[i];for(var s=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/n),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/r),u=o*e.h,h=a*e.v,c=[],f=0;f<h;f++){for(var p=[],d=0;d<u;d++)p.push(new Int32Array(64));c.push(p)}e.blocksPerLine=s,e.blocksPerColumn=l,e.blocks=c}t.maxH=n,t.maxV=r,t.mcusPerLine=o,t.mcusPerColumn=a}var u,h,c=null,f=null,p=[],d=[],g=[],y=[],m=a();if(65496!=m)throw new Error("SOI not found");for(m=a();65497!=m;){switch(m){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=s();65504===m&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(c={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65518===m&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(f={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var _=a()+o-2;o<_;){var b=e[o++],w=new Int32Array(64);if(b>>4==0)for(V=0;V<64;V++){w[t[V]]=e[o++]}else{if(b>>4!=1)throw new Error("DQT: invalid table spec");for(V=0;V<64;V++){w[t[V]]=a()}}p[15&b]=w}break;case 65472:case 65473:case 65474:a(),(u={}).extended=65473===m,u.progressive=65474===m,u.precision=e[o++],u.scanLines=a(),u.samplesPerLine=a(),u.components={},u.componentsOrder=[];var M,x=e[o++];for(F=0;F<x;F++){M=e[o];var T=e[o+1]>>4,A=15&e[o+1],L=e[o+2];u.componentsOrder.push(M),u.components[M]={h:T,v:A,quantizationIdx:L},o+=3}l(u),d.push(u);break;case 65476:var S=a();for(F=2;F<S;){var E=e[o++],I=new Uint8Array(16),P=0;for(V=0;V<16;V++,o++)P+=I[V]=e[o];var C=new Uint8Array(P);for(V=0;V<P;V++,o++)C[V]=e[o];F+=17+P,(E>>4==0?y:g)[15&E]=i(I,C)}break;case 65501:a(),h=a();break;case 65498:a();var O=e[o++],R=[];for(F=0;F<O;F++){Z=u.components[e[o++]];var D=e[o++];Z.huffmanTableDC=y[D>>4],Z.huffmanTableAC=g[15&D],R.push(Z)}var k=e[o++],B=e[o++],U=e[o++],N=n(e,o,u,R,h,k,B,U>>4,15&U);o+=N;break;case 65535:255!==e[o]&&o--;break;default:if(255==e[o-3]&&e[o-2]>=192&&e[o-2]<=254){o-=3;break}throw new Error("unknown JPEG marker "+m.toString(16))}m=a()}if(1!=d.length)throw new Error("only single frame JPEGs supported");for(var F=0;F<d.length;F++){var j=d[F].components;for(var V in j)j[V].quantizationTable=p[j[V].quantizationIdx],delete j[V].quantizationIdx}this.width=u.samplesPerLine,this.height=u.scanLines,this.jfif=c,this.adobe=f,this.components=[];for(F=0;F<u.componentsOrder.length;F++){var Z=u.components[u.componentsOrder[F]];this.components.push({lines:r(0,Z),scaleX:Z.h/u.maxH,scaleY:Z.v/u.maxV})}},getData:function(t,e){var i,n,r,a,s,l,u,h,c,f,p,d,g,y,m,v,_,b,w,M,x,T=this.width/t,A=this.height/e,L=0,S=t*e*this.components.length,E=new Uint8Array(S);switch(this.components.length){case 1:for(i=this.components[0],f=0;f<e;f++)for(s=i.lines[0|f*i.scaleY*A],c=0;c<t;c++)p=s[0|c*i.scaleX*T],E[L++]=p;break;case 2:for(i=this.components[0],n=this.components[1],f=0;f<e;f++)for(s=i.lines[0|f*i.scaleY*A],l=n.lines[0|f*n.scaleY*A],c=0;c<t;c++)p=s[0|c*i.scaleX*T],E[L++]=p,p=l[0|c*n.scaleX*T],E[L++]=p;break;case 3:for(x=!0,this.adobe&&this.adobe.transformCode?x=!0:void 0!==this.colorTransform&&(x=!!this.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],f=0;f<e;f++)for(s=i.lines[0|f*i.scaleY*A],l=n.lines[0|f*n.scaleY*A],u=r.lines[0|f*r.scaleY*A],c=0;c<t;c++)x?(p=s[0|c*i.scaleX*T],d=l[0|c*n.scaleX*T],b=o(p+1.402*((g=u[0|c*r.scaleX*T])-128)),w=o(p-.3441363*(d-128)-.71413636*(g-128)),M=o(p+1.772*(d-128))):(b=s[0|c*i.scaleX*T],w=l[0|c*n.scaleX*T],M=u[0|c*r.scaleX*T]),E[L++]=b,E[L++]=w,E[L++]=M;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(x=!1,this.adobe&&this.adobe.transformCode?x=!0:void 0!==this.colorTransform&&(x=!!this.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],a=this.components[3],f=0;f<e;f++)for(s=i.lines[0|f*i.scaleY*A],l=n.lines[0|f*n.scaleY*A],u=r.lines[0|f*r.scaleY*A],h=a.lines[0|f*a.scaleY*A],c=0;c<t;c++)x?(p=s[0|c*i.scaleX*T],d=l[0|c*n.scaleX*T],g=u[0|c*r.scaleX*T],y=h[0|c*a.scaleX*T],m=255-o(p+1.402*(g-128)),v=255-o(p-.3441363*(d-128)-.71413636*(g-128)),_=255-o(p+1.772*(d-128))):(m=s[0|c*i.scaleX*T],v=l[0|c*n.scaleX*T],_=u[0|c*r.scaleX*T],y=h[0|c*a.scaleX*T]),E[L++]=255-m,E[L++]=255-v,E[L++]=255-_,E[L++]=255-y;break;default:throw new Error("Unsupported color mode")}return E},copyToImageData:function(t){var e,i,n,r,a,s,l,u,h,c=t.width,f=t.height,p=t.data,d=this.getData(c,f),g=0,y=0;switch(this.components.length){case 1:for(i=0;i<f;i++)for(e=0;e<c;e++)n=d[g++],p[y++]=n,p[y++]=n,p[y++]=n,p[y++]=255;break;case 3:for(i=0;i<f;i++)for(e=0;e<c;e++)l=d[g++],u=d[g++],h=d[g++],p[y++]=l,p[y++]=u,p[y++]=h,p[y++]=255;break;case 4:for(i=0;i<f;i++)for(e=0;e<c;e++)a=d[g++],s=d[g++],n=d[g++],l=255-o(a*(1-(r=d[g++])/255)+r),u=255-o(s*(1-r/255)+r),h=255-o(n*(1-r/255)+r),p[y++]=l,p[y++]=u,p[y++]=h,p[y++]=255;break;default:throw new Error("Unsupported color mode")}}},e}();t.exports=function(t,n){var r={useTArray:!1,colorTransform:!0};n?"object"==typeof n?n={useTArray:void 0===n.useTArray?r.useTArray:n.useTArray,colorTransform:void 0===n.colorTransform?r.colorTransform:n.colorTransform}:(n=r).useTArray=!0:n=r;var o=new Uint8Array(t),a=new i;a.parse(o),a.colorTransform=n.colorTransform;var s={width:a.width,height:a.height,data:n.useTArray?new Uint8Array(a.width*a.height*4):new e(a.width*a.height*4)};return a.copyToImageData(s),s}}).call(this,i(4).Buffer)},function(t,e,i){(function(e){t.exports=function(t){if(t){if("Uint8Array"===t.constructor.name||t.constructor===Uint8Array)return t;"string"==typeof t&&(t=e(t));for(var i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t[n];return i}}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";(function(e){var n=i(254);t.exports=function(t,i){for(var r=n.decode(e.from(t)),o=r.width,a=r.height,s=new Uint8Array(o*a*4),l=0;l<s.length;l+=4){var u=r.data[l+0],h=r.data[l+1],c=r.data[l+2],f=r.data[l+3];s[l+0]=f,s[l+1]=c,s[l+2]=h,s[l+3]=r.is_with_alpha?u:255}return{data:s,width:r.width,height:r.height}}}).call(this,i(4).Buffer)},function(t,e,i){var n=i(255),r=i(256);t.exports={encode:n,decode:r}},function(t,e,i){(function(e){function i(t){this.buffer=t.data,this.width=t.width,this.height=t.height,this.extraBytes=this.width%4,this.rgbSize=this.height*(3*this.width+this.extraBytes),this.headerInfoSize=40,this.data=[],this.flag="BM",this.reserved=0,this.offset=54,this.fileSize=this.rgbSize+this.offset,this.planes=1,this.bitPP=24,this.compress=0,this.hr=0,this.vr=0,this.colors=0,this.importantColors=0}i.prototype.encode=function(){var t=new e(this.offset+this.rgbSize);this.pos=0,t.write(this.flag,this.pos,2),this.pos+=2,t.writeUInt32LE(this.fileSize,this.pos),this.pos+=4,t.writeUInt32LE(this.reserved,this.pos),this.pos+=4,t.writeUInt32LE(this.offset,this.pos),this.pos+=4,t.writeUInt32LE(this.headerInfoSize,this.pos),this.pos+=4,t.writeUInt32LE(this.width,this.pos),this.pos+=4,t.writeInt32LE(-this.height,this.pos),this.pos+=4,t.writeUInt16LE(this.planes,this.pos),this.pos+=2,t.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,t.writeUInt32LE(this.compress,this.pos),this.pos+=4,t.writeUInt32LE(this.rgbSize,this.pos),this.pos+=4,t.writeUInt32LE(this.hr,this.pos),this.pos+=4,t.writeUInt32LE(this.vr,this.pos),this.pos+=4,t.writeUInt32LE(this.colors,this.pos),this.pos+=4,t.writeUInt32LE(this.importantColors,this.pos),this.pos+=4;for(var i=0,n=3*this.width+this.extraBytes,r=0;r<this.height;r++){for(var o=0;o<this.width;o++){var a=this.pos+r*n+3*o;i++,t[a]=this.buffer[i++],t[a+1]=this.buffer[i++],t[a+2]=this.buffer[i++]}if(this.extraBytes>0){var s=this.pos+r*n+3*this.width;t.fill(0,s,s+this.extraBytes)}}return t},t.exports=function(t,e){return void 0===e&&(e=100),{data:new i(t).encode(),width:t.width,height:t.height}}}).call(this,i(4).Buffer)},function(t,e,i){(function(e){function i(t,e){if(this.pos=0,this.buffer=t,this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),"BM"!=this.flag)throw new Error("Invalid BMP File");this.parseHeader(),this.parseRGBA()}i.prototype.parseHeader=function(){if(this.fileSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.reserved=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.offset=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.headerSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.width=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.height=this.buffer.readInt32LE(this.pos),this.pos+=4,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compress=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.rawSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.hr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.vr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.colors=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.importantColors=this.buffer.readUInt32LE(this.pos),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var i=this.buffer.readUInt8(this.pos++),n=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++);this.palette[e]={red:r,green:n,blue:i,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},i.prototype.parseRGBA=function(){var t="bit"+this.bitPP,i=this.width*this.height*4;this.data=new e(i),this[t]()},i.prototype.bit1=function(){var t=Math.ceil(this.width/8),e=t%4,i=this.height>=0?this.height-1:-this.height;for(i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<t;r++)for(var o=this.buffer.readUInt8(this.pos++),a=n*this.width*4+8*r*4,s=0;s<8&&8*r+s<this.width;s++){var l=this.palette[o>>7-s&1];this.data[a+4*s]=0,this.data[a+4*s+1]=l.blue,this.data[a+4*s+2]=l.green,this.data[a+4*s+3]=l.red}0!=e&&(this.pos+=4-e)}},i.prototype.bit4=function(){if(2==this.compress){this.data.fill(255);for(var t=0,e=this.bottom_up?this.height-1:0,i=!1;t<this.data.length;){var n=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++);if(0==n){if(0==r){this.bottom_up?e--:e++,t=e*this.width*4,i=!1;continue}if(1==r)break;if(2==r){var o=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++);this.bottom_up?e-=a:e+=a,t+=a*this.width*4+4*o}else{for(var s=this.buffer.readUInt8(this.pos++),l=0;l<r;l++)i?u.call(this,15&s):u.call(this,(240&s)>>4),1&l&&l+1<r&&(s=this.buffer.readUInt8(this.pos++)),i=!i;1==(r+1>>1&1)&&this.pos++}}else for(l=0;l<n;l++)i?u.call(this,15&r):u.call(this,(240&r)>>4),i=!i}function u(e){var i=this.palette[e];this.data[t]=0,this.data[t+1]=i.blue,this.data[t+2]=i.green,this.data[t+3]=i.red,t+=4}}else{var h=Math.ceil(this.width/2),c=h%4;for(a=this.height-1;a>=0;a--){var f=this.bottom_up?a:this.height-1-a;for(o=0;o<h;o++){r=this.buffer.readUInt8(this.pos++),t=f*this.width*4+2*o*4;var p=r>>4,d=15&r,g=this.palette[p];if(this.data[t]=0,this.data[t+1]=g.blue,this.data[t+2]=g.green,this.data[t+3]=g.red,2*o+1>=this.width)break;g=this.palette[d],this.data[t+4]=0,this.data[t+4+1]=g.blue,this.data[t+4+2]=g.green,this.data[t+4+3]=g.red}0!=c&&(this.pos+=4-c)}}},i.prototype.bit8=function(){if(1==this.compress){this.data.fill(255);for(var t=0,e=this.bottom_up?this.height-1:0;t<this.data.length;){var i=this.buffer.readUInt8(this.pos++),n=this.buffer.readUInt8(this.pos++);if(0==i){if(0==n){this.bottom_up?e--:e++,t=e*this.width*4;continue}if(1==n)break;if(2==n){var r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++);this.bottom_up?e-=o:e+=o,t+=o*this.width*4+4*r}else{for(var a=0;a<n;a++){var s=this.buffer.readUInt8(this.pos++);l.call(this,s)}!0&n&&this.pos++}}else for(a=0;a<i;a++)l.call(this,n)}function l(e){var i=this.palette[e];this.data[t]=0,this.data[t+1]=i.blue,this.data[t+2]=i.green,this.data[t+3]=i.red,t+=4}}else{var u=this.width%4;for(o=this.height-1;o>=0;o--){var h=this.bottom_up?o:this.height-1-o;for(r=0;r<this.width;r++){n=this.buffer.readUInt8(this.pos++),t=h*this.width*4+4*r;if(n<this.palette.length){var c=this.palette[n];this.data[t]=0,this.data[t+1]=c.blue,this.data[t+2]=c.green,this.data[t+3]=c.red}else this.data[t]=0,this.data[t+1]=255,this.data[t+2]=255,this.data[t+3]=255}0!=u&&(this.pos+=4-u)}}},i.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<this.width;r++){var o=this.buffer.readUInt16LE(this.pos);this.pos+=2;var a=(o&e)/e*255|0,s=(o>>5&e)/e*255|0,l=(o>>10&e)/e*255|0,u=o>>15?255:0,h=n*this.width*4+4*r;this.data[h]=u,this.data[h+1]=a,this.data[h+2]=s,this.data[h+3]=l}this.pos+=t}},i.prototype.bit16=function(){var t=this.width%2*2;this.maskRed=31744,this.maskGreen=992,this.maskBlue=31,this.mask0=0,3==this.compress&&(this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4);for(var e=[0,0,0],i=0;i<16;i++)this.maskRed>>i&1&&e[0]++,this.maskGreen>>i&1&&e[1]++,this.maskBlue>>i&1&&e[2]++;e[1]+=e[0],e[2]+=e[1],e[0]=8-e[0],e[1]-=8,e[2]-=8;for(var n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var a=this.buffer.readUInt16LE(this.pos);this.pos+=2;var s=(a&this.maskBlue)<<e[0],l=(a&this.maskGreen)>>e[1],u=(a&this.maskRed)>>e[2],h=r*this.width*4+4*o;this.data[h]=0,this.data[h+1]=s,this.data[h+2]=l,this.data[h+3]=u}this.pos+=t}},i.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++),a=e*this.width*4+4*i;this.data[a]=0,this.data[a+1]=n,this.data[a+2]=r,this.data[a+3]=o}this.pos+=this.width%4}},i.prototype.bit32=function(){if(3==this.compress){this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4;for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=e*this.width*4+4*i;this.data[s]=n,this.data[s+1]=r,this.data[s+2]=o,this.data[s+3]=a}}else for(t=this.height-1;t>=0;t--)for(e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),n=this.buffer.readUInt8(this.pos++),s=e*this.width*4+4*i;this.data[s]=n,this.data[s+1]=r,this.data[s+2]=o,this.data[s+3]=a}},i.prototype.getData=function(){return this.data},t.exports=function(t){return new i(t)}}).call(this,i(4).Buffer)},function(t,e,i){"use strict";var n=i(258);t.exports=function(t,e){var i=n.decode(t);return n.decodeImages(t,i),{data:n.toRGBA8(i[0]),height:i[0].height,width:i[0].width}}},function(t,e,i){(function(e){!function(){var n={};function r(){void 0===e&&console.log.apply(console,arguments)}t.exports=n,function(t,e){var i,n,o;i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t){this.message="JPEG error: "+t}return t.prototype=Error(),t.prototype.name="JpegError",t.constructor=t}(),o=function(){function t(t,e){this.message=t,this.g=e}return t.prototype=Error(),t.prototype.name="DNLMarkerError",t.constructor=t}(),function(){function e(){this.M=null,this.B=-1}function r(t,e){for(var i,n,r=0,o=[],a=16;0<a&&!t[a-1];)a--;o.push({children:[],index:0});var s,l=o[0];for(i=0;i<a;i++){for(n=0;n<t[i];n++){for((l=o.pop()).children[l.index]=e[r];0<l.index;)l=o.pop();for(l.index++,o.push(l);o.length<=i;)o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;r++}i+1<a&&(o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return o[0].children}function a(t,e,r,a,s,h,c,f,p){function d(){if(0<D)return D--,R>>D&1;if(255===(R=t[e++])){var i=t[e++];if(i){if(220===i&&P){e+=2;var a=t[e++]<<8|t[e++];if(0<a&&a!==r.g)throw new o("Found DNL marker (0xFFDC) while parsing scan data",a)}throw new n("unexpected marker "+(R<<8|i).toString(16))}}return D=7,R>>>7}function g(t){for(;;){if("number"==typeof(t=t[d()]))return t;if("object"!==(void 0===t?"undefined":i(t)))throw new n("invalid huffman sequence")}}function y(t){for(var e=0;0<t;)e=e<<1|d(),t--;return e}function m(t){if(1===t)return 1===d()?1:-1;var e=y(t);return e>=1<<t-1?e:e+(-1<<t)+1}function v(t,e){var i=g(t.D);for(i=0===i?0:m(i),t.a[e]=t.m+=i,i=1;64>i;){var n=g(t.o),r=15&n;if(n>>=4,0===r){if(15>n)break;i+=16}else i+=n,t.a[e+u[i]]=m(r),i++}}function _(t,e){var i=g(t.D);i=0===i?0:m(i)<<p,t.a[e]=t.m+=i}function b(t,e){t.a[e]|=d()<<p}function w(t,e){if(0<k)k--;else for(var i=h;i<=c;){var n=g(t.o),r=15&n;if(n>>=4,0===r){if(15>n){k=y(n)+(1<<n)-1;break}i+=16}else i+=n,t.a[e+u[i]]=m(r)*(1<<p),i++}}function M(t,e){for(var i,r=h,o=0;r<=c;){i=e+u[r];var a=0>t.a[i]?-1:1;switch(B){case 0:if(i=15&(o=g(t.o)),o>>=4,0===i)15>o?(k=y(o)+(1<<o),B=4):(o=16,B=1);else{if(1!==i)throw new n("invalid ACn encoding");x=m(i),B=o?2:3}continue;case 1:case 2:t.a[i]?t.a[i]+=a*(d()<<p):0==--o&&(B=2===B?3:0);break;case 3:t.a[i]?t.a[i]+=a*(d()<<p):(t.a[i]=x<<p,B=0);break;case 4:t.a[i]&&(t.a[i]+=a*(d()<<p))}r++}4===B&&0==--k&&(B=0)}for(var x,T,A,L,S,E,I,P=9<arguments.length&&void 0!==arguments[9]&&arguments[9],C=r.P,O=e,R=0,D=0,k=0,B=0,U=a.length,N=r.S?0===h?0===f?_:b:0===f?w:M:v,F=0,j=1===U?a[0].c*a[0].l:C*r.O;F<j;){var V=s?Math.min(j-F,s):j;for(T=0;T<U;T++)a[T].m=0;if(k=0,1===U){var Z=a[0];for(S=0;S<V;S++)N(Z,64*((Z.c+1)*(F/Z.c|0)+F%Z.c)),F++}else for(S=0;S<V;S++){for(T=0;T<U;T++)for(E=(Z=a[T]).h,I=Z.j,A=0;A<I;A++)for(L=0;L<E;L++)N(Z,64*((Z.c+1)*((F/C|0)*Z.j+A)+(F%C*Z.h+L)));F++}if(D=0,(Z=l(t,e))&&Z.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+Z.f),e=Z.offset),!(Z=Z&&Z.F)||65280>=Z)throw new n("marker was not found");if(!(65488<=Z&&65495>=Z))break;e+=2}return(Z=l(t,e))&&Z.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+Z.f),e=Z.offset),e-O}function s(t,e){for(var i=e.c,r=e.l,o=new Int16Array(64),a=0;a<r;a++)for(var s=0;s<i;s++){var l=64*((e.c+1)*a+s),u=o,h=e.G,c=e.a;if(!h)throw new n("missing required Quantization Table.");for(var f=0;64>f;f+=8){var p=c[l+f],d=c[l+f+1],g=c[l+f+2],y=c[l+f+3],m=c[l+f+4],v=c[l+f+5],_=c[l+f+6],b=c[l+f+7];if(p*=h[f],0==(d|g|y|m|v|_|b))p=5793*p+512>>10,u[f]=p,u[f+1]=p,u[f+2]=p,u[f+3]=p,u[f+4]=p,u[f+5]=p,u[f+6]=p,u[f+7]=p;else{d*=h[f+1],g*=h[f+2],y*=h[f+3],m*=h[f+4],v*=h[f+5];var w=5793*p+128>>8,M=5793*m+128>>8,x=g,T=_*=h[f+6];M=(w=w+M+1>>1)-M,p=3784*x+1567*T+128>>8,x=1567*x-3784*T+128>>8,v=(m=(m=2896*(d-(b*=h[f+7]))+128>>8)+(v<<=4)+1>>1)-v,y=(b=(b=2896*(d+b)+128>>8)+(y<<=4)+1>>1)-y,T=(w=w+(T=p)+1>>1)-T,x=(M=M+x+1>>1)-x,p=2276*m+3406*b+2048>>12,m=3406*m-2276*b+2048>>12,b=p,p=799*y+4017*v+2048>>12,y=4017*y-799*v+2048>>12,v=p,u[f]=w+b,u[f+7]=w-b,u[f+1]=M+v,u[f+6]=M-v,u[f+2]=x+y,u[f+5]=x-y,u[f+3]=T+m,u[f+4]=T-m}}for(h=0;8>h;++h)p=u[h],0==((d=u[h+8])|(g=u[h+16])|(y=u[h+24])|(m=u[h+32])|(v=u[h+40])|(_=u[h+48])|(b=u[h+56]))?(p=-2040>(p=5793*p+8192>>14)?0:2024<=p?255:p+2056>>4,c[l+h]=p,c[l+h+8]=p,c[l+h+16]=p,c[l+h+24]=p,c[l+h+32]=p,c[l+h+40]=p,c[l+h+48]=p,c[l+h+56]=p):(w=5793*p+2048>>12,M=5793*m+2048>>12,p=3784*(x=g)+1567*(T=_)+2048>>12,x=1567*x-3784*T+2048>>12,T=p,v=(m=(m=2896*(d-b)+2048>>12)+v+1>>1)-v,y=(b=(b=2896*(d+b)+2048>>12)+y+1>>1)-y,p=2276*m+3406*b+2048>>12,m=3406*m-2276*b+2048>>12,b=p,p=799*y+4017*v+2048>>12,y=4017*y-799*v+2048>>12,d=(M=(M=(w=4112+(w+M+1>>1))-M)+x+1>>1)+(v=p),_=M-v,v=(x=M-x)-y,p=16>(p=(w=w+T+1>>1)+b)?0:4080<=p?255:p>>4,d=16>d?0:4080<=d?255:d>>4,g=16>(g=x+y)?0:4080<=g?255:g>>4,y=16>(y=(T=w-T)+m)?0:4080<=y?255:y>>4,m=16>(m=T-m)?0:4080<=m?255:m>>4,v=16>v?0:4080<=v?255:v>>4,_=16>_?0:4080<=_?255:_>>4,b=16>(b=w-b)?0:4080<=b?255:b>>4,c[l+h]=p,c[l+h+8]=d,c[l+h+16]=g,c[l+h+24]=y,c[l+h+32]=m,c[l+h+40]=v,c[l+h+48]=_,c[l+h+56]=b)}return e.a}function l(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,n=t.length-1;if(i=i<e?i:e,e>=n)return null;var r=t[e]<<8|t[e+1];if(65472<=r&&65534>=r)return{f:null,F:r,offset:e};for(var o=t[i]<<8|t[i+1];!(65472<=o&&65534>=o);){if(++i>=n)return null;o=t[i]<<8|t[i+1]}return{f:r.toString(16),F:o,offset:i}}var u=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);e.prototype={parse:function(t){function e(){var e=t[p]<<8|t[p+1];return p+=2,e}function i(){var i=e(),n=l(t,i=p+i-2,p);return n&&n.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+n.f),i=n.offset),i=t.subarray(p,i),p+=i.length,i}function h(t){for(var e=Math.ceil(t.v/8/t.s),i=Math.ceil(t.g/8/t.u),n=0;n<t.b.length;n++){S=t.b[n];var r=Math.ceil(Math.ceil(t.v/8)*S.h/t.s),o=Math.ceil(Math.ceil(t.g/8)*S.j/t.u);S.a=new Int16Array(64*i*S.j*(e*S.h+1)),S.c=r,S.l=o}t.P=e,t.O=i}var c=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).N,f=void 0===c?null:c,p=0,d=null,g=0;c=[];var y=[],m=[],v=e();if(65496!==v)throw new n("SOI not found");for(v=e();65497!==v;){switch(v){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var _=i();65518===v&&65===_[0]&&100===_[1]&&111===_[2]&&98===_[3]&&101===_[4]&&(d={version:_[5]<<8|_[6],Y:_[7]<<8|_[8],Z:_[9]<<8|_[10],W:_[11]});break;case 65499:v=e()+p-2;for(var b;p<v;){var w=t[p++],M=new Uint16Array(64);if(0==w>>4)for(_=0;64>_;_++)M[b=u[_]]=t[p++];else{if(1!=w>>4)throw new n("DQT - invalid table spec");for(_=0;64>_;_++)M[b=u[_]]=e()}c[15&w]=M}break;case 65472:case 65473:case 65474:if(x)throw new n("Only single frame JPEGs supported");e();var x={};for(x.X=65473===v,x.S=65474===v,x.precision=t[p++],v=e(),x.g=f||v,x.v=e(),x.b=[],x.C={},_=t[p++],v=M=w=0;v<_;v++){b=t[p];var T=t[p+1]>>4,A=15&t[p+1];w<T&&(w=T),M<A&&(M=A),T=x.b.push({h:T,j:A,T:t[p+2],G:null}),x.C[b]=T-1,p+=3}x.s=w,x.u=M,h(x);break;case 65476:for(b=e(),v=2;v<b;){for(w=t[p++],M=new Uint8Array(16),_=T=0;16>_;_++,p++)T+=M[_]=t[p];for(A=new Uint8Array(T),_=0;_<T;_++,p++)A[_]=t[p];v+=17+T,(0==w>>4?m:y)[15&w]=r(M,A)}break;case 65501:e();var L=e();break;case 65498:for(_=1==++g&&!f,e(),w=t[p++],b=[],v=0;v<w;v++){M=x.C[t[p++]];var S=x.b[M];M=t[p++],S.D=m[M>>4],S.o=y[15&M],b.push(S)}v=t[p++],w=t[p++],M=t[p++];try{var E=a(t,p,x,b,L,v,w,M>>4,15&M,_);p+=E}catch(e){if(e instanceof o)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(t,{N:e.g});throw e}break;case 65500:p+=4;break;case 65535:255!==t[p]&&p--;break;default:if(255===t[p-3]&&192<=t[p-2]&&254>=t[p-2])p-=3;else{if(!(_=l(t,p-2))||!_.f)throw new n("unknown marker "+v.toString(16));(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+_.f),p=_.offset}}v=e()}for(this.width=x.v,this.height=x.g,this.A=d,this.b=[],v=0;v<x.b.length;v++)(L=c[(S=x.b[v]).T])&&(S.G=L),this.b.push({R:s(0,S),U:S.h/x.s,V:S.j/x.u,c:S.c,l:S.l});this.i=this.b.length},L:function(t,e){var i,n,r=this.width/t,o=this.height/e,a=this.b.length,s=t*e*a,l=new Uint8ClampedArray(s),u=new Uint32Array(t);for(n=0;n<a;n++){var h=this.b[n],c=h.U*r,f=h.V*o,p=n,d=h.R,g=h.c+1<<3;for(i=0;i<t;i++)h=0|i*c,u[i]=(4294967288&h)<<3|7&h;for(c=0;c<e;c++)for(h=g*(4294967288&(h=0|c*f))|(7&h)<<3,i=0;i<t;i++)l[p]=d[h+u[i]],p+=a}if(o=this.M)for(n=0;n<s;)for(r=h=0;h<a;h++,n++,r+=2)l[n]=(l[n]*o[r]>>8)+o[r+1];return l},w:function(){return this.A?!!this.A.W:3===this.i?0!==this.B:1===this.B},I:function(t){for(var e,i,n,r=0,o=t.length;r<o;r+=3)e=t[r],i=t[r+1],n=t[r+2],t[r]=e-179.456+1.402*n,t[r+1]=e+135.459-.344*i-.714*n,t[r+2]=e-226.816+1.772*i;return t},K:function(t){for(var e,i,n,r,o=0,a=0,s=t.length;a<s;a+=4)e=t[a],i=t[a+1],n=t[a+2],r=t[a+3],t[o++]=i*(-660635669420364e-19*i+.000437130475926232*n-54080610064599e-18*e+.00048449797120281*r-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*e-.00477271405408747*r+1.53380253221734)+e*(.000961250184130688*e-.00266257332283933*r+.48357088451265)+r*(-.000336197177618394*r+.484791561490776),t[o++]=107.268039397724+i*(219927104525741e-19*i-.000640992018297945*n+.000659397001245577*e+.000426105652938837*r-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*e+.000770482631801132*r-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*r+.25802910206845)+r*(-.000318913117588328*r-.213742400323665),t[o++]=i*(-.000570115196973677*i-263409051004589e-19*n+.0020741088115012*e-.00288260236853442*r+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*e+.000560833691242812*r-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*r+.116935020465145)+r*(-.000343531996510555*r+.24165260232407);return t.subarray(0,o)},J:function(t){for(var e,i,n,r=0,o=t.length;r<o;r+=4)e=t[r],i=t[r+1],n=t[r+2],t[r]=434.456-e-1.402*n,t[r+1]=119.541-e+.344*i+.714*n,t[r+2]=481.816-e-1.772*i;return t},H:function(t){for(var e,i,n,r,o=0,a=1/255,s=0,l=t.length;s<l;s+=4)e=t[s]*a,i=t[s+1]*a,n=t[s+2]*a,r=t[s+3]*a,t[o++]=255+e*(-4.387332384609988*e+54.48615194189176*i+18.82290502165302*n+212.25662451639585*r-285.2331026137004)+i*(1.7149763477362134*i-5.6096736904047315*n-17.873870861415444*r-5.497006427196366)+n*(-2.5217340131683033*n-21.248923337353073*r+17.5119270841813)-r*(21.86122147463605*r+189.48180835922747),t[o++]=255+e*(8.841041422036149*e+60.118027045597366*i+6.871425592049007*n+31.159100130055922*r-79.2970844816548)+i*(-15.310361306967817*i+17.575251261109482*n+131.35250912493976*r-190.9453302588951)+n*(4.444339102852739*n+9.8632861493405*r-24.86741582555878)-r*(20.737325471181034*r+187.80453709719578),t[o++]=255+e*(.8842522430003296*e+8.078677503112928*i+30.89978309703729*n-.23883238689178934*r-14.183576799673286)+i*(10.49593273432072*i+63.02378494754052*n+50.606957656360734*r-112.23884253719248)+n*(.03296041114873217*n+115.60384449646641*r-193.58209356861505)-r*(22.33816807309886*r+180.12613974708367);return t.subarray(0,o)},getData:function(t,e,i){if(4<this.i)throw new n("Unsupported color mode");if(t=this.L(t,e),1===this.i&&i){i=t.length,e=new Uint8ClampedArray(3*i);for(var r=0,o=0;o<i;o++){var a=t[o];e[r++]=a,e[r++]=a,e[r++]=a}return e}if(3===this.i&&this.w())return this.I(t);if(4===this.i){if(this.w())return i?this.K(t):this.J(t);if(i)return this.H(t)}return t}},t.JpegDecoder=e}(),t.encodeImage=function(e,i,n,r){var o={t256:[i],t257:[n],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[n],t279:[i*n*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(r)for(var a in r)o[a]=r[a];var s=new Uint8Array(t.encode([o])),l=new Uint8Array(e),u=new Uint8Array(1e3+i*n*4);for(a=0;a<s.length;a++)u[a]=s[a];for(a=0;a<l.length;a++)u[1e3+a]=l[a];return u.buffer},t.encode=function(e){var i=new Uint8Array(2e4),n=4,r=t._binBE;i[0]=77,i[1]=77,i[3]=42;var o=8;r.writeUint(i,n,o),n+=4;for(var a=0;a<e.length;a++){var s=t._writeIFD(r,i,o,e[a]);o=s[1],a<e.length-1&&r.writeUint(i,s[0],o)}return i.slice(0,o).buffer},t.decode=function(e){t.decode._decodeG3.allow2D=null;var i=new Uint8Array(e),n=0,r=t._binBE.readASCII(i,n,2);n+=2;var o="II"==r?t._binLE:t._binBE;o.readUshort(i,n);n+=2;var a=o.readUint(i,n);n+=4;for(var s=[];;){var l=t._readIFD(o,i,a,s);if(0==(a=o.readUint(i,l)))break}return s},t.decodeImages=function(e,i){for(var n=new Uint8Array(e),o=t._binBE.readASCII(n,0,2),a=0;a<i.length;a++){var s=i[a];if(null!=s.t256){s.isLE="II"==o,s.width=s.t256[0],s.height=s.t257[0];var l=s.t259?s.t259[0]:1,u=s.t266?s.t266[0]:1;s.t284&&2==s.t284[0]&&r("PlanarConfiguration 2 should not be used!");var h=(s.t258?Math.min(32,s.t258[0]):1)*(s.t277?s.t277[0]:1),c=8*Math.ceil(s.width*h/8),f=s.t273;null==f&&(f=s.t324);var p=s.t279;1==l&&1==f.length&&(p=[s.height*(c>>>3)]),null==p&&(p=s.t325);var d=new Uint8Array(s.height*(c>>>3)),g=0;if(null!=s.t322){for(var y=s.t322[0],m=s.t323[0],v=Math.floor((s.width+y-1)/y),_=Math.floor((s.height+m-1)/m),b=new Uint8Array(0|Math.ceil(y*m*h/8)),w=0;w<_;w++)for(var M=0;M<v;M++){for(var x=w*v+M,T=0;T<b.length;T++)b[T]=0;t.decode._decompress(s,n,f[x],p[x],l,b,0,u),6==l?d=b:t._copyTile(b,0|Math.ceil(y*h/8),m,d,0|Math.ceil(s.width*h/8),s.height,0|Math.ceil(M*y*h/8),w*m)}g=8*d.length}else{var A=s.t278?s.t278[0]:s.height;A=Math.min(A,s.height);for(x=0;x<f.length;x++)t.decode._decompress(s,n,f[x],p[x],l,d,0|Math.ceil(g/8),u),g+=c*A;g=Math.min(g,8*d.length)}s.data=new Uint8Array(d.buffer,0,0|Math.ceil(g/8))}}},t.decode._decompress=function(i,n,o,a,s,l,u,h){if(1==s)for(var c=0;c<a;c++)l[u+c]=n[o+c];else if(3==s)t.decode._decodeG3(n,o,a,l,u,i.width,h);else if(4==s)t.decode._decodeG4(n,o,a,l,u,i.width,h);else if(5==s)t.decode._decodeLZW(n,o,l,u);else if(6==s)t.decode._decodeOldJPEG(i,n,o,a,l,u);else if(7==s)t.decode._decodeNewJPEG(i,n,o,a,l,u);else if(8==s)for(var f=new Uint8Array(n.buffer,o,a),p=e.inflate(f),d=0;d<p.length;d++)l[u+d]=p[d];else 32773==s?t.decode._decodePackBits(n,o,a,l,u):32809==s?t.decode._decodeThunder(n,o,a,l,u):r("Unknown compression",s);if(i.t317&&2==i.t317[0])for(var g=i.t277?i.t277[0]:1,y=i.t278?i.t278[0]:i.height,m=i.width*g,v=0;v<y;v++){var _=u+v*m;if(3==g)for(c=3;c<m;c+=3)l[_+c]=l[_+c]+l[_+c-3]&255,l[_+c+1]=l[_+c+1]+l[_+c-2]&255,l[_+c+2]=l[_+c+2]+l[_+c-1]&255;else for(c=g;c<m;c++)l[_+c]=l[_+c]+l[_+c-g]&255}},t.decode._decodeNikon=function(t,e,i,n,o){var a,s;r(t.slice(e,e+100)),a=t[e],s=t[++e],e++,r(a.toString(16),s.toString(16),i)},t.decode._decodeNewJPEG=function(e,i,n,r,o,a){var s=e.t347,l=s?s.length:0,u=new Uint8Array(l+r);if(s){for(var h=0,c=0;c<l-1&&(255!=s[c]||217!=s[c+1]);c++)u[h++]=s[c];var f=i[n],p=i[n+1];255==f&&216==p||(u[h++]=f,u[h++]=p);for(c=2;c<r;c++)u[h++]=i[n+c]}else for(c=0;c<r;c++)u[c]=i[n+c];if(32803==e.t262){var d=e.t258[0],g=(new LosslessJpegDecoder).decode(u),y=g.length;if(16==d)for(c=0;c<y;c++)o[a++]=255&g[c],o[a++]=g[c]>>>8;else{if(12!=d)throw new Error("unsupported bit depth "+d);for(c=0;c<y;c+=2)o[a++]=g[c]>>>4,o[a++]=255&(g[c]<<4|g[c+1]>>>8),o[a++]=255&g[c+1]}}else{var m=new t.JpegDecoder;m.parse(u);var v=m.getData(m.width,m.height);for(c=0;c<v.length;c++)o[a+c]=v[c]}6==e.t262[0]&&(e.t262[0]=2)},t.decode._decodeOldJPEGInit=function(t,e,i,n){var o,a,s,l,u,h=0,c=0,f=!1,p=t.t513,d=p?p[0]:0,g=t.t514,y=g?g[0]:0,m=t.t324||t.t273||p,v=t.t530,_=0,b=0,w=t.t277?t.t277[0]:1,M=t.t515;if(m&&(c=m[0],f=m.length>1),!f){if(255==e[i]&&216==e[i+1])return{jpegOffset:i};if(null!=p&&(255==e[i+d]&&216==e[i+d+1]?h=i+d:r("JPEGInterchangeFormat does not point to SOI"),null==g?r("JPEGInterchangeFormatLength field is missing"):(d>=c||d+y<=c)&&r("JPEGInterchangeFormatLength field value is invalid"),null!=h))return{jpegOffset:h}}if(null!=v&&(_=v[0],b=v[1]),null!=p&&null!=g)if(y>=2&&d+y<=c){for(o=255==e[i+d+y-2]&&216==e[i+d+y-1]?new Uint8Array(y-2):new Uint8Array(y),s=0;s<o.length;s++)o[s]=e[i+d+s];r("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else r("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==o){var x=0,T=[];T[x++]=255,T[x++]=216;var A=t.t519;if(null==A)throw new Error("JPEGQTables tag is missing");for(s=0;s<A.length;s++)for(T[x++]=255,T[x++]=219,T[x++]=0,T[x++]=67,T[x++]=s,l=0;l<64;l++)T[x++]=e[i+A[s]+l];for(u=0;u<2;u++){var L=t[0==u?"t520":"t521"];if(null==L)throw new Error((0==u?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(s=0;s<L.length;s++){T[x++]=255,T[x++]=196;var S=19;for(l=0;l<16;l++)S+=e[i+L[s]+l];for(T[x++]=S>>>8,T[x++]=255&S,T[x++]=s|u<<4,l=0;l<16;l++)T[x++]=e[i+L[s]+l];for(l=0;l<S;l++)T[x++]=e[i+L[s]+16+l]}}if(T[x++]=255,T[x++]=192,T[x++]=0,T[x++]=8+3*w,T[x++]=8,T[x++]=t.height>>>8&255,T[x++]=255&t.height,T[x++]=t.width>>>8&255,T[x++]=255&t.width,T[x++]=w,1==w)T[x++]=1,T[x++]=17,T[x++]=0;else for(s=0;s<3;s++)T[x++]=s+1,T[x++]=0!=s?17:(15&_)<<4|15&b,T[x++]=s;null!=M&&0!=M[0]&&(T[x++]=255,T[x++]=221,T[x++]=0,T[x++]=4,T[x++]=M[0]>>>8&255,T[x++]=255&M[0]),o=new Uint8Array(T)}var E=-1;for(s=0;s<o.length-1;){if(255==o[s]&&192==o[s+1]){E=s;break}s++}if(-1==E){var I=new Uint8Array(o.length+10+3*w);I.set(o);var P=o.length;if(E=o.length,(o=I)[P++]=255,o[P++]=192,o[P++]=0,o[P++]=8+3*w,o[P++]=8,o[P++]=t.height>>>8&255,o[P++]=255&t.height,o[P++]=t.width>>>8&255,o[P++]=255&t.width,o[P++]=w,1==w)o[P++]=1,o[P++]=17,o[P++]=0;else for(s=0;s<3;s++)o[P++]=s+1,o[P++]=0!=s?17:(15&_)<<4|15&b,o[P++]=s}if(255==e[c]&&218==e[c+1]){var C=e[c+2]<<8|e[c+3];for((a=new Uint8Array(C+2))[0]=e[c],a[1]=e[c+1],a[2]=e[c+2],a[3]=e[c+3],s=0;s<C-2;s++)a[s+4]=e[c+s+4]}else{var O=0;if((a=new Uint8Array(8+2*w))[O++]=255,a[O++]=218,a[O++]=0,a[O++]=6+2*w,a[O++]=w,1==w)a[O++]=1,a[O++]=0;else for(s=0;s<3;s++)a[O++]=s+1,a[O++]=s<<4|s;a[O++]=0,a[O++]=63,a[O++]=0}return{jpegOffset:i,tables:o,sosMarker:a,sofPosition:E}},t.decode._decodeOldJPEG=function(e,i,n,r,o,a){var s,l,u,h=t.decode._decodeOldJPEGInit(e,i,n,r);if(null!=h.jpegOffset)for(s=n+r-h.jpegOffset,u=new Uint8Array(s),p=0;p<s;p++)u[p]=i[h.jpegOffset+p];else{for(l=h.tables.length,(u=new Uint8Array(l+h.sosMarker.length+r+2)).set(h.tables),l,u[h.sofPosition+5]=e.height>>>8&255,u[h.sofPosition+6]=255&e.height,u[h.sofPosition+7]=e.width>>>8&255,u[h.sofPosition+8]=255&e.width,255==i[n]&&i[n+1]==SOS||(u.set(h.sosMarker,bufoff),bufoff+=sosMarker.length),p=0;p<r;p++)u[bufoff++]=i[n+p];u[bufoff++]=255,u[bufoff++]=EOI}var c=new t.JpegDecoder;c.parse(u);for(var f=c.getData(c.width,c.height),p=0;p<f.length;p++)o[a+p]=f[p];6==e.t262[0]&&(e.t262[0]=2)},t.decode._decodePackBits=function(t,e,i,n,r){for(var o=new Int8Array(t.buffer),a=new Int8Array(n.buffer),s=e+i;e<s;){var l=o[e];if(e++,l>=0&&l<128)for(var u=0;u<l+1;u++)a[r]=o[e],r++,e++;if(l>=-127&&l<0){for(u=0;u<1-l;u++)a[r]=o[e],r++;e++}}},t.decode._decodeThunder=function(t,e,i,n,r){for(var o=[0,1,0,-1],a=[0,1,2,3,0,-3,-2,-1],s=e+i,l=2*r,u=0;e<s;){var h=t[e],c=h>>>6,f=63&h;if(e++,3==c&&(u=15&f,n[l>>>1]|=u<<4*(1-l&1),l++),0==c)for(var p=0;p<f;p++)n[l>>>1]|=u<<4*(1-l&1),l++;if(2==c)for(p=0;p<2;p++){4!=(d=f>>>3*(1-p)&7)&&(u+=a[d],n[l>>>1]|=u<<4*(1-l&1),l++)}if(1==c)for(p=0;p<3;p++){var d;2!=(d=f>>>2*(2-p)&3)&&(u+=o[d],n[l>>>1]|=u<<4*(1-l&1),l++)}}},t.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},t.decode._lens=function(){var t=function(t,e,i,n){for(var r=0;r<e.length;r++)t[e[r]]=i+r*n},e="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",i="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",n="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",r="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",o="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";e=e.split(","),i=i.split(","),n=n.split(","),r=r.split(","),o=o.split(",");var a={},s={};return t(a,e,0,1),t(a,n,64,64),t(a,o,1792,64),t(s,i,0,1),t(s,r,64,64),t(s,o,1792,64),[a,s]}(),t.decode._decodeG4=function(e,i,n,r,o,a,s){for(var l=t.decode,u=i<<3,h=0,c="",f=[],p=[],d=0;d<a;d++)p.push(0);p=l._makeDiff(p);for(var g=0,y=0,m=0,v=0,_=0,b=0,w="",M=0,x=8*Math.ceil(a/8);u>>>3<i+n;){m=l._findDiff(p,g+(0==g?0:1),1-_),v=l._findDiff(p,m,_);var T=0;if(1==s&&(T=e[u>>>3]>>>7-(7&u)&1),2==s&&(T=e[u>>>3]>>>(7&u)&1),u++,c+=T,"H"==w){if(null!=l._lens[_][c]){var A=l._lens[_][c];c="",h+=A,A<64&&(l._addNtimes(f,h,_),g+=h,_=1-_,h=0,0==--M&&(w=""))}}else"0001"==c&&(c="",l._addNtimes(f,v-g,_),g=v),"001"==c&&(c="",w="H",M=2),null!=l._dmap[c]&&(y=m+l._dmap[c],l._addNtimes(f,y-g,_),g=y,c="",_=1-_);f.length==a&&""==w&&(l._writeBits(f,r,8*o+b*x),_=0,b++,g=0,p=l._makeDiff(f),f=[])}},t.decode._findDiff=function(t,e,i){for(var n=0;n<t.length;n+=2)if(t[n]>=e&&t[n+1]==i)return t[n]},t.decode._makeDiff=function(t){var e=[];1==t[0]&&e.push(0,1);for(var i=1;i<t.length;i++)t[i-1]!=t[i]&&e.push(i,t[i]);return e.push(t.length,0,t.length,1),e},t.decode._decodeG3=function(e,i,n,r,o,a,s){for(var l=t.decode,u=i<<3,h=0,c="",f=[],p=[],d=0;d<a;d++)f.push(0);for(var g=0,y=0,m=0,v=0,_=0,b=-1,w="",M=0,x=!1,T=8*Math.ceil(a/8);u>>>3<i+n;){m=l._findDiff(p,g+(0==g?0:1),1-_),v=l._findDiff(p,m,_);var A=0;if(1==s&&(A=e[u>>>3]>>>7-(7&u)&1),2==s&&(A=e[u>>>3]>>>(7&u)&1),u++,c+=A,x){if(null!=l._lens[_][c]){var L=l._lens[_][c];c="",h+=L,L<64&&(l._addNtimes(f,h,_),_=1-_,h=0)}}else if("H"==w){if(null!=l._lens[_][c]){L=l._lens[_][c];c="",h+=L,L<64&&(l._addNtimes(f,h,_),g+=h,_=1-_,h=0,0==--M&&(w=""))}}else"0001"==c&&(c="",l._addNtimes(f,v-g,_),g=v),"001"==c&&(c="",w="H",M=2),null!=l._dmap[c]&&(y=m+l._dmap[c],l._addNtimes(f,y-g,_),g=y,c="",_=1-_);c.endsWith("000000000001")&&(b>=0&&l._writeBits(f,r,8*o+b*T),1==s&&(x=1==(e[u>>>3]>>>7-(7&u)&1)),2==s&&(x=1==(e[u>>>3]>>>(7&u)&1)),u++,null==l._decodeG3.allow2D&&(l._decodeG3.allow2D=x),l._decodeG3.allow2D||(x=!0,u--),c="",_=0,b++,g=0,p=l._makeDiff(f),f=[])}f.length==a&&l._writeBits(f,r,8*o+b*T)},t.decode._addNtimes=function(t,e,i){for(var n=0;n<e;n++)t.push(i)},t.decode._writeBits=function(t,e,i){for(var n=0;n<t.length;n++)e[i+n>>>3]|=t[n]<<7-(i+n&7)},t.decode._decodeLZW=function(e,i,n,r){if(null==t.decode._lzwTab){for(var o=new Uint32Array(65535),a=new Uint16Array(65535),s=new Uint8Array(2e6),l=0;l<256;l++)s[l<<2]=l,o[l]=l<<2,a[l]=1;t.decode._lzwTab=[o,a,s]}for(var u=t.decode._copyData,h=t.decode._lzwTab[0],c=t.decode._lzwTab[1],f=(s=t.decode._lzwTab[2],258),p=1032,d=9,g=i<<3,y=0,m=0;y=(e[g>>>3]<<16|e[g+8>>>3]<<8|e[g+16>>>3])>>24-(7&g)-d&(1<<d)-1,g+=d,257!=y;){if(256==y){if(d=9,f=258,p=1032,y=(e[g>>>3]<<16|e[g+8>>>3]<<8|e[g+16>>>3])>>24-(7&g)-d&(1<<d)-1,g+=d,257==y)break;n[r]=y,r++}else if(y<f){var v=h[y],_=c[y];if(u(s,v,n,r,_),r+=_,m>=f)h[f]=p,s[h[f]]=v[0],c[f]=1,p=p+1+3&-4,f++;else h[f]=p,u(s,h[m],s,p,b=c[m]),s[p+b]=s[v],b++,c[f]=b,f++,p=p+b+3&-4;f+1==1<<d&&d++}else{var b;if(m>=f)h[f]=p,c[f]=0,f++;else h[f]=p,u(s,h[m],s,p,b=c[m]),s[p+b]=s[p],b++,c[f]=b,f++,u(s,p,n,r,b),r+=b,p=p+b+3&-4;f+1==1<<d&&d++}m=y}},t.decode._copyData=function(t,e,i,n,r){for(var o=0;o<r;o+=4)i[n+o]=t[e+o],i[n+o+1]=t[e+o+1],i[n+o+2]=t[e+o+2],i[n+o+3]=t[e+o+3]},t.tags={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffset",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",296:"ResolutionUnit",297:"PageNumber",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffset",325:"TileByteCounts",330:"SubIFDs",336:"DotRange",338:"ExtraSample",339:"SampleFormat",347:"JPEGTables",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",700:"XMP",33421:"CFARepeatPatternDim",33422:"CFAPattern",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33723:"IPTC/NAA",34377:"Photoshop",34665:"ExifIFD",34675:"ICC Profile",34850:"ExposureProgram",34853:"GPSInfo",34855:"ISOSpeedRatings",34858:"TimeZoneOffset",34859:"SelfTimeMode",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37377:"ShutterSpeedValue",37378:"ApertureValue",37380:"ExposureBiasValue",37383:"MeteringMode",37385:"Flash",37386:"FocalLength",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37398:"TIFF/EPStandardID",37399:"SensingMethod",37500:"MakerNote",37510:"UserComment",37724:"ImageSourceData",40092:"XPComment",40094:"XPKeywords",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelXDimension",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50733:"BayerGreenSplit",50738:"AntiAliasStrength",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50727:"AnalogBalance",50728:"AsShotNeutral",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50827:"OriginalRawFileName",50829:"ActiveArea",50830:"MaskedAreas",50931:"CameraCalibrationSignature",50932:"ProfileCalibrationSignature",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualityFinalSize",51091:"OriginalDefaultCropSize",51125:"DefaultUserCrop"},t.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},t._readIFD=function(e,i,n,o){var a=e.readUshort(i,n);n+=2;var s={};o.push(s);for(var l=0;l<a;l++){var u=e.readUshort(i,n);n+=2;var h=e.readUshort(i,n);n+=2;var c=e.readUint(i,n);n+=4;var f=e.readUint(i,n);n+=4;var p=[];if(s["t"+u]=p,1==h||7==h)for(var d=0;d<c;d++)p.push(i[(c<5?n-4:f)+d]);if(2==h&&p.push(e.readASCII(i,c<5?n-4:f,c-1)),3==h)for(d=0;d<c;d++)p.push(e.readUshort(i,(c<3?n-4:f)+2*d));if(4==h)for(d=0;d<c;d++)p.push(e.readUint(i,(c<2?n-4:f)+4*d));if(5==h)for(d=0;d<c;d++)p.push(e.readUint(i,f+8*d)/e.readUint(i,f+8*d+4));if(8==h)for(d=0;d<c;d++)p.push(e.readShort(i,(c<3?n-4:f)+2*d));if(9==h)for(d=0;d<c;d++)p.push(e.readInt(i,(c<2?n-4:f)+4*d));if(10==h)for(d=0;d<c;d++)p.push(e.readInt(i,f+8*d)/e.readInt(i,f+8*d+4));if(11==h)for(d=0;d<c;d++)p.push(e.readFloat(i,f+4*d));if(12==h)for(d=0;d<c;d++)p.push(e.readDouble(i,f+8*d));if(0!=c&&0==p.length&&r("unknown TIFF tag type: ",h,"num:",c),330==u)for(d=0;d<c;d++)t._readIFD(e,i,p[d],o)}return n},t._writeIFD=function(e,i,n,r){var o=Object.keys(r);e.writeUshort(i,n,o.length);for(var a=(n+=2)+12*o.length+4,s=0;s<o.length;s++){var l=o[s],u=parseInt(l.slice(1)),h=t.ttypes[u];if(null==h)throw new Error("unknown type of tag: "+u);var c=r[l];2==h&&(c=c[0]+"\0");var f=c.length;e.writeUshort(i,n,u),n+=2,e.writeUshort(i,n,h),n+=2,e.writeUint(i,n,f);var p=[-1,1,1,2,4,8,0,0,0,0,0,0,8][h]*f,d=n+=4;if(p>4&&(e.writeUint(i,n,a),d=a),2==h&&e.writeASCII(i,d,c),3==h)for(var g=0;g<f;g++)e.writeUshort(i,d+2*g,c[g]);if(4==h)for(g=0;g<f;g++)e.writeUint(i,d+4*g,c[g]);if(5==h)for(g=0;g<f;g++)e.writeUint(i,d+8*g,Math.round(1e4*c[g])),e.writeUint(i,d+8*g+4,1e4);if(12==h)for(g=0;g<f;g++)e.writeDouble(i,d+8*g,c[g]);p>4&&(a+=p+=1&p),n+=4}return[n,a]},t.toRGBA8=function(t){var e=t.width,i=t.height,n=e*i,o=4*n,a=t.data,s=new Uint8Array(4*n),l=t.t262[0],u=t.t258?Math.min(32,t.t258[0]):1,h=t.isLE?1:0;if(0==l)for(var c=Math.ceil(u*e/8),f=0;f<i;f++){var p=f*c,d=f*e;if(1==u)for(var g=0;g<e;g++){var y=d+g<<2,m=a[p+(g>>3)]>>7-(7&g)&1;s[y]=s[y+1]=s[y+2]=255*(1-m),s[y+3]=255}if(4==u)for(g=0;g<e;g++){y=d+g<<2,m=a[p+(g>>1)]>>4-4*(1&g)&15;s[y]=s[y+1]=s[y+2]=17*(15-m),s[y+3]=255}if(8==u)for(g=0;g<e;g++){y=d+g<<2,m=a[p+g];s[y]=s[y+1]=s[y+2]=255-m,s[y+3]=255}}else if(1==l)for(c=Math.ceil(u*e/8),f=0;f<i;f++){p=f*c,d=f*e;if(1==u)for(g=0;g<e;g++){y=d+g<<2,m=a[p+(g>>3)]>>7-(7&g)&1;s[y]=s[y+1]=s[y+2]=255*m,s[y+3]=255}if(2==u)for(g=0;g<e;g++){y=d+g<<2,m=a[p+(g>>2)]>>6-2*(3&g)&3;s[y]=s[y+1]=s[y+2]=85*m,s[y+3]=255}if(8==u)for(g=0;g<e;g++){y=d+g<<2,m=a[p+g];s[y]=s[y+1]=s[y+2]=m,s[y+3]=255}if(16==u)for(g=0;g<e;g++){y=d+g<<2,m=a[p+(2*g+h)];s[y]=s[y+1]=s[y+2]=Math.min(255,m),s[y+3]=255}}else if(2==l)if(8==u)if(t.t338)if(t.t338[0]>0)for(g=0;g<o;g++)s[g]=a[g];else for(g=0;g<o;g+=4)s[g]=a[g],s[g+1]=a[g+1],s[g+2]=a[g+2],s[g+3]=255;else{if(4==(w=t.t258?t.t258.length:3))for(g=0;g<o;g++)s[g]=a[g];if(3==w)for(g=0;g<n;g++){var v=3*g;s[y=g<<2]=a[v],s[y+1]=a[v+1],s[y+2]=a[v+2],s[y+3]=255}}else for(g=0;g<n;g++){v=6*g;s[y=g<<2]=a[v],s[y+1]=a[v+2],s[y+2]=a[v+4],s[y+3]=255}else if(3==l){var _=t.t320;for(g=0;g<n;g++){y=g<<2;var b=a[g];s[y]=_[b]>>8,s[y+1]=_[256+b]>>8,s[y+2]=_[512+b]>>8,s[y+3]=255}}else if(5==l){var w,M=(w=t.t258?t.t258.length:4)>4?1:0;for(g=0;g<n;g++){y=g<<2;var x=g*w,T=255-a[x],A=255-a[x+1],L=255-a[x+2],S=(255-a[x+3])*(1/255);s[y]=~~(T*S+.5),s[y+1]=~~(A*S+.5),s[y+2]=~~(L*S+.5),s[y+3]=255*(1-M)+a[x+4]*M}}else r("Unknown Photometric interpretation: "+l);return s},t.replaceIMG=function(){for(var e=document.getElementsByTagName("img"),i=0;i<e.length;i++){var n=e[i],r=n.getAttribute("src");if(null!=r){var o=r.split(".").pop().toLowerCase();if("tif"==o||"tiff"==o){var a=new XMLHttpRequest;t._xhrs.push(a),t._imgs.push(n),a.open("GET",r),a.responseType="arraybuffer",a.onload=t._imgLoaded,a.send()}}}},t._xhrs=[],t._imgs=[],t._imgLoaded=function(e){var i=e.target.response,n=t.decode(i),r=n[0];t.decodeImages(i,n);var o=t.toRGBA8(r),a=r.width,s=r.height,l=t._xhrs.indexOf(e.target),u=t._imgs[l];t._xhrs.splice(l,1),t._imgs.splice(l,1);var h=document.createElement("canvas");h.width=a,h.height=s;for(var c=h.getContext("2d"),f=c.createImageData(a,s),p=0;p<o.length;p++)f.data[p]=o[p];c.putImageData(f,0,0);var d=["style","class","id"];for(p=0;p<d.length;p++)h.setAttribute(d[p],u.getAttribute(d[p]));u.parentNode.replaceChild(h,u)},t._binBE={nextZero:function(t,e){for(;0!=t[e];)e++;return e},readUshort:function(t,e){return t[e]<<8|t[e+1]},readShort:function(e,i){var n=t._binBE.ui8;return n[0]=e[i+1],n[1]=e[i+0],t._binBE.i16[0]},readInt:function(e,i){var n=t._binBE.ui8;return n[0]=e[i+3],n[1]=e[i+2],n[2]=e[i+1],n[3]=e[i+0],t._binBE.i32[0]},readUint:function(e,i){var n=t._binBE.ui8;return n[0]=e[i+3],n[1]=e[i+2],n[2]=e[i+1],n[3]=e[i+0],t._binBE.ui32[0]},readASCII:function(t,e,i){for(var n="",r=0;r<i;r++)n+=String.fromCharCode(t[e+r]);return n},readFloat:function(e,i){for(var n=t._binBE.ui8,r=0;r<4;r++)n[r]=e[i+3-r];return t._binBE.fl32[0]},readDouble:function(e,i){for(var n=t._binBE.ui8,r=0;r<8;r++)n[r]=e[i+7-r];return t._binBE.fl64[0]},writeUshort:function(t,e,i){t[e]=i>>8&255,t[e+1]=255&i},writeUint:function(t,e,i){t[e]=i>>24&255,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=i>>0&255},writeASCII:function(t,e,i){for(var n=0;n<i.length;n++)t[e+n]=i.charCodeAt(n)},writeDouble:function(e,i,n){t._binBE.fl64[0]=n;for(var r=0;r<8;r++)e[i+r]=t._binBE.ui8[7-r]}},t._binBE.ui8=new Uint8Array(8),t._binBE.i16=new Int16Array(t._binBE.ui8.buffer),t._binBE.i32=new Int32Array(t._binBE.ui8.buffer),t._binBE.ui32=new Uint32Array(t._binBE.ui8.buffer),t._binBE.fl32=new Float32Array(t._binBE.ui8.buffer),t._binBE.fl64=new Float64Array(t._binBE.ui8.buffer),t._binLE={nextZero:t._binBE.nextZero,readUshort:function(t,e){return t[e+1]<<8|t[e]},readShort:function(e,i){var n=t._binBE.ui8;return n[0]=e[i+0],n[1]=e[i+1],t._binBE.i16[0]},readInt:function(e,i){var n=t._binBE.ui8;return n[0]=e[i+0],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t._binBE.i32[0]},readUint:function(e,i){var n=t._binBE.ui8;return n[0]=e[i+0],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t._binBE.ui32[0]},readASCII:t._binBE.readASCII,readFloat:function(e,i){for(var n=t._binBE.ui8,r=0;r<4;r++)n[r]=e[i+r];return t._binBE.fl32[0]},readDouble:function(e,i){for(var n=t._binBE.ui8,r=0;r<8;r++)n[r]=e[i+r];return t._binBE.fl64[0]}},t._copyTile=function(t,e,i,n,r,o,a,s){for(var l=Math.min(e,r-a),u=Math.min(i,o-s),h=0;h<u;h++)for(var c=(s+h)*r+a,f=h*e,p=0;p<l;p++)n[c+p]=t[f+p]}}(n,i(259))}()}).call(this,i(18))},function(t,e,i){"use strict";var n={};(0,i(30).assign)(n,i(260),i(261),i(88)),t.exports=n},function(t,e,i){"use strict";var n=i(126),r=i(30),o=i(140),a=i(87),s=i(86),l=Object.prototype.toString;function u(t){if(!(this instanceof u))return new u(t);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==i)throw new Error(a[i]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var h;if(h="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(i=n.deflateSetDictionary(this.strm,h)))throw new Error(a[i]);this._dict_set=!0}}function h(t,e){var i=new u(e);if(i.push(t,!0),i.err)throw i.msg||a[i.err];return i.result}u.prototype.push=function(t,e){var i,a,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=o.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(u),s.next_out=0,s.avail_out=u),1!==(i=n.deflate(s,a))&&0!==i)return this.onEnd(i),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==i);return 4===a?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,0===i):2!==a||(this.onEnd(0),s.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=u,e.deflate=h,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,h(t,e)}},function(t,e,i){"use strict";var n=i(129),r=i(30),o=i(140),a=i(88),s=i(87),l=i(86),u=i(262),h=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,e.windowBits);if(i!==a.Z_OK)throw new Error(s[i]);this.header=new u,n.inflateGetHeader(this.strm,this.header)}function f(t,e){var i=new c(e);if(i.push(t,!0),i.err)throw i.msg||s[i.err];return i.result}c.prototype.push=function(t,e){var i,s,l,u,c,f,p=this.strm,d=this.options.chunkSize,g=this.options.dictionary,y=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof t?p.input=o.binstring2buf(t):"[object ArrayBuffer]"===h.call(t)?p.input=new Uint8Array(t):p.input=t,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new r.Buf8(d),p.next_out=0,p.avail_out=d),(i=n.inflate(p,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&g&&(f="string"==typeof g?o.string2buf(g):"[object ArrayBuffer]"===h.call(g)?new Uint8Array(g):g,i=n.inflateSetDictionary(this.strm,f)),i===a.Z_BUF_ERROR&&!0===y&&(i=a.Z_OK,y=!1),i!==a.Z_STREAM_END&&i!==a.Z_OK)return this.onEnd(i),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&i!==a.Z_STREAM_END&&(0!==p.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(p.output,p.next_out),u=p.next_out-l,c=o.buf2string(p.output,l),p.next_out=u,p.avail_out=d-u,u&&r.arraySet(p.output,p.output,l,u,0),this.onData(c)):this.onData(r.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(y=!0)}while((p.avail_in>0||0===p.avail_out)&&i!==a.Z_STREAM_END);return i===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),p.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=c,e.inflate=f,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},e.ungzip=f},function(t,e,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,i){"use strict";t.exports=function(t,e){}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return Object.defineProperty(t,"isWorker",{get:function(){try{return!window.document}catch(t){return!0}},enumerable:!0,configurable:!0}),t}();e.Thread=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.maxTask=3,this.numberOfRunningTask=0,this.worker=t}return t.prototype.finishedTask=function(){this.numberOfRunningTask=Math.max(this.numberOfRunningTask-1,0)},t.prototype.canExecuteTask=function(){return this.numberOfRunningTask<this.maxTask},t.prototype.executeTask=function(t){if(this.canExecuteTask()){var e={execute:!0,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask+=1}},t.prototype.cancel=function(t){var e={execute:!1,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask=Math.max(this.numberOfRunningTask-1,0)},t}();e.TaskWorker=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(20),o=i(267),a=i(10),s=function(){function t(){}return t.loadModel=function(t,e){if(void 0===e&&(e=!1),0==t.length)return null;for(var i=t.split("\n").map((function(t){return t.trim().toLowerCase().split(" ").filter((function(t){return""!==t}))})),s=[new r.Vector3],l=[new r.Vector3],u=[new n.Vector2],h=[],c=null,f=[],p=-1,d=null,g=Number.MAX_VALUE,y=Number.MAX_VALUE,m=Number.MAX_VALUE,v=Number.MIN_VALUE,_=Number.MIN_VALUE,b=Number.MIN_VALUE,w=[],M=0,x=i;M<x.length;M++){var T=x[M],A=T[0];if("v"==A){var L=+T[1]||0,S=+T[2]||0,E=+T[3]||0,I=new r.Vector3(L,S,E);s.push(I),S>p&&(p=S,d=I),g=Math.min(g,L),v=Math.max(v,L),y=Math.min(y,E),_=Math.max(_,E),m=Math.min(m,S),b=Math.max(b,S)}else if("vn"==A){L=+T[1]||0,S=+T[2]||0,E=+T[3]||0;l.push(new r.Vector3(L,S,E))}else if("vt"==A){L=+T[1]||0,S=+T[2]||0;u.push(new n.Vector2(L,S))}else if("f"==A)for(var P=0;P<3;P++){var C=T[P+1].split("/"),O=(I=s[+C[0]||0],u[+C[1]||0]),R=l[+C[2]||0];c||(c=new o.ModelGeometry,h.push(c)),f.push(I.x),f.push(I.y),f.push(I.z),f.push(O.x),f.push(O.y),f.push(R.x),f.push(R.y),f.push(R.z),w.push(new a.Point(I.x,I.z)),c.numberOfVertices++}}return h[0].data=e?new Float32Array(f).buffer:f,h[0].points=w,h[0].highestPosition=d,h[0].minX=g,h[0].minY=y,h[0].minZ=m,h[0].maxX=v,h[0].maxY=_,h[0].maxZ=b,h},t}();e.ObjModelLoader=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.numberOfVertices=0};e.ModelGeometry=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(23),r=i(0),o=i(269),a=function(){function t(t,e){this.mapState=e,this.gl=t,this.layerRenderers=n(r.compareLayerId)}return t.prototype.render=function(){this.mapState.is3dMode()&&this.effectManager.enableShadowEffect&&this.layerRenderers.forEach((function(t,e){e.renderShadowMapping()})),this.layerRenderers.forEach((function(t,e){e.render()}))},t.prototype.renderSelection=function(){this.layerRenderers.forEach((function(t,e){e.renderSelection()}))},t.prototype.addLayer=function(t){this.layerRenderers=this.layerRenderers.insert(new r.LayerId(t.getLayerId(),t.getOrder()),o.LayerRenderFactory.create(this.gl,this.mapState,t))},t.prototype.setEffectManager=function(t){this.effectManager=t},t.prototype.removeLayer=function(t,e){var i=new r.LayerId(t,e);this.layerRenderers=this.layerRenderers.remove(i)},t}();e.MapRenderer=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(270),o=i(272),a=i(273),s=i(274),l=i(89),u=i(275),h=i(90),c=i(276),f=i(277),p=i(278),d=i(279),g=i(280),y=i(281),m=i(282),v=i(283),_=i(284),b=i(285),w=function(){function t(){}return t.create=function(t,e,i){switch(i.getLayerType()){case n.LayerType.SURFACE:return new m.SurfaceLayerRenderer(e,i);case n.LayerType.BOUNDARY:return new v.BoundaryLayerRenderer(e,i);case n.LayerType.ROADS:return new _.RoadLayerRenderer(e,i);case n.LayerType.LABEL:return new b.LabelLayerRenderer(e,i);case n.LayerType.RASTER:return new r.RasterLayerRenderer(e,i);case n.LayerType.RASTER_OVERLAY:return new d.RasterOverlayRenderer(e,i);case n.LayerType.BUILDING:return new l.BuildingLayerRenderer(t,e,i);case n.LayerType.LINE:return new o.LineLayerRenderer(e,i);case n.LayerType.FILL:return new a.FillLayerRenderer(e,i);case n.LayerType.CIRCLE:return new s.CircleLayerRenderer(e,i);case n.LayerType.SYMBOL:return new u.SymbolLayerRenderer(e,i);case n.LayerType.POI:return new h.POILayerRenderer(e,i);case n.LayerType.POI_OVERLAY:return new g.POIOverlayRenderer(e,i);case n.LayerType.USERPOI:return new f.UserPOILayerRenderer(e,i);case n.LayerType.USERBUILDING:return new p.UserBuildingLayerRenderer(t,e,i);case n.LayerType.BUILDING_OVERLAY:return new y.BuildingOverlayRender(t,e,i);case n.LayerType.GEOJSON:return new c.GeoJsonLayerRenderer(e,i);default:console.error("Invalid layer type")}},t}();e.LayerRenderFactory=w},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(11),a=i(8),s=i(15),l=i(2),u=i(9),h=i(7),c=i(6),f=i(3),p=i(17),d=i(12),g=i(49),y=i(19),m=i(26),v=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.time=0,n.mvpMatrix=new u.Matrix4,n.modelMatrix=new u.Matrix4,n}return r(e,t),e.prototype.render=function(){var t=this,e=this.layer.mapView.gl,i=o.ResourceManager.getInstance(e),n=this.mapState.is3dMode()&&this.mapState.getTilt()>l.MapConstants.maxTiltIntersectWithScreen,r=i.getModel(o.ModelEnum.RASTER_MODEL),s=null,u=this.layer,v=u.effectManager,_=this.mapState.is3dMode()&&v.enableShadowEffect,b=this.mapState.getViewProjectionMatrix();if(r.bind(),n){(s=_?i.getShader(o.ShaderEnum.RASTER_3D_WITH_SHADOW_SHADER):i.getShader(o.ShaderEnum.RASTER_FOG_SHADER)).bind(),s.setAttributes(r.attributeInfos);var w=l.MapConstants.defaultMaxNativeZoom,M=u.timeEffectManager.getFogColor(),x=6*Math.max(this.mapState.getZoom()-w,0),T=u.lightManager.sunLight;s.setUniforms([new a.UniformInfo("u_light_color","3fv",T.lightColor.rgbBuffer()),new a.UniformInfo("u_light_position","3f",T.lightPosition),new a.UniformInfo("u_fogStart","1f",22+x),new a.UniformInfo("u_fogRange","1f",10+x),new a.UniformInfo("u_fogColor","3fv",M.rgbBuffer())])}else(s=_?i.getShader(o.ShaderEnum.RASTER_WITH_SHADOW_SHADER):i.getShader(o.ShaderEnum.RASTER_SHADER)).bind(),s.setAttributes(r.attributeInfos);if(this.mapState.is3dMode()&&this.mapState.getTilt()>l.MapConstants.maxTiltIntersectWithScreen){var A=d.Color.fromHex(l.MapConstants.mapBackgroundColor3D),L=i.getTexture(o.TextureEnum.WHITE_TEXTURE);L.loadColor(A);var S=new y.CameraPosition(this.mapState.cameraPosition.target,this.mapState.cameraPosition.tilt,0,this.mapState.cameraPosition.zoom),E=this.mapState.getScreenSize(),I=m.CameraUtils.calculateViewProjectionMatrix(S,E.x,E.y),P=c.ProjectionMercator.projectScale(this.mapState.getTarget(),this.mapState.scale),C=h.GeometryUtils.pixelCoordinateToCameraCoordinate(new f.Vector2(P.x,P.y),this.mapState.cameraPosition);this.mvpMatrix.setIdentity(),this.mvpMatrix.translate(C.x,C.y,0),this.mvpMatrix.scale(l.MapConstants.mapBackgroundScaleRatio,l.MapConstants.mapBackgroundScaleRatio,1),this.mvpMatrix.concat(I),s.setUniforms([new a.UniformInfo("u_texture","texture",L),new a.UniformInfo("u_mvpMatrix","matrix",this.mvpMatrix)]),r.render(e.TRIANGLES),s.resetTextureUnit()}var O=i.getTexture(o.TextureEnum.WATER_DISPLACEMENT),R=i.getTexture(o.TextureEnum.WATER_COLOR),D=u.effectManager.enableWaterEffect&&this.mapState.is3dMode()?1:0,k=u.lightManager.sunLight;this.time+=8e-4,s.setUniforms([new a.UniformInfo("u_light_color","3fv",k.lightColor.rgbBuffer()),new a.UniformInfo("u_light_position","3f",k.lightPosition),new a.UniformInfo("u_time","1f",this.time),new a.UniformInfo("u_enableWater","1i",D)]);var B=this.getRenderTiles();B.forEach((function(i){var n=i.getTile();if(n.getKind()==p.Kind.BASEMAP){var o=n.getTileRenderData().getLayerRenderData(l.LayerConstants.rasterTileLayerId);if(o){var u=o.getTexture();if(null!=u){if(t.mapState.matrixFor(t.modelMatrix,i.getUnwrappedTileCoordinate()),_){var h=v.shadowMap,c=t.mvpMatrix.copy(t.modelMatrix);t.mvpMatrix.concat(h.getLightViewProjectionMatrix()).concat(l.MapConstants.biasMatrix),s.setUniforms([new a.UniformInfo("u_shadowMap","texture",h.getShadowMapTexture()),new a.UniformInfo("u_shadowMvpMatrix","matrix",c)])}t.mvpMatrix.copy(t.modelMatrix),t.mvpMatrix.concat(b),s.setUniforms([new a.UniformInfo("u_waterDisplacement","texture",O),new a.UniformInfo("u_waterColor","texture",R),new a.UniformInfo("u_texture","texture",u),new a.UniformInfo("u_mvpMatrix","matrix",t.mvpMatrix)]),r.render(e.TRIANGLES),s.resetTextureUnit()}}}else console.log("Tile is not base map")})),g.Env.isTileDebug&&((s=i.getShader(o.ShaderEnum.TILE_DEBUG_SHADER)).bind(),s.setAttributes(r.attributeInfos),B.forEach((function(i){i.getTile().getKind()==p.Kind.BASEMAP?(t.mapState.matrixFor(t.modelMatrix,i.getUnwrappedTileCoordinate()),t.mvpMatrix.copy(t.modelMatrix),t.mvpMatrix.concat(b),s.setUniforms([new a.UniformInfo("u_mvpMatrix","matrix",t.mvpMatrix)]),r.render(e.LINE_STRIP)):console.log("Tile is not base map")}))),r.unbind(),s.disableAttributes(),this.mapState.is3dMode()&&this.mapState.getTilt()>l.MapConstants.maxTiltIntersectWithScreen&&u.skyRenderer.render(u.skyObject,this.mapState)},e}(s.LayerRenderer);e.RasterLayerRenderer=v},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.lightEffect="\n    vec4 calculateLightEffect(vec3 normal, vec3 light, vec3 camera, vec3 light_color, vec4 material_color) {\n        vec4 ambient_color = vec4(0.03, 0.03, 0.03, 0);\n        material_color += ambient_color;\n        \n        float light_intensity = 1.0;\n        vec3 diffuse = vec3(1.0, 1.0, 1.0);\n        float diffuseCoefficient1 = max(0.0, dot(normal, light));\n        diffuseCoefficient1 = diffuseCoefficient1 * light_intensity;\n        diffuseCoefficient1 = clamp(diffuseCoefficient1, 0.0, 1.0);\n\n        float diffuseCoefficient2 = max(0.0, dot(normal, camera));\n        diffuseCoefficient2 = clamp(diffuseCoefficient2, 0.0, 1.0);\n        \n        vec4 finalColor = vec4(mix(material_color.rgb, diffuseCoefficient1 * light_color, diffuseCoefficient1 * 0.35), material_color.a);\n        finalColor = vec4(mix(finalColor.rgb, diffuseCoefficient2 * material_color.rgb, diffuseCoefficient2 * 0.35), finalColor.a);   \n        \n        return finalColor;\n    }\n  ",t.waterFragment="\n    vec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time) {\n      float eps = 0.01;\n      if (abs(tileColor.x - 0.639) < eps && abs(tileColor.y - 0.8) < eps && abs(tileColor.z - 1.0) < eps) {\n        vec2 displacement = texture2D( waterDispl, 4.0 * vec2(uv.x, uv.y + time )).rg;\n        vec2 offset = (displacement * 2.0 - 1.0) * 0.2;\n        vec4 color = texture2D(waterColor, uv * 2.0 + offset);\n        return color;\n      } else {\n        return tileColor;\n      } \n    }\n  ",t.basicVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n}\n   ",t.basicFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;\nuniform int u_enableWater;   \n \nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    vec4 tileColor = texture2D(u_texture, v_uv);     \n  \n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    gl_FragColor = vertexColor;\n}  \n  "+t.waterFragment,t.rasterFogVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n}\n   ",t.rasterFogFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform vec3 u_light_color;\nuniform vec3 u_light_position;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\n\nvarying vec2 v_uv;\n\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;   \nuniform int u_enableWater;\n \nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    float light_intensity = 1.0;\n    \n    // initialize\n    vec3 diffuse = vec3(1.0, 1.0, 1.0);\n    vec3 v_normal = vec3(0.0, 0.0, 1.0);\n    vec4 tileColor = texture2D(u_texture, v_uv); \n    \n    // diffuse\n    float diffuseCoefficient = max(0.0, dot(normalize(v_normal), normalize(u_light_position)));\n    diffuseCoefficient = mix((1.0 - light_intensity), max((0.5 + light_intensity), 1.0), diffuseCoefficient);\n    diffuse = clamp(diffuseCoefficient * u_light_color, mix(vec3(0.0), vec3(0.3), 1.0 - u_light_color), vec3(1.0));\n    vec4 vertexLightColor = vec4(mix(tileColor.rgb, diffuseCoefficient * diffuse, 0.3), tileColor.a);\n    \n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    vertexColor = vec4(mix(vertexColor.rgb, vertexLightColor.rgb, 0.2), vertexColor.a);\n    \n    // fog\n    float dist = (gl_FragCoord.z / gl_FragCoord.w);\n    float visibility = (dist - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    gl_FragColor = vec4(mix(vertexColor.rgb, u_fogColor, visibility), vertexColor.a);\n} \n  "+t.waterFragment,t.polylineVS="\nattribute vec2 a_position;\nattribute vec2 a_extrude;\nattribute vec2 a_uv;\n\nuniform float u_lineWidth;\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  vec2 delta = (u_lineWidth / 2.0) * a_extrude;\n  v_uv = a_uv;\n  gl_Position = u_mvpMatrix * vec4(a_position + delta, 0.0, 1.0);\n}\n  ",t.polylineFS="\nprecision mediump float;\n\nuniform vec4 u_color;\nuniform float u_textureScale;\nuniform bool u_isDotted;\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  if (u_isDotted) {\n    vec2 line_st = vec2(v_uv.x * u_textureScale, v_uv.y);\n    vec4 line_color = texture2D(u_texture, line_st);\n    if (line_color.r > 0.9) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n}\n  ",t.fillVS="\nattribute vec2 a_position;\n\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 0.0, 1.0);\n}\n  ",t.fillFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.geoJsonVS="\nattribute vec2 a_position;\nattribute vec2 a_extrude;\n\nuniform float u_lineWidth;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  vec2 delta = (u_lineWidth / 2.0) * a_extrude;\n  gl_Position = u_mvpMatrix * vec4(a_position + delta, 0.0, 1.0); \n}\n  ",t.geoJsonFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.circleVS="\n  precision highp float;\nattribute vec2 a_extrude;\n\nuniform float u_radius;\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_extrude;\n\nvoid main() {\n    vec2 circleExtrude = u_radius * a_extrude;\n    gl_Position = u_mvpMatrix * vec4(circleExtrude, 0, 1);\n    v_extrude = circleExtrude;        \n}\n  ",t.circleFS="\nprecision highp float;\n\nuniform vec4 u_color;\nuniform mat4 u_mvpMatrix;\nuniform float u_strokeWidth;\nuniform vec4 u_strokeColor;\nuniform float u_outerRadius;\nuniform float u_innerRadius;\n\nvarying vec2 v_extrude;\n\nvoid main() {      \n \n    float dist = length(v_extrude);\n    if (dist - u_outerRadius >= 0.0) {\n      discard;\n    }            \n    if (dist - u_innerRadius >= 0.0){\n      gl_FragColor = u_strokeColor;\n    }\n    else {\n      gl_FragColor = u_color;\n    }\n}\n  ",t.markerVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n}\n  ",t.markerFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n  ",t.buildingVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\nattribute vec3 a_normal;\n\nuniform mat4 u_modelMatrix;\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\nvarying vec3 v_position;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n    v_uv = a_uv;\n    // Convert normal vector to world space (make sure that we don't translate it)\n    v_normal = normalize(vec3((u_modelMatrix * vec4(a_normal, 0.0)).xyz));\n    v_position = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n}\n  ",t.buildingFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform vec3 u_light_color;\nuniform vec3 u_light_position;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\nuniform vec3 u_camera_direction;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\nvarying vec3 v_position;\n\nvec4 calculateLightEffect(vec3 normal, vec3 light, vec3 camera, vec3 light_color, vec4 material_color);\n\nvoid main() {\n    vec4 material_color = texture2D(u_texture, v_uv);\n    vec4 vertexColor = calculateLightEffect(normalize(v_normal), normalize(u_light_position), normalize(u_camera_direction), u_light_color, material_color);\n    \n    float distance = distance(v_position, vec3(0));\n    // fog\n    float visibility = (distance - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    gl_FragColor = vec4(mix(vertexColor.rgb, u_fogColor, visibility), vertexColor.a);\n    \n    if (gl_FragColor.a < 0.3 || visibility >= 0.5) {\n      discard;\n    }\n}\n  "+t.lightEffect,t.buildingSelectionVS="\nattribute vec3 a_position;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n}\n  ",t.buildingSelectionFS="\nprecision mediump float;\nuniform vec3 u_color;\n\nvoid main() {\n    gl_FragColor = vec4(u_color, 1.0);\n}\n  ",t.debugSelectionVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    \n    varying vec2 v_uv;\n    \n    void main() {\n      gl_Position = vec4(a_position, 1.0);\n      v_uv = a_uv;\n    }\n  ",t.debugSelectionFS="\n    precision mediump float;\n    \n    uniform sampler2D u_texture;\n    varying vec2 v_uv;\n    \n    void main() {\n        gl_FragColor = texture2D(u_texture, vec2(v_uv.x , 1.0 - v_uv.y));\n    }\n\n  ",t.skyVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\nuniform mat4 u_mvpMatrix;\nuniform mat4 u_viewMatrix;\n\nvarying vec3 v_position;\n\nvoid main() { \n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  gl_Position.z = gl_Position.w - 0.000001;  \n  v_position = gl_Position.xyz;\n}\n  ",t.skyFS="\nprecision mediump float;\nuniform float u_lowerLimit;\nuniform float u_upperLimit;\n\nuniform vec3 u_skyColor;\nuniform vec3 u_fogColor;\n\nvarying vec3 v_position;\n\nvoid main() {\n  float factor = (v_position.y - u_lowerLimit) / (u_upperLimit - u_lowerLimit);       \n  factor = clamp(factor, 0.05, 1.0);  \n  if (v_position.y > u_lowerLimit) {\n    gl_FragColor = vec4(mix(u_fogColor.rgb, u_skyColor.rgb, factor), 1.0);\n  } else {\n    discard;\n  }      \n}\n  ",t.shadowMappingVS="\n    attribute vec3 a_position;\n\n    uniform mat4 u_shadowMvpMatrix;\n    \n    varying vec4 v_position;\n\n    void main() {\n      gl_Position = u_shadowMvpMatrix * vec4(a_position, 1.0);\n      v_position = gl_Position;\n    }\n   ",t.shadowMappingFS="\n    precision mediump float;\n    \n    varying vec4 v_position;\n    \n    vec4 pack(float depth) {\n        depth *= (256.0 * 256.0 * 256.0 - 1.0) / (256.0 * 256.0 * 256.0);\n        vec4 encode = fract(depth * vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0) );\n        return vec4(encode.xyz - encode.yzw / 256.0, encode.w ) + 1.0 / 512.0;\n    }\n\n    void main() {\n      float depth = v_position.z / v_position.w;\n      depth = (depth + 1.0) / 2.0;\n      gl_FragColor = pack(depth);\n    }  \n  ",t.shadowFS="\n  \n    float unpack(vec4 pack) {\n      float depth = dot(pack, 1.0 / vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0));\n      return depth * (256.0 * 256.0 * 256.0) / (256.0 * 256.0 * 256.0 - 1.0);\n    }\n  \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias) {\n      float shadowFactor = 1.0;\n      vec4 shadowMapPosition = shadowCoord / shadowCoord.w;\n      bool inShadowArea = (shadowMapPosition.x >= 0.0 && shadowMapPosition.x <= 1.0) && \n      (shadowMapPosition.y >= 0.0 && shadowMapPosition.y <= 1.0) && \n      (shadowMapPosition.z >= 0.0 && shadowMapPosition.z <= 1.0);\n      if (inShadowArea) {\n        float distanceFromLight = unpack(texture2D(shadowMap, shadowMapPosition.xy));\t\n        if (distanceFromLight  + bias < shadowMapPosition.z  ) {\n          shadowFactor = 0.7;   \n        }\n      }\n      return shadowFactor;\n    }\n    \n  ",t.raster3DWithShadowVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\nuniform mat4 u_shadowMvpMatrix;\n\nvarying vec2 v_uv;\nvarying vec4 v_shadowCoord;\nvarying vec3 v_position;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n  // Calculate shadow coordinate\n  v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0);\n}\n   ",t.raster3DWithShadowFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\n// The shadow map\nuniform sampler2D u_shadowMap;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\nuniform vec3 u_light_color;\nuniform vec3 u_light_position;\n\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;\nuniform int u_enableWater;\n    \nvarying vec2 v_uv;\nvarying vec4 v_shadowCoord;\nvarying vec3 v_position;\n    \nfloat calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    float light_intensity = 1.0;\n\n    // initialize\n    vec3 diffuse = vec3(1.0, 1.0, 1.0);\n    vec3 v_normal = vec3(0.0, 0.0, 1.0);\n    vec4 tileColor = texture2D(u_texture, v_uv);\n    \n    // diffuse\n    float diffuseCoefficient = max(0.0, dot(normalize(v_normal), normalize(u_light_position)));\n    diffuseCoefficient = mix((1.0 - light_intensity), max((0.5 + light_intensity), 1.0), diffuseCoefficient);\n    diffuse = clamp(diffuseCoefficient * u_light_color, mix(vec3(0.0), vec3(0.3), 1.0 - u_light_color), vec3(1.0));\n    vec4 vertexLightColor = vec4(mix(tileColor.rgb, diffuseCoefficient * diffuse, 0.3), tileColor.a);\n    \n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    vertexColor = vec4(mix(vertexColor.rgb, vertexLightColor.rgb, 0.2), vertexColor.a);\n    \n    // fog\n    float dist = (gl_FragCoord.z / gl_FragCoord.w);\n    float visibility = (dist - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    float shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, 0.0005);\n    vec3 vertexWithFogColor = mix(vertexColor.rgb, u_fogColor.rgb, visibility);\n    gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), vertexWithFogColor, shadowFactor), vertexColor.a);\n} \n  "+t.waterFragment,t.rasterWithShadowVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n\n    uniform mat4 u_mvpMatrix;\n    uniform mat4 u_shadowMvpMatrix;\n\n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n\n    void main() {\n      gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n      v_uv = a_uv;\n      // Calculate shadow coordinate\n      v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0);\n    }\n   ",t.rasterWithShadowFS="\n    precision mediump float;\n    \n    // The texture\n    uniform sampler2D u_texture;\n    // The shadow map\n    uniform sampler2D u_shadowMap;\n    \n    uniform sampler2D u_waterDisplacement;\n    uniform sampler2D u_waterColor;\n    uniform float u_time;\n    uniform int u_enableWater;\n \n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n    \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\n    vec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n    \n    void main() {\n      vec4 tileColor = texture2D(u_texture, v_uv);\n      vec4 rasterColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n      float shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, 0.0005);\n      gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), rasterColor.rgb, shadowFactor), rasterColor.a);      \n    }\n  "+t.waterFragment,t.buildingWithShadowVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    attribute vec3 a_normal;\n\n    uniform mat4 u_modelMatrix;\n    uniform mat4 u_mvpMatrix;\n    uniform mat4 u_shadowMvpMatrix;\n\n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n    varying vec3 v_normal;\n    varying vec3 v_position;\n    \n    void main() { \n      gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n      v_uv = a_uv;\n      // Convert normal vector to world space (make sure that we don't translate it)\n      vec3 normal = normalize(vec3((u_modelMatrix * vec4(a_normal, 0.0)).xyz));\n      v_position = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n      v_normal = normal;\n      \n      // Calculate shadow coordinate\n      v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0); \n    }\n  ",t.buildingWithShadowFS="\n    precision mediump float;\n\n    uniform sampler2D u_texture;\n    uniform sampler2D u_shadowMap;   \n    uniform float u_fogStart;\n    uniform float u_fogRange;\n    uniform vec3 u_fogColor;\n    uniform vec3 u_light_color;\n    uniform vec3 u_light_position;\n    uniform vec3 u_camera_direction;\n    \n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n    varying vec3 v_normal;\n    varying vec3 v_position;\n    \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\n\n    float calculateBias() {\n      float bias;\n      vec3 n = normalize(v_normal); \n      vec3 l = normalize(u_light_position);\n      float cosTheta = clamp( dot( n,l ), 0.0, 1.0 );\n      bias = 0.0001 * tan(acos(cosTheta));\n      bias = clamp(bias, 0.0, 0.01);\n      return bias;\n    }\n    \n    vec4 calculateLightEffect(vec3 normal, vec3 light, vec3 camera, vec3 light_color, vec4 material_color);\n    \n    void main() {\n      vec4 material_color = texture2D(u_texture, v_uv);\n      float bias = calculateBias();\n      float shadowFactor = 1.0;\n      if (bias >= 0.01) {\n        shadowFactor = 0.7;\n      }\n      else {\n        shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, bias);\n      }\n      \n      vec4 vertexColor = calculateLightEffect(normalize(v_normal), normalize(u_light_position), normalize(u_camera_direction), u_light_color, material_color);\n      \n      // fog\n      float distance = distance(v_position, vec3(0));\n      float visibility = (distance - u_fogStart) / u_fogRange;\n      visibility = clamp(visibility, 0.0, 1.0);\n      vec3 vertexWithFogColor = mix(vertexColor.rgb, u_fogColor.rgb, visibility);\n      \n      gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), vertexWithFogColor, shadowFactor), material_color.a);\n      \n      if (gl_FragColor.a < 0.3 || visibility >= 0.5) {\n        discard;\n      }\n    }\n  "+t.lightEffect,t.buildingOutliningFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n  ",t.textLabelVS="\nattribute vec2 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\nuniform vec2 u_texsize;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 0.0, 1.0);\n  v_uv = a_uv / u_texsize;\n}\n   ",t.textLabelFS="\n#define SDF_PX 8.0\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform float u_pixel_scale;\nuniform vec4 u_color;\nuniform float u_gamma_scale;\nuniform bool u_is_halo;\nuniform float u_text_size;\n\nvarying vec2 v_uv;\n\nvoid main() {\n     lowp float dist = texture2D(u_texture, v_uv).r;\n     float font_scale = u_text_size / 24.0;\n     lowp float buff = (256.0 - 64.0) / 256.0;\n     highp float edge_gamma = 0.105;\n     highp float gamma = edge_gamma / font_scale;\n     if (u_is_halo) {\n      float halo_width = u_pixel_scale * font_scale;\n      float halo_blur = 0.01;\n      gamma = (halo_blur * 1.19 / SDF_PX + edge_gamma) / (font_scale * u_gamma_scale);\n      buff = (6.0 - halo_width / font_scale) / SDF_PX;\n     }\n     highp float alpha = smoothstep(buff - gamma, buff + gamma, dist);\n     gl_FragColor = vec4(u_color.rgb, alpha * u_color.a);\n}  \n  ",t.tileDebugVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n}\n   ",t.tileDebugFS="\nprecision mediump float;  \n\nvoid main() {\n    gl_FragColor = vec4(0.1, 0.2, 0.3, 1.0);\n}\n  ",t.collisionDebugVS="\nprecision mediump float;\n\nattribute vec2 a_position;\n\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 0.0, 1.0);\n}\n  ",t.collisionDebugFS="\nprecision mediump float;  \n\nuniform vec3 u_color;\n\nvoid main() {\n  gl_FragColor = vec4(u_color, 1.0);\n}\n  ",t}();e.ShaderSource=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(3),s=i(11),l=i(8),u=i(1),h=i(9),c=i(17),f=i(7),p=i(6),d=i(15),g=i(2),y=i(36),m=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mvpMatrix=new h.Matrix4,n}return r(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==o.LayerType.LINE){var e=this.layer;if(0!=e.renderTiles.size){var i=!1,n=this.layer.mapView.gl,r=s.ResourceManager.getInstance(n).getShader(s.ShaderEnum.POLYLINE_SHADER);n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),r.bind();var h=p.ProjectionMercator.worldSize(this.mapState.getScale()),d=this.layer.getLayerId(),m=1;this.mapState.getZoom()>this.mapState.getMaxNativeZoom()&&(m=Math.pow(2,Math.round(this.mapState.getZoom())-this.mapState.getMaxNativeZoom())),e.renderTiles.forEach((function(e){var p=e.getTile(),v=p.getKind();if(v==c.Kind.ANNOTATION||v==c.Kind.VECTOR){if(p.hasData(d)){var _=p.getTileData().getTileLayer(d).getFeature(0).getProperties(),b=_.getStrokeWidth(),w=p.getLayerData(d);if(w.getType()==o.LayerType.LINE){var M=w;i=_.getStyle()==y.PolylineStyle.Dotted;var x=p.getTileCoordinate(),T=1<<x.getZoom(),A=h/T,L=A/u.MapUtils.getTileSize(),S=f.GeometryUtils.pixelCoordinateToCameraCoordinate(new a.Vector2(x.getX()*A+A/2,x.getY()*A+A/2),t.mapState.cameraPosition);t.mvpMatrix.setIdentity(L,L,1),t.mvpMatrix.translate(S.x,S.y,t.mapState.is3dMode()?f.GeometryUtils.getElevationPixelFromMeter(_.getElevation(),t.mapState.cameraPosition):0),t.mvpMatrix.concat(t.mapState.getViewProjectionMatrix());var E,I=M.getModel();if(I.bind(),r.setAttributes(I.attributeInfos),r.setUniforms([new l.UniformInfo("u_mvpMatrix","matrix",t.mvpMatrix)]),i){E=m/b*(g.PolyConstants.polylineTextureHeight/g.PolyConstants.polylineTextureWidth);var P=s.ResourceManager.getInstance(n).getTexture(s.TextureEnum.POLYLINE_TEXTURE);r.setUniforms([new l.UniformInfo("u_texture","texture",P)])}r.setUniforms([new l.UniformInfo("u_lineWidth","1f",b/m),new l.UniformInfo("u_color","4fv",_.getStrokeColor().buffer()),new l.UniformInfo("u_isDotted","1i",i)]),i&&r.setUniforms([new l.UniformInfo("u_textureScale","1f",E)]),I.render(n.TRIANGLES)}else console.warn("ERROR: layerData.getType() != LayerType.LINE .............")}}else console.warn("Invalid tile kind")})),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),n.bindBuffer(n.ARRAY_BUFFER,null),r.disableAttributes(),n.disable(n.BLEND)}}},e}(d.LayerRenderer);e.LineLayerRenderer=m},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(3),s=i(11),l=i(8),u=i(1),h=i(9),c=i(17),f=i(7),p=i(6),d=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mvpMatrix=new h.Matrix4,n}return r(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==o.LayerType.FILL){var e=this.layer;if(0!=e.renderTiles.size){var i=this.layer.mapView.gl,n=s.ResourceManager.getInstance(i).getShader(s.ShaderEnum.FILL_SHADER);i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),n.bind();var r=p.ProjectionMercator.worldSize(this.mapState.getScale()),d=this.layer.getLayerId(),g=null,y=!1,m=new Map;e.renderTiles.forEach((function(e){var s=e.getTile(),p=s.getKind();if(p==c.Kind.ANNOTATION||p==c.Kind.VECTOR){if(s.hasData(d)){var v=s.getLayerData(d);if(v.getType()==o.LayerType.FILL){var _=v;if(g||(g=_.getLayerProperties(),y=g.getStrokeWidth()>0),g.isVisible()){var b=s.getTileCoordinate(),w=1<<b.getZoom(),M=r/w,x=M/u.MapUtils.getTileSize(),T=f.GeometryUtils.pixelCoordinateToCameraCoordinate(new a.Vector2(b.getX()*M+M/2,b.getY()*M+M/2),t.mapState.cameraPosition);t.mvpMatrix.setIdentity(x,x,1),t.mvpMatrix.translate(T.x,T.y,t.mapState.is3dMode()?f.GeometryUtils.getElevationPixelFromMeter(g.getElevation(),t.mapState.cameraPosition):0);var A=t.mvpMatrix.concat(t.mapState.getViewProjectionMatrix());n.setUniforms([new l.UniformInfo("u_mvpMatrix","matrix",A)]);var L=_.getFillModel();if(L.bind(),n.setAttributes(L.attributeInfos),n.setUniforms([new l.UniformInfo("u_color","4fv",g.getFillColor().buffer())]),L.render(i.TRIANGLES),L.unbind(),y){var S=new h.Matrix4;m.set(_.getLineModel(),S.copy(A))}}}else console.warn("ERROR: layerData.getType() != LayerType.FILL .............")}}else console.warn("Invalid tile kind")})),n.disableAttributes(),g&&g.isVisible()&&y&&this.renderLine(m,g.getStrokeColor(),g.getStrokeWidth()),i.disable(i.BLEND)}}else console.log("Invalid layer type")},e.prototype.renderLine=function(t,e,i){var n=1;this.mapState.getZoom()>this.mapState.getMaxNativeZoom()&&(n=Math.pow(2,Math.round(this.mapState.getZoom()-this.mapState.getMaxNativeZoom())));var r=this.layer.mapView.gl,o=s.ResourceManager.getInstance(r).getShader(s.ShaderEnum.POLYLINE_SHADER);o.bind(),o.setUniforms([new l.UniformInfo("u_lineWidth","1f",i/n),new l.UniformInfo("u_color","4fv",e.buffer()),new l.UniformInfo("u_isDotted","1i",!1)]),t.forEach((function(t,e){e.bind(),o.setAttributes(e.attributeInfos),o.setUniforms([new l.UniformInfo("u_mvpMatrix","matrix",t)]),e.render(r.TRIANGLES),e.unbind()})),o.disableAttributes()},e}(i(15).LayerRenderer);e.FillLayerRenderer=d},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(11),s=i(8),l=i(9),u=i(7),h=i(15),c=i(6),f=i(2),p=i(17),d=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mvpMatrix=new l.Matrix4,n}return r(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==o.LayerType.CIRCLE){var t=this.layer;if(0!=t.renderTiles.size){var e=this.layer.mapView.gl,i=a.ResourceManager.getInstance(e),n=i.getShader(a.ShaderEnum.CIRCLE_SHADER);e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),n.bind();var r=i.getModel(a.ModelEnum.CIRCLE_MODEL);r.bind();for(var l=this.mapState.cameraPosition.getTarget(),h=c.ProjectionMercator.getMetersPerPixelAtLatitude(l.lat,this.mapState.getZoom()),d=this.layer.getLayerId(),g=Array.from(t.renderTiles),y=0;y<g.length;++y){var m=g[y][1].getTile(),v=m.getKind();if(v!=p.Kind.ANNOTATION&&v!=p.Kind.VECTOR&&console.warn("Invalid tile kind in CircleLayerRenderer"),m.hasData(d)){var _=m.getLayerData(d);if(_.getType()==o.LayerType.CIRCLE){var b=_.getLayerProperties();if(b.isVisible()){var w=b.getRadius()/h,M=w/Math.cos(Math.PI/f.PolyConstants.numTrianglesPerCircle),x=b.getStrokeWidth(),T=u.GeometryUtils.pixelCoordinateToCameraCoordinate(c.ProjectionMercator.projectScale(b.getCenter(),this.mapState.scale),this.mapState.cameraPosition);this.mvpMatrix.setIdentity(),this.mvpMatrix.translate(T.x,T.y,this.mapState.is3dMode()?u.GeometryUtils.getElevationPixelFromMeter(b.getElevation(),this.mapState.cameraPosition):0),this.mvpMatrix.concat(this.mapState.getViewProjectionMatrix()),n.setUniforms([new s.UniformInfo("u_color","4fv",b.getFillColor().buffer()),new s.UniformInfo("u_radius","1f",M+b.getHypotenuseStrokeWidth()),new s.UniformInfo("u_outerRadius","1f",w+x),new s.UniformInfo("u_innerRadius","1f",w),new s.UniformInfo("u_strokeColor","4fv",b.getStrokeColor().buffer()),new s.UniformInfo("u_mvpMatrix","matrix",this.mvpMatrix)]),n.setAttributes(r.attributeInfos),r.render(e.TRIANGLES);break}}else console.warn("ERROR: layerData.getType() != LayerType.CIRCLE .............")}}r.unbind(),e.disable(e.BLEND)}}else console.log("Invalid layer type")},e}(h.LayerRenderer);e.CircleLayerRenderer=d},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(15),s=i(11),l=i(17),u=i(7),h=i(9),c=i(8),f=i(141),p=i(12),d=i(3),g=i(1),y=i(2),m=i(26),v=function(t){function e(e,i){var n=t.call(this,e,i)||this,r=s.ResourceManager.getInstance(n.layer.mapView.gl);return n.symbolShader=r.getShader(s.ShaderEnum.SYMBOL_SHADER),n.model=r.getModel(s.ModelEnum.SYMBOL_MODEL),n.mvpMatrix=new h.Matrix4,n}return r(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==o.LayerType.SYMBOL){var e=this.layer;if(0!=e.renderTiles.size){var i=e.getLayerId(),n=this.layer.mapView.gl;n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),this.flag=!0;var r=this.mapState.cameraPosition,a=this.mapState.getScreenSize(),s=m.CameraUtils.calculateViewProjectionMatrix(r,a.x,a.y),h=null;e.renderTiles.forEach((function(e){var c=e.getTile();if(c.getKind()==l.Kind.ANNOTATION){if(c.hasData(i)){var f=c.getLayerData(i);if(f.getType()==o.LayerType.SYMBOL){var p=f,d=p.getTexture();if(d&&d.isLoaded&&(h||(h=p.getLayerProperties()),h.isVisible())){var g=h.getWidth()<0?d.width:h.getWidth(),y=h.getHeight()<0?d.height:h.getHeight(),m=t.mapState.is3dMode()?h.getElevation():0,v=u.GeometryUtils.latLngToScreenCoordinate(h.getPosition(),m,r,a,s),_=h.getAnchor(),b=p.getTextLabelData();if(t.renderSymbol(n,d,v,g,y,_,h.getRotation()),b){var w=h.getLabelAnchor(),M=h.getMarkerLabel();t.renderSymbolLabel(n,v,g,y,_,b,M,w),t.flag=!0}}}else console.warn("ERROR: layerData.getType() != LayerType.SYMBOL ....")}}else console.error("Invalid tile")})),this.model.unbind(),n.disable(n.BLEND)}}else console.log("Invalid layer type")},e.prototype.renderSymbol=function(t,e,i,n,r,o,a){void 0===a&&(a=0),e.isLoaded&&(this.flag&&(this.symbolShader.bind(),this.model.bind(),this.symbolShader.setAttributes(this.model.attributeInfos),this.flag=!1),this.mvpMatrix.setIdentity(n/2,r/2,1),this.mvpMatrix.rotateZ(a),this.mvpMatrix.translate((.5-o.x)*n,(.5-o.y)*r,0),this.mvpMatrix.translate(i.x,i.y,0),this.mvpMatrix.concat(this.mapState.getOrthoProjectionMatrix()),this.symbolShader.setUniforms([new c.UniformInfo("u_mvpMatrix","matrix",this.mvpMatrix),new c.UniformInfo("u_texture","texture",e)]),this.model.render(t.TRIANGLES),this.symbolShader.resetTextureUnit())},e.prototype.renderSymbolLabel=function(t,e,i,n,r,o,a,s){var l=a.getMargin(),u=a.getAnchor(),h=g.MapUtils.pixelScale,c=o.widthPerLine==y.MapConstants.none?o.width:o.widthPerLine,m=(s.x-r.x)*i+(l.left-l.right)*h+c*(.5-u.x),v=(s.y-r.y)*n+(l.top-l.bottom)*h+o.height*(.5-u.y),_=e.add(new d.Vector2(m,v));f.TextLabelRenderer.render(t,this.mapState,o,_,p.Color.fromHex(a.getColor()),a.hasHalo(),p.Color.fromHex(a.getHaloColor()))},e}(a.LayerRenderer);e.SymbolLayerRenderer=v},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(15),s=i(11),l=i(6),u=i(17),h=i(1),c=i(9),f=i(3),p=i(8),d=i(7),g=i(2),y=i(16),m=i(26),v=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mvpMatrix=new c.Matrix4,n}return r(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==o.LayerType.GEOJSON){var e=this.layer;if(0!=e.renderTiles.size){var i=this.mapState.getZoom();if(!(i<this.mapState.mapSettings.dataLayerMinZoom||i>this.mapState.mapSettings.dataLayerMaxZoom)){var n=this.layer.mapView.gl,r=s.ResourceManager.getInstance(n),a=r.getShader(s.ShaderEnum.GEOJSON_SHADER);n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA);var c=l.ProjectionMercator.worldSize(this.mapState.getScale()),v=this.layer.getLayerId(),_=1;i>this.mapState.getMaxNativeZoom()&&(_=Math.pow(2,Math.round(i)-this.mapState.getMaxNativeZoom()));var b=this.mapState.cameraPosition,w=this.mapState.getScreenSize();e.renderTiles.forEach((function(e){e.forEach((function(e){var i=e.getTile();if(i.getKind()==u.Kind.VECTOR){var r=i;if(r.hasData(v)){var s=r._getLayerData(v,o.LayerType.GEOJSON);if(s.getType()==o.LayerType.GEOJSON){a.bind();var l=s,g=r.getTileCoordinate(),y=1<<g.getZoom(),m=c/y,w=m/h.MapUtils.getTileSize(),M=d.GeometryUtils.pixelCoordinateToCameraCoordinate(new f.Vector2(g.getX()*m+m/2,g.getY()*m+m/2),b);t.mvpMatrix.setIdentity(w,w,1),t.mvpMatrix.translate(M.x,M.y,0);var x=t.mvpMatrix.concat(t.mapState.getViewProjectionMatrix());a.setUniforms([new p.UniformInfo("u_mvpMatrix","matrix",x)]);var T=l.getPartials(),A=l.getFillOutlinedPartials(),L=l.getFillProperties(),S=l.getLineProperties(),E=l.getFillOutlinedProperties(),I=Array.from(T.keys()),P=l.getModel();P.bind(),a.setAttributes(P.attributeInfos),I.forEach((function(t){if(S.has(t))for(var e=T.get(t),i=S.get(t),r=0;r<e.length;++r){a.setUniforms([new p.UniformInfo("u_lineWidth","1f",i.strokeWidth/_),new p.UniformInfo("u_color","4fv",i.strokeColor.buffer())]);var o=e[r];P.renderPartial(n.TRIANGLES,o.start,o.length)}else if(L.has(t)){a.setUniforms([new p.UniformInfo("u_lineWidth","1f",0)]);var s=T.get(t),l=A.get(t);for(r=0;r<s.length;++r){a.setUniforms([new p.UniformInfo("u_color","4fv",L.get(t).fillColor.buffer())]);var u=s[r];if(P.renderPartial(n.TRIANGLES,u.start,u.length),l&&r<l.length)(h=l[r]).forEach((function(e){a.setUniforms([new p.UniformInfo("u_color","4fv",E.get(t).strokeColor.buffer())]),P.renderPartial(n.LINES,e.start,e.length)}))}if(l)for(r=s.length;r<l.length;++r){var h=l[r];a.setUniforms([new p.UniformInfo("u_color","4fv",E.get(t).strokeColor.buffer())]),h.forEach((function(t){P.renderPartial(n.LINES,t.start,t.length)}))}}else console.warn("Invalid geojson key: "+t)}))}else console.warn("ERROR: layerData.getType() != LayerType.GEOJSON .............")}}else console.warn("Invalid tile kind")}))}));var M=r.getShader(s.ShaderEnum.SYMBOL_SHADER),x=r.getModel(s.ModelEnum.SYMBOL_MODEL),T=y.MapResourceManager.getInstance(n),A=T.getTexture(g.SymbolConstants.geoJsonLayerId);A?A.retain():A=T.createMarkerTexture(g.SymbolConstants.geoJsonLayerId,g.SymbolConstants.defaultSymbol),M.bind(),x.bind(),M.setAttributes(x.attributeInfos),M.setUniforms([new p.UniformInfo("u_texture","texture",A)]),e.renderTiles.forEach((function(e){e.forEach((function(e){var i=e.getTile();if(i.getKind()==u.Kind.VECTOR){var r=i;if(r.hasData(v)){var a=r._getLayerData(v,o.LayerType.GEOJSON);if(a.getType()==o.LayerType.GEOJSON){var s=m.CameraUtils.calculateViewProjectionMatrix(b,w.x,w.y);a.getPointCoordinates().forEach((function(e){e.forEach((function(e){var i=d.GeometryUtils.latLngToScreenCoordinate(e,0,b,w,s),r=g.MapConstants.pointGeoJsonAnchor,o=r[0],a=r[1],l=g.MapConstants.pointGeoJsonWidth*h.MapUtils.pixelScale,u=g.MapConstants.pointGeoJsonHeight*h.MapUtils.pixelScale;t.mvpMatrix.setIdentity(l/2,u/2,1),t.mvpMatrix.translate((.5-o)*l,(.5-a)*u,0),t.mvpMatrix.translate(i.x,i.y,0);var c=t.mvpMatrix.concat(t.mapState.getOrthoProjectionMatrix());M.setUniforms([new p.UniformInfo("u_mvpMatrix","matrix",c)]),x.render(n.TRIANGLES)}))}))}else console.warn("ERROR: layerData.getType() != LayerType.GEOJSON .............")}}else console.warn("Invalid tile kind")}))})),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),n.bindBuffer(n.ARRAY_BUFFER,null)}}}},e}(a.LayerRenderer);e.GeoJsonLayerRenderer=v},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==o.LayerType.USERPOI){var t=this.layer;if(0!=t.renderTiles.size){var e=t.getUserPOIRenderDatas();null!=e&&0!=e.length&&this.renderPOIs(e)}}else console.log("Invalid layer type")},e}(i(90).POILayerRenderer);e.UserPOILayerRenderer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=i(89),s=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}return r(e,t),e.prototype.render=function(){if(this.mapState.is3dMode())if(this.layer.getLayerType()==o.LayerType.USERBUILDING){var e=this.layer;t.prototype.renderInternal.call(this,a.BuildingRenderType.Building,e)}else console.warn("This layer is not user building !")},e.prototype.renderSelection=function(){if(this.mapState.is3dMode())if(this.layer.getLayerType()==o.LayerType.USERBUILDING){var e=this.layer;t.prototype.renderInternal.call(this,a.BuildingRenderType.Selection,e)}else console.warn("This layer is not user building !")},e.prototype.renderShadowMapping=function(){if(this.mapState.is3dMode())if(this.layer.getLayerType()==o.LayerType.USERBUILDING){var e=this.layer;t.prototype.renderInternal.call(this,a.BuildingRenderType.Shadow,e)}else console.warn("This layer is not user building !")},e}(a.BuildingLayerRenderer);e.UserBuildingLayerRenderer=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),a=i(2),s=i(17),l=i(11),u=i(15),h=i(9),c=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.time=0,n.mvpMatrix=new h.Matrix4,n.modelMatrix=new h.Matrix4,n}return r(e,t),e.prototype.render=function(){var t=this,e=this.layer,i=e.getOverlayProperties();if(null!=i){var n=this.layer.mapView.gl;n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA);var r=l.ResourceManager.getInstance(n),u=this.mapState.is3dMode()&&this.mapState.getTilt()>a.MapConstants.maxTiltIntersectWithScreen,h=r.getModel(l.ModelEnum.RASTER_MODEL),c=null,f=e.effectManager,p=this.mapState.is3dMode()&&f.enableShadowEffect;if(h.bind(),u){(c=p?r.getShader(l.ShaderEnum.RASTER_3D_WITH_SHADOW_SHADER):r.getShader(l.ShaderEnum.RASTER_FOG_SHADER)).bind(),c.setAttributes(h.attributeInfos);var d=a.MapConstants.defaultMaxNativeZoom,g=e.timeEffectManager.getFogColor(),y=6*Math.max(this.mapState.getZoom()-d,0),m=e.lightManager.sunLight;c.setUniforms([new o.UniformInfo("u_light_color","3fv",m.lightColor.rgbBuffer()),new o.UniformInfo("u_light_position","3f",m.lightPosition),new o.UniformInfo("u_fogStart","1f",22+y),new o.UniformInfo("u_fogRange","1f",10+y),new o.UniformInfo("u_fogColor","3fv",g.rgbBuffer())])}else(c=p?r.getShader(l.ShaderEnum.RASTER_WITH_SHADOW_SHADER):r.getShader(l.ShaderEnum.RASTER_SHADER)).bind(),c.setAttributes(h.attributeInfos);var v=r.getTexture(l.TextureEnum.WATER_DISPLACEMENT),_=r.getTexture(l.TextureEnum.WATER_COLOR),b=e.effectManager.enableWaterEffect&&this.mapState.is3dMode()?1:0,w=e.lightManager.sunLight;this.time+=8e-4,c.setUniforms([new o.UniformInfo("u_light_color","3fv",w.lightColor.rgbBuffer()),new o.UniformInfo("u_light_position","3f",w.lightPosition),new o.UniformInfo("u_time","1f",this.time),new o.UniformInfo("u_enableWater","1i",b)]),e.mapView.overlayManager.getRenderTiles().forEach((function(r){var l=r.getTile();if(l.getKind()==s.Kind.OVERLAY){var u=null,d=l.getTileRenderData();if(i.forEach((function(t,i){e.getLayerId()==i.getLayerId()&&null==u&&i.isVisible()&&(u=d.getLayerRenderData(i.getLayerId()))})),null!=u){var g=u.getTexture();if(null!=g){var y=t.mapState.getViewProjectionMatrix();if(t.mapState.matrixFor(t.modelMatrix,r.getUnwrappedTileCoordinate()),p){var m=f.shadowMap;t.mvpMatrix.copy(t.modelMatrix),t.mvpMatrix.concat(m.getLightViewProjectionMatrix()).concat(a.MapConstants.biasMatrix),c.setUniforms([new o.UniformInfo("u_shadowMap","texture",m.getShadowMapTexture()),new o.UniformInfo("u_shadowMvpMatrix","matrix",t.mvpMatrix)])}t.mvpMatrix.copy(t.modelMatrix),t.mvpMatrix.concat(y),c.setUniforms([new o.UniformInfo("u_waterDisplacement","texture",v),new o.UniformInfo("u_waterColor","texture",_),new o.UniformInfo("u_texture","texture",g),new o.UniformInfo("u_mvpMatrix","matrix",t.mvpMatrix)]),h.render(n.TRIANGLES),c.resetTextureUnit()}}}else console.log("Tile is not overlay")})),h.unbind(),c.disableAttributes(),n.disable(n.BLEND)}},e}(u.LayerRenderer);e.RasterOverlayRenderer=c},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==o.LayerType.POI_OVERLAY){var t=this.layer,e=t.poiRenderDatas;t.isVisible()&&null!=e&&0!=e.length&&this.renderPOIs(e)}else console.error("Invalid layer type")},e}(i(90).POILayerRenderer);e.POIOverlayRenderer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(89),a=i(0),s=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}return r(e,t),e.prototype.render=function(){if(this.mapState.is3dMode()&&this.layer.getLayerType()==a.LayerType.BUILDING_OVERLAY){var e=this.layer;e.isVisible()&&t.prototype.renderInternal.call(this,o.BuildingRenderType.Building,e)}},e.prototype.renderSelection=function(){if(this.layer.getLayerType()==a.LayerType.BUILDING_OVERLAY){var e=this.layer;t.prototype.renderInternal.call(this,o.BuildingRenderType.Selection,e)}},e}(o.BuildingLayerRenderer);e.BuildingOverlayRender=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),a=i(11),s=i(0),l=i(15),u=i(81),h=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==s.LayerType.SURFACE){var t=this.layer.mapView.gl;t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);var e=a.ResourceManager.getInstance(t).getShader(a.ShaderEnum.POLYLINE_SHADER),i=a.ResourceManager.getInstance(t).getShader(a.ShaderEnum.FILL_SHADER),n=this.layer,r=n.renderDatas,l=n.mvpMatrixs;r.forEach((function(n,r){var a=r.layerRenderData,s=l[r.matrixIndex],h=a.getModel();if(null!=h){var c=a.getLayerProperties();switch(a.getSurfaceType()){case u.SurfaceType.LINE:e.bind(),h.bind(),e.setAttributes(h.attributeInfos),e.setUniforms([new o.UniformInfo("u_mvpMatrix","matrix",s),new o.UniformInfo("u_lineWidth","1f",c.getWidth()),new o.UniformInfo("u_color","4fv",c.getColor().buffer()),new o.UniformInfo("u_isDotted","1i",!1)]),h.render(t.TRIANGLES),e.disableAttributes();break;case u.SurfaceType.POLYGON:i.bind(),h.bind(),i.setAttributes(h.attributeInfos),i.setUniforms([new o.UniformInfo("u_mvpMatrix","matrix",s),new o.UniformInfo("u_color","4fv",c.getColor().buffer())]),h.render(t.TRIANGLES),i.disableAttributes()}}})),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindBuffer(t.ARRAY_BUFFER,null),t.disable(t.BLEND)}},e}(l.LayerRenderer);e.SurfaceLayerRenderer=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),a=i(0),s=i(11),l=i(81),u=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==a.LayerType.BOUNDARY){var t=this.layer.mapView.gl;t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);var e=s.ResourceManager.getInstance(t).getShader(s.ShaderEnum.POLYLINE_SHADER);e.bind();var i=this.layer,n=i.renderDatas,r=i.mvpMatrixs;n.forEach((function(i,n){var a=n.layerRenderData;if(a.getSurfaceType()!=l.SurfaceType.POLYGON){var s=a.getModel();if(null!=s){var u=r[n.matrixIndex],h=a.getLayerProperties();s.bind(),e.setAttributes(s.attributeInfos),e.setUniforms([new o.UniformInfo("u_mvpMatrix","matrix",u),new o.UniformInfo("u_lineWidth","1f",h.getWidth()),new o.UniformInfo("u_color","4fv",h.getColor().buffer()),new o.UniformInfo("u_isDotted","1i",!1)]),s.render(t.TRIANGLES)}}})),e.disableAttributes(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindBuffer(t.ARRAY_BUFFER,null),t.disable(t.BLEND)}},e}(i(15).LayerRenderer);e.BoundaryLayerRenderer=u},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),a=i(0),s=i(11),l=function(t){function e(e,i){return t.call(this,e,i)||this}return r(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==a.LayerType.ROADS){var t=this.layer.mapView.gl;t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA);var e=s.ResourceManager.getInstance(t).getShader(s.ShaderEnum.POLYLINE_SHADER);e.bind();var i=this.layer,n=i.renderDatas,r=i.mvpMatrixs;n.forEach((function(i,n){var a=n.getModel();if(null!=a){var s=n.getLayerProperties();if(s.hasOutline()){var l=r[n.matrixIndex],u=2*s.getOutlineWidth()+s.getWidth();a.bind(),e.setAttributes(a.attributeInfos),e.setUniforms([new o.UniformInfo("u_mvpMatrix","matrix",l),new o.UniformInfo("u_lineWidth","1f",u),new o.UniformInfo("u_color","4fv",s.getOutlineColor().buffer()),new o.UniformInfo("u_isDotted","1i",!1)]),a.render(t.TRIANGLES)}}})),n.forEach((function(i,n){var a=n.getModel();if(null!=a){var s=n.getLayerProperties(),l=r[n.matrixIndex];a.bind(),e.setAttributes(a.attributeInfos),e.setUniforms([new o.UniformInfo("u_mvpMatrix","matrix",l),new o.UniformInfo("u_lineWidth","1f",s.getWidth()),new o.UniformInfo("u_color","4fv",s.getColor().buffer()),new o.UniformInfo("u_isDotted","1i",!1)]),a.render(t.TRIANGLES)}})),e.disableAttributes(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindBuffer(t.ARRAY_BUFFER,null),t.disable(t.BLEND)}},e}(i(15).LayerRenderer);e.RoadLayerRenderer=l},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(15),a=i(0),s=i(11),l=i(8),u=i(1),h=i(9),c=i(7),f=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mvpMatrix=new h.Matrix4,n}return r(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==a.LayerType.LABEL){var e=this.layer.mapView.gl;e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);var i=s.ResourceManager.getInstance(e).getShader(s.ShaderEnum.TEXT_LABEL_SHADER);i.bind();var n=this.mapState.getCamera(),r=this.mapState.getScreenSize(),o=this.mapState.getOrthoProjectionMatrix();this.layer.renderDatas.forEach((function(a,s){var h=s.getLayerProperties();if(h&&h.isVisible()){var f=s.getTextData();if(f){var p=h.getColor(),d=h.getHaloColor(),g=h.isReverse()?h.getPosition()[1]:h.getPosition()[0],y=c.GeometryUtils.latLngToScreenCoordinate(g,0,n,r),m=f.font.texture,v=f.model;null!=v&&(t.mvpMatrix.setIdentity(),t.mvpMatrix.translate(y.x,y.y,0),t.mvpMatrix.concat(o),v.bind(),i.setAttributes(v.attributeInfos),i.setUniforms([new l.UniformInfo("u_mvpMatrix","matrix",t.mvpMatrix),new l.UniformInfo("u_texture","texture",m),new l.UniformInfo("u_pixel_scale","1f",u.MapUtils.pixelScale),new l.UniformInfo("u_text_size","1f",f.size),new l.UniformInfo("u_texsize","2fv",new Float32Array([m.width,m.height]))]),h.hasHalo()&&(i.setUniforms([new l.UniformInfo("u_color","4fv",d.buffer()),new l.UniformInfo("u_is_halo","1i",!0)]),v.render(e.TRIANGLES)),i.setUniforms([new l.UniformInfo("u_color","4fv",p.buffer()),new l.UniformInfo("u_gamma_scale","1f",1),new l.UniformInfo("u_is_halo","1i",!1)]),v.render(e.TRIANGLES),v.unbind(),i.resetTextureUnit())}}})),i.disableAttributes(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindBuffer(e.ARRAY_BUFFER,null),e.disable(e.BLEND)}},e}(o.LayerRenderer);e.LabelLayerRenderer=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=i(287),o=i(288),a=i(289),s=i(290),l=i(91),u=i(292),h=i(142),c=i(293),f=i(294),p=i(295),d=i(296),g=i(297),y=i(298),m=i(144),v=i(299),_=i(300),b=i(301),w=function(){function t(){}return t.createLayer=function(t,e,i,w){switch(e){case n.LayerType.SURFACE:return new m.SurfaceLayer(t,w,i);case n.LayerType.BOUNDARY:return new v.BoundaryLayer(t,w,i);case n.LayerType.ROADS:return new _.RoadLayer(t,w,i);case n.LayerType.LABEL:return new b.LabelLayer(t,w,i);case n.LayerType.RASTER:return new r.RasterLayer(t,w,i);case n.LayerType.RASTER_OVERLAY:return new g.RasterOverlayLayer(t,w,i);case n.LayerType.BUILDING:return new l.BuildingLayer(t,w,i);case n.LayerType.LINE:return new o.LineLayer(t,w,i);case n.LayerType.FILL:return new a.FillLayer(t,w,i);case n.LayerType.CIRCLE:return new s.CircleLayer(t,w,i);case n.LayerType.SYMBOL:return new u.SymbolLayer(t,w,i);case n.LayerType.POI:return new h.POILayer(t,w,i);case n.LayerType.POI_OVERLAY:return new c.POIOverlayLayer(t,w,i);case n.LayerType.USERPOI:return new p.UserPOILayer(t,w,i);case n.LayerType.USERBUILDING:return new d.UserBuildingLayer(t,w,i);case n.LayerType.BUILDING_OVERLAY:return new y.BuildingOverlayLayer(t,w,i);case n.LayerType.GEOJSON:return new f.GeoJsonLayer(t,w,i);default:return console.log("Un-support layer type"),null}},t}();e.LayerFactory=w},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){return t.call(this,e,i,o.LayerType.RASTER,n)||this}return r(e,t),e.prototype.update=function(){},Object.defineProperty(e.prototype,"effectManager",{get:function(){return this._effectManager},set:function(t){this._effectManager=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeEffectManager",{get:function(){return this._timeEffectManager},set:function(t){this._timeEffectManager=t},enumerable:!0,configurable:!0}),e.prototype.setLightingManager=function(t){this.lightManager=t},e}(o.Layer);e.RasterLayer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){var r=t.call(this,e,i,o.LayerType.LINE,n)||this;return r._renderTiles=new Map,r}return r(e,t),e.prototype.update=function(t){},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){var e=this._renderTiles.get(t);e&&(e.tile.getTileRenderData().removeLayerRenderData(this.layerId.id),this._renderTiles.delete(t))},e.prototype.clearRenderTiles=function(){var t=this;this._renderTiles.forEach((function(e){e.tile.getTileRenderData().removeLayerRenderData(t.layerId.id)})),this._renderTiles.clear()},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e}(o.Layer);e.LineLayer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){var r=t.call(this,e,i,o.LayerType.FILL,n)||this;return r._renderTiles=new Map,r}return r(e,t),e.prototype.update=function(t){},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){var e=this._renderTiles.get(t);e&&(e.tile.getTileRenderData().removeLayerRenderData(this.layerId.id),this._renderTiles.delete(t))},e.prototype.clearRenderTiles=function(){var t=this;this._renderTiles.forEach((function(e){e.tile.getTileRenderData().removeLayerRenderData(t.layerId.id)})),this._renderTiles.clear()},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e}(o.Layer);e.FillLayer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){var r=t.call(this,e,i,o.LayerType.CIRCLE,n)||this;return r._renderTiles=new Map,r}return r(e,t),e.prototype.update=function(t){},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){var e=this._renderTiles.get(t);e&&(e.tile.getTileRenderData().removeLayerRenderData(this.layerId.id),this._renderTiles.delete(t))},e.prototype.clearRenderTiles=function(){var t=this;this._renderTiles.forEach((function(e){e.tile.getTileRenderData().removeLayerRenderData(t.layerId.id)})),this._renderTiles.clear()},e}(o.Layer);e.CircleLayer=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.buildings=[],this.id=t}return t.prototype.addBuilding=function(t){this.buildings.push(t)},t.prototype.getModel=function(){return 0==this.buildings.length?null:this.buildings[0].getModel()},t}();e.BuildingGroup=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){var r=t.call(this,e,i,o.LayerType.SYMBOL,n)||this;return r._renderTiles=new Map,r}return r(e,t),e.prototype.update=function(t){},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){var e=this._renderTiles.get(t);e&&(e.tile.getTileRenderData().removeLayerRenderData(this.layerId.id),this._renderTiles.delete(t))},e.prototype.clearRenderTiles=function(){var t=this;this._renderTiles.forEach((function(e){e.tile.getTileRenderData().removeLayerRenderData(t.layerId.id)})),this._renderTiles.clear()},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e}(o.Layer);e.SymbolLayer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(23),a=i(0),s=i(142),l=i(24),u=i(26),h=function(t){function e(e,i,n){return t.call(this,e,i,n,a.LayerType.POI_OVERLAY)||this}return r(e,t),e.prototype.update=function(t){var e=this;if(this.poiRenderDatas=o(l.compareOrderDESC),this.properties.isVisible()){var i=this.mapView.overlayManager.getRenderTiles();i&&i.forEach((function(t){var i=t.getTile(),n=i.getTileData().getTileLayer(e.properties.getLayerId());if(null!=n){var r=i.getTileRenderData();n.getFeatures().forEach((function(t){var i=r.getLayerRenderData(t.getId());if(i.getType()==a.LayerType.POI_OVERLAY){var n=i.getLayerProperties();e.poiRenderDatas=e.poiRenderDatas.insert(new l.Order(n.getId(),n.getRank()),i)}else console.warn("Type "+i.getType()+" is not POI overlay")}))}}));var n=t.getScreenSize(),r=u.CameraUtils.calculateViewProjectionMatrix(t.cameraPosition,n.x,n.y);this.poiRenderDatas.forEach((function(i,n){e.placePOIRenderData(i,n,t,r)}))}},e.prototype.setProperties=function(t){this.properties=t},e.prototype.isVisible=function(){return this.properties.isVisible()},e}(s.POILayer);e.POIOverlayLayer=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){var r=t.call(this,e,i,o.LayerType.GEOJSON,n)||this;return r.renderTiles=new Map,r}return r(e,t),e.prototype.update=function(t){},e.prototype.addRenderTile=function(t,e){this.renderTiles.has(t)?this.renderTiles.get(t).push(e):this.renderTiles.set(t,[e])},e.prototype.removeRenderTile=function(t){this.renderTiles.delete(t)},e}(o.Layer);e.GeoJsonLayer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(23),a=i(0),s=i(109),l=i(2),u=i(1),h=i(7),c=i(3),f=i(24),p=i(16),d=i(26),g=i(61),y=i(92),m=i(47),v=function(t){function e(e,i,n){var r=t.call(this,e,i,a.LayerType.USERPOI,n)||this;return r._renderTiles=new Map,r.userPOIRenderDatas=null,r}return r(e,t),e.prototype.update=function(t){var e=this,i=this.mapView.getCollision2DManager();this.userPOIRenderDatas=o(f.compareOrderDESC),this._renderTiles.forEach((function(t){t.tile.getTileRenderData().getLayerRenderDatas().forEach((function(t){if(t.getType()==a.LayerType.USERPOI){var i=t,n=i.getLayerProperties();n&&(e.userPOIRenderDatas=e.userPOIRenderDatas.insert(new f.Order(n.getId(),n.getRank()),i))}}))}));var n=t.getScreenSize(),r=d.CameraUtils.calculateViewProjectionMatrix(t.cameraPosition,n.x,n.y),s=[],v=l.MapConstants.placeWidth*u.MapUtils.pixelScale,_=l.MapConstants.placeHeight*u.MapUtils.pixelScale;this.userPOIRenderDatas.forEach((function(o,l){if(l.getType()==a.LayerType.USERPOI){var u=l,f=u.getLayerProperties();if(u.setVisible(!1),u.setTextVisible(!1),f.isVisible()){var d=f.getPosition(),b=h.GeometryUtils.latLngToScreenCoordinate(d,0,t.cameraPosition,n,r),w=b.x-v/2,M=b.x+v/2,x=b.y-_,T=b.y,A=new c.Vector2((w+M)/2,(x+T)/2),L=new g.OBB(A.x,A.y,0,M-w,T-x);i.insert(new y.POICollisionIconRenderData(L,m.CollisionType.USERPOI,u)),u.setVisible(!0),f.getTitle().length>0&&(null==u.getTextData()&&u.setTextData(p.MapResourceManager.getInstance(e.mapView.gl).acquireText(f.getTitle(),f.getFontSize())),s.push({order:o,renderData:u,coordinate:b}))}}})),s.forEach((function(t){var e=t.renderData,n=e.getTextData(),r=n.width,o=n.height,a=t.coordinate,s=new c.Vector2(a.x+v/2+r/2+1,a.y-_/2),l=s.x-r/2,u=s.x+r/2,h=s.y-o/2,f=s.y+o/2,p=new c.Vector2((l+u)/2,(h+f)/2);e.setTextVisible(!0);var d=new g.OBB(p.x,p.y,0,u-l,f-h);i.insert(new y.POICollisionIconRenderData(d,m.CollisionType.USERPOITEXT,e))}))},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){var e=this._renderTiles.get(t);e&&(this.removeTileRenderData(e),this._renderTiles.delete(t))},e.prototype.clearRenderTiles=function(){var t=this;this._renderTiles.forEach((function(e){t.removeTileRenderData(e)})),this._renderTiles.clear()},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e.prototype.getUserPOIRenderDatas=function(){return this.userPOIRenderDatas},e.prototype.queryFeature=function(t){if(null!=this.userPOIRenderDatas&&this.userPOIRenderDatas.length>0){var e=this.userPOIRenderDatas.get(t);if(null!=e){var i=e.getLayerProperties();if(i.isUserInteractionEnabled())return this.mapView.annotationManager.getPOI(i.getAnnotationId())}}return null},e.prototype.removeTileRenderData=function(t){var e=t.tile.getTileRenderData().getLayerRenderDatas();e.forEach((function(t){if(t instanceof s.UserPOILayerRenderData){var i=t.getLayerProperties().getId();t.destroy(),e.delete(i)}}))},e}(a.Layer);e.UserPOILayer=v},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(91),a=i(0),s=i(111),l=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this;return r.layerType=a.LayerType.USERBUILDING,r._renderTiles=new Map,r}return r(e,t),e.prototype.update=function(e){if(e.is3dMode())if(this.getLayerType()==a.LayerType.USERBUILDING){if(this.dirty&&(this.dirty=!1,this.clear(),!(this._renderTiles.size<1))){var i=[];this._renderTiles.forEach((function(t){i.push(t)})),t.prototype.updateInternal.call(this,e,i)}}else console.warn("This layer is not user building !")},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e),this.setDirty()},e.prototype.removeRenderTile=function(t){var e=this._renderTiles.get(t);e&&(this.removeTileRenderData(e),this._renderTiles.delete(t),this.setDirty())},e.prototype.clearRenderTiles=function(){var t=this;this._renderTiles.forEach((function(e){t.removeTileRenderData(e)})),this._renderTiles.clear(),this.setDirty()},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e.prototype.removeTileRenderData=function(t){var e=t.tile.getTileRenderData().getLayerRenderDatas();e.forEach((function(t){if(t instanceof s.UserBuildingLayerRenderData){var i=t.getLayerProperties().getId();t.destroy(),e.delete(i)}}))},e}(o.BuildingLayer);e.UserBuildingLayer=l},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(23),a=i(24),s=i(0),l=function(t){function e(e,i,n){var r=t.call(this,e,i,s.LayerType.RASTER_OVERLAY,n)||this;return r.dirty=!0,r.overlayProperties=null,r}return r(e,t),e.prototype.update=function(t){if(this.dirty){this.dirty=!1;var e=o(a.compareOrderDESC),i=this.mapView.overlayManager;i.tileOverlays.forEach((function(t){var i=t.getProperties();e=e.insert(new a.Order(i.getLayerId(),i.getZIndex()),i)})),i.groundOverlays.forEach((function(t){var i=t.getProperties();e=e.insert(new a.Order(i.getLayerId(),i.getZIndex()),i)})),e.length>0?this.overlayProperties=e:this.overlayProperties=null}},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.getOverlayProperties=function(){return this.overlayProperties},Object.defineProperty(e.prototype,"effectManager",{get:function(){return this._effectManager},set:function(t){this._effectManager=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeEffectManager",{get:function(){return this._timeEffectManager},set:function(t){this._timeEffectManager=t},enumerable:!0,configurable:!0}),e.prototype.setLightingManager=function(t){this.lightManager=t},e}(s.Layer);e.RasterOverlayLayer=l},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(91),a=i(0),s=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this;return r.layerType=a.LayerType.BUILDING_OVERLAY,r}return r(e,t),e.prototype.update=function(e){if(e.is3dMode())if(this.getLayerType()==a.LayerType.BUILDING_OVERLAY){if(this.dirty){this.dirty=!1,this.clear();var i=this.mapView.overlayManager.getRenderTiles();t.prototype.updateInternal.call(this,e,i)}}else console.warn("This layer is not building overlay !")},e.prototype.setProperties=function(t){this.properties=t},e.prototype.isVisible=function(){return this.properties.isVisible()},e}(o.BuildingLayer);e.BuildingOverlayLayer=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),a=function(t){function e(e,i,n){var r=t.call(this,e,i,n,o.LayerType.BOUNDARY)||this;return r.renderDatas=null,r.mvpMatrixs=[],r}return r(e,t),e.prototype.update=function(t){this.updateLayer(t,o.LayerType.BOUNDARY)},e}(i(144).SurfaceLayer);e.BoundaryLayer=a},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(23),a=i(9),s=i(3),l=i(6),u=i(7),h=i(1),c=i(24),f=i(0),p=function(t){function e(e,i,n){var r=t.call(this,e,i,f.LayerType.ROADS,n)||this;return r.dirty=!0,r.renderDatas=null,r.mvpMatrixs=[],r}return r(e,t),e.prototype.destroy=function(){this.renderDatas=null},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.update=function(t){var e=this;if(this.dirty){this.dirty=!1;var i=h.MapUtils.getTileSize(),n=l.ProjectionMercator.worldSize(t.getScale()),r=t.cameraPosition,p=t.getViewProjectionMatrix(),d=this.mapView.tileManager.getTilePyramid().getRenderTiles();this.renderDatas=o(c.compareOrderASC);var g=0;d.forEach((function(t,o){var l=t.getTile(),h=l.getTileCoordinate(),d=1<<h.getZoom(),y=n/d,m=u.GeometryUtils.pixelCoordinateToCameraCoordinate(new s.Vector2(h.getX()*y+y/2,h.getY()*y+y/2),r),v=void 0;o<e.mvpMatrixs.length?v=e.mvpMatrixs[o]:(v=new a.Matrix4,e.mvpMatrixs.push(v));var _=y/i;v.setIdentity(_,_,1),v.translate(m.x,m.y,0),v.concat(p),l.getTileRenderData().getLayerRenderDatas().forEach((function(t,i){if(t.getType()==f.LayerType.ROADS){var n=t.getLayerProperties();if(n.isVisible()){var r=t;r.matrixIndex=o,e.renderDatas=e.renderDatas.insert(new c.Order(g++,n.getSortRank()),r)}}}))})),this.mvpMatrixs.length>d.length&&(this.mvpMatrixs.length=d.length)}},e}(f.Layer);e.RoadLayer=p},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(23),a=i(0),s=i(1),l=i(6),u=i(24),h=i(3),c=i(80),f=i(70),p=i(2),d=i(102),g=i(19),y=i(7),m=i(61),v=i(92),_=i(47),b=i(5),w=i(143),M=function(t){function e(e,i,n){var r=t.call(this,e,i,a.LayerType.LABEL,n)||this;return r.renderDatas=null,r}return r(e,t),e.prototype.destroy=function(){this.renderDatas=null},e.prototype.update=function(t){var e=this,i=this.mapView.getCollision2DManager(),n=t.getScreenSize(),r=s.MapUtils.getTileSize(),g=l.ProjectionMercator.worldSize(t.getScale()),w=t.cameraPosition,M=this.mapView.tileManager.getTilePyramid().getRenderTiles();this.renderDatas=o(u.compareOrderASC),M.forEach((function(o,l){var M=o.getTile(),x=[],T=M.getTileCoordinate(),A=1<<T.getZoom(),L=g/A,S=new h.Vector2(T.getX()*L+L/2,T.getY()*L+L/2),E=L/r,I=M.getTileRenderData();I.getLayerRenderDatas().forEach((function(r,o){if(r.getType()==a.LayerType.LABEL){var l=r,g=l.getLayerProperties();if(g){var M=g.getName();if(M&&0!=M.length){g.setVisible(!0);var T=l.getLineCoordinates().length,A=l.gl,L=g.getId(),I=e.shouldUpdateTextData(t,l);if(g.getLabelType()==c.LabelType.PLACE){if(I){var P=180*s.MapUtils.pixelScale,C=f.TextLabelFactory.getInstance(A).createText(L,new d.TextLabel(M,g.getFontSize()),p.MapConstants.poiFontWeight,P,1);if(l.setTextData(C),!C)return void x.push(o)}var O=l.getTextData(),R=g.getPosition()[0],D=y.GeometryUtils.latLngToScreenCoordinate(R,0,w,n),k=O.width,B=O.height,U=new h.Vector2(D.x,D.y),N=new m.OBB(U.x,U.y,0,k,B);i.insert(new v.LabelCollisionRenderData(N,_.CollisionType.PLACE_LABEL,l))}else if(T>=2){if(I){l.buildScreenLineCoords(w,n,S,E);var F=f.TextLabelFactory.getInstance(A).createCurvedText(L,new d.TextLabel(M,g.getFontSize()),p.MapConstants.poiFontWeight,l.getScreenLineCoords(),g.isReverse());if(l.setTextData(F),!F)return void x.push(o)}O=l.getTextData();for(var j=l.getScreenLineCoords(),V=T-1,Z=j[0],z=j[V];z.equals(Z);)z=j[V-=1];U=new h.Vector2(0,0);if(2==T&&g.getLabelType()!=c.LabelType.BOUNDARY){R=new b.LatLng((g.getPosition()[0].lat+g.getPosition()[1].lat)/2,(g.getPosition()[0].lng+g.getPosition()[1].lng)/2);U=Y=y.GeometryUtils.latLngToScreenCoordinate(R,0,w,n)}else{var G=O.vertices,Y=(R=g.isReverse()?g.getPosition()[1]:g.getPosition()[0],y.GeometryUtils.latLngToScreenCoordinate(R,0,w,n)),W=0,H=0;G.forEach((function(t){W+=t.x,H+=t.y}));var X=G.length;U=new h.Vector2(Y.x+W/X,Y.y+H/X)}var q=g.getLabelType()==c.LabelType.BOUNDARY?_.CollisionType.BOUNDARY_LABEL:_.CollisionType.VECTOR_LABEL,J=z.sub(Z),Q=Math.atan2(J.y,J.x),K=new m.OBB(U.x,U.y,Q,O.width,O.height);i.insert(new v.LabelCollisionRenderData(K,q,l))}e.renderDatas=e.renderDatas.insert(new u.Order(g.getId(),g.getSortRank()),l)}}}})),x.forEach((function(t){I.removeLayerRenderData(t)}))}))},e.prototype.shouldUpdateTextData=function(t,e){var i=!1;null==e.getTextData()&&(i=!0);var n=e.getLayerProperties();if(n.getLabelType()==c.LabelType.PLACE)return i;var r=t.getCamera();if(e.setCameraPosition(r)&&(i=!0),i){var o=e.getLineCoordinates(),a=t.getScreenSize(),s=new g.CameraPosition(r.getTarget(),0,r.getBearing(),r.getZoom()),l=void 0,u=void 0;l=y.GeometryUtils.latLngToScreenCoordinate(n.getPosition()[0],0,s,a),u=y.GeometryUtils.latLngToScreenCoordinate(n.getPosition()[1],0,s,a);var f=Math.atan2(u.y-l.y,u.x-l.x)*p.MathConstants.rad2Deg;l=y.GeometryUtils.latLngToScreenCoordinate(n.getPosition()[0],0,r,a),u=y.GeometryUtils.latLngToScreenCoordinate(n.getPosition()[1],0,r,a);var d=Math.atan2(u.y-l.y,u.x-l.x)*p.MathConstants.rad2Deg-f,m=new h.Vector2(o[0].x,o[0].y),v=new h.Vector2(o[o.length-1].x,o[o.length-1].y),_=new h.Vector2(v.x-m.x,-v.y+m.y),b=(r.getBearing()-d)*p.MathConstants.deg2Rad,w=new h.Vector2(Math.cos(b),Math.sin(b)),M=_.dot(w)<0;n.setReverse(M)}return i},e.prototype.queryFeature=function(t){var e=null;if(null!=this.renderDatas&&this.renderDatas.length>0){var i=this.renderDatas.get(t);if(null!=i){var n=i.getLayerProperties();e=new w.PlaceQueryResult(0,""+n.getOsmId(),n.getName(),"",n.getPosition()[0],"place")}}return e},e}(a.Layer);e.LabelLayer=M},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(56),r=i(5),o=i(52),a=i(31),s=i(10),l=function(){function t(t){this.userLocationDotId=-1,this.userLocationDot=null,this.lastKnownLocation=null,this.myLocationZoom=17,this.animate=!1,this.defaultPositionOptions={enableHighAccuracy:!0,maximumAge:0,timeout:6e3},this.mapView=t}return t.prototype.updateMapUI=function(t){var e=this;null!=t&&(this.myLocationButton=n.DOMUtils.create("div","mf-button",t),this.myLocationButton.innerHTML="<a class='mf-location'></a>",this.myLocationButton.addEventListener("click",(function(){e.onMyLocationButtonClick()})))},t.prototype.moveToMyLocation=function(t){void 0===t&&(t=!0),location.protocol.startsWith("https")||location.host.startsWith("localhost")?(this.animate=t,window.navigator.geolocation.getCurrentPosition(this.onGetCurrentPositionSuccess.bind(this),this.onGetCurrentPositionError.bind(this),this.defaultPositionOptions)):alert("This feature is available only in secure contexts (HTTPS)")},t.prototype.onMyLocationButtonClick=function(){this.moveToMyLocation()},t.prototype.onGetCurrentPositionSuccess=function(t){var e=new r.LatLng(t.coords.latitude,t.coords.longitude);if(this.mapView.moveCamera({target:e,zoom:this.myLocationZoom},{animate:this.animate}),this.lastKnownLocation=e,null==this.userLocationDot){var i=new o.Icon(32,32,"myPosition");this.userLocationDot=new a.Marker({position:e,visible:!0,anchor:new s.Point(.5,.5),icon:i}),this.userLocationDotId=this.mapView.addAnnotation(this.userLocationDot)}else this.userLocationDot.setPosition(e),this.userLocationDot.setVisible(!0)},t.prototype.onGetCurrentPositionError=function(t){-1!=this.userLocationDotId&&(this.mapView.removeAnnotation(this.userLocationDotId),this.userLocationDotId=-1,this.userLocationDot=null)},t}();e.GeolocateControl=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(10),r=i(36),o=i(41),a=i(51),s=i(19),l=i(1),u=i(40),h=i(31),c=i(73),f=i(54),p=i(53),d=function(){function t(t,e,i){this._id=t,this._eventOptions=e,this._eventCallback=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventCallBack",{get:function(){return this._eventCallback},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventOptions",{get:function(){return this._eventOptions},set:function(t){this._eventOptions=t},enumerable:!0,configurable:!0}),t}(),g=function(){function t(t){this.eventIdCounter=0,this.events=new Map,this.geoJsonEvents=new Map,this.mapView=t}return t.convertEventFromName=function(t){switch(t){case"cameraWillChange":return u.MapEvent.cameraWillChange;case"cameraChanging":return u.MapEvent.cameraChanging;case"idle":return u.MapEvent.idle;case"click":return u.MapEvent.click;case"dblClick":return u.MapEvent.dblClick;case"drag":return u.MapEvent.drag;case"dragEnd":return u.MapEvent.dragEnd;case"dragStart":return u.MapEvent.dragStart;case"mouseMove":return u.MapEvent.mouseMove;case"mouseOut":return u.MapEvent.mouseOut;case"mouseOver":return u.MapEvent.mouseOver;case"rightClick":return u.MapEvent.rightClick;case"modeChanged":return u.MapEvent.modeChanged;case"longClick":return u.MapEvent.longClick;case"hover":return u.MapEvent.hover;case"tilesLoaded":return u.MapEvent.tilesLoaded;case"boundsChanged":return u.MapEvent.boundsChanged;default:throw new Error("Event not supported: "+t)}},t.prototype.addGeoJsonListener=function(e,i){var n="string"==typeof e?t.convertEventFromName(e):e,r=this.eventIdCounter++,o=new d(r,{},i);this.geoJsonEvents.has(n)?this.geoJsonEvents.get(n).push(o):this.geoJsonEvents.set(n,[o]);var a=this.geoJsonEvents;return new(function(){function t(){}return t.prototype.remove=function(){if(a.has(n)){var t=a.get(n),e=t.findIndex((function(t){return t.id==r}));e>=0&&t.splice(e,1),0===t.length&&a.delete(n)}},t.prototype.updateEventOptions=function(t){},t}())},t.prototype.addEvent=function(e,i,n){var r="string"==typeof e?t.convertEventFromName(e):e,o={};l.MapUtils.extendOptions(o,t.defaultEventOptions,n),o.marker||o.polygon||o.polyline||o.directions||o.circle||o.location||o.poi||o.mappoi||o.building||o.mapbuilding||o.place||(o.location=!0);var a=this.eventIdCounter++,s=new d(a,o,i);this.events.has(r)?this.events.get(r).push(s):this.events.set(r,[s]);var u=this.events;return new(function(){function e(){}return e.prototype.remove=function(){if(u.has(r)){var t=u.get(r),e=t.findIndex((function(t){return t.id==a}));e>=0&&t.splice(e,1),0===t.length&&u.delete(r)}},e.prototype.updateEventOptions=function(e){var i={};l.MapUtils.extendOptions(i,t.defaultEventOptions,e),i.marker||i.polygon||i.polyline||i.directions||i.circle||i.location||i.poi||i.mappoi||i.building||i.mapbuilding||i.place||(i.location=!0),s.eventOptions=i},e}())},t.prototype.onHoverEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.hover)},t.prototype.onClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.click)},t.prototype.onLongClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.longClick)},t.prototype.onRightClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.rightClick)},t.prototype.onDoubleClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.dblClick)},t.prototype.onDragEvent=function(t,e,i){if(t==u.MapEvent.dragStart||t==u.MapEvent.drag||t==u.MapEvent.dragEnd){var s=this.events.get(t)||[];if(0!=s.length){var c={};if(i instanceof f.Building?(s=s.filter((function(t){return t.eventOptions.building})),c.building=i):i instanceof p.POI?(s=s.filter((function(t){return t.eventOptions.poi})),c.poi=i):i instanceof h.Marker?(s=s.filter((function(t){return t.eventOptions.marker})),c.marker=i):i instanceof r.Polyline?(s=s.filter((function(t){return t.eventOptions.polyline})),c.polyline=i):i instanceof o.Polygon?(s=s.filter((function(t){return t.eventOptions.polygon})),c.polygon=i):i instanceof a.Circle&&(s=s.filter((function(t){return t.eventOptions.circle})),c.circle=i),0!=s.length){var d=this.mapView.getCurrentMousePosition(e),g=new n.Point(d.x,d.y),y=l.MapUtils.pixelToPoint(g);c.location=this.mapView.screenCoordinateToLatLng(d),c.point=y,c.pixel=g,c.xa=e,s.forEach((function(t){return t.eventCallBack(c)}))}}}else console.error("Invalid event")},t.prototype.queryBuildingAndAnnotation=function(t,e,i,s){var u=this.mapView.getCurrentMousePosition(i),f=this.mapView.screenCoordinateToLatLng(u),p=new n.Point(u.x,u.y),d=l.MapUtils.pixelToPoint(p),g=this.mapView.queryBuildingAndAnnotation(e);if(g instanceof h.Marker){var y=g;if(this.mapView.showInfoWindow(y.getId()),!this.mapView.directionsRendererManager.isDirectionsRendererMarker(y.getId())){var m=(t||[]).filter((function(t){return t.eventOptions.marker}));m&&0!=m.length&&y.getMap()&&m.forEach((function(t){return t.eventCallBack({marker:y,pixel:d,xa:i,location:f})}))}}else if(g instanceof r.Polyline){var v=g,_=this.mapView.directionsRendererManager.getDirectionsRendererByAnnotationId(v.getId());if(_){var b=(t||[]).filter((function(t){return t.eventOptions.directions}));b&&0!=b.length&&b.forEach((function(t){t.eventCallBack({renderer:_.renderer,routeIndex:_.routeIndex,pixel:d,xa:i,location:f})}))}else{var w=(t||[]).filter((function(t){return t.eventOptions.polyline}));w&&0!=w.length&&w.forEach((function(t){return t.eventCallBack({polyline:v,pixel:d,xa:i,location:f})}))}}else if(g instanceof o.Polygon){var M=(t||[]).filter((function(t){return t.eventOptions.polygon}));M&&0!=M.length&&M.forEach((function(t){return t.eventCallBack({polygon:g,pixel:d,xa:i,location:f})}))}else if(g instanceof a.Circle){var x=(t||[]).filter((function(t){return t.eventOptions.circle}));x&&0!=x.length&&x.forEach((function(t){return t.eventCallBack({circle:g,pixel:d,xa:i,location:f})}))}else if(g instanceof c.BuildingQueryResult){var T,A=g;if(0!=A.annotationId){if((T=(t||[]).filter((function(t){return t.eventOptions.building})))&&T.length>0){var L=this.mapView.annotationManager.getBuilding(A.annotationId);T.forEach((function(t){t.eventCallBack({building:L,pixel:d,xa:i,location:f})}))}}else(T=(t||[]).filter((function(t){return t.eventOptions.mapbuilding})))&&T.length>0&&T.forEach((function(t){t.eventCallBack({building:{id:A.id,name:A.name,location:A.location},pixel:d,xa:i,location:f})}))}return null!=g},t.prototype.queryPlace=function(t,e,i,r,o){var a=this.mapView.getCurrentMousePosition(i),s=this.mapView.screenCoordinateToLatLng(a),u=new n.Point(a.x,a.y),h=l.MapUtils.pixelToPoint(u);if(o){var c=this.mapView.queryUserPOI(e);if(null!=c)return(f=(t||[]).filter((function(t){return t.eventOptions.poi})))&&f.forEach((function(t){return t.eventCallBack({poi:c,pixel:h,xa:i,location:s})})),!0}else{var f,p=this.mapView.queryPOI(e);if(null!=p&&0==p.annotationId)return(f=(t||[]).filter((function(t){return t.eventOptions.mappoi})))&&f.forEach((function(t){return t.eventCallBack({poi:{id:p.placeId,name:p.name,location:p.location,type:p.type},pixel:h,xa:i,location:s})})),!0;if(null!=(p=this.mapView.queryPlace(e))){var d=(t||[]).filter((function(t){return t.eventOptions.place}));return d&&d.forEach((function(t){return t.eventCallBack({place:{id:p.placeId,name:p.name,location:p.location,type:p.type},pixel:h,xa:i,location:s})})),!0}}return!1},t.prototype.queryGeoJsonFeature=function(t,e,i,r){var o=this.mapView.getCurrentMousePosition(i),a=this.mapView.screenCoordinateToLatLng(o),s=new n.Point(o.x,o.y),u=l.MapUtils.pixelToPoint(s),h=this.geoJsonEvents.get(r);if(h&&h.length>0){var c=this.mapView.getGeoJsonManager().queryFeature(e);if(c)return h.forEach((function(t){return t.eventCallBack({feature:c,pixel:u,xa:MouseEvent,location:a})})),!0}return!1},t.prototype.onEvent=function(t,e,i){var n=this.events.get(i);if(i==u.MapEvent.click)this.mapView.hideInfoWindow();else if(null==n||0==n.length)return!1;return this.mapView.mapState.is3dMode()?this.queryPlace(n,t,e,i,!0)||this.queryBuildingAndAnnotation(n,t,e,i)||this.queryGeoJsonFeature(n,t,e,i):this.queryPlace(n,t,e,i,!0)||this.queryBuildingAndAnnotation(n,t,e,i)||this.queryGeoJsonFeature(n,t,e,i)||this.queryPlace(n,t,e,i,!1)},t.prototype.notify=function(t,e,i){var r=this,o=this.events.get(t);if(o&&Array.isArray(o)&&0!==o.length)switch(t){case u.MapEvent.hover:case u.MapEvent.click:case u.MapEvent.rightClick:case u.MapEvent.dblClick:case u.MapEvent.longClick:case u.MapEvent.dragStart:case u.MapEvent.drag:case u.MapEvent.dragEnd:case u.MapEvent.mouseMove:case u.MapEvent.mouseOut:case u.MapEvent.mouseOver:var a=(o||[]).filter((function(t){return t.eventOptions.location}));if(0==a.length)return;var h=this.mapView.getCurrentMousePosition(e),c=new n.Point(h.x,h.y),f=l.MapUtils.pixelToPoint(c);a.forEach((function(t){return t.eventCallBack({location:r.mapView.screenCoordinateToLatLng(h),pixel:f,xa:e})}));break;case u.MapEvent.cameraWillChange:var p=this.mapView.getCamera();o.filter((function(t){return t.eventOptions.location})).forEach((function(t){return t.eventCallBack({camera:new s.CameraPosition(p.getTarget(),p.getTilt(),p.getBearing(),p.getZoom()),gesture:i})}));break;case u.MapEvent.cameraChanging:case u.MapEvent.idle:var d=this.mapView.getCamera();o.filter((function(t){return t.eventOptions.location})).forEach((function(t){return t.eventCallBack({camera:new s.CameraPosition(d.getTarget(),d.getTilt(),d.getBearing(),d.getZoom())})}));break;case u.MapEvent.modeChanged:o.filter((function(t){return t.eventOptions.location})).forEach((function(t){return t.eventCallBack({is3DMode:r.mapView.mapSettings.is3dMode()})}));break;case u.MapEvent.tilesLoaded:case u.MapEvent.boundsChanged:default:o.filter((function(t){return t.eventOptions.location})).forEach((function(t){return t.eventCallBack()}))}},t.prototype.destroy=function(){this.events.clear()},t.defaultEventOptions={marker:!1,polygon:!1,polyline:!1,circle:!1,poi:!1,building:!1,location:!1,mappoi:!1,mapbuilding:!1,place:!1,directions:!1},t}();e.MapsEventManager=g},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(305),r=i(307),o=i(3),a=i(2),s=i(93),l=i(308),u=function(){function t(t,e){this._particleSystems=[],this.mapState=e,this._liveMode=!1,this._weather=s.Weather.Sunny,this._particlePool=new l.ParticlePool;var i=new n.ParticleRain(t,this._particlePool);i.init(),this._particleSystems.push(i);var o=new r.ParticleSnow(t,this._particlePool);o.init(),this._particleSystems.push(o),this._lastTime=NaN}return t.prototype.setWeather=function(e){var i="string"==typeof e?t.convertWeatherFromName(e):e;i===this._weather||this._liveMode&&i===s.Weather.Live||(i==s.Weather.Live?(this._liveMode=!0,this._lastTimeGetLive=Date.now(),this._lastLocationGetLive=this.mapState.getTarget(),this.getLiveInfomation()):this._liveMode=!1,i<s.Weather.Sunny&&this._particleSystems[i].cleanup(),this._weather=i,this._lastTime=NaN)},t.prototype.setProvider=function(t){this.weatherProvider=t},t.prototype.setWeatherFromLive=function(t){t!=this._weather&&(t<s.Weather.Sunny&&this._particleSystems[t].cleanup(),this._weather=t,this._lastTime=NaN)},t.prototype.getWeather=function(){return this._weather},t.prototype.dirty=function(){return this.mapState.is3dMode()&&(this._liveMode||this.getWeather()!=s.Weather.None&&this.getWeather()!=s.Weather.Sunny&&this.getWeather()!=s.Weather.Cloudy)},t.prototype.getLiveInfomation=function(){var e=this;this.weatherProvider&&this.weatherProvider.getWeather&&this.weatherProvider.getWeather(this.mapState.getTarget(),(function(i){var n=s.Weather.None;n="string"==typeof i?t.convertWeatherFromName(i):i,e.setWeatherFromLive(n)}))},t.prototype.update=function(){if(this.dirty()){if(this._weather<s.Weather.Sunny){var t=Date.now(),e=isNaN(this._lastTime)?0:t-this._lastTime;this._lastTime=t,this._particleSystems[this._weather].update(e/1e3)}if(this._liveMode){t=Date.now();var i=this.mapState.getTarget(),n=i.distanceTo(this._lastLocationGetLive),r=(this.weatherProvider||{}).refreshDistance||a.WeatherConstants.refreshDistance,o=1e3*(this.weatherProvider||{}).refreshTime||a.WeatherConstants.refreshTime;(null==this._lastLocationGetLive||n>r||t-this._lastTimeGetLive>o)&&(this._lastLocationGetLive=i,this._lastTimeGetLive=t,this.getLiveInfomation())}}},t.prototype.render=function(t){this.dirty()&&this._weather<s.Weather.Sunny&&this._particleSystems[this._weather].render(t)},t.prototype.resize=function(t,e){for(var i=0;i<s.Weather.Sunny;++i){var n=0;i==s.Weather.Rainy&&(n=Math.abs(Math.tan(a.ParticleConstants.rainParticleRotation*a.MathConstants.deg2Rad))*e);var r=t+n;this._particleSystems[i].spawnRect={width:r,height:2},this._particleSystems[i].emitterPosition=new o.Vector2(t/2-n/2,0),this._particleSystems[i].lifetimeFunc=function(i){return i.position.y>e||i.position.x>t}}},t.convertWeatherFromName=function(t){switch(t){case"rainy":return s.Weather.Rainy;case"snowy":return s.Weather.Snowy;case"sunny":return s.Weather.Sunny;case"cloudy":return s.Weather.Cloudy;case"live":return s.Weather.Live;case"none":return s.Weather.None;default:return console.warn("Weather not supported: "+t),s.Weather.None}},t.prototype.destroy=function(){for(var t=0;t<s.Weather.Sunny;++t)this._particleSystems[t].destroy();for(;0!=this._particleSystems.length;)this._particleSystems.pop();this._particleSystems=null,this._particlePool.destroy(),this._particlePool=null},t}();e.WeatherManager=u},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(146),a=i(11),s=i(3),l=i(2),u=function(t){function e(e,i){var n=a.ResourceManager.getInstance(e),r=n.getShader(a.ShaderEnum.PARTICLE_SHADER),o=n.getTexture(a.TextureEnum.RAIN_TEXTURE);return t.call(this,e,r,o,i)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this,{frequency:l.ParticleConstants.rainFrequency,maxParticles:1e3,acceleration:new s.Vector2(0,1e3).rotateBy(l.ParticleConstants.rainParticleRotation),minSpeed:0,maxSpeed:1e3,minScale:.35,maxScale:.35,maxRotation:l.ParticleConstants.rainParticleRotation,minRotation:l.ParticleConstants.rainParticleRotation})},e}(o.ParticleSystemQuad);e.ParticleRain=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=function(){function t(t){this._particlePool=t,this._acceleration=null,this._frequency=1,this._maxParticles=1e3,this._minSpeed=0,this._maxSpeed=0,this._minScale=1,this._maxScale=1,this._minLifetime=0,this._maxLifetime=0,this._minRotation=0,this._maxRotation=0,this._minRotationSpeed=0,this._maxRotationSpeed=0,this._lifetimeFunc=null,this._extraData=null,this._updateFunc=null,this._emitterPosition=new n.Vector2(0,0),this._activeParticlesFirst=null,this._activeParticlesLast=null,this._spawnRect=null,this._spawnTimer=0,this._particleCount=0}return t.prototype.init=function(t){this.cleanup(),t.frequency&&(this._frequency=t.frequency),t.maxParticles&&(this._maxParticles=t.maxParticles>0?t.maxParticles:1e3);var e=t.acceleration;e&&(e.x||e.y)&&(this._acceleration=new n.Vector2(e.x,e.y)),t.minSpeed&&(this._minSpeed=t.minSpeed),t.maxSpeed&&(this._maxSpeed=t.maxSpeed),t.minScale&&(this._minScale=t.minScale),t.maxScale&&(this._maxScale=t.maxScale),t.maxRotation&&(this._maxRotation=t.maxRotation),t.minRotation&&(this._minRotation=t.minRotation),t.minRotationSpeed&&(this._minRotationSpeed=t.minRotationSpeed),t.maxRotationSpeed&&(this._maxRotationSpeed=t.maxRotationSpeed),t.minLifetime&&(this._minLifetime=t.minLifetime),t.maxLifetime&&(this._maxLifetime=t.maxLifetime),t.extraData&&(this._extraData=t.extraData),t.updateFunc&&(this._updateFunc=t.updateFunc),t.lifetimeFunc&&(this._lifetimeFunc=t.lifetimeFunc),t.spawnRect&&(this._spawnRect=t.spawnRect),this._spawnTimer=0},t.prototype.update=function(e){var i,r;for(i=this._activeParticlesFirst;i;i=r)r=i.next,i.update(e);for(this._spawnTimer-=e<0?0:e;this._spawnTimer<=0;)if(this._particleCount>=this._maxParticles)this._spawnTimer+=this._frequency;else{var o=void 0;o=this._lifetimeFunc?0:Math.random()*(this._maxLifetime-this._minLifetime)+this._minLifetime;var a=this._emitterPosition.x,s=this._emitterPosition.y,l=this._particlePool.acquire(this);if(l.acceleration=this._acceleration?new n.Vector2(this._acceleration.x,this._acceleration.y):null,l.scale=(this._maxScale-this._minScale)*Math.random()+this._minScale,l.maxLife=o,l.lifetimeFunc=this._lifetimeFunc,l.velocity=new n.Vector2(0,(this._maxSpeed-this._minSpeed)*Math.random()+this._minSpeed),l.rotation=(this._maxRotation-this._minRotation)*Math.random()+this._minRotation,l.rotationSpeed=(this._maxRotationSpeed-this._minRotationSpeed)*Math.random()+this._minRotationSpeed,l.extraData=t.deepClone(this._extraData),l.updateFunc=this._updateFunc,this._spawnRect&&this._spawnRect.width&&this._spawnRect.height){var u=Math.random()*this._spawnRect.width,h=Math.random()*this._spawnRect.height;l.position=new n.Vector2(a+u-this._spawnRect.width/2,s+h-this._spawnRect.height/2)}else l.position=new n.Vector2(a,s);l.init(),this._activeParticlesLast?(this._activeParticlesLast.next=l,l.prev=this._activeParticlesLast,this._activeParticlesLast=l):this._activeParticlesLast=this._activeParticlesFirst=l,++this._particleCount,this._spawnTimer+=this._frequency}},t.prototype.recycle=function(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t==this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t==this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),this._particlePool.release(t),--this._particleCount},t.prototype.cleanup=function(){var t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t);this._activeParticlesFirst=this._activeParticlesLast=null,this._particleCount=0},t.prototype.destroy=function(){this.cleanup(),this._particlePool=null,this._lifetimeFunc=null,this._spawnRect=null,this._extraData=null,this._updateFunc=null},Object.defineProperty(t.prototype,"particleCount",{get:function(){return this._particleCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"emitterPosition",{set:function(t){this._emitterPosition=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spawnRect",{set:function(t){this._spawnRect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lifetimeFunc",{set:function(t){this._lifetimeFunc=t},enumerable:!0,configurable:!0}),t.deepClone=function(t){var e={};for(var i in t)e[i]=t[i];return e},t}();e.ParticleSystem=r},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(146),a=i(11),s=i(3),l=i(2),u=function(t){function e(e,i){var n=a.ResourceManager.getInstance(e),r=n.getShader(a.ShaderEnum.PARTICLE_SHADER),o=n.getTexture(a.TextureEnum.SNOW_TEXTURE);return t.call(this,e,r,o,i)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this,{frequency:l.ParticleConstants.snowFrequency,maxParticles:1e3,acceleration:new s.Vector2(0,50),minSpeed:50,maxSpeed:200,minScale:.25,maxScale:.35,maxRotation:0,minRotation:0,minRotationSpeed:0,maxRotationSpeed:200,extraData:{counter:0},updateFunc:function(t,e){t.acceleration&&(t.velocity.y+=t.acceleration.y*e),0!==t.rotationSpeed&&(t.rotation+=t.rotationSpeed*e),t.extraData.counter+=4,t.position.x+=2*Math.cos(t.extraData.counter*l.MathConstants.deg2Rad),t.position.y+=t.velocity.y*e}})},e}(o.ParticleSystemQuad);e.ParticleSnow=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(309),r=function(){function t(){}return t.prototype.acquire=function(t){var e;return this._poolFirst?(e=this._poolFirst,this._poolFirst=this._poolFirst.next,e.next=null,e.emitter=t):e=new n.Particle(t),e},t.prototype.release=function(t){t.prev=null,t.next=this._poolFirst,this._poolFirst=t},t.prototype.destroy=function(){for(var t,e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=null},t}();e.ParticlePool=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=function(){function t(t){this._emitter=t,this._position=new n.Vector2(0,0),this._scale=1,this._velocity=new n.Vector2(0,0),this._rotation=0,this._rotationSpeed=0,this._acceleration=null,this._extraData=null,this._updateFunc=null,this._maxLife=0,this._age=0}return t.prototype.update=function(t){if(this._age+=t,this._lifetimeFunc){if(this._lifetimeFunc(this))return void this.kill()}else if(this._age>=this._maxLife||this._age<0)return void this.kill();this._updateFunc?this._updateFunc(this,t):(this._acceleration&&(this._velocity.x+=this._acceleration.x*t,this._velocity.y+=this._acceleration.y*t),0!==this._rotationSpeed&&(this._rotation+=this._rotationSpeed*t),this._position.x+=this._velocity.x*t,this._position.y+=this._velocity.y*t)},t.prototype.init=function(){this._age=0,this._velocity=this._velocity.rotateBy(this._rotation)},t.prototype.destroy=function(){this._emitter=null,this._lifetimeFunc=null,this._extraData=null,this._updateFunc=null,this._next=null,this._prev=null},t.prototype.kill=function(){this._emitter.recycle(this)},Object.defineProperty(t.prototype,"emitter",{set:function(t){this._emitter=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this._velocity=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationSpeed",{get:function(){return this._rotationSpeed},set:function(t){this._rotationSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxLife",{set:function(t){this._maxLife=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lifetimeFunc",{set:function(t){this._lifetimeFunc=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateFunc",{set:function(t){this._updateFunc=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceleration",{get:function(){return this._acceleration},set:function(t){this._acceleration=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraData",{get:function(){return this._extraData},set:function(t){this._extraData=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prev",{get:function(){return this._prev},set:function(t){this._prev=t},enumerable:!0,configurable:!0}),t}();e.Particle=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(311),r=i(312),o=i(20),a=i(13),s=i(12),l=function(){function t(t){this._lastUpdateTime=0,this._sunLight=new r.DirectionalLight(s.Color.fromHex("FFFFFF"),new o.Vector3(0,0,1)),this._timeEffectManager=t,this._oldTimeEffect=this._timeEffectManager.getTimeEffect()}return t.prototype.update=function(t){var e=(new Date).getTime();if(!(e-this._lastUpdateTime<6e4&&this._oldTimeEffect==this._timeEffectManager.getTimeEffect())){this._lastUpdateTime=e,this._oldTimeEffect=this._timeEffectManager.getTimeEffect();var i=n.getPosition(this._timeEffectManager.getTime(),t.lat,t.lng),r=-1*i.azimuth,s=a.MathUtils.clamp(Math.abs(i.altitude),Math.PI/6,Math.PI/2);this._sunLight.lightColor=this._timeEffectManager.getBuildingColor(),this._sunLight.lightPosition=new o.Vector3(Math.cos(s)*Math.sin(r),Math.cos(s)*Math.cos(r),Math.sin(s)),this._onLightPositionChanged&&this._onLightPositionChanged()}},t.prototype.setOnLightPositionChanged=function(t){this._onLightPositionChanged=t},Object.defineProperty(t.prototype,"sunLight",{get:function(){return this._sunLight},enumerable:!0,configurable:!0}),t}();e.LightingManager=l},function(t,e,i){!function(){"use strict";var e=Math.PI,i=Math.sin,n=Math.cos,r=Math.tan,o=Math.asin,a=Math.atan2,s=Math.acos,l=e/180;function u(t){return new Date(864e5*(t+.5-2440588))}function h(t){return function(t){return t.valueOf()/864e5-.5+2440588}(t)-2451545}var c=23.4397*l;function f(t,e){return a(i(t)*n(c)-r(e)*i(c),n(t))}function p(t,e){return o(i(e)*n(c)+n(e)*i(c)*i(t))}function d(t,e,o){return a(i(t),n(t)*i(e)-r(o)*n(e))}function g(t,e,r){return o(i(e)*i(r)+n(e)*n(r)*n(t))}function y(t,e){return l*(280.16+360.9856235*t)-e}function m(t){return l*(357.5291+.98560028*t)}function v(t){return t+l*(1.9148*i(t)+.02*i(2*t)+3e-4*i(3*t))+102.9372*l+e}function _(t){var e=v(m(t));return{dec:p(e,0),ra:f(e,0)}}var b={getPosition:function(t,e,i){var n=l*-i,r=l*e,o=h(t),a=_(o),s=y(o,n)-a.ra;return{azimuth:d(s,r,a.dec),altitude:g(s,r,a.dec)}}},w=b.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];b.addTime=function(t,e,i){w.push([t,e,i])};function M(t,i,n){return 9e-4+(t+i)/(2*e)+n}function x(t,e,n){return 2451545+t+.0053*i(e)-.0069*i(2*n)}function T(t,e,r,o,a,l,u){return x(M(function(t,e,r){return s((i(t)-i(e)*i(r))/(n(e)*n(r)))}(t,r,o),e,a),l,u)}function A(t){var e=l*(134.963+13.064993*t),r=l*(93.272+13.22935*t),o=l*(218.316+13.176396*t)+6.289*l*i(e),a=5.128*l*i(r),s=385001-20905*n(e);return{ra:f(o,a),dec:p(o,a),dist:s}}function L(t,e){return new Date(t.valueOf()+864e5*e/24)}b.getTimes=function(t,i,n){var r,o,a,s,c,f=l*-n,d=l*i,g=function(t,i){return Math.round(t-9e-4-i/(2*e))}(h(t),f),y=M(0,f,g),_=m(y),b=v(_),A=p(b,0),L=x(y,_,b),S={solarNoon:u(L),nadir:u(L-.5)};for(r=0,o=w.length;r<o;r+=1)c=L-((s=T((a=w[r])[0]*l,f,d,A,g,_,b))-L),S[a[1]]=u(c),S[a[2]]=u(s);return S},b.getMoonPosition=function(t,e,o){var s=l*-o,u=l*e,c=h(t),f=A(c),p=y(c,s)-f.ra,m=g(p,u,f.dec),v=a(i(p),r(u)*n(f.dec)-i(f.dec)*n(p));return m+=function(t){return t<0&&(t=0),2967e-7/Math.tan(t+.00312536/(t+.08901179))}(m),{azimuth:d(p,u,f.dec),altitude:m,distance:f.dist,parallacticAngle:v}},b.getMoonIllumination=function(t){var e=h(t||new Date),r=_(e),o=A(e),l=s(i(r.dec)*i(o.dec)+n(r.dec)*n(o.dec)*n(r.ra-o.ra)),u=a(149598e3*i(l),o.dist-149598e3*n(l)),c=a(n(r.dec)*i(r.ra-o.ra),i(r.dec)*n(o.dec)-n(r.dec)*i(o.dec)*n(r.ra-o.ra));return{fraction:(1+n(u))/2,phase:.5+.5*u*(c<0?-1:1)/Math.PI,angle:c}},b.getMoonTimes=function(t,e,i,n){var r=new Date(t);n?r.setUTCHours(0,0,0,0):r.setHours(0,0,0,0);for(var o,a,s,u,h,c,f,p,d,g,y,m,v,_=.133*l,w=b.getMoonPosition(r,e,i).altitude-_,M=1;M<=24&&(o=b.getMoonPosition(L(r,M),e,i).altitude-_,p=((h=(w+(a=b.getMoonPosition(L(r,M+1),e,i).altitude-_))/2-o)*(f=-(c=(a-w)/2)/(2*h))+c)*f+o,g=0,(d=c*c-4*h*o)>=0&&(y=f-(v=Math.sqrt(d)/(2*Math.abs(h))),m=f+v,Math.abs(y)<=1&&g++,Math.abs(m)<=1&&g++,y<-1&&(y=m)),1===g?w<0?s=M+y:u=M+y:2===g&&(s=M+(p<0?m:y),u=M+(p<0?y:m)),!s||!u);M+=2)w=a;var x={};return s&&(x.rise=L(r,s)),u&&(x.set=L(r,u)),s||u||(x[p>0?"alwaysUp":"alwaysDown"]=!0),x},t.exports=b}()},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,i){var n=t.call(this,e)||this;return n._lightPosition=i,n}return r(e,t),Object.defineProperty(e.prototype,"lightPosition",{get:function(){return this._lightPosition},set:function(t){this._lightPosition=t},enumerable:!0,configurable:!0}),e}(i(313).Light);e.DirectionalLight=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this._lightColor=t}return Object.defineProperty(t.prototype,"lightColor",{get:function(){return this._lightColor},set:function(t){this._lightColor=t},enumerable:!0,configurable:!0}),t}();e.Light=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(145),r=i(9),o=i(20),a=i(1),s=i(2),l=i(12),u=function(){function t(t,e,i){this._gl=t,this._directionalLight=e,this._mapState=i,this._lightProjectionMatrix=r.Matrix4.ortho(-10,10,-10,10,-10,20),this._lookAtMatrix=new r.Matrix4,this._lightViewProjectionMatrix=new r.Matrix4,this.resize(i.screenWidth,i.screenHeight)}return t.prototype.bind=function(){this._frameBuffer.bind(),this._gl.viewport(0,0,this._width,this._height),this._gl.clearColor(1,1,1,1),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT);var t=l.Color.fromHex(this._mapState.is3dMode()?s.MapConstants.mapBackgroundColor3D:s.MapConstants.mapBackgroundColor2D);this._gl.clearColor(t.red,t.green,t.blue,1)},t.prototype.unbind=function(){this._frameBuffer.unbind(),this._gl.viewport(0,0,this._mapState.screenWidth,this._mapState.screenHeight)},t.prototype.clear=function(){this.bind(),this.unbind()},t.prototype.getLightViewProjectionMatrix=function(){return this._lightViewProjectionMatrix},t.prototype.getShadowMapTexture=function(){return this._frameBuffer.colorTexture},t.prototype.resize=function(t,e){this._width=1.5*t,this._height=1.5*e,this._frameBuffer&&this._frameBuffer.destroy(),this._frameBuffer=new n.FrameBuffer(this._gl,this._width,this._height),this.updateMatrices(),this.clear()},t.prototype.updateMatrices=function(){var t=a.MapUtils.getTileSize(),e=s.CameraConstants.height*Math.tan(s.CameraConstants.fov/2)*t/this._mapState.screenHeight/(t/2);this._lookAtMatrix.lookAt(this._directionalLight.lightPosition,new o.Vector3(0,0,0),1,new o.Vector3(0,1,0)),this._lightViewProjectionMatrix.setIdentity(e,e,e),this._lightViewProjectionMatrix.concat(this._lookAtMatrix),this._lightViewProjectionMatrix.concat(this._lightProjectionMatrix)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.renderDebug=function(){this._frameBuffer.drawDebug()},t.prototype.destroy=function(){this._frameBuffer.destroy(),this._frameBuffer=null,this._directionalLight=null,this._gl=null,this._mapState=null,this._lightViewProjectionMatrix=null,this._lightProjectionMatrix=null},t}();e.ShadowMap=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(94),r=i(2),o=i(12),a=function(){function t(t){this._timeArray=[r.TimeConstants.morningTime,r.TimeConstants.noonTime,r.TimeConstants.afterNoonTime,r.TimeConstants.eveningTime],this.defaultTimeByString="Noon",this.mapState=t,this._timeEffect=n.TimeEffect.Noon}return t.prototype.dirty=function(){return this.mapState.is3dMode()&&this._timeEffect==n.TimeEffect.Live},t.prototype.getTimeEffect=function(){return this._timeEffect},t.prototype.getTime=function(){return this._timeEffect==n.TimeEffect.Live||null==this._time?(new Date).getTime():this._time},t.prototype.setTimeEffect=function(e){var i="string"==typeof e?t.convertTimeEffectFromName(e):e;if(null!=i){if(this._timeEffect!=i){this._timeEffect=i;var o=new Date;switch(i){case n.TimeEffect.Live:this._time=null;break;case n.TimeEffect.Morning:this._time=o.setHours(r.TimeConstants.morningTime,0,0,0);break;case n.TimeEffect.Noon:case n.TimeEffect.None:this._time=o.setHours(r.TimeConstants.noonTime,0,0,0);break;case n.TimeEffect.AfterNoon:this._time=o.setHours(r.TimeConstants.afterNoonTime,0,0,0);break;case n.TimeEffect.Evening:this._time=o.setHours(r.TimeConstants.eveningTime,0,0,0)}}}else console.error("TimeEffect value is invalid, please set again !")},t.prototype.getSkyColor=function(){if(this._timeEffect==n.TimeEffect.None)return r.ColorConstants.getSkyColor(this.defaultTimeByString);var e=null,i=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case n.TimeEffect.Live:e=this.getSkyColorByTime();break;case n.TimeEffect.Morning:case n.TimeEffect.AfterNoon:case n.TimeEffect.Evening:e=r.ColorConstants.getSkyColor(i);break;default:e=r.ColorConstants.getSkyColor(this.defaultTimeByString)}return e},t.prototype.getFogColor=function(){if(this._timeEffect==n.TimeEffect.None)return r.ColorConstants.getFogColor(this.defaultTimeByString);var e=null,i=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case n.TimeEffect.Live:e=this.getFogColorByTime();break;case n.TimeEffect.Morning:case n.TimeEffect.Noon:case n.TimeEffect.AfterNoon:case n.TimeEffect.Evening:e=r.ColorConstants.getFogColor(i);break;default:e=r.ColorConstants.getFogColor(this.defaultTimeByString)}return e},t.prototype.getSkyColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),i=null,a=0;a<this._timeArray.length-1;++a)if(e>this._timeArray[a]&&e<=this._timeArray[a+1]){i=o.Color.mix(r.ColorConstants.getSkyColor(t.getStringByTimeEffect(n.TimeEffect.Morning+a)),r.ColorConstants.getSkyColor(t.getStringByTimeEffect(n.TimeEffect.Morning+a+1)),(this._timeArray[a+1]-e)/(this._timeArray[a+1]-this._timeArray[a]));break}if(null==i&&e>r.TimeConstants.eveningTime||null==i&&e<=r.TimeConstants.morningTime){if(e>=r.TimeConstants.eveningTime||e<r.TimeConstants.morningTime-2)return r.ColorConstants.getSkyColor(t.getStringByTimeEffect(n.TimeEffect.Evening));var s=e;e<=r.TimeConstants.morningTime&&(s+=24),i=o.Color.mix(r.ColorConstants.getSkyColor("Morning"),r.ColorConstants.getSkyColor("Evening"),(s-r.TimeConstants.eveningTime)/(24-(r.TimeConstants.eveningTime-r.TimeConstants.morningTime)))}return i},t.prototype.getFogColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),i=null,a=0;a<this._timeArray.length-1;++a)if(e>this._timeArray[a]&&e<=this._timeArray[a+1]){i=o.Color.mix(r.ColorConstants.getFogColor(t.getStringByTimeEffect(n.TimeEffect.Morning+a)),r.ColorConstants.getFogColor(t.getStringByTimeEffect(n.TimeEffect.Morning+a+1)),(this._timeArray[a+1]-e)/(this._timeArray[a+1]-this._timeArray[a]));break}if(null==i&&e>r.TimeConstants.eveningTime||null==i&&e<=r.TimeConstants.morningTime){if(e>=r.TimeConstants.eveningTime||e<r.TimeConstants.morningTime-2)return r.ColorConstants.getFogColor(t.getStringByTimeEffect(n.TimeEffect.Evening));var s=e;e<=r.TimeConstants.morningTime&&(s+=24),i=o.Color.mix(r.ColorConstants.getFogColor("Morning"),r.ColorConstants.getFogColor("Evening"),(s-r.TimeConstants.eveningTime)/(24-(r.TimeConstants.eveningTime-r.TimeConstants.morningTime)))}return i},t.getStringByTimeEffect=function(t){switch(t){case n.TimeEffect.Live:return"Live";case n.TimeEffect.Morning:return"Morning";case n.TimeEffect.Noon:return"Noon";case n.TimeEffect.AfterNoon:return"AfterNoon";case n.TimeEffect.Evening:return"Evening";default:return null}},t.convertTimeEffectFromName=function(t){switch(t){case"live":return n.TimeEffect.Live;case"morning":return n.TimeEffect.Morning;case"noon":return n.TimeEffect.Noon;case"afternoon":return n.TimeEffect.AfterNoon;case"evening":return n.TimeEffect.Evening;case"none":return n.TimeEffect.None;default:return console.warn("TimeEffect not supported: "+t),n.TimeEffect.None}},t.prototype.isEveningTime=function(){var t=new Date(this.getTime()).getHours();return t>=r.TimeConstants.eveningTime||t<r.TimeConstants.morningTime},t.prototype.getBuildingColor=function(){if(this._timeEffect==n.TimeEffect.None)return r.ColorConstants.getSkyColor(this.defaultTimeByString);var e=null,i=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case n.TimeEffect.Live:e=this.getLightColorByTime();break;case n.TimeEffect.Morning:case n.TimeEffect.AfterNoon:case n.TimeEffect.Evening:e=r.ColorConstants.getLightColor(i);break;default:e=r.ColorConstants.getLightColor(this.defaultTimeByString)}return e},t.prototype.getLightColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),i=null,a=0;a<this._timeArray.length-1;++a)if(e>this._timeArray[a]&&e<=this._timeArray[a+1]){i=o.Color.mix(r.ColorConstants.getLightColor(t.getStringByTimeEffect(n.TimeEffect.Morning+a)),r.ColorConstants.getLightColor(t.getStringByTimeEffect(n.TimeEffect.Morning+a+1)),(this._timeArray[a+1]-e)/(this._timeArray[a+1]-this._timeArray[a]));break}if(null==i&&e>r.TimeConstants.eveningTime||null==i&&e<=r.TimeConstants.morningTime){if(e>=r.TimeConstants.eveningTime||e<r.TimeConstants.morningTime-2)return r.ColorConstants.getLightColor(t.getStringByTimeEffect(n.TimeEffect.Evening));var s=e;e<=r.TimeConstants.morningTime&&(s+=24),i=o.Color.mix(r.ColorConstants.getSkyColor("Morning"),r.ColorConstants.getSkyColor("Evening"),(s-r.TimeConstants.eveningTime)/(24-(r.TimeConstants.eveningTime-r.TimeConstants.morningTime)))}return i},t}();e.TimeEffectManager=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}return t.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},t.prototype.remove=function(t){for(var e=this._currentlyRunning,i=0,n=e?this._queue.concat(e):this._queue;i<n.length;i++){var r=n[i];if(r.id===t)return void(r.cancelled=!0)}},t.prototype.run=function(){this._currentlyRunning&&console.log("Task is currently running");var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];if(!n.cancelled&&(n.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},t.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]},t}();e.TaskQueue=n},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(318),a=i(9),s=function(t){function e(){var e=t.call(this)||this;return e.viewMatrix=new a.Matrix4,e}return r(e,t),e.prototype.getViewMatrix=function(){return this.viewMatrix},e.prototype.updateMatrices=function(t){this.viewMatrix.setIdentity(),this.viewMatrix.translate(0,1-2*t.getSkyRatio(),-1),this.mvpMatrix.copy(this.viewMatrix),this.mvpMatrix.concat(t.getProjectionMatrix())},e.prototype.destroy=function(){},e}(o.Object3D);e.SkyObject=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(9),a=function(t){function e(){var e=t.call(this)||this;return e.mvpMatrix=new o.Matrix4,e.modelMatrix=new o.Matrix4,e}return r(e,t),e.prototype.setModel=function(t){this.model=t},e.prototype.setTexture=function(t){this.texture=t},e.prototype.getModel=function(){return this.model},e.prototype.getTexture=function(){return this.texture},e.prototype.hasTexture=function(){return null!=this.texture},e.prototype.getModelMatrix=function(){return this.modelMatrix},e.prototype.getMvpMatrix=function(){return this.mvpMatrix},e}(i(69).ResourceReference);e.Object3D=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),r=i(8),o=function(){function t(t,e){this.gl=t,this.timeEffectManager=e}return t.prototype.render=function(t,e){if(null!=t&&null!=t.getMvpMatrix()){this.gl.enable(this.gl.DEPTH_TEST);var i=n.ResourceManager.getInstance(this.gl),o=i.getShader(n.ShaderEnum.SKY_SHARDER),a=i.getModel(n.ModelEnum.SKY_MODEL);o.bind();var s=1-2*e.getSkyRatio(),l=s+e.screenHeight/e.screenHeight/2,u=this.timeEffectManager.getSkyColor(),h=this.timeEffectManager.getFogColor();o.setUniforms([new r.UniformInfo("u_lowerLimit","1f",s),new r.UniformInfo("u_upperLimit","1f",l),new r.UniformInfo("u_viewMatrix","matrix",t.getViewMatrix()),new r.UniformInfo("u_mvpMatrix","matrix",t.getMvpMatrix()),new r.UniformInfo("u_skyColor","3fv",u.rgbBuffer()),new r.UniformInfo("u_fogColor","3fv",h.rgbBuffer())]),a.bind(),o.setAttributes(a.attributeInfos),a.render(this.gl.TRIANGLES),a.unbind(),this.gl.disable(this.gl.DEPTH_TEST)}else console.warn("Can not render because skyObject is null !")},t}();e.SkyRenderer=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this._shadowMap=t,this.mapState=e,this._enableShadowEffect=!1,this._enableWaterEffect=!1}return Object.defineProperty(t.prototype,"enableWaterEffect",{get:function(){return this._enableWaterEffect},set:function(t){this._enableWaterEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableShadowEffect",{get:function(){return this._enableShadowEffect},set:function(t){this._enableShadowEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowMap",{get:function(){return this._shadowMap},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e){this._shadowMap.resize(t,e)},t.prototype.dirty=function(){return this.mapState.is3dMode()&&this.enableWaterEffect},t.prototype.destroy=function(){this._shadowMap.destroy(),this._shadowMap=null},t}();e.EffectManager=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(96),r=i(105),o=i(322),a=i(0),s=i(2),l=i(104),u=i(76),h=i(113),c=i(28),f=i(78),p=i(75),d=i(5),g=i(14),y=i(101),m=i(3),v=i(7),_=i(6),b=i(10),w=i(67),M=i(1),x=i(95),T=i(107),A=i(68),L=i(41),S=function(){function t(t,e,i,n){this._id=t,this._coordinate=e,this._properties=i,this._order=n,this._minX=e.lng,this._minY=e.lat,this._maxX=e.lng,this._maxY=e.lat}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coordinate",{get:function(){return this._coordinate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this._properties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this._order},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}(),E=function(){function t(t){this.pointTree=r(),this.tiles=new Map,this.features=new o,this.mapView=t,this.dirty=!1}return t.prototype.update=function(){var t=this;this.dirty&&(this.tiles.forEach((function(e){var i=t.getTileData(e.getTileCoordinate());t.updateRenderTile(i,e),e.setData(i)})),this.dirty=!1)},t.prototype.addFeature=function(t){var e=t instanceof x.Data.Feature?t:new x.Data.Feature(t.id,t.geometry,t.properties),i=e.getId();return this.features.push("string"==typeof i?i:i.toString(),e),this.reloadIndexer(),e},t.prototype.removeFeature=function(t){if(null!=t){var e=t.getId();e&&this.features.remove("string"==typeof e?e:e.toString())&&this.reloadIndexer()}},t.prototype.removeAllFeatures=function(){this.features.clear(),this.reloadIndexer()},t.prototype.addGeoJson=function(t){var e=this,i=[];return JSON.parse(t).features.forEach((function(t){var n=[],r=[],o=t.geometry.type,a=null;if("Point"===o){var s=t.geometry.coordinates;a=new x.Data.Point(s)}else if("MultiPoint"===o){var l=t.geometry.coordinates,u=[];l.forEach((function(t){u.push(d.LatLng.convert(t))})),a=new x.Data.MultiPoint(u)}else if("Polygon"===o){for(var h=t.geometry.coordinates,c=[],f=0;f<h.length;++f){h[f].forEach((function(t){n.push(d.LatLng.convert(t))})),c.push(n),n=[]}L.Polygon.normalizePaths(c);for(f=0;f<c.length;++f)r.push(new x.Data.LinearRing(c[f]));a=new x.Data.Polygon(r)}else if("MultiPolygon"===o){var p=[];t.geometry.coordinates.forEach((function(t){for(var e=[],i=[],n=function(e){var n=t[e],r=[];n.forEach((function(t){r.push(d.LatLng.convert(t))})),i.push(r)},r=0;r<t.length;++r)n(r);L.Polygon.normalizePaths(i);for(r=0;r<i.length;++r)e.push(new x.Data.LinearRing(i[r]));p.push(new x.Data.Polygon(e))})),a=new x.Data.MultiPolygon(p)}else if("LineString"===o)t.geometry.coordinates.forEach((function(t){n.push(d.LatLng.convert(t))})),a=new x.Data.LineString(n);else{if("MultiLineString"!==o)return void console.warn("Geometry type not supported: "+o);var g=[];t.geometry.coordinates.forEach((function(t){var e=[];t.forEach((function(t){e.push(d.LatLng.convert(t))})),g.push(new x.Data.LineString(e))})),a=new x.Data.MultiLineString(g)}var m=t.id?"string"==typeof t.id?t.id:t.id.toString():y.UUID.generate();if(e.features.get(m))console.warn("Feature id already exist! This feature will be ignored: "+m);else{var v=new x.Data.Feature(m,a,t.properties);e.features.push(m,v),i.push(v)}})),this.reloadIndexer(),i},t.prototype.addTile=function(t){var e=t.getTileCoordinate(),i=this.getTileData(e);this.updateRenderTile(i,t),t.setData(i),this.tiles.set(e.toString(),t)},t.prototype.removeTile=function(t){var e=this,i=this.tiles.get(t.toString());if(i){var n=i.getGeometryTileData();if(null!=n){var r=n.getLayerIds(),o=i.getTileCoordinate().toString();r.forEach((function(t){var i=e.mapView.getLayer(t);null!=i&&(i.getLayerType()==a.LayerType.GEOJSON&&i.removeRenderTile(o))}))}i.destroy(),this.tiles.delete(i.getTileCoordinate().toString())}},t.prototype.removeAllTiles=function(){var t=this;Array.from(this.tiles.values()).forEach((function(e){return t.removeTile(e.tileCoordinate)}))},t.prototype.queryFeature=function(t){var e=this.mapView.mapState,i=v.GeometryUtils.screenCoordinateToLatLng(t,e.cameraPosition,e.getScreenSize());if(!i.valid())return null;var n=new A.Box(new b.Point(t.x-M.MapUtils.touchBoxSize/2,t.y-M.MapUtils.touchBoxSize/2),new b.Point(t.x+M.MapUtils.touchBoxSize/2,t.y+M.MapUtils.touchBoxSize/2)),r=u.TileCoordinate.fromLatLng(i,e.getZoom(),e.is3dMode()),o=1,a=e.getMaxNativeZoom();e.getZoom()>a&&(r=u.TileCoordinate.fromLatLng(i,e.getMaxNativeZoom(),e.is3dMode()),o=Math.pow(2,Math.round(e.getZoom())-a));var l=this.querySymbols(t);if(this.tiles.has(r.toString())){for(var h=0;h<l.length;++h){var c=l[h],f=s.MapConstants.pointGeoJsonAnchor,p=f[0],d=f[1];if(w.CollisionUtils.boxIntersectsSymbol(n,c.coordinate,0,s.MapConstants.pointGeoJsonWidth,s.MapConstants.pointGeoJsonHeight,new b.Point(p,d),e))return this.features.get(c.id)}var g=this.tiles.get(r.toString()).getGeometryTileData();if(null==g||0==g.getLayerIds().length)return null;var y=e.scale,x=r.getX(),T=r.getY(),L=v.GeometryUtils.screenCoordinateToLatLng(new m.Vector2(n.min.x,n.min.y),e.cameraPosition,e.getScreenSize()),S=v.GeometryUtils.screenCoordinateToLatLng(new m.Vector2(n.max.x,n.max.y),e.cameraPosition,e.getScreenSize()),E=v.GeometryUtils.pixelCoordinateToVectorTileCoordinate(_.ProjectionMercator.projectScale(L,y),x,T,o),I=v.GeometryUtils.pixelCoordinateToVectorTileCoordinate(_.ProjectionMercator.projectScale(S,y),x,T,o),P=this.queryShapeAnnotationInternal(E,I,g);if(P)return P}return null},t.prototype.querySymbols=function(t){var e=this,i=[];if(null==t)return i;var n=new A.Box(new b.Point(t.x-M.MapUtils.getTileSize()/2,t.y-M.MapUtils.getTileSize()/2),new b.Point(t.x+M.MapUtils.getTileSize()/2,t.y+M.MapUtils.getTileSize()/2));return this.tiles.forEach((function(t){var r=t.getTileCoordinate(),o=v.GeometryUtils.tileCoordinateToLatLngBounds(r),a=e.mapView.latLngToScreenCoordinate(o.getSouthwest()),s=e.mapView.latLngToScreenCoordinate(o.getNortheast()),l=new A.Box(new b.Point(a.x,s.y),new b.Point(s.x,a.y));if(w.CollisionUtils.boxIntersectsBox(l,n)){var u={minX:o.getSouthwest().lng,minY:o.getSouthwest().lat,maxX:o.getNortheast().lng,maxY:o.getNortheast().lat};e.pointTree.search(u).forEach((function(t){i.push(t)}))}})),i.length>0&&i.sort((function(t,e){return e.order-t.order})),i},t.prototype.queryShapeAnnotationInternal=function(t,e,i){var n=M.MapUtils.getTileSize(),r=i.getLayerIds();r.sort();for(var o=i.getLayerIds().length,a=this.mapView.mapState,s=[new b.Point(t.x,e.y),new b.Point(e.x,e.y),new b.Point(e.x,t.y),new b.Point(t.x,t.y)],l=0;l<o;++l)for(var u=r[l],c=i.getLayer(u),f=function(t){var e=c.getFeature(t),i=e.getType();if(!(e instanceof h.VectorTileFeature)||i==g.GeometryType.Point||i==g.GeometryType.Unknown)return"continue";var r=e,o=r.getGeometries().geometryCoordinates;if(null==p.mapView.getLayer(u))return console.error("There is problem while querying shape annotation"),{value:null};if(i==g.GeometryType.LineString){var l=(e.properties.get("stroke-width")||T.LineLayerRenderData.defaultStrokeWidth)*M.MapUtils.pixelScale/2;a.getZoom()>a.getMaxNativeZoom()&&(l/=Math.pow(2,Math.round(a.getZoom())-a.getMaxNativeZoom()));var f=[];if(o.forEach((function(t){var e=[];t.forEach((function(t){return e.push(new b.Point(t[0],t[1]))})),f.push(e)})),l*=M.MapUtils.pixelScale,w.CollisionUtils.polygonIntersectsBufferedMultiLine(s,f,l/n))return{value:p.features.get(r.getId())}}else if(i==g.GeometryType.Polygon){for(var d=!1,y=function(t){var e=o[t],i=[];if(e.forEach((function(t){return i.push(new b.Point(t[0],t[1]))})),0==t){if(!(d=w.CollisionUtils.polygonIntersectsPolygon(s,i)))return"break"}else if(w.CollisionUtils.polygonIntersectsPolygon(s,i)&&!w.CollisionUtils.polygonIntersectsBufferedMultiLine(s,[i],0))return d=!1,"break"},m=0;m<o.length;++m){if("break"===y(m))break}if(d)return{value:p.features.get(r.getId())}}},p=this,d=c.featureCount()-1;d>=0;--d){var y=f(d);if("object"==typeof y)return y.value}return null},t.prototype.updateRenderTile=function(t,e){var i=this;if(null!=t){var n=e.getTileCoordinate(),r=n.toString();t.getLayerIds().forEach((function(t){var o=i.mapView.getLayer(t);if(null!=o){var s=o.getLayerType(),l=new f.RenderTile(p.UnwrappedTileCoordinate.createWithXYZoom(n.getX(),n.getY(),n.getZoom()),e);if(s==a.LayerType.GEOJSON)o.addRenderTile(r,l)}}))}},t.prototype.reloadIndexer=function(){var t=this,e={type:"FeatureCollection",features:[]};this.pointTree.clear();var i=0;this.features.each((function(n,r){var o=r.getGeometry().getType(),a=r.getProperties(),s=[],l=!1,u=[];if("Point"===o){var h=r.getGeometry();t.pointTree.insert(new S(n,h.get(),a,i++))}else if("MultiPoint"===o){r.getGeometry().forEachLatLng((function(e){t.pointTree.insert(new S(n,e,a,i++))}))}else if("Polygon"===o){for(var c=r.getGeometry(),f=function(t){var e=[];c.getAt(t).elements.forEach((function(t){return e.push([t.lng,t.lat])})),s.push(e)},p=0;p<c.getLength();++p)f(p);(null==a||!a["stroke-width"]||a["stroke-width"]>0)&&(l=!0,u=s)}else if("MultiPolygon"===o){var d=r.getGeometry(),g=d.getLength();(null==a||!a["stroke-width"]||a["stroke-width"]>0)&&(l=!0);for(p=0;p<g;++p){for(var y=[],m=(c=d.getAt(p),function(t){var e=[];c.getAt(t).elements.forEach((function(t){return e.push([t.lng,t.lat])})),y.push(e)}),v=0;v<c.getLength();++v)m(v);l&&y.forEach((function(t){return u.push(t)}));var _={type:"Feature",id:r.getId(),properties:a,geometry:{type:"Polygon",coordinates:y}};e.features.push(_)}}else if("LineString"===o)r.getGeometry().forEachLatLng((function(t){s.push([t.lng,t.lat])}));else{if("MultiLineString"!==o)throw new Error("Not reachable");var b=r.getGeometry(),w=(g=b.getLength(),function(t){var e=[];b.getAt(t).forEachLatLng((function(t){e.push([t.lng,t.lat])})),s.push(e)});for(p=0;p<g;++p)w(p)}if("MultiPolygon"!==o&&"Point"!==o){_={type:"Feature",id:r.getId(),properties:a,geometry:{type:o,coordinates:s}};e.features.push(_)}if(l){var M="#555555",x=1;a&&(M=a.stroke||"#555555",x=a["stroke-opacity"]?a["stroke-opacity"]:1);for(p=0;p<u.length;++p){var T=u[p],A={type:"Feature",id:r.getId(),properties:{"fill-outlined":!0,stroke:M,"stroke-opacity":x},geometry:{type:"LineString",coordinates:T}};e.features.push(A)}}}));var r={maxZoom:Math.max(s.MapConstants.geoJsonMinNativeZoom,this.mapView.getMaxNativeZoom()),buffer:0,extent:s.MapConstants.tileExtend,tolerance:6};this.geoJsonIndexer=n.default(e,r),this.dirty=!0,this.mapView.dirty=!0;var o=[];Array.from(this.tiles.values()).forEach((function(t){return o.push(new l.VectorTile(t.tileCoordinate,t.gl))})),this.removeAllTiles(),o.forEach((function(e){return t.addTile(e)}))},t.prototype.getTileData=function(e){if(0==this.features.size())return null;var i=new h.VectorTileData,n=this.geoJsonIndexer.getTile(e.getZoom(),e.getX(),e.getY());null!=n&&null!=n.features&&n.features.forEach((function(e){var n=e.type,r=new c.GeometryCollection(e.geometry),o=new Map,a=e.tags;for(var s in a)o.set(s,a[s]);var l=i.addLayer(t.geoJsonLayerId);n===g.GeometryType.Polygon?l.addFeature(e.id,n,r,o):n===g.GeometryType.LineString&&(o.has("fill-outlined"),l.addFeature(e.id,n,r,o))}));var r=v.GeometryUtils.tileCoordinateToLatLngBounds(e),o={minX:r.getSouthwest().lng,minY:r.getSouthwest().lat,maxX:r.getNortheast().lng,maxY:r.getNortheast().lat},a=this.pointTree.search(o),s=i.addLayer(t.geoJsonLayerId);return a.sort((function(t,e){return t.order-e.order})),a.forEach((function(t){var e=new Map;e.set("coordinate-lat",t.coordinate.lat),e.set("coordinate-lng",t.coordinate.lng),s.addFeature(t.id,g.GeometryType.Point,null,e)})),i},t.geoJsonLayerId="3.maplink.geojson.layer",t}();e.GeoJsonManager=E},function(t,e,i){!function(e){"use strict";function i(t){this._map=t}function n(){throw new Error("Cannot write to an immutable view of LinkedMap")}function r(){this.clear()}["size","get","headKey","head","tailKey","tail","each","nextKey","next","previousKey","previous","keys","values","toObject","toString"].forEach((function(t){i.prototype[t]=function(){var e=Array.prototype.slice.apply(arguments);return this._map[t].apply(this._map,e)}})),["unshift","push","shift","pop","remove","clear"].forEach((function(t){i.prototype[t]=n})),i.prototype.immutableView=function(){return this},r.prototype._add=function(t,e){var i=this._map[t];return i?(i.value=e,null):(i={key:t,value:e,next:null,prev:null},this._map[t]=i,this._size++,i)},r.prototype.size=function(){return this._size},r.prototype.get=function(t){return(this._map[t]||{}).value||null},r.prototype.headKey=function(){return(this._head||{}).key||null},r.prototype.tailKey=function(){return(this._tail||this._head||{}).key||null},r.prototype.head=function(){return(this._head||{}).value||null},r.prototype.tail=function(){return(this._tail||this._head||{}).value||null},r.prototype.unshift=function(t,e){var i=this._add(t,e);i&&(this._head?this._tail?(i.next=this._head,this._head.prev=i,this._head=i):(this._tail=this._head,this._head=i,this._head.next=this._tail,this._tail.prev=this._head):this._head=i)},r.prototype.push=function(t,e){var i=this._add(t,e);i&&(this._head?this._tail?(this._tail.next=i,i.prev=this._tail,this._tail=i):(this._tail=i,this._tail.prev=this._head,this._head.next=this._tail):this._head=i)},r.prototype._remove=function(t){return t&&this._head?(delete this._map[t.key],this._size--,t===this._head?this._tail?this._head.next===this._tail?(this._head.next=this._tail.prev=null,this._head=this._tail,this._tail=null):(this._head=this._head.next,this._head.prev=null):this._head=null:t===this._tail?this._head.next==this._tail?this._tail.prev=this._head.next=this._tail=null:(this._tail=this._tail.prev,this._tail.next=null):(t.prev.next=t.next,t.next.prev=t.prev),t.next=t.prev=null,t.value):null},r.prototype.shift=function(){return this._remove(this._head)},r.prototype.pop=function(){return this._remove(this._tail||this._head)},r.prototype.remove=function(t){return this._remove(this._map[t])},r.prototype.each=function(t,e,i){"function"==typeof t&&(i=e,e=t,t=!1);for(var n=t&&this._tail||this._head;n&&!1!==e.call(i,n.key,n.value);)n=t?n.prev:n.next},r.prototype.nextKey=function(t,e){var i=this._map[t];return i?(i=i.next)?i.key:e&&this._head?this._head.key:null:null},r.prototype.next=function(t,e){return this.get(this.nextKey(t,e))},r.prototype.previousKey=function(t,e){var i=this._map[t];return i?(i=i.prev)?i.key:e&&(this._tail||this._head)?(this._tail||this._head).key:null:null},r.prototype.previous=function(t,e){return this.get(this.previousKey(t,e))},r.prototype.clear=function(){this._map={},this._size=0,this._head=null,this._tail=null},r.prototype.keys=function(){var t=[];return this.each((function(e){t.push(e)})),t},r.prototype.values=function(){var t=[];return this.each((function(e,i){t.push(i)})),t},r.prototype.immutableView=function(){return new i(this)},r.prototype.toObject=function(){var t={};return this.each((function(e,i){t[e]=i})),t},r.prototype.toString=function(){return"LinkedMap[size="+this.size()+"]"},void 0!==t.exports?t.exports=r:e.LinkedMap=r}(this)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(24),o=i(47),a=i(324),s=i(61),l=i(2),u=i(11),h=i(49),c=i(8),f=i(20),p=i(1),d=i(0);function g(t){return t==o.CollisionType.POI||t==o.CollisionType.USERPOI}function y(t){return t==o.CollisionType.POITEXT||t==o.CollisionType.USERPOITEXT}var m=function(){function t(t,e){this.aabbs=[],this.obbs=[],this.gl=t,this.mapState=e,this.isect2d=new a.ISect2D}return t.prototype.clearCollision=function(){this.obbs=[];var t=this.mapState.getScreenSize();this.isect2d.resize(new n.Vector2(t.x/128,t.y/128),t),this.isect2d.clear()},t.prototype.insert=function(t){this.obbs.push(t)},t.prototype.intersectAABBs=function(){var t=this;this.aabbs=[],this.obbs.forEach((function(e){var i=e.obb.getExtent();t.aabbs.push(i)})),this.isect2d.intersect(this.aabbs),this.isect2d.pairs.forEach((function(e){var i=t.obbs[e.first],n=t.obbs[e.second];(i.type>n.type||i.type==n.type&&(i.getRank()<n.getRank()||Math.abs(i.getRank()-n.getRank())<l.MathConstants.epsilon&&i.getId()>n.getId()))&&e.swapFirstAndSecond()})),this.isect2d.pairs.sort((function(e,i){if(e.first==i.first)return e.second-i.second;var n=t.obbs[e.first],r=t.obbs[i.first];return n.type!=r.type?n.type-r.type:Math.abs(n.getRank()-r.getRank())>l.MathConstants.epsilon?r.getRank()-n.getRank():n.getId()-r.getId()}))},t.prototype.hitTest=function(){this.intersectAABBs();for(var t=0;t<this.isect2d.pairs.length;++t){var e=this.isect2d.pairs[t],i=this.obbs[e.first],n=this.obbs[e.second];if(s.OBB.intersect(i.obb,n.obb)){if(i.type==o.CollisionType.USERPOI&&i.type==n.type)continue;if((i.type==o.CollisionType.POI||i.type==o.CollisionType.POITEXT)&&n.type==i.type&&i.getId()==n.getId())continue;if((i.type==o.CollisionType.VECTOR_LABEL||i.type==o.CollisionType.PLACE_LABEL||i.type==o.CollisionType.BOUNDARY_LABEL)&&n.type==i.type){var r=this.mapState.getZoom();if(Math.abs(i.getZoom()-n.getZoom())>=l.MapConstants.collisionZoomStep){Math.abs(i.getZoom()-r)<l.MathConstants.epsilon?n.setVisible(!1):i.setVisible(!1);continue}if(r-Math.floor(r)>l.MathConstants.epsilon&&r-Math.floor(r)<l.MapConstants.collisionZoomStep)continue}if(!i.isVisible()||!n.isVisible())continue;(i.type==o.CollisionType.POI&&n.type==o.CollisionType.POITEXT&&i.getRank()<n.getRank()?i:n).setVisible(!1)}}},t.prototype.query=function(t){if(0==this.obbs.length)return null;var e=4*p.MapUtils.pixelScale,i=t.x-e,n=t.y-e,a=t.x+e,l=t.y+e,u=new s.OBB((i+a)/2,(n+l)/2,0,a-i,l-n),h=new o.CollisionItem(u,o.CollisionType.QUERYBOX,null);this.obbs.push(h),this.intersectAABBs();for(var c=this.obbs.length-1,f=this.obbs[c],m=this.isect2d.pairs.filter((function(t){return(t.first==c||t.second==c)&&t.first!=t.second})),v=0;v<m.length;++v){var _=m[v],b=this.obbs[_.first];_.first==c&&(b=this.obbs[_.second]);var w=b.type;if((g(w)||y(w)||w==o.CollisionType.PLACE_LABEL)&&s.OBB.intersect(f.obb,b.obb)){var M=b.renderData,x=M.getType();if(x==d.LayerType.POI||x==d.LayerType.USERPOI){var T=M;if(!T.isVisible()&&g(w))continue;if(!T.isTextVisible()&&y(w))continue;if(x==d.LayerType.POI){var A=M.getLayerProperties();return this.popObbs(),new r.Order(A.getId(),A.getRank())}return(A=M.getLayerProperties()).isUserInteractionEnabled()?(this.popObbs(),new r.Order(A.getId(),A.getRank())):(this.popObbs(),null)}if(!(A=M.getLayerProperties()).isVisible())continue;return this.popObbs(),new r.Order(A.getId(),A.getSortRank())}}return this.popObbs(),null},t.prototype.popObbs=function(){this.obbs.splice(-1)},t.prototype.drawDebug=function(){if(h.Env.isCollisionDebug){var t=this.gl,e=u.ResourceManager.getInstance(t).getShader(u.ShaderEnum.LINE_COLLISION_SHADER);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),e.bind();var i=t.createBuffer();t.bindBuffer(this.gl.ARRAY_BUFFER,i);var n=this.mapState.getOrthoProjectionMatrix(),r=new f.Vector3(1,0,0);e.setUniforms([new c.UniformInfo("u_mvpMatrix","matrix",n),new c.UniformInfo("u_color","3f",r)]);var o=e.attributes.a_position;this.obbs.forEach((function(e){var i=new Array(8);i[0]=e.obb.getQuad()[0],i[1]=e.obb.getQuad()[1],i[2]=e.obb.getQuad()[2],i[3]=e.obb.getQuad()[3],i[4]=e.obb.getQuad()[4],i[5]=e.obb.getQuad()[5],i[6]=e.obb.getQuad()[6],i[7]=e.obb.getQuad()[7],t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,8,0),t.drawArrays(t.LINE_LOOP,0,4)})),t.bindBuffer(t.ARRAY_BUFFER,null),t.disable(t.BLEND)}},t}();e.Collision2DManager=m},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(13),r=function(){function t(t,e,i){this.first=t,this.second=e,this.next=i}return t.prototype.swapFirstAndSecond=function(){var t=this.first;this.first=this.second,this.second=t},t}();e.Pair=r;var o=function(){function t(){this.split_x=0,this.split_y=0,this.res_x=0,this.res_y=0,this.xpad=0,this.ypad=0,this.pairs=[],this.pairMap=new Array(2048).fill(-1)}return t.prototype.resize=function(t,e){this.split_x=Math.round(t.x),this.split_y=Math.round(t.y),this.res_x=Math.round(e.x),this.res_y=Math.round(e.y),this.split_x=Math.max(this.split_x,1),this.split_y=Math.max(this.split_y,1),this.res_x=Math.max(this.res_x,this.split_x),this.res_y=Math.max(this.res_y,this.split_y),this.xpad=Math.round(this.res_x/this.split_x),this.ypad=Math.round(this.res_y/this.split_y),this.gridAABBs=new Array(this.split_x*this.split_y);for(var i=0;i<this.gridAABBs.length;++i)this.gridAABBs[i]=[]},t.prototype.clear=function(){this.pairs=[],this.pairMap=new Array(this.pairMap.length).fill(-1),this.gridAABBs.forEach((function(t){[]}))},t.prototype.intersect=function(e){this.clear();for(var i=0,o=0;o<e.length;++o){var a=e[o],s=Math.round(a.getMin().x/this.xpad),l=Math.round(a.getMin().y/this.ypad),u=Math.round(a.getMax().x/this.xpad+1),h=Math.round(a.getMax().y/this.ypad+1);s=n.MathUtils.clamp(s,0,this.split_x-1),l=n.MathUtils.clamp(l,0,this.split_y-1),u=n.MathUtils.clamp(u,1,this.split_x),h=n.MathUtils.clamp(h,1,this.split_y);for(var c=l;c<h;++c)for(var f=s;f<u;++f)this.gridAABBs[f+c*this.split_x].push(i);i++}for(o=0;o<this.gridAABBs.length;++o){var p=this.gridAABBs[o];if(p&&0!=p.length){for(var d=0;d<p.length-1;++d)for(var g=e[p[d]],y=d+1;y<p.length;++y){var m=e[p[y]];if(g.intersect(m)){var v=t.hashKey(t.hashNumber(p[d])<<32|t.hashNumber(p[y]));v&=this.pairMap.length-1;for(var _=this.pairMap[v];-1!=_&&(this.pairs[_].first!=p[d]||this.pairs[_].second!=p[y]);)_=this.pairs[_].next;-1==_&&(this.pairs.push(new r(p[d],p[y],this.pairMap[v])),this.pairMap[v]=this.pairs.length-1)}}p=[]}}},t.hashNumber=function(t){return t+=~(t<<15),t^=t>>10,t+=t<<3,t^=t>>6,t+=~(t<<11),t^=t>>16},t.hashKey=function(t){return t=~t+(t<<18),t^=t>>31,t*=21,t^=t>>11,t+=t<<6,t^=t>>22},t}();e.ISect2D=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(77),r=i(114),o=i(0),a=i(2),s=i(17),l=i(37),u=i(48),h=i(326),c=i(16),f=function(){function t(t,e,i){var o=this;this.idCounter=1,this.map=t,this.mapState=t.mapState,this.rasterOverlayLayers=new Map,this.tileRequestsMap=new Map,this.tileOverlays=new Map,this.buildingOverlays=new Map,this.groundOverlays=new Map,this.poiOverlays=new Map;this.tilePyramid=new n.TilePyramid(this.map,a.MapConstants.tileCacheSize,(function(t){return o.createTile(t)}),(function(t){o.removeTile(t)}),(function(t){o.updateTileFromCache(t)}),this.tileRequestsMap),this.taskDataManager=new r.TaskDataManager(t,e,i,this.tileRequestsMap)}return t.prototype.visibleTilesChanged=function(){this.finishedLoad=!1},t.prototype.createTile=function(t){var e=new s.Tile(s.Kind.OVERLAY,t,this.map.gl);return this.requestOverlayData(e,t)||e.setRenderable(),e},t.prototype.requestOverlayData=function(t,e){var i=this,n=e.getX(),r=e.getY(),o=e.getZoom(),a=this.mapState.is3dMode(),s=!1;return a?this.buildingOverlays.forEach((function(e){var a=e.getUrl(n,r,o);if(a&&a.length>0){s=!0;var u=e.getProperties().getLayerId(),h=e.getPrefixId();i.taskDataManager.requestData(t,l.Resource.BuildingOverlay,a,u,h,(function(t){return e.parserData(t)}))}})):this.poiOverlays.forEach((function(e){var a=e.getUrl(n,r,o);if(a&&a.length>0){s=!0;var u=e.getProperties().getLayerId(),h=e.getPrefixId();i.taskDataManager.requestData(t,l.Resource.POIOverlay,a,u,h,(function(t){return e.parserData(t)}))}})),this.tileOverlays.forEach((function(e){var u=e.getUrl(n,r,o,a);if(null!=u&&0!=u.length){s=!0;var h=e.getProperties().getLayerId();i.taskDataManager.requestData(t,l.Resource.RasterOverlay,u,h)}})),this.groundOverlays.forEach((function(u){if(h.TileRange.fromLatLngBounds(u.getBounds(),o,o).contains(e)){var c=u.getUrl(n,r,o,a);if(c&&c.length>0){s=!0;var f=u.getProperties().getLayerId();i.taskDataManager.requestData(t,l.Resource.RasterOverlay,c,f)}}})),s},t.prototype.removeTile=function(t){if(t.getTileData().hasLayerType(o.LayerType.BUILDING_OVERLAY)&&this.dirtyBuildingOverlay(),this.taskDataManager.removeTaskResult(t.getTileCoordinate(),!0),this.mapState.is3dMode()){var e=c.MapResourceManager.getInstance(this.map.gl);t.getTileRenderData().getLayerRenderDatas().forEach((function(t){if(t.getType()==o.LayerType.BUILDING_OVERLAY){var i=t;e.removeVisibleBuildingId(i.getId())}}))}this.tilePyramid.getTileCache()||t.destroy()},t.prototype.updateTileFromCache=function(t){var e=this,i=t.getTileCoordinate(),n=t.getTileData(),r=n.getLayerIds(),a=i.getX(),s=i.getY(),u=i.getZoom(),f=this.map.mapState.is3dMode();if(f){if(n.hasLayerType(o.LayerType.BUILDING_OVERLAY)){var p=c.MapResourceManager.getInstance(this.map.gl);t.getTileRenderData().getLayerRenderDatas().forEach((function(t){if(t.getType()==o.LayerType.BUILDING_OVERLAY){var e=t,i=e.getId();p.hasVisibleBuildingId(i)||e.resetScaleZ(),p.retainVisibleBuildingId(i)}}))}this.buildingOverlays.forEach((function(i){var o=i.getProperties().getLayerId();if(null!=n.getTileLayer(o))r.splice(r.indexOf(o),1);else{var h=i.getUrl(a,s,u);null!=h&&h.length>0&&e.taskDataManager.requestData(t,l.Resource.BuildingOverlay,h,o,i.getPrefixId(),(function(t){return i.parserData(t)}))}}))}else this.poiOverlays.forEach((function(i){var o=i.getProperties().getLayerId();if(null!=n.getTileLayer(o))r.splice(r.indexOf(o),1);else{var h=i.getUrl(a,s,u);h&&h.length>0&&e.taskDataManager.requestData(t,l.Resource.POIOverlay,h,o,i.getPrefixId(),(function(t){return i.parserData(t)}))}}));this.tileOverlays.forEach((function(i){var o=i.getProperties().getLayerId();if(null!=n.getTileLayer(o))r.splice(r.indexOf(o),1);else{var h=i.getUrl(a,s,u,f);null!=h&&h.length>0&&e.taskDataManager.requestData(t,l.Resource.RasterOverlay,h,o)}})),this.groundOverlays.forEach((function(o){var c=o.getProperties().getLayerId();if(null!=n.getTileLayer(c))r.splice(r.indexOf(c),1);else if(h.TileRange.fromLatLngBounds(o.getBounds(),u,u).contains(i)){var p=o.getUrl(a,s,u,f);p&&p.length>0&&e.taskDataManager.requestData(t,l.Resource.RasterOverlay,p,c)}})),r.forEach((function(i){e.removeTileData(t,i)}))},t.prototype.removeTileDataFromTiles=function(t){var e=this,i=this.map.tileManager.getVisibleTiles();i&&i.forEach((function(i){var n=e.tilePyramid.getTile(i.getTileCoordinate());e.removeTileData(n,t)}))},t.prototype.removeTileData=function(t,e){var i=t.getTileData(),n=i.getTileLayer(e);if(null!=n){var r=t.getTileRenderData();n.getFeatures().forEach((function(t){r.removeLayerRenderData(t.getId())})),i.removeTileLayer(e)}},t.prototype.createRasterOverlayLayer=function(t){if(!this.rasterOverlayLayers.has(t)){var e=this.map.createLayer(a.LayerConstants.rasterOverlayLayerId+t.toString(),o.LayerType.RASTER_OVERLAY,a.MapConstants.baseMapLowestOrder);e.effectManager=this.map.effectManager,e.timeEffectManager=this.map.timeEffectManager,e.setLightingManager(this.map.lightManager),this.rasterOverlayLayers.set(t,e)}},t.prototype.removeRasterOverlayLayer=function(t){this.map.removeLayer(a.LayerConstants.rasterOverlayLayerId+t.toString(),a.MapConstants.baseMapLowestOrder),this.rasterOverlayLayers.delete(t)},t.prototype.getRenderTiles=function(){return this.tilePyramid.getRenderTiles()},t.prototype.isDirty=function(){var t=this.mapState.getZoom(),e=!0;return(this.finishedLoad||this.mapState.isZoomIn()||this.mapState.isZoomOut()||!this.mapState.isFlyingTo()&&(Math.ceil(t-a.MathConstants.epsilon)>t||Math.floor(t+a.MathConstants.epsilon)<t))&&(e=!1),e},t.prototype.update=function(){this.isDirty()&&(this.tilePyramid.update(this.map.tileManager.getVisibleTiles(),this.mapState,this.lastZoom),this.taskDataManager.isAllRequestFinished()&&(this.finishedLoad=!0,this.lastZoom=this.mapState.getZoom()))},t.prototype.reload=function(){var t=this;this.finishedLoad=!1,this.taskDataManager.reload(),this.tilePyramid.getTiles().forEach((function(t){t.tile.destroy()})),this.tilePyramid.clear(),this.mapState.is3dMode()&&this.buildingOverlays.forEach((function(e,i){var n=t.map.getLayer(a.LayerConstants.buildingOverlayLayerId+i);null==n&&console.error("Error when get layer "+(a.LayerConstants.buildingOverlayLayerId+i)+" from Map."),n&&n.clear()}))},t.prototype.dirtyBuildingOverlay=function(){var t=this;this.buildingOverlays.forEach((function(e,i){var n=t.map.getLayer(a.LayerConstants.buildingOverlayLayerId+i);null==n&&console.error("Error when get layer "+(a.LayerConstants.buildingOverlayLayerId+i)+" from Map."),n&&n.setDirty()}))},t.prototype.dirtyRasterOverlays=function(){this.rasterOverlayLayers.forEach((function(t){t.setDirty()}))},t.prototype.isOverrideBaseMapTile=function(t){var e=!1,i=t.getZoom(),n=this.mapState.is3dMode();return this.groundOverlays.forEach((function(r){if(!e&&r.isOverride()&&h.TileRange.fromLatLngBounds(r.getBounds(),i,i).contains(t)){var o=r.getUrl(t.getX(),t.getY(),i,n);o&&o.length>0&&(e=!0)}})),e},t.prototype.addOverlay=function(t){var e=0;switch(t.getType()){case u.OverlayType.TILE:e=this.addTileOverlay(t);break;case u.OverlayType.GROUND:e=this.addGroundOverlay(t);break;case u.OverlayType.POI:e=this.addPOIOverlay(t);break;case u.OverlayType.BUILDING:e=this.addBuildingOverlay(t);break;default:console.warn("Unknown overlay type!")}return e},t.prototype.removeOverlay=function(t){this.tileOverlays.has(t)?this.removeTileOverlay(t):this.groundOverlays.has(t)?this.removeGroundOverlay(t):this.poiOverlays.has(t)?this.removePOIOverlay(t):this.buildingOverlays.has(t)?this.removeBuildingOverlay(t):console.warn("Overlay "+t+" not exist")},t.prototype.addTileOverlay=function(t){var e=this,i=this.idCounter++,n=a.LayerConstants.rasterOverlayLayerId+i.toString();t.getProperties().setLayerId(n),this.tileOverlays.set(i,t),this.createRasterOverlayLayer(i);var r=this.map.tileManager.getVisibleTiles();return r&&r.forEach((function(i){var r=i.getTileCoordinate(),o=e.tilePyramid.getTile(r);if(null!=o){var a=t.getUrl(r.getX(),r.getY(),r.getZoom(),e.map.mapState.is3dMode());a&&a.length>0&&e.taskDataManager.requestData(o,l.Resource.RasterOverlay,a,n)}})),i},t.prototype.removeTileOverlay=function(t){var e=this.tileOverlays.get(t);null!=t&&(this.removeTileDataFromTiles(e.getProperties().getLayerId()),this.tileOverlays.delete(t),this.removeRasterOverlayLayer(t))},t.prototype.addBuildingOverlay=function(t){var e=this,i=this.idCounter++,n=a.LayerConstants.buildingOverlayLayerId+i.toString();if(this.buildingOverlays.set(i,t),t.createLayer(this.map,n),this.mapState.is3dMode()){var r=this.map.tileManager.getVisibleTiles();r&&r.forEach((function(i){var r=i.getTileCoordinate(),o=e.tilePyramid.getTile(r);if(null!=o){var a=t.getUrl(r.getX(),r.getY(),r.getZoom());a&&a.length>0&&e.taskDataManager.requestData(o,l.Resource.BuildingOverlay,a,n,t.getPrefixId(),(function(e){return t.parserData(e)}))}}))}return i},t.prototype.removeBuildingOverlay=function(t){var e=this.buildingOverlays.get(t);null!=e&&(e.removeLayer(this.map),this.mapState.is3dMode()&&this.removeTileDataFromTiles(e.getProperties().getLayerId()),this.buildingOverlays.delete(t))},t.prototype.addGroundOverlay=function(t){var e=this,i=this.idCounter++,n=a.LayerConstants.rasterOverlayLayerId+i.toString();t.getProperties().setLayerId(n),this.groundOverlays.set(i,t),this.createRasterOverlayLayer(i);var r=this.map.tileManager.getVisibleTiles(),o=t.getBounds();return r&&r.forEach((function(i){var r=i.getTileCoordinate(),a=e.tilePyramid.getTile(r);if(null!=a){var s=r.getZoom();if(h.TileRange.fromLatLngBounds(o,s,s).contains(r)){var u=t.getUrl(r.getX(),r.getY(),r.getZoom(),e.map.mapState.is3dMode());u&&u.length>0&&(e.taskDataManager.requestData(a,l.Resource.RasterOverlay,u,n),e.map.tileManager.dirtyOverriddenTiles())}}})),i},t.prototype.removeGroundOverlay=function(t){var e=this.groundOverlays.get(t);null!=e&&(this.removeTileDataFromTiles(e.getProperties().getLayerId()),this.groundOverlays.delete(t),this.removeRasterOverlayLayer(t),e.isOverride()&&this.map.tileManager.dirtyOverriddenTiles())},t.prototype.addPOIOverlay=function(t){var e=this,i=this.idCounter++,n=a.LayerConstants.pointOverlayLayerId+i.toString();if(t.getProperties().setLayerId(n),this.map.createLayer(n,o.LayerType.POI_OVERLAY,a.MapConstants.baseMapLowestOrder).setProperties(t.getProperties()),this.poiOverlays.set(i,t),!this.mapState.is3dMode()){var r=this.map.tileManager.getVisibleTiles();r&&r.forEach((function(i){var r=i.getTileCoordinate(),o=e.tilePyramid.getTile(r);if(null!=o){var a=t.getUrl(r.getX(),r.getY(),r.getZoom());a&&a.length>0&&e.taskDataManager.requestData(o,l.Resource.POIOverlay,a,n,t.getPrefixId(),(function(e){return t.parserData(e)}))}}))}return i},t.prototype.removePOIOverlay=function(t){var e=this.poiOverlays.get(t);if(null!=e){var i=e.getProperties().getLayerId();this.map.removeLayer(i,a.MapConstants.baseMapLowestOrder),this.mapState.is3dMode()||this.removeTileDataFromTiles(i),this.poiOverlays.delete(t)}},t}();e.OverlayManager=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6),r=i(13),o=function(){function t(t,e,i,n,r,o){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n,this.minZoom=r,this.maxZoom=o}return t.fromLatLngBounds=function(e,i,o){var a=n.ProjectionMercator.projectZoom(e.getSouthwest(),o),s=n.ProjectionMercator.projectZoom(e.getNortheast(),o),l=Math.pow(2,o);return new t(Math.floor(a.x),Math.floor(s.x),r.MathUtils.clamp(Math.floor(s.y),0,l),r.MathUtils.clamp(Math.floor(a.y),0,l),i,o)},t.prototype.contains=function(t){var e=t.getX(),i=t.getY(),n=t.getZoom();if(n<=this.maxZoom&&n>=this.minZoom){if(0==n)return!0;var r=this.maxZoom-n,o=this.minX>>r,a=this.maxX>>r,s=this.minY>>r,l=this.maxY>>r;return(this.minX>this.maxX?e>=o||e<=a:e<=a&&e>=o)&&i<=l&&i>=s}return!1},t}();e.TileRange=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this._zoomGesturesEnabled=!0,this._scrollGesturesEnabled=!0,this._rotateGesturesEnabled=!0,this._tiltGesturesEnabled=!0}return t.prototype.isZoomGesturesEnabled=function(){return this._zoomGesturesEnabled},t.prototype.setZoomGesturesEnabled=function(t){this._zoomGesturesEnabled=t},t.prototype.isScrollGesturesEnabled=function(){return this._scrollGesturesEnabled},t.prototype.setScrollGesturesEnabled=function(t){this._scrollGesturesEnabled=t},t.prototype.isRotateGesturesEnabled=function(){return this._rotateGesturesEnabled},t.prototype.setRotateGesturesEnabled=function(t){this._rotateGesturesEnabled=t},t.prototype.isTiltGesturesEnabled=function(){return this._tiltGesturesEnabled},t.prototype.setTiltGesturesEnabled=function(t){this._tiltGesturesEnabled=t},t.prototype.setAllGesturesEnabled=function(t){this._zoomGesturesEnabled=t,this._scrollGesturesEnabled=t,this._rotateGesturesEnabled=t,this._tiltGesturesEnabled=t},t}();e.UISettings=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=i(64),o=i(329),a=function(){function t(){this.load(r.MapSettings.defaultMapStyle)}return t.prototype.load=function(t){if(null!=t&&0!=t.length){this.layers={};var e=JSON.parse(t).layers;for(var i in e){var n=o.LayerStyle.parser(i,e[i],null);null!=n&&(this.layers[i]=n)}}},t.prototype.build=function(t,e,i,r,a){var s=this.layers[t];if(null==s)return null;var l={kind:r||null,kind_detail:a||null},u=s.match(l,e);if(0==u.length)return null;switch(e){case"polygons":if(h=o.LayerStyle.getValue(i,u,"color"))return{color:h};break;case"lines":var h,c=o.LayerStyle.getValue(i,u,"width");if(c&&c>0)if(h=o.LayerStyle.getValue(i,u,"color"))return{width:c*n.MapUtils.pixelScale,color:h,outline:{width:o.LayerStyle.getValue(i,u,"outline_width"),color:o.LayerStyle.getValue(i,u,"outline_color")}};break;case"text":if((f=o.LayerStyle.getValue(i,u,"size"))&&f>0)return(p={}).size=f*n.MapUtils.resourceScale,p.color=o.LayerStyle.getValue(i,u,"color"),p.halo={},p.halo.color=o.LayerStyle.getValue(i,u,"halo_color"),p;break;case"points":var f,p;if((f=o.LayerStyle.getValue(i,u,"size"))&&f>0)return(p={}).size=f*n.MapUtils.pixelScale,p.halo={},p.halo.color=o.LayerStyle.getValue(i,u,"halo_color"),p;break;default:return null}return null},t}();e.MapStyle=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(330),r=i(331),o=function(){function t(t,e){this.name=t,this.depth=e,this.sublayers=[]}return t.prototype.match=function(t,e){var i=this.matchRule(t,e);return i.sort((function(t,e){return t.match==e.match?e.depth-t.depth:e.match-t.match})),i},t.prototype.matchRule=function(t,e){var i=[],n=null==this.filter?0:this.filter.match(t);return n>=0&&(null!=this.draw&&null!=this.draw[e]&&i.push({match:n,depth:this.depth,layer:this.name,rule:this.draw[e]}),this.sublayers.forEach((function(n){n.matchRule(t,e).forEach((function(t){i.push(t)}))}))),i},t.getValue=function(t,e,i){for(var r=0,o=e;r<o.length;r++){var a=o[r].rule;if(a[i])return n.Draw.getValue(t,a[i])}return null},t.parser=function(e,i,o){if(null==i||"object"!=typeof i)return null;var a=new t(e,null==o?0:o.depth+1),s=r.Filter.parser(i.filter);if(null!=o&&(null!=o.filter&&(s=o.filter.intersect(s)),null==s))return console.warn("The filter for layer "+e+" is incorrect"),null;for(var l in a.filter=s,a.draw=n.Draw.parser(i.draw),i)if("filter"!==l&&"draw"!==l){var u=t.parser(l,i[l],a);null!=u&&a.sublayers.push(u)}return a},t}();e.LayerStyle=o},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(12),a=i(2);function s(t){if("string"==typeof t)return[[a.MapConstants.defaultMinZoom,o.Color.fromHex(t)]];var e=[];return(t||[]).forEach((function(t){var i=t||[];2==i.length&&"number"==typeof i[0]&&"string"==typeof i[1]&&e.push([i[0],o.Color.fromHex(i[1])])})),e.length>0?(e.sort((function(t,e){return t[0]-e[0]})),e):null}function l(t){if("number"==typeof t)return[[a.MapConstants.defaultMinZoom,t]];var e=[];return(t||[]).forEach((function(t){var i=t||[];2==i.length&&"number"==typeof i[0]&&"number"==typeof i[1]&&e.push([i[0],i[1]])})),e.length>0?(e.sort((function(t,e){return t[0]-e[0]})),e):null}var u=function(){function t(t,e){this.color=t,this.width=e}return t.parser=function(e){if(null==e||"object"!=typeof e)return null;var i=s(e.color),n=l(e.width);return null!=i||null!=n?new t(i,n):null},t}(),h=function(t){function e(e,i,n){var r=t.call(this,e,i)||this;return r.outline=n,n&&(r.outline_color=n.color,r.outline_width=n.width),r}return r(e,t),e.parser=function(t){if(null==t||"object"!=typeof t)return null;var i=u.parser(t),n=u.parser(t.outline);return null!=i?new e(i.color,i.width,n):null!=n?new e(null,null,n):null},e}(u);e.LineRule=h;var c=function(){function t(t){this.color=t}return t.parser=function(e){if(null==e||"object"!=typeof e)return null;var i=s(e.color);return null!=i?new t(i):null},t}();e.PolygonRule=c;var f=function(){function t(t,e,i){this.color=t,this.size=e,this.halo_color=i}return t.parser=function(e){if(null==e||"object"!=typeof e)return null;var i=s(e.color),n=l(e.size),r=e.halo?s(e.halo.color):null;return null!=i||null!=n||null!=r?new t(i,n,r):null},t}();e.TextRule=f;var p=function(){function t(t,e){this.size=t,this.halo_color=e}return t.parser=function(e){if(null==e||"object"!=typeof e)return null;var i=l(e.size),n=e.halo?s(e.halo.color):null;return null!=i||null!=n?new t(i,n):null},t}();e.PointRule=p;var d=function(){function t(t,e,i,n){this.lines=t,this.polygons=e,this.text=i,this.points=n}return t.getValue=function(t,e){for(var i=null,n=0,r=e;n<r.length;n++){var o=r[n];if(o[0]>t)break;o[0]>0&&(i=o[1])}return i},t.parser=function(e){if(null==e||"object"!=typeof e)return null;var i=h.parser(e.lines),n=c.parser(e.polygons),r=f.parser(e.text),o=p.parser(e.points);return null==i&&null==n&&null==r&&null==o?null:new t(i,n,r,o)},t}();e.Draw=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.kind=t,this.kind_detail=e}return t.prototype.match=function(t){var e=0;if(this.kind){if(!this.kind.includes(t.kind))return-1;e++}if(this.kind_detail){if(!this.kind_detail.includes(t.kind_detail))return-1;e++}return e>0?e:-1},t.prototype.intersect=function(e){if(!e)return new t(this.kind,this.kind_detail);var i,n;if(this.kind&&e.kind){if(0==(i=this.kind.filter((function(t){return e.kind.includes(t)}))).length)return null}else i=this.kind?this.kind:e.kind;if(this.kind_detail&&e.kind_detail){if(0==(n=this.kind_detail.filter((function(t){return e.kind_detail.includes(t)}))).length)return null}else n=this.kind_detail?this.kind_detail:e.kind_detail;return new t(i,n)},t.parser=function(e){if(null==e||"object"!=typeof e)return null;var i=t.parserProperty(e,"kind");if(i&&0==i.length)return null;var n=t.parserProperty(e,"kind_detail");return n&&0==n.length?null:null!=i||null!=n?new t(i,n):null},t.parserProperty=function(t,e){var i=t[e];if(null==i)return null;if("string"==typeof i)return[i];var n=[];return(i||[]).forEach((function(t){"string"==typeof t&&(n.includes(t)||n.push(t))})),n},t}();e.Filter=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.idCounter=1,this.directionsRenderers=new Map}return t.prototype.addDirectionsRenderer=function(t){var e=this.idCounter++;return this.directionsRenderers.set(e,t),e},t.prototype.removeDirectionsRenderer=function(t){this.directionsRenderers.delete(t)},t.prototype.isDirectionsRendererMarker=function(t){var e=!1;return this.directionsRenderers.forEach((function(i){e||i.isMarkerClicked(t)&&(e=!0)})),e},t.prototype.getDirectionsRendererByAnnotationId=function(t){var e=null;return this.directionsRenderers.forEach((function(i){if(!e){var n=i.getRouteIndexByAnnotationId(t);-1!=n&&(e={renderer:i,routeIndex:n})}})),e},t}();e.DirectionsRendererManager=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(31),r=i(5),o=i(1),a=i(21),s=i(2),l=i(360),u=i(79),h=i(52),c=function(){function t(e,i){if(void 0===e&&(e=[]),this.clusters=[],this.events=[],null==e||0==e.length)throw Error("Markers list can not be null or empty");this.markers=e,this.markerClusterMap=new Map;var n={};o.MapUtils.extendOptions(n,t.defaultMarkerClusterOptions,i);for(var r=0,a=n;r<a.length;r++){if(null==a[r])throw Error("Parameters can not be null")}n.radius=n.radius*o.MapUtils.pixelScale,this.zoomOnClick=n.zoomOnClick,this.superCluster=new l.default(n);var s=this.getFeatures();this.superCluster.load(s)}return t.prototype.setMap=function(e){var i=this;if(this.map!==e&&(this.map&&(this.events.forEach((function(t){return t.remove()})),this.events=[],this.markers.forEach((function(t){return t.setMap(null)})),this.removeMarkerClusters()),this.map=e,this.map)){this.updateCluster(this.map.getCamera().getZoom());var n=this.map.addListener("click",(function(e){if("mouseup"==e.xa.type&&i.zoomOnClick){var n=e.marker,r=i.markerClusterMap.get(n.getId());if(null!=r){for(var o=i.superCluster.getLeaves(r,s.MapConstants.clusterMaxPointCount),l=new a.LatLngBounds,u=0,h=o;u<h.length;u++){var c=h[u];l.extend([c.geometry.coordinates[0],c.geometry.coordinates[1]])}var f=i.map.mapView.getCameraPositionForLatLngBounds(l,{top:0,left:0,right:0,bottom:0});i.map.fitBounds(l,t.defaultPadding,{animate:!0}),i.updateCluster(f.getZoom())}}}),{marker:!0}),r=this.map.addListener("idle",(function(){var t=i.map.mapView.mapState;(t.isZoomIn()||t.isZoomOut()||t.isFlyingTo())&&i.updateCluster(i.map.getCamera().getZoom())}));this.events.push(n),this.events.push(r)}},t.prototype.setZoomOnClick=function(t){null!=t?this.zoomOnClick=t:console.warn("Parameter zoomOnClick can not be null")},t.prototype.updateCluster=function(t){this.removeMarkerClusters();var e=this.map.mapView.getBounds();if(null!=e){var i=[e.getSouthwest().lng,e.getSouthwest().lat,e.getNortheast().lng,e.getNortheast().lat],n=this.superCluster.getClusters(i,Math.round(t));this.update(n)}},t.prototype.removeMarkerClusters=function(){this.clusters.forEach((function(t){return t.setMap(null)})),this.clusters=[]},t.prototype.update=function(t){var e=this;for(var i in t)if(null!=t[i].id){var o=this.superCluster.getLeaves(t[i].id,s.MapConstants.clusterMaxPointCount),a=15*(o.length.toString().length-1),l=50+a,c=50+a,f=new h.Icon(l,c,"markerClusterIcon"),p=new n.Marker({position:r.LatLng.convert(t[i].geometry.coordinates),icon:f,label:new u.MarkerLabel({text:o.length.toString(),fontSize:13,color:"#000000",haloColor:"#b22525"})});p.setMap(this.map),this.clusters.push(p),this.markerClusterMap.set(p.getId(),t[i].id),o.forEach((function(t){return e.markers[t.properties.index].setMap(null)}))}else{this.markers[t[i].properties.index].setMap(this.map)}},t.prototype.getFeatures=function(){var t=[];return this.markers.forEach((function(e,i){var n={type:"Feature",properties:{index:i},geometry:{type:"Point",coordinates:[]}};n.geometry.coordinates.push(e.getPosition().lng),n.geometry.coordinates.push(e.getPosition().lat),t.push(n)})),t},t.defaultMarkerClusterOptions={minZoom:0,maxZoom:22,radius:100,zoomOnClick:!0},t.defaultPadding={top:10,bottom:10,left:10,right:10},t}();e.MarkerClusterer=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=i(5),o=i(10),a=i(1),s=function(){function t(t){this.map=t}return t.prototype.fromLatLngToScreen=function(t,e){void 0===e&&(e=0);var i=this.map.mapView.latLngToScreenCoordinate(r.LatLng.convert(t),e);return a.MapUtils.pixelToPoint(new o.Point(i.x,i.y))},t.prototype.fromScreenToLatLng=function(t,e){void 0===e&&(e=0);var i=o.Point.convert(t),r=a.MapUtils.pointToPixel(i);return this.map.mapView.screenCoordinateToLatLng(new n.Vector2(r.x,r.y),e)},t}();e.Projection=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r=i(338),o=function(){function t(t){this._path=[],this._path=t.map((function(t){return n.LatLng.convert(t)}))}return t.prototype.setPath=function(t){this._path=t.map((function(t){return n.LatLng.convert(t)}))},t.prototype.addPath=function(t){var e=this;t.forEach((function(t){return e._path.push(n.LatLng.convert(t))}))},Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=0;e<this._path.length-1;++e)t+=r.SphericalUtil.computeDistanceBetween(this._path[e],this._path[e+1]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"perimeter",{get:function(){if(this._path.length<3)return 0;var t=this.length;return t+=r.SphericalUtil.computeDistanceBetween(this._path[0],this._path[this._path.length-1])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return r.SphericalUtil.computeArea(this._path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){if(0==this._path.length)return null;for(var t=new n.LatLng(0,0),e=0;e<this._path.length;++e)t.lat+=this._path[e].lat,t.lng+=this._path[e].lng;return t.lat/=this._path.length,t.lng/=this._path.length,t},enumerable:!0,configurable:!0}),t}();e.Measure=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(13),r=i(2),o=function(){function t(){}return t.computeDistanceBetweenHelper=function(t,e){var i=n.MathUtils.toRadians(t.lat),r=n.MathUtils.toRadians(t.lng),o=n.MathUtils.toRadians(e.lat),a=n.MathUtils.toRadians(e.lng);return 2*Math.asin(Math.sqrt(Math.pow(Math.sin((i-o)/2),2)+Math.cos(i)*Math.cos(o)*Math.pow(Math.sin((r-a)/2),2)))},t.sphericalExcess=function(e,i,n){for(var r=[e,i,n,e],o=[],a=0,s=0;s<3;s++)o[s]=t.computeDistanceBetweenHelper(r[s],r[s+1]),a+=o[s];var l=a/2,u=Math.tan(l/2);for(s=0;s<3;s++)u*=Math.tan((l-o[s])/2);return 4*Math.atan(Math.sqrt(Math.abs(u)))},t.sphericalSign=function(t,e,i){var r=[t,e,i].map((function(t){var e=n.MathUtils.toRadians(t.lat),i=n.MathUtils.toRadians(t.lng);return[Math.cos(e)*Math.cos(i),Math.cos(e)*Math.sin(i),Math.sin(e)]}));return 0<r[0][0]*r[1][1]*r[2][2]+r[1][0]*r[2][1]*r[0][2]+r[2][0]*r[0][1]*r[1][2]-r[0][0]*r[2][1]*r[1][2]-r[1][0]*r[0][1]*r[2][2]-r[2][0]*r[1][1]*r[0][2]?1:-1},t.computeSphericalExcess=function(e,i,n){return t.sphericalExcess(e,i,n)*t.sphericalSign(e,i,n)},t.computeSignedArea=function(e){if(e.length<3)return 0;for(var i=0,n=1;n<e.length-1;++n)i+=t.computeSphericalExcess(e[0],e[n],e[n+1]);return i*r.MapConstants.radiusEarthMeters*r.MapConstants.radiusEarthMeters},t.computeDistanceBetween=function(e,i){return t.computeDistanceBetweenHelper(e,i)*r.MapConstants.radiusEarthMeters},t.computeArea=function(e){return Math.abs(t.computeSignedArea(e))},t}();e.SphericalUtil=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),r=i(6),o=i(13),a=i(3),s=function(){function t(t){this.coordinates=[],this.coordinates=t.map((function(t){return n.LatLng.convert(t)}))}return t.prototype.setCoordinates=function(t){this.coordinates=t.map((function(t){return n.LatLng.convert(t)}))},t.prototype.addCoordinates=function(t){var e=this;t.forEach((function(t){return e.coordinates.push(n.LatLng.convert(t))}))},t.prototype.rotate=function(t,e){if(void 0===e&&(e=null),this.coordinates.length<=1)return this.coordinates.slice();var i=null;i=null!=e?n.LatLng.convert(i):this.center;var s=r.ProjectionMercator.convertToMeterFromLatLng(i),l=[],u=o.MathUtils.toRadians(t);return this.coordinates.forEach((function(t){var e=r.ProjectionMercator.convertToMeterFromLatLng(t);e.x-=s.x,e.y-=s.y;var i=e.x,n=e.y;e.x=i*Math.cos(u)-n*Math.sin(u),e.y=i*Math.sin(u)+n*Math.cos(u),l.push(r.ProjectionMercator.convertToLatLngFromMeter(new a.Vector2(s.x+e.x,s.y+e.y)))})),l},t.prototype.translate=function(t,e){if(void 0===e&&(e=null),this.coordinates.length<=0)return[];var i=n.LatLng.convert(t),r=null;r=null!=e?n.LatLng.convert(e):this.center;var o=[],a=i.lng-r.lng,s=i.lat-r.lat;return this.coordinates.forEach((function(t){o.push(new n.LatLng(t.lat+s,t.lng+a))})),o},t.prototype.scale=function(t,e){if(void 0===e&&(e=null),this.coordinates.length<=1)return this.coordinates.slice();var i=null;i=null!=e?n.LatLng.convert(e):this.center;var o=r.ProjectionMercator.convertToMeterFromLatLng(i),s=[];return this.coordinates.forEach((function(e){var i=r.ProjectionMercator.convertToMeterFromLatLng(e);i.x-=o.x,i.y-=o.y,i.x*=t,i.y*=t,s.push(r.ProjectionMercator.convertToLatLngFromMeter(new a.Vector2(o.x+i.x,o.y+i.y)))})),s},Object.defineProperty(t.prototype,"center",{get:function(){if(0==this.coordinates.length)return null;for(var t=new n.LatLng(0,0),e=0;e<this.coordinates.length;++e)t.lat+=this.coordinates[e].lat,t.lng+=this.coordinates[e].lng;return t.lat/=this.coordinates.length,t.lng/=this.coordinates.length,t},enumerable:!0,configurable:!0}),t}();e.CoordinateTransformer=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(48),a=i(62),s=i(0),l=i(2),u=i(1),h=function(t){function e(i){var n=t.call(this,o.OverlayType.BUILDING)||this,r={};u.MapUtils.extendOptions(r,e.defaultBuildingOverlayOptions,i);var s=r.visible;return n.prefixId=r.prefixId||"",n.properties=new a.OverlayProperties(s),n.getBuildingUrl=r.getUrl,n.parserBuildingData=r.parserData,null!=n.getBuildingUrl&&null!=n.parserBuildingData||(n.isValid=!1,console.warn("The BuildingOverlay is invalid, getUrl or parserData undefined")),n}return r(e,t),e.prototype.getUrl=function(t,e,i){return this.getBuildingUrl(t,e,i)},e.prototype.parserData=function(t){return this.parserBuildingData(t)},e.prototype.getPrefixId=function(){return this.prefixId},e.prototype.createLayer=function(t,e){this.properties.setLayerId(e);var i=t.createLayer(e,s.LayerType.BUILDING_OVERLAY,l.MapConstants.buildingLayerOrder);i.effectManager=this.map.mapView.effectManager,i.timeEffectManager=this.map.mapView.timeEffectManager,i.setLightingManager(this.map.mapView.lightManager),i.setProperties(this.properties)},e.prototype.removeLayer=function(t){t.removeLayer(this.properties.getLayerId(),l.MapConstants.buildingLayerOrder)},e.defaultBuildingOverlayOptions={prefixId:"",visible:!0},e}(o.Overlay);e.BuildingOverlay=h},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(48),a=i(62),s=function(t){function e(e){var i=t.call(this,o.OverlayType.TILE)||this,n=e||{};return i.getTileUrl=n.getUrl,i.properties=new a.OverlayProperties(null==n.visible||n.visible,n.zIndex||0),null==i.getTileUrl&&(i.isValid=!1,console.warn("The TileOverlay is invalid, getUrl undefined")),i}return r(e,t),e.prototype.getUrl=function(t,e,i,n){return this.getTileUrl?this.getTileUrl(t,e,i,n):""},e.prototype.getZIndex=function(){return this.properties.getZIndex()},e}(o.Overlay);e.TileOverlay=s},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(21),a=i(48),s=i(62),l=function(t){function e(e){var i=t.call(this,a.OverlayType.GROUND)||this,n=e||{};return i.bounds=o.LatLngBounds.convert(n.bounds),i.override=null!=n.override&&n.override,i.getGroundUrl=n.getUrl,i.properties=new s.OverlayProperties(null==n.visible||n.visible,n.zIndex||0),null==i.getGroundUrl&&(i.isValid=!1,console.warn("The GroundOverlay is invalid, getUrl undefined")),i}return r(e,t),e.prototype.getBounds=function(){return this.bounds},e.prototype.getUrl=function(t,e,i,n){return null!=this.getGroundUrl?this.getGroundUrl(t,e,i,n):""},e.prototype.isOverride=function(){return this.override},e.prototype.getZIndex=function(){return this.properties.getZIndex()},e}(a.Overlay);e.GroundOverlay=l},function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(48),a=i(62),s=function(t){function e(e){var i=t.call(this,o.OverlayType.POI)||this,n=e||{};return i.getPOIUrl=n.getUrl,i.parserPOIData=n.parserData,i.prefixId=n.prefixId||"",i.properties=new a.OverlayProperties(null==n.visible||n.visible),null!=i.getPOIUrl&&null!=i.parserPOIData||(i.isValid=!1,console.warn("The POIOverlay is invalid, getUrl or parserData undefined")),i}return r(e,t),e.prototype.getUrl=function(t,e,i){return this.getPOIUrl(t,e,i)},e.prototype.parserData=function(t){return this.parserPOIData(t)},e.prototype.getPrefixId=function(){return this.prefixId},e}(o.Overlay);e.POIOverlay=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=i(5),o=i(31),a=i(36),s=function(){function t(t){this.id=0,this.initialize(t)}return t.prototype.initialize=function(e){var i={};n.MapUtils.extendOptions(i,t.defaultOptions,e);var s=i.routes||[];s.length>0?this.routes=s.map((function(t){return t.map((function(t){return r.LatLng.convert(t)}))})):this.routes=i.directions?this.parseDirections(i.directions):[],this.activedIndex=i.activedIndex||0,this.activeStrokeWidth=i.activeStrokeWidth,this.activeStrokeColor=i.activeStrokeColor,this.activeOutlineWidth=i.activeOutlineWidth,this.activeOutlineColor=i.activeOutlineColor,this.inactiveStrokeWidth=i.inactiveStrokeWidth,this.inactiveStrokeColor=i.inactiveStrokeColor,this.inactiveOutlineWidth=i.inactiveOutlineWidth,this.inactiveOutlineColor=i.inactiveOutlineColor,this.lines=[],this.outlines=[];var l=i.originMarkerOptions||{};this.hasOriginPoint=!!l.position,l.draggable=!1,l.position=l.position||[0,0],this.originMarker=new o.Marker(l);var u=i.destinationMarkerOptions||{};this.hasDestinationPoint=!!u.position,u.draggable=!1,u.position=u.position||[0,0],this.destinationMarker=new o.Marker(u),this.originToRoutePolyline=new a.Polyline({path:[],strokeWidth:5,zIndex:-32e5,style:"dotted",strokeColor:"#000",userInteractionEnabled:!1}),this.destinationToRoutePolyline=new a.Polyline({path:[],strokeWidth:5,zIndex:-32e5,style:"dotted",strokeColor:"#000",userInteractionEnabled:!1})},t.prototype.setOptions=function(t){this.removeObjecsFromMap(),this.initialize(t),this.map&&(this.lines=[],this.outlines=[],this.routes.length>0&&(this.setupRouteLines(),this.setupOriginWaypoint(),this.setupDestinationWaypoint()))},t.prototype.setMap=function(t){if(this.map!==t&&(null!=this.map&&(this.removeObjecsFromMap(),this.map.mapView.directionsRendererManager.removeDirectionsRenderer(this.id),this.id=0),this.map=t,null!=t)){if(this.id=this.map.mapView.directionsRendererManager.addDirectionsRenderer(this),0==this.routes.length)return;this.setupRouteLines(),this.setupOriginWaypoint(),this.setupDestinationWaypoint()}},t.prototype.getMap=function(){return this.map},t.prototype.setRoutes=function(t){var e=t||[];this.routes=e.map((function(t){return t.map((function(t){return r.LatLng.convert(t)}))})),this.activedIndex>=this.routes.length&&(this.activedIndex=0),this.map&&(this.removeObjecsFromMap(),this.lines=[],this.outlines=[],this.routes.length>0&&(this.setupRouteLines(),this.setupOriginWaypoint(),this.setupDestinationWaypoint()))},t.prototype.getRoutes=function(){return(this.routes||[]).slice()},t.prototype.setDirections=function(t){this.setRoutes(this.parseDirections(t))},t.prototype.setActivedIndex=function(t){var e=this.activedIndex;t>=this.routes.length?this.activedIndex=0:this.activedIndex=t,e!=this.activedIndex&&this.map&&(this.swapLineOptions(this.lines[e],this.lines[t]),this.swapLineOptions(this.outlines[e],this.outlines[t]))},t.prototype.getActivedIndex=function(){return this.activedIndex},t.prototype.getRouteIndexByAnnotationId=function(t){for(var e=0;e<this.lines.length;e++)if(this.lines[e].getId()==t||this.outlines[e].getId()==t)return e;return-1},t.prototype.isMarkerClicked=function(t){return this.originMarker.getId()==t||this.destinationMarker.getId()==t},t.prototype.parseDirections=function(t){var e=((JSON.parse(t)||{}).result||{}).routes||[];if(0==e.length)return[];for(var i=[],n=0,o=e;n<o.length;n++){var a=o[n].legs||[];if(0!=a.length){for(var s=[],l=0,u=a;l<u.length;l++)for(var h=u[l].steps||[],c=0;c<h.length;c++){var f=h[c];s.push(r.LatLng.convert(f.startLocation)),c==h.length-1&&s.push(r.LatLng.convert(f.endLocation))}i.push(s)}}return i},t.prototype.setupOriginWaypoint=function(){var t=this.routes[this.activedIndex];if(t&&0!=t.length&&this.originMarker.isVisible()){var e=t[0];this.hasOriginPoint?(this.originToRoutePolyline.setPath([e,this.originMarker.getPosition()]),this.originToRoutePolyline.setMap(this.map)):(this.originMarker.setPosition(e),this.originToRoutePolyline.setMap(null)),this.originMarker.setMap(this.map)}},t.prototype.setupDestinationWaypoint=function(){var t=this.routes[this.activedIndex];if(t&&0!=t.length&&this.destinationMarker.isVisible()){var e=t[t.length-1];this.hasDestinationPoint?(this.destinationToRoutePolyline.setPath([e,this.destinationMarker.getPosition()]),this.destinationToRoutePolyline.setMap(this.map)):(this.destinationMarker.setPosition(e),this.destinationToRoutePolyline.setMap(null)),this.destinationMarker.setMap(this.map)}},t.prototype.swapLineOptions=function(t,e){var i={width:t.getStrokeWidth(),color:t.getStrokeColor(),zIndex:t.getZIndex(),map:t.getMap()};t.setStrokeWidth(e.getStrokeWidth()),t.setStrokeColor(e.getStrokeColor()),t.setZIndex(e.getZIndex()),i.map!=e.getMap()&&t.setMap(e.getMap()),e.setStrokeWidth(i.width),e.setStrokeColor(i.color),e.setZIndex(i.zIndex),i.map!=e.getMap()&&e.setMap(i.map)},t.prototype.setupRouteLines=function(){var t=this;this.routes.forEach((function(e,i){var n=i==t.activedIndex,r=new a.Polyline({path:e,strokeColor:n?t.activeStrokeColor:t.inactiveStrokeColor,strokeWidth:n?t.activeStrokeWidth:t.inactiveStrokeWidth,zIndex:n?-2e6:-3e6});r.setMap(t.map),t.lines.push(r);var o=new a.Polyline({path:e,zIndex:n?-21e5:-31e5});t.outlines.push(o),(n?t.activeOutlineWidth>0:t.inactiveOutlineWidth>0)&&(o.setStrokeColor(n?t.activeOutlineColor:t.inactiveOutlineColor),o.setStrokeWidth(n?t.activeStrokeWidth+2*t.activeOutlineWidth:t.inactiveStrokeWidth+2*t.inactiveOutlineWidth),o.setMap(t.map))}))},t.prototype.removeObjecsFromMap=function(){this.lines.forEach((function(t){t.setMap(null)})),this.outlines.forEach((function(t){t.setMap(null)})),this.originMarker.setMap(null),this.destinationMarker.setMap(null),this.originToRoutePolyline.setMap(null),this.destinationToRoutePolyline.setMap(null)},t.defaultOptions={activeStrokeWidth:8,activeStrokeColor:"#669DF6",activeOutlineWidth:2,activeOutlineColor:"#0000FF",inactiveStrokeWidth:8,inactiveStrokeColor:"#BBBDBF",inactiveOutlineWidth:2,inactiveOutlineColor:"#000000"},t}();e.DirectionsRenderer=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.POIOptions=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.BuildingOptions=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,i){"use strict";function n(t,e,i,o,a,s){if(a-o<=i)return;const l=o+a>>1;!function t(e,i,n,o,a,s){for(;a>o;){if(a-o>600){const r=a-o+1,l=n-o+1,u=Math.log(r),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(r-h)/r)*(l-r/2<0?-1:1),f=Math.max(o,Math.floor(n-l*h/r+c)),p=Math.min(a,Math.floor(n+(r-l)*h/r+c));t(e,i,n,f,p,s)}const l=i[2*n+s];let u=o,h=a;for(r(e,i,o,n),i[2*a+s]>l&&r(e,i,o,a);u<h;){for(r(e,i,u,h),u++,h--;i[2*u+s]<l;)u++;for(;i[2*h+s]>l;)h--}i[2*o+s]===l?r(e,i,o,h):(h++,r(e,i,h,a)),h<=n&&(o=h+1),n<=h&&(a=h-1)}}(t,e,l,o,a,s%2),n(t,e,i,o,l-1,s+1),n(t,e,i,l+1,a,s+1)}function r(t,e,i,n){o(t,i,n),o(e,2*i,2*n),o(e,2*i+1,2*n+1)}function o(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function a(t,e,i,n){const r=t-i,o=e-n;return r*r+o*o}i.r(e),i.d(e,"default",(function(){return c}));const s=t=>t[0],l=t=>t[1];class u{constructor(t,e=s,i=l,r=64,o=Float64Array){this.nodeSize=r,this.points=t;const a=t.length<65536?Uint16Array:Uint32Array,u=this.ids=new a(t.length),h=this.coords=new o(2*t.length);for(let n=0;n<t.length;n++)u[n]=n,h[2*n]=e(t[n]),h[2*n+1]=i(t[n]);n(u,h,r,0,u.length-1,0)}range(t,e,i,n){return function(t,e,i,n,r,o,a){const s=[0,t.length-1,0],l=[];let u,h;for(;s.length;){const c=s.pop(),f=s.pop(),p=s.pop();if(f-p<=a){for(let a=p;a<=f;a++)u=e[2*a],h=e[2*a+1],u>=i&&u<=r&&h>=n&&h<=o&&l.push(t[a]);continue}const d=Math.floor((p+f)/2);u=e[2*d],h=e[2*d+1],u>=i&&u<=r&&h>=n&&h<=o&&l.push(t[d]);const g=(c+1)%2;(0===c?i<=u:n<=h)&&(s.push(p),s.push(d-1),s.push(g)),(0===c?r>=u:o>=h)&&(s.push(d+1),s.push(f),s.push(g))}return l}(this.ids,this.coords,t,e,i,n,this.nodeSize)}within(t,e,i){return function(t,e,i,n,r,o){const s=[0,t.length-1,0],l=[],u=r*r;for(;s.length;){const h=s.pop(),c=s.pop(),f=s.pop();if(c-f<=o){for(let r=f;r<=c;r++)a(e[2*r],e[2*r+1],i,n)<=u&&l.push(t[r]);continue}const p=Math.floor((f+c)/2),d=e[2*p],g=e[2*p+1];a(d,g,i,n)<=u&&l.push(t[p]);const y=(h+1)%2;(0===h?i-r<=d:n-r<=g)&&(s.push(f),s.push(p-1),s.push(y)),(0===h?i+r>=d:n+r>=g)&&(s.push(p+1),s.push(c),s.push(y))}return l}(this.ids,this.coords,t,e,i,this.nodeSize)}}const h={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,map:t=>t};class c{constructor(t){this.options=_(Object.create(h),t),this.trees=new Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:i,maxZoom:n,nodeSize:r}=this.options;e&&console.time("total time");const o=`prepare ${t.length} points`;e&&console.time(o),this.points=t;let a=[];for(let e=0;e<t.length;e++)t[e].geometry&&a.push(p(t[e],e));this.trees[n+1]=new u(a,b,w,r,Float32Array),e&&console.timeEnd(o);for(let t=n;t>=i;t--){const i=+Date.now();a=this._cluster(a,t),this.trees[t]=new u(a,b,w,r,Float32Array),e&&console.log("z%d: %d clusters in %dms",t,a.length,+Date.now()-i)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let i=((t[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)i=-180,r=180;else if(i>r){const t=this.getClusters([i,n,180,o],e),a=this.getClusters([-180,n,r,o],e);return t.concat(a)}const a=this.trees[this._limitZoom(e)],s=a.range(y(i),m(o),y(r),m(n)),l=[];for(const t of s){const e=a.points[t];l.push(e.numPoints?d(e):this.points[e.index])}return l}getChildren(t){const e=t>>5,i=t%32,n="No cluster with the specified id.",r=this.trees[i];if(!r)throw new Error(n);const o=r.points[e];if(!o)throw new Error(n);const a=this.options.radius/(this.options.extent*Math.pow(2,i-1)),s=r.within(o.x,o.y,a),l=[];for(const e of s){const i=r.points[e];i.parentId===t&&l.push(i.numPoints?d(i):this.points[i.index])}if(0===l.length)throw new Error(n);return l}getLeaves(t,e,i){e=e||10,i=i||0;const n=[];return this._appendLeaves(n,t,e,i,0),n}getTile(t,e,i){const n=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:o,radius:a}=this.options,s=a/o,l=(i-s)/r,u=(i+1+s)/r,h={features:[]};return this._addTileFeatures(n.range((e-s)/r,l,(e+1+s)/r,u),n.points,e,i,r,h),0===e&&this._addTileFeatures(n.range(1-s/r,l,1,u),n.points,r,i,r,h),e===r-1&&this._addTileFeatures(n.range(0,l,s/r,u),n.points,-1,i,r,h),h.features.length?h:null}getClusterExpansionZoom(t){let e=t%32-1;for(;e<=this.options.maxZoom;){const i=this.getChildren(t);if(e++,1!==i.length)break;t=i[0].properties.cluster_id}return e}_appendLeaves(t,e,i,n,r){const o=this.getChildren(e);for(const e of o){const o=e.properties;if(o&&o.cluster?r+o.point_count<=n?r+=o.point_count:r=this._appendLeaves(t,o.cluster_id,i,n,r):r<n?r++:t.push(e),t.length===i)break}return r}_addTileFeatures(t,e,i,n,r,o){for(const a of t){const t=e[a],s={type:1,geometry:[[Math.round(this.options.extent*(t.x*r-i)),Math.round(this.options.extent*(t.y*r-n))]],tags:t.numPoints?g(t):this.points[t.index].properties},l=t.numPoints?t.id:this.points[t.index].id;void 0!==l&&(s.id=l),o.features.push(s)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))}_cluster(t,e){const i=[],{radius:n,extent:r,reduce:o}=this.options,a=n/(r*Math.pow(2,e));for(let n=0;n<t.length;n++){const r=t[n];if(r.zoom<=e)continue;r.zoom=e;const s=this.trees[e+1],l=s.within(r.x,r.y,a);let u=r.numPoints||1,h=r.x*u,c=r.y*u;const p=o?this._map(r,!0):null,d=(n<<5)+(e+1);for(const t of l){const i=s.points[t];if(i.zoom<=e)continue;i.zoom=e;const n=i.numPoints||1;h+=i.x*n,c+=i.y*n,u+=n,i.parentId=d,o&&o(p,this._map(i))}1===u?i.push(r):(r.parentId=d,i.push(f(h/u,c/u,d,u,p)))}return i}_map(t,e){if(t.numPoints)return e?_({},t.properties):t.properties;const i=this.points[t.index].properties,n=this.options.map(i);return e&&n===i?_({},n):n}}function f(t,e,i,n,r){return{x:t,y:e,zoom:1/0,id:i,parentId:-1,numPoints:n,properties:r}}function p(t,e){const[i,n]=t.geometry.coordinates;return{x:y(i),y:m(n),zoom:1/0,index:e,parentId:-1}}function d(t){return{type:"Feature",id:t.id,properties:g(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),v(t.y)]}};var e}function g(t){const e=t.numPoints,i=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return _(_({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:i})}function y(t){return t/360+.5}function m(t){const e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function v(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function _(t,e){for(const i in e)t[i]=e[i];return t}function b(t){return t.x}function w(t){return t.y}}]);
//# sourceMappingURL=map4dsdk@1.6.2.prod.js.map